<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet" />
        <script src="node_modules/@fds-components/fds-treeview/dist/fds-treeview.js"></script>
        <script src="node_modules/@fds-components/fds-image-editor-button/dist/fds-image-editor-button.js"></script>
        <script src="node_modules/@fds-components/fds-tabs/dist/fds-tabs.js"></script>
        <script src="node_modules/@fds-components/fds-tippy/dist/fds-tippy.js"></script>
        <script src="node_modules/@fds-components/fds-ai-image-editor/dist/fds-ai-image-editor.js?3"></script>
        <script src="node_modules/@fds-components/fds-pose-editor/dist/fds-pose-editor.js?5"></script>
        <script src="node_modules/@fds-components/fds-image-editor-text/dist/fds-image-editor-text.js?3"></script>
        <script src="node_modules/@fds-components/fds-slider/dist/fds-slider.js?3"></script>
        <script src="node_modules/@fds-components/fds-progress/dist/fds-progress.js?3"></script>
        <script src="node_modules/@fds-components/fds-3d-scene/dist/fds-3d-scene.js?3"></script>
        <script src="node_modules/@fds-components/fds-image-editor-dialog/dist/fds-image-editor-dialog.js?3"></script>
        <script src="node_modules/@fds-components/fds-image-editor-toggle/dist/fds-image-editor-toggle.js?3"></script>
        <script src="node_modules/@fds-components/fds-image-editor-progress-bar/dist/fds-image-editor-progress-bar.js?3"></script>

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, height=device-height" />

        <script src="node_modules/@fds-components/fds-image-transform/dist/fds-image-transform.js?1"></script>
        <script src="node_modules/@fds-components/fds-local-files/dist/fds-local-files.js?1"></script>
        <link
            href="https://fonts.googleapis.com/css?family=Montez|Lobster|Josefin+Sans|Shadows+Into+Light|Pacifico|Amatic+SC:700|Orbitron:400,900|Rokkitt|Righteous|Dancing+Script:700|Bangers|Chewy|Sigmar+One|Architects+Daughter|Abril+Fatface|Covered+By+Your+Grace|Kaushan+Script|Gloria+Hallelujah|Satisfy|Lobster+Two:700|Comfortaa:700|Cinzel|Courgette"
            rel="stylesheet"
            type="text/css"
            data-noprefix
        />

        <script src="bootstrap.js?1"></script>
        <script src="appdata/brushes/tinycolor.js"></script>
        <script src="appdata/brushes/brush_Default.js?5"></script>
        <script src="appdata/brushes/brush_Oil_A.js?4"></script>
        <script src="appdata/brushes/brush_Caligraphy.js?20"></script>
        <script src="appdata/brushes/brush_FromLayers.js?19"></script>

        <script src="babylon/babylon.js"></script>
        <script src="babylon/babylonjs.loaders.min.js"></script>
        <script src="babylon/babylon.gridMaterial.min.js"></script>
        <script src="babylon/babylon.gui.min.js"></script>

        <script src="fds-image-editor-canvas.js?18"></script>

        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet" />



<script src="https://fds-image-editor-sam-components-357098670083755d61d952e2824f114.pages.fdog.de/fds-image-editor-sam.js?2"></script>

        <style>
            :root {
                color-scheme: dark;
            }
            body {
                font-size: 15px;
                font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, 'Segoe UI', Helvetica, Arial,
                    'Apple Color Emoji', 'Segoe UI Emoji';

                background-color: var(--theme-bgcolor);
                margin: 0;
                overflow: hidden;
            }

            html {
                scroll-behavior: smooth;
            }

            * {
                box-sizing: border-box;
            }
            .psColorScheme {
                --theme-stage-color: #282828;
                --theme-btn-selected-bgcolor: #454545;
                --theme-btn-selected-border-color: #5e5e5e;
                --theme-btn-text-color: #dddddd;
                --theme-bgcolor: #4c4c4c;
                --theme-dialog-bgcolor: #4c4c4c;
                --theme-text-color: #dddddd;
                --theme-internal-seperator-color: #707070;
                /* Slider */
                --theme-slider-track-bgcolor: #757575;
                --theme-slider-track-focus-bgcolor: #367ebd;
                --theme-slider-track-border-color: #010101;
                --theme-slider-thumb-color: #dddddd;
            }

            .darkColorScheme {
                --theme-stage-color: #1d1d1d;
                --theme-btn-selected-bgcolor: #ddb74f;
                --theme-btn-selected2-bgcolor: #e3ce74;

                --theme-btn-selected-border-color: #ddb74f;
                --theme-btn-text-color: #fbfbfb;
                --theme-btn-selected-text-color: #272727;
                --theme-bgcolor: #323232;
                --theme-dialog-bgcolor: #202020;
                --theme-text-color: #ebebeb;
                --theme-internal-seperator-color: #535353;
                /* Slider */
                --theme-slider-track-bgcolor: #757575;
                --theme-slider-track-focus-bgcolor: #ddb74f;
                --theme-slider-track-border-color: #010101;
                --theme-slider-thumb-color: #dddddd;
            }
            .swal-button--confirm {
                border: none;
                background-color: #ddb74f;
                color: #272727;
            }
            .swal-button--confirm:not([disabled]):hover {
                border: none;
                background-color: #e3ce74;
            }
            .swal-title {
                font-weight: bold;
                font-size: 16px;
            }
            .colorScheme {
                --stage-color: var(--theme-stage-color);
                --btn-selected-bgcolor: var(--theme-btn-selected-bgcolor);
                --btn-selected2-bgcolor: var(--theme-btn-selected2-bgcolor);
                --btn-selected-border-color: var(--theme-btn-selected-border-color);
                --btn-text-color: var(--theme-btn-text-color);
                --btn-selected-text-color: var(--theme-btn-selected-text-color);

                --bgcolor: var(--theme-bgcolor);
                --dialog-bgcolor: var(--theme-dialog-bgcolor);
                --text-color: var(--theme-text-color);
                /* Slider */
                --slider-track-bgcolor: var(--theme-slider-track-bgcolor);
                --slider-track-focus-bgcolor: var(--theme-slider-track-focus-bgcolor);
                --slider-track-border-color: var(--theme-slider-track-border-color);
                --slider-ipad-track-border-color: var(--theme-slider-track-bgcolor);
                --slider-thumb-color: var(--theme-slider-thumb-color);

                --btn-bw-simple-bgcolor: #6b6b6b;
                --btn-bw-simple-bgcolor-hover: var(--theme-btn-selected-bgcolor);
                --btn-bw-simple-color: white;
                --btn-bw-simple-color-hover: #000000;
            }
        </style>
    </head>
    <body class="darkColorScheme">
        <script>

            class Gyre {
                serverName
                currentExtensionName

                setCurrentExtensionName(extensionName) {
                    this.currentExtensionName=extensionName
                }
                getFullExtensionPath(extensionName) {
                    return this.serverName+"/gyre_extensions/"+extensionName
                }

                loadScript(path,extensionName="") {
                    if (!extensionName) extensionName=this.currentExtensionName
                    let src=this.getFullExtensionPath(extensionName)+"/"+path
                    let script=window.document.createElement("script")
                    script.async = false
                    script.src=src
                    document.head.appendChild(script)
                }
            }
            globalThis.gyre=new Gyre()

            const params = new URLSearchParams(window.location.search);
            // Get a specific parameter value by its name
            const paramName = params.get('comfy');
            if(paramName) window.comfyuimode = true;
            window.addEventListener('load', () => {

                window.demomode = !window.postMessageAdapter
                window.developmode = false;
                let documentInfo = { width: 2301, height: 1536 }
                let layers = []
                let Config = {}
                let serverFeatures = {}
                let component = document.querySelector('fds-ai-editor')
                component.registerBrush(new brush_Default(), 'brush_Default')
                component.registerBrush(new brush_FromLayers(), 'brush_FromLayers')
                component.registerBrush(new brush_Oil_A(), 'brush_Oil_A')
                component.registerBrush(new brush_Caligraphy(), 'brush_Caligraphy')

                globalThis.gyre.registerPlugin("fds-image-editor-sam",{type:"tool",floatingToolBar:true,floatingToolBarWidth:480,title:"Auto Matte",
        icons: {
            "eye": {
                body: '<path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/><path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/></svg>'
            },
            "toolbar-icon": {
              body: '<rect id="Canvas" fill="#ff13dc" opacity="0" width="18" height="18"></rect><path class="fill" d="M8.1665,8.907a2.234,2.234,0,0,0-1.57.419,3.2175,3.2175,0,0,0-.984,1.718,3.04951,3.04951,0,0,1-1.091,1.8135,1.13982,1.13982,0,0,0-.294.205.262.262,0,0,0-.031.3285.36445.36445,0,0,0,.2.0945c1.6585.382,3.7745.509,5.139-.717A2.2,2.2,0,0,0,8.895,9.105,2.35712,2.35712,0,0,0,8.1665,8.907Z"></path><path class="fill" d="M11.4685,9.7635c2.8535-3.245,6.477-7.705,5.528-8.654S12.1175,4.587,9.291,7.685A3.965,3.965,0,0,1,11.4685,9.7635Z"></path><path class="fill" d="M3.7345,2.977l-.3-1.0185A5.57649,5.57649,0,0,0,1.532,4.195l.9925.2415A4.50337,4.50337,0,0,1,3.7345,2.977Z"></path><path class="fill" d="M2,6.5c0-.121.026-.2345.0355-.353l-.994-.242A5.58233,5.58233,0,0,0,1,6.5555V8.111H2Z"></path><path class="fill" d="M2,11.5V9.889H1v1.5555a5.58371,5.58371,0,0,0,.055.7415l.99-.2415A4.35788,4.35788,0,0,1,2,11.5Z"></path><path class="fill" d="M2.57,13.6465l-.997.243a5.57542,5.57542,0,0,0,1.863,2.15l.3-1.019A4.48951,4.48951,0,0,1,2.57,13.6465Z"></path><path class="fill" d="M6.5,16a4.43493,4.43493,0,0,1-1.15-.168l-.2815.9605a5.432,5.432,0,0,0,2.974,0L7.75,15.8A4.434,4.434,0,0,1,6.5,16Z"></path><path class="fill" d="M10.443,13.6225A4.49545,4.49545,0,0,1,9.355,14.95l.32,1.0925a5.57705,5.57705,0,0,0,1.8635-2.15Z"></path><path class="fill" d="M10.471,4.428q.4025-.43451.777-.83A5.55,5.55,0,0,0,9.675,1.9585L9.355,3.05A4.49016,4.49016,0,0,1,10.471,4.428Z"></path><path class="fill" d="M6.5,2a4.43323,4.43323,0,0,1,1.25.2l.2905-.9915a5.432,5.432,0,0,0-2.974,0l.281.96A4.442,4.442,0,0,1,6.5,2Z"></path>'  
            }
        }


        })            

                if (!window.uxpHost && window.demomode) {
                    component.document = documentInfo
                    component.layers = layers
                    component.paletteValues.Config = Config
                    component.paletteValues.generate = Config.generalConfig.dlgData
                    component.paletteValues.generate.prompt = Config.globalData.prompt
                    component.paletteValues.generate.modifiers = Config.globalData.modifiers
                    component.paletteValues.generate.mode = ''
                    component.paletteValues.serverFeatures = serverFeatures
                }
            })
            // handle unhandled promise rejections
            window.addEventListener('unhandledrejection', function (event) {
                console.log(event.reason)
                console.log(event.promise)
                alert(event.reason)
            })
        </script>
        <!--  <img id="test" width="500" /> -->
        <fds-ai-editor class="darkColorScheme"></fds-ai-editor>
    </body>
</html>
