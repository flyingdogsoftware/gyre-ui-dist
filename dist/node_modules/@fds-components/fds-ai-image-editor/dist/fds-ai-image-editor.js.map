{"version":3,"file":"fds-ai-image-editor.js","sources":["../node_modules/svelte/internal/index.mjs","../node_modules/@fds-components/fds-helper/dist/index.js","../src/postmessageadapter/tutorials.js","../src/postmessageadapter/quickStart.js","../src/postmessageadapter/newDocument.js","../node_modules/sweetalert/dist/sweetalert.min.js","../src/postmessageadapter/confirmDialog.js","../node_modules/svelte/store/index.mjs","../src/postmessageadapter/TasksStore.js","../src/postmessageadapter/Gyre.js","../src/postmessageadapter/gyreDocument.js","../src/postmessageadapter/wizards.js","../src/postmessageadapter/FirstConfig.svelte","../src/postmessageadapter/WizardSteps.svelte","../src/postmessageadapter/LayerStack3D.svelte","../src/postmessageadapter/ConfigClass.js","../src/Preparser/mappingsHelper.js","../src/Preparser/rulesExecution.js","../src/Preparser/loopPreparser.js","../src/Preparser/valuePreparser.js","../src/Preparser/ComfyUIPreparser.js","../src/workflowjsonconverter/converter.js","../src/litegraph/litegraph.js","../src/postmessageadapter/Comfy.js","../src/postmessageadapter/SDWebservice.js","../src/postmessageadapter/prompt.js","../src/postmessageadapter/ComfyStandAlone.js","../src/postmessageadapter/postMessageAdapter.js","../src/App.svelte"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\nfunction is_promise(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function') && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\nfunction split_css_unit(value) {\n    const split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n    return split ? [parseFloat(split[1]), split[2] || 'px'] : [value, 'px'];\n}\nconst contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\n/**\n * Resize observer singleton.\n * One listener per element only!\n * https://groups.google.com/a/chromium.org/g/blink-dev/c/z6ienONUb5A/m/F5-VcUZtBAAJ\n */\nclass ResizeObserverSingleton {\n    constructor(options) {\n        this.options = options;\n        this._listeners = 'WeakMap' in globals ? new WeakMap() : undefined;\n    }\n    observe(element, listener) {\n        this._listeners.set(element, listener);\n        this._getObserver().observe(element, this.options);\n        return () => {\n            this._listeners.delete(element);\n            this._observer.unobserve(element); // this line can probably be removed\n        };\n    }\n    _getObserver() {\n        var _a;\n        return (_a = this._observer) !== null && _a !== void 0 ? _a : (this._observer = new ResizeObserver((entries) => {\n            var _a;\n            for (const entry of entries) {\n                ResizeObserverSingleton.entries.set(entry.target, entry);\n                (_a = this._listeners.get(entry.target)) === null || _a === void 0 ? void 0 : _a(entry);\n            }\n        }));\n    }\n}\n// Needs to be written like this to pass the tree-shake-test\nResizeObserverSingleton.entries = 'WeakMap' in globals ? new WeakMap() : undefined;\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n    return style.sheet;\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentNode !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction comment(content) {\n    return document.createComment(content);\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_immediate_propagation(fn) {\n    return function (event) {\n        event.stopImmediatePropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set && always_set_through_set_attribute.indexOf(key) === -1) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data_map(node, data_map) {\n    Object.keys(data_map).forEach((key) => {\n        set_custom_element_data(node, key, data_map[key]);\n    });\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction set_dynamic_element_data(tag) {\n    return (/-/.test(tag)) ? set_custom_element_data_map : set_attributes;\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction init_binding_group(group) {\n    let _inputs;\n    return {\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            _inputs.forEach(input => group.push(input));\n        },\n        /* remove */ r() {\n            _inputs.forEach(input => group.splice(group.indexOf(input), 1));\n        }\n    };\n}\nfunction init_binding_group_dynamic(group, indexes) {\n    let _group = get_binding_group(group);\n    let _inputs;\n    function get_binding_group(group) {\n        for (let i = 0; i < indexes.length; i++) {\n            group = group[indexes[i]] = group[indexes[i]] || [];\n        }\n        return group;\n    }\n    function push() {\n        _inputs.forEach(input => _group.push(input));\n    }\n    function remove() {\n        _inputs.forEach(input => _group.splice(_group.indexOf(input), 1));\n    }\n    return {\n        /* update */ u(new_indexes) {\n            indexes = new_indexes;\n            const new_group = get_binding_group(group);\n            if (new_group !== _group) {\n                remove();\n                _group = new_group;\n                push();\n            }\n        },\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            push();\n        },\n        /* remove */ r: remove\n    };\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction claim_comment(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 8, (node) => {\n        node.data = '' + data;\n        return undefined;\n    }, () => comment(data), true);\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes, is_svg) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration(undefined, is_svg);\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes, is_svg);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    text.data = data;\n}\nfunction set_data_contenteditable(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable(text, data);\n    }\n    else {\n        set_data(text, data);\n    }\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value == null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value, mounting) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    if (!mounting || value !== undefined) {\n        select.selectedIndex = -1; // no option should be selected\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked');\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_iframe_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n            // make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n            // see https://github.com/sveltejs/svelte/issues/4233\n            fn();\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nconst resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'content-box' });\nconst resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'border-box' });\nconst resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'device-pixel-content-box' });\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, cancelable, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nfunction head_selector(nodeId, head) {\n    const result = [];\n    let started = 0;\n    for (const node of head.childNodes) {\n        if (node.nodeType === 8 /* comment node */) {\n            const comment = node.textContent.trim();\n            if (comment === `HEAD_${nodeId}_END`) {\n                started -= 1;\n                result.push(node);\n            }\n            else if (comment === `HEAD_${nodeId}_START`) {\n                started += 1;\n                result.push(node);\n            }\n        }\n        else if (started > 0) {\n            result.push(node);\n        }\n    }\n    return result;\n}\nclass HtmlTag {\n    constructor(is_svg = false) {\n        this.is_svg = false;\n        this.is_svg = is_svg;\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            if (this.is_svg)\n                this.e = svg_element(target.nodeName);\n            /** #7364  target for <template> may be provided as #document-fragment(11) */\n            else\n                this.e = element((target.nodeType === 11 ? 'TEMPLATE' : target.nodeName));\n            this.t = target.tagName !== 'TEMPLATE' ? target : target.content;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes, is_svg = false) {\n        super(is_svg);\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\nfunction construct_svelte_component(component, props) {\n    return new component(props);\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { ownerNode } = info.stylesheet;\n            // there is no ownerNode if it runs on jsdom.\n            if (ownerNode)\n                detach(ownerNode);\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs#run-time-svelte-beforeupdate\n */\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs#run-time-svelte-onmount\n */\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n */\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs#run-time-svelte-ondestroy\n */\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * https://svelte.dev/docs#run-time-svelte-createeventdispatcher\n */\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail, { cancelable = false } = {}) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail, { cancelable });\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n            return !event.defaultPrevented;\n        }\n        return true;\n    };\n}\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-setcontext\n */\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n    return context;\n}\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-getcontext\n */\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs#run-time-svelte-getallcontexts\n */\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-hascontext\n */\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nlet render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    // Do not reenter flush while dirty components are updated, as this can\n    // result in an infinite loop. Instead, let the inner flush handle it.\n    // Reentrancy is ok afterwards for bindings etc.\n    if (flushidx !== 0) {\n        return;\n    }\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        try {\n            while (flushidx < dirty_components.length) {\n                const component = dirty_components[flushidx];\n                flushidx++;\n                set_current_component(component);\n                update(component.$$);\n            }\n        }\n        catch (e) {\n            // reset dirty state to not end up in a deadlocked state and then rethrow\n            dirty_components.length = 0;\n            flushidx = 0;\n            throw e;\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n */\nfunction flush_render_callbacks(fns) {\n    const filtered = [];\n    const targets = [];\n    render_callbacks.forEach((c) => fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c));\n    targets.forEach((c) => c());\n    render_callbacks = filtered;\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n    else if (callback) {\n        callback();\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    const options = { direction: 'in' };\n    let config = fn(node, params, options);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config(options);\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    const options = { direction: 'out' };\n    let config = fn(node, params, options);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config(options);\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    const options = { direction: 'both' };\n    let config = fn(node, params, options);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro  we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro  needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config(options);\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    const updates = [];\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            // defer updates until all the DOM shuffling is done\n            updates.push(() => block.p(child_ctx, dirty));\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    run_all(updates);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\nconst _boolean_attributes = [\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'inert',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n];\n/**\n * List of HTML boolean attributes (e.g. `<input disabled>`).\n * Source: https://html.spec.whatwg.org/multipage/indices.html\n */\nconst boolean_attributes = new Set([..._boolean_attributes]);\n\n/** regex of all html void element names */\nconst void_element_names = /^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;\nfunction is_void(name) {\n    return void_element_names.test(name) || name.toLowerCase() === '!doctype';\n}\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst ATTR_REGEX = /[&\"]/g;\nconst CONTENT_REGEX = /[&<]/g;\n/**\n * Note: this method is performance sensitive and has been optimized\n * https://github.com/sveltejs/svelte/pull/5701\n */\nfunction escape(value, is_attr = false) {\n    const str = String(value);\n    const pattern = is_attr ? ATTR_REGEX : CONTENT_REGEX;\n    pattern.lastIndex = 0;\n    let escaped = '';\n    let last = 0;\n    while (pattern.test(str)) {\n        const i = pattern.lastIndex - 1;\n        const ch = str[i];\n        escaped += str.substring(last, i) + (ch === '&' ? '&amp;' : (ch === '\"' ? '&quot;' : '&lt;'));\n        last = i + 1;\n    }\n    return escaped + str.substring(last);\n}\nfunction escape_attribute_value(value) {\n    // keep booleans, null, and undefined for the sake of `spread`\n    const should_escape = typeof value === 'string' || (value && typeof value === 'object');\n    return should_escape ? escape(value, true) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${name}>.`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    const assignment = (boolean && value === true) ? '' : `=\"${escape(value, true)}\"`;\n    return ` ${name}${assignment}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${escape_attribute_value(style_object[key])};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n            // if the component was destroyed immediately\n            // it will update the `$$.on_destroy` reference to `null`.\n            // the destructured on_destroy may still reference to the old array\n            if (component.$$.on_destroy) {\n                component.$$.on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        flush_render_callbacks($$.after_update);\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: [],\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            if (!is_function(callback)) {\n                return noop;\n            }\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        if (!is_function(callback)) {\n            return noop;\n        }\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.59.2' }, detail), { bubbles: true }));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation, has_stop_immediate_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    if (has_stop_immediate_propagation)\n        modifiers.push('stopImmediatePropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_contenteditable_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable_dev(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable_dev(text, data);\n    }\n    else {\n        set_data_dev(text, data);\n    }\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nfunction validate_dynamic_element(tag) {\n    const is_string = typeof tag === 'string';\n    if (tag && !is_string) {\n        throw new Error('<svelte:element> expects \"this\" attribute to be a string.');\n    }\n}\nfunction validate_void_dynamic_element(tag) {\n    if (tag && is_void(tag)) {\n        console.warn(`<svelte:element this=\"${tag}\"> is self-closing and cannot have content.`);\n    }\n}\nfunction construct_svelte_component_dev(component, props) {\n    const error_message = 'this={...} of <svelte:component> should specify a Svelte component.';\n    try {\n        const instance = new component(props);\n        if (!instance.$$ || !instance.$set || !instance.$on || !instance.$destroy) {\n            throw new Error(error_message);\n        }\n        return instance;\n    }\n    catch (err) {\n        const { message } = err;\n        if (typeof message === 'string' && message.indexOf('is not a constructor') !== -1) {\n            throw new Error(error_message);\n        }\n        else {\n            throw err;\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, ResizeObserverSingleton, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_iframe_resize_listener, add_location, add_render_callback, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_comment, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, comment, component_subscribe, compute_rest_props, compute_slots, construct_svelte_component, construct_svelte_component_dev, contenteditable_truthy_values, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, flush_render_callbacks, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, head_selector, identity, init, init_binding_group, init_binding_group_dynamic, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, is_void, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, resize_observer_border_box, resize_observer_content_box, resize_observer_device_pixel_content_box, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_custom_element_data_map, set_data, set_data_contenteditable, set_data_contenteditable_dev, set_data_dev, set_data_maybe_contenteditable, set_data_maybe_contenteditable_dev, set_dynamic_element_data, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, split_css_unit, spread, src_url_equal, start_hydrating, stop_immediate_propagation, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_dynamic_element, validate_each_argument, validate_each_keys, validate_slots, validate_store, validate_void_dynamic_element, xlink_attr };\n","let path = import.meta.url\nexport default class fdsHelper {\n\n    static async getInfo(type,componentname){\n        let fetchurl = \"\";\n        let alternativefetchurl = \"\";\n        let notfound = false;\n        if(componentname){\n            componentname = componentname.replace(\"@fds-components/\",\"\");\n            fetchurl  = fdsHelper.get_href()+type+\"-\"+componentname+\".json\";\n            alternativefetchurl =  `@fds-components/${componentname}/dist/${type}-${componentname}.json`;\n        }\n\n        let res = await fetch(fetchurl)\n            .then(response => {\n                if (!response.ok) {\n                    notfound = true;\n                }\n                return response.json();\n            })\n            .then(data => {\n                if (type!==\"api\") return data\n                if (!data) return\n                if (!data.components) return data\n                return data.components[0]\n            });\n            if(notfound) {\n                res = await fetch(alternativefetchurl)\n                    .then(response => {\n                        if (!response.ok) {\n                            notfound = true;\n                        }\n                        return response.json();\n                    })\n                    .then(data => {\n                        if (type !== \"api\") return data\n                        if (!data) return\n                        if (!data.components) return data\n                        return data.components[0]\n                    });\n            }\n        return res;\n    }\n\n\n    static get_href() {\n        return new URL('./', path).href\n    }\n\n    static get_local() {\n        return new URL('./', path).pathname\n    }\n}\n","export let tutorialsData=[\n    { \n        \"id\": \"tutorials\",\n        \"title\": \"Tutorials\",\n        \"intro\": \" Each tutorial opens a video.\",\n        \"entries\": [\n            {\n                \"url\": \"https://youtu.be/4Ak4mERDzLs\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/refacer_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/refacer_result.jpg\",\n                \"title\": \"ComfyUI Setup and Testing\",\n                \"play\": true,\n                \"square\": true\n            },    \n            {\n                \"url\": \"https://youtu.be/uxfnU3KOnGQ\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/comfyui.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/comfyui.jpg\",\n                \"title\": \"Gyre for ComfyUI (Preview)\",\n                \"play\": true,\n                \"square\": true\n            },                      \n            {\n                \"url\": \"https://youtu.be/W4Gaz43iq-0\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/text_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/text_result.jpg\",\n                \"title\": \"V 4.2, AI-styled text (Old)\",\n                \"play\": true,\n                \"square\": true\n            },\n            {\n                \"url\": \"https://youtu.be/dWyqnJAQmyU\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/background_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/background_result.jpg\",\n                \"title\": \"Background Removal and Replacement (Old)\",\n                \"play\": true,\n                \"square\": true\n            },\n            {\n                \"url\": \"https://youtu.be/MWAeZxAlGxw\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/posenet_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/posenet_result.jpg\",\n                \"title\": \"Pose Layer (Old)\",\n                \"play\": true,\n                \"square\": true\n            },\n            {\n                \"url\": \"https://youtu.be/OerI9whHDSE\",\n                \"image\": \"https://www.flyingdog.de/sd/appdata/tutorials/lineart_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/tutorials/lineart_result.jpg\",\n                \"title\": \"ControlNet (Old)\",\n                \"play\": true,\n                \"square\": true\n            }                                \n\n        ]\n    },\n    { \n        \"id\": \"demofiles\",\n        \"title\": \"Examples\",\n        \"intro\": \"Examples\",\n        \"entries\": [\n            {\n                \"image\": \"https://www.flyingdog.de/sd/appdata/examples/example_pose.jpg\",\n                \"type\": \"file\",\n                \"file\": \"https://www.flyingdog.de/sd/appdata/examples/pose.fdsai\",\n                \"from\": \"external\",\n                \"title\": \"Pose.gyre\"\n        },\n/*        {\n                \"image\": \"https://www.flyingdog.de/sd/appdata/examples/example_controlnet.jpg\",\n                \"type\": \"file\",\n                \"file\": \"https://www.flyingdog.de/sd/appdata/examples/controlnet.fdsai\",\n                \"from\": \"external\",\n                \"title\": \"ControlNet.gyre\"\n        },*/\n        {\n            \"image\": \"https://www.flyingdog.de/sd/appdata/examples/example_face.webp\",\n            \"type\": \"file\",\n            \"file\": \"https://www.flyingdog.de/sd/appdata/examples/face.fdsai\",\n            \"from\": \"external\",\n            \"title\": \"Face.gyre\"\n    },       \n        {\n                \"image\": \"https://www.flyingdog.de/sd/appdata/examples/example_buick.jpg\",\n                \"type\": \"file\",\n                \"file\": \"https://www.flyingdog.de/sd/appdata/examples/buick.fdsai\",\n                \"from\": \"external\",\n                \"title\": \"3D Layer Buick.gyre\"\n        },                \n    ]\n    }           \n]","export let quickStartData=[\n    { \n        \"id\": \"quickStart\",\n        \"title\": \"Quick Start\",\n        \"intro\": \"Use these wizards to prepare a multi layer document for different AI tasks.\",\n        \"entries\": [\n            {\n                \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/txt2img_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/txt2img_result.jpg\",\n                \"title\": \"Text to image\",\n                \"wizard\": \"txt2img\"\n            },         \n    {\n        \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/text_source.jpg\",\n        \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/text_result.jpg\",\n        \"title\": \"AI generated text\",\n        \"wizard\": \"text\"\n}, \n{\n    \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/outpainting_source.jpg\",\n    \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/outpainting_result.jpg\",\n    \"title\": \"Outpainting\",\n    \"wizard\": \"outpainting\"\n},\n\n\n            {\n                \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/3d_source.jpg\",\n                \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/3d_result.jpg\",\n                \"title\": \"Add object to scene\",\n                \"wizard\": \"3d\"\n        },\n        {\n            \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/posenet_source.jpg\",\n            \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/posenet_result.jpg\",\n            \"title\": \"Add a character to scene\",\n            \"wizard\": \"pose\"\n    },\n    {\n        \"image\": \"https://www.flyingdog.de/sd/appdata/quickStart/background_source.jpg\",\n        \"imageHover\": \"https://www.flyingdog.de/sd/appdata/quickStart/background_result.jpg\",\n        \"title\": \"Background Replacement\",\n        \"wizard\": \"background\"\n},\n\n    ]\n    }           \n]","export let newDocumentData=[\n    { \n        \"id\": \"new\",\n        \"title\": \"\",\n        \"intro\": \"Default empty\",\n        \"entries\": [\n            {\n                \"icon\": \"square\",\n                \"title\": \"1024 x 1024\",\n                \"selected\":true,\n                \"width\": 1024,\n                \"height\": 1024\n            },\n            {\n                \"icon\": \"square\",\n                \"title\": \"1280 x 768\",\n                \"selected\":true,\n                \"width\": 1280,\n                \"height\": 768\n            },                          \n            {\n                \"icon\": \"square\",\n                \"title\": \"512 x 512\",\n                \"selected\":true,\n                \"width\": 512,\n                \"height\": 512\n            },\n            {\n                \"icon\": \"square\",\n                \"title\": \"2048 x 2048\",\n                \"selected\":true,\n                \"width\": 2048,\n                \"height\": 2048\n            },                  \n        ]\n    },\n    { \n        \"id\": \"new_social\",\n        \"title\": \"\",\n        \"intro\": \"Social Media\",\n        \"entries\": [\n            {\n                \"icon\": \"Instagram\",\n                \"title\": \"Instagram post<br> 1080 x 1080\",\n                \"selected\":true,\n                \"width\": 1080,\n                \"height\": 1080\n            },\n            {\n                \"icon\": \"Instagram\",\n                \"title\": \"Instagram story<br> 1080 x 1920\",\n                \"selected\":true,\n                \"width\": 1080,\n                \"height\": 1920\n            },\n            {\n                \"icon\": \"Facebook\",\n                \"title\": \"Facebook post<br> 940 x 768\",\n                \"selected\":true,\n                \"width\": 940,\n                \"height\": 768\n            },\n            {\n                \"icon\": \"Youtube\",\n                \"title\": \"Youtube thumbnail<br>1280 x 720\",\n                \"selected\":true,\n                \"width\": 1280,\n                \"height\": 720\n            },\n            {\n                \"icon\": \"X\",\n                \"title\": \"X post<br> 1600 x 900\",\n                \"selected\":true,\n                \"width\": 1600,\n                \"height\": 900\n            },\n            {\n                \"icon\": \"TikTok\",\n                \"title\": \"TikTok<br> 1080 x 1920\",\n                \"selected\":true,\n                \"width\": 1080,\n                \"height\": 1920\n            }                       \n        ]\n    }            \n]","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.swal=e():t.swal=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=8)}([function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=\"swal-button\";e.CLASS_NAMES={MODAL:\"swal-modal\",OVERLAY:\"swal-overlay\",SHOW_MODAL:\"swal-overlay--show-modal\",MODAL_TITLE:\"swal-title\",MODAL_TEXT:\"swal-text\",ICON:\"swal-icon\",ICON_CUSTOM:\"swal-icon--custom\",CONTENT:\"swal-content\",FOOTER:\"swal-footer\",BUTTON_CONTAINER:\"swal-button-container\",BUTTON:o,CONFIRM_BUTTON:o+\"--confirm\",CANCEL_BUTTON:o+\"--cancel\",DANGER_BUTTON:o+\"--danger\",BUTTON_LOADING:o+\"--loading\",BUTTON_LOADER:o+\"__loader\"},e.default=e.CLASS_NAMES},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.getNode=function(t){var e=\".\"+t;return document.querySelector(e)},e.stringToNode=function(t){var e=document.createElement(\"div\");return e.innerHTML=t.trim(),e.firstChild},e.insertAfter=function(t,e){var n=e.nextSibling;e.parentNode.insertBefore(t,n)},e.removeNode=function(t){t.parentElement.removeChild(t)},e.throwErr=function(t){throw t=t.replace(/ +(?= )/g,\"\"),\"SweetAlert: \"+(t=t.trim())},e.isPlainObject=function(t){if(\"[object Object]\"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},e.ordinalSuffixOf=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+\"st\":2===e&&12!==n?t+\"nd\":3===e&&13!==n?t+\"rd\":t+\"th\"}},function(t,e,n){\"use strict\";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,\"__esModule\",{value:!0}),o(n(25));var r=n(26);e.overlayMarkup=r.default,o(n(27)),o(n(28)),o(n(29));var i=n(0),a=i.default.MODAL_TITLE,s=i.default.MODAL_TEXT,c=i.default.ICON,l=i.default.FOOTER;e.iconMarkup='\\n  <div class=\"'+c+'\"></div>',e.titleMarkup='\\n  <div class=\"'+a+'\"></div>\\n',e.textMarkup='\\n  <div class=\"'+s+'\"></div>',e.footerMarkup='\\n  <div class=\"'+l+'\"></div>\\n'},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1);e.CONFIRM_KEY=\"confirm\",e.CANCEL_KEY=\"cancel\";var r={visible:!0,text:null,value:null,className:\"\",closeModal:!0},i=Object.assign({},r,{visible:!1,text:\"Cancel\",value:null}),a=Object.assign({},r,{text:\"OK\",value:!0});e.defaultButtonList={cancel:i,confirm:a};var s=function(t){switch(t){case e.CONFIRM_KEY:return a;case e.CANCEL_KEY:return i;default:var n=t.charAt(0).toUpperCase()+t.slice(1);return Object.assign({},r,{text:n,value:t})}},c=function(t,e){var n=s(t);return!0===e?Object.assign({},n,{visible:!0}):\"string\"==typeof e?Object.assign({},n,{visible:!0,text:e}):o.isPlainObject(e)?Object.assign({visible:!0},n,e):Object.assign({},n,{visible:!1})},l=function(t){for(var e={},n=0,o=Object.keys(t);n<o.length;n++){var r=o[n],a=t[r],s=c(r,a);e[r]=s}return e.cancel||(e.cancel=i),e},u=function(t){var n={};switch(t.length){case 1:n[e.CANCEL_KEY]=Object.assign({},i,{visible:!1});break;case 2:n[e.CANCEL_KEY]=c(e.CANCEL_KEY,t[0]),n[e.CONFIRM_KEY]=c(e.CONFIRM_KEY,t[1]);break;default:o.throwErr(\"Invalid number of 'buttons' in array (\"+t.length+\").\\n      If you want more than 2 buttons, you need to use an object!\")}return n};e.getButtonListOpts=function(t){var n=e.defaultButtonList;return\"string\"==typeof t?n[e.CONFIRM_KEY]=c(e.CONFIRM_KEY,t):Array.isArray(t)?n=u(t):o.isPlainObject(t)?n=l(t):!0===t?n=u([!0,!0]):!1===t?n=u([!1,!1]):void 0===t&&(n=e.defaultButtonList),n}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(2),i=n(0),a=i.default.MODAL,s=i.default.OVERLAY,c=n(30),l=n(31),u=n(32),f=n(33);e.injectElIntoModal=function(t){var e=o.getNode(a),n=o.stringToNode(t);return e.appendChild(n),n};var d=function(t){t.className=a,t.textContent=\"\"},p=function(t,e){d(t);var n=e.className;n&&t.classList.add(n)};e.initModalContent=function(t){var e=o.getNode(a);p(e,t),c.default(t.icon),l.initTitle(t.title),l.initText(t.text),f.default(t.content),u.default(t.buttons,t.dangerMode)};var m=function(){var t=o.getNode(s),e=o.stringToNode(r.modalMarkup);t.appendChild(e)};e.default=m},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(3),r={isOpen:!1,promise:null,actions:{},timer:null},i=Object.assign({},r);e.resetState=function(){i=Object.assign({},r)},e.setActionValue=function(t){if(\"string\"==typeof t)return a(o.CONFIRM_KEY,t);for(var e in t)a(e,t[e])};var a=function(t,e){i.actions[t]||(i.actions[t]={}),Object.assign(i.actions[t],{value:e})};e.setActionOptionsFor=function(t,e){var n=(void 0===e?{}:e).closeModal,o=void 0===n||n;Object.assign(i.actions[t],{closeModal:o})},e.default=i},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(3),i=n(0),a=i.default.OVERLAY,s=i.default.SHOW_MODAL,c=i.default.BUTTON,l=i.default.BUTTON_LOADING,u=n(5);e.openModal=function(){o.getNode(a).classList.add(s),u.default.isOpen=!0};var f=function(){o.getNode(a).classList.remove(s),u.default.isOpen=!1};e.onAction=function(t){void 0===t&&(t=r.CANCEL_KEY);var e=u.default.actions[t],n=e.value;if(!1===e.closeModal){var i=c+\"--\"+t;o.getNode(i).classList.add(l)}else f();u.default.promise.resolve(n)},e.getState=function(){var t=Object.assign({},u.default);return delete t.promise,delete t.timer,t},e.stopLoading=function(){for(var t=document.querySelectorAll(\".\"+c),e=0;e<t.length;e++){t[e].classList.remove(l)}}},function(t,e){var n;n=function(){return this}();try{n=n||Function(\"return this\")()||(0,eval)(\"this\")}catch(t){\"object\"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){t.exports=e.sweetAlert=n(9)}).call(e,n(7))},function(t,e,n){(function(e){t.exports=e.swal=n(10)}).call(e,n(7))},function(t,e,n){\"undefined\"!=typeof window&&n(11),n(16);var o=n(23).default;t.exports=o},function(t,e,n){var o=n(12);\"string\"==typeof o&&(o=[[t.i,o,\"\"]]);var r={insertAt:\"top\"};r.transform=void 0;n(14)(o,r);o.locals&&(t.exports=o.locals)},function(t,e,n){e=t.exports=n(13)(void 0),e.push([t.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:\"\";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:\"\";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:\" \";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',\"\"])},function(t,e){function n(t,e){var n=t[1]||\"\",r=t[3];if(!r)return n;if(e&&\"function\"==typeof btoa){var i=o(r);return[n].concat(r.sources.map(function(t){return\"/*# sourceURL=\"+r.sourceRoot+t+\" */\"})).concat([i]).join(\"\\n\")}return[n].join(\"\\n\")}function o(t){return\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,\"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+\" */\"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var o=n(e,t);return e[2]?\"@media \"+e[2]+\"{\"+o+\"}\":o}).join(\"\")},e.i=function(t,n){\"string\"==typeof t&&(t=[[null,t,\"\"]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];\"number\"==typeof i&&(o[i]=!0)}for(r=0;r<t.length;r++){var a=t[r];\"number\"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]=\"(\"+a[2]+\") and (\"+n+\")\"),e.push(a))}},e}},function(t,e,n){function o(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=m[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(u(o.parts[i],e))}else{for(var a=[],i=0;i<o.parts.length;i++)a.push(u(o.parts[i],e));m[o.id]={id:o.id,refs:1,parts:a}}}}function r(t,e){for(var n=[],o={},r=0;r<t.length;r++){var i=t[r],a=e.base?i[0]+e.base:i[0],s=i[1],c=i[2],l=i[3],u={css:s,media:c,sourceMap:l};o[a]?o[a].parts.push(u):n.push(o[a]={id:a,parts:[u]})}return n}function i(t,e){var n=v(t.insertInto);if(!n)throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");var o=w[w.length-1];if(\"top\"===t.insertAt)o?o.nextSibling?n.insertBefore(e,o.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),w.push(e);else{if(\"bottom\"!==t.insertAt)throw new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");n.appendChild(e)}}function a(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=w.indexOf(t);e>=0&&w.splice(e,1)}function s(t){var e=document.createElement(\"style\");return t.attrs.type=\"text/css\",l(e,t.attrs),i(t,e),e}function c(t){var e=document.createElement(\"link\");return t.attrs.type=\"text/css\",t.attrs.rel=\"stylesheet\",l(e,t.attrs),i(t,e),e}function l(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function u(t,e){var n,o,r,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var l=h++;n=g||(g=s(e)),o=f.bind(null,n,l,!1),r=f.bind(null,n,l,!0)}else t.sourceMap&&\"function\"==typeof URL&&\"function\"==typeof URL.createObjectURL&&\"function\"==typeof URL.revokeObjectURL&&\"function\"==typeof Blob&&\"function\"==typeof btoa?(n=c(e),o=p.bind(null,n,e),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),o=d.bind(null,n),r=function(){a(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}function f(t,e,n,o){var r=n?\"\":o.css;if(t.styleSheet)t.styleSheet.cssText=x(e,r);else{var i=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function d(t,e){var n=e.css,o=e.media;if(o&&t.setAttribute(\"media\",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function p(t,e,n){var o=n.css,r=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||i)&&(o=y(o)),r&&(o+=\"\\n/*# sourceMappingURL=data:application/json;base64,\"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+\" */\");var a=new Blob([o],{type:\"text/css\"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}var m={},b=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),v=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}(function(t){return document.querySelector(t)}),g=null,h=0,w=[],y=n(15);t.exports=function(t,e){if(\"undefined\"!=typeof DEBUG&&DEBUG&&\"object\"!=typeof document)throw new Error(\"The style-loader cannot be used in a non-browser environment\");e=e||{},e.attrs=\"object\"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=b()),e.insertInto||(e.insertInto=\"head\"),e.insertAt||(e.insertAt=\"bottom\");var n=r(t,e);return o(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a],c=m[s.id];c.refs--,i.push(c)}if(t){o(r(t,e),e)}for(var a=0;a<i.length;a++){var c=i[a];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete m[c.id]}}}};var x=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join(\"\\n\")}}()},function(t,e){t.exports=function(t){var e=\"undefined\"!=typeof window&&window.location;if(!e)throw new Error(\"fixUrls requires window.location\");if(!t||\"string\"!=typeof t)return t;var n=e.protocol+\"//\"+e.host,o=n+e.pathname.replace(/\\/[^\\/]*$/,\"/\");return t.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi,function(t,e){var r=e.trim().replace(/^\"(.*)\"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});if(/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(r))return t;var i;return i=0===r.indexOf(\"//\")?r:0===r.indexOf(\"/\")?n+r:o+r.replace(/^\\.\\//,\"\"),\"url(\"+JSON.stringify(i)+\")\"})}},function(t,e,n){var o=n(17);\"undefined\"==typeof window||window.Promise||(window.Promise=o),n(21),String.prototype.includes||(String.prototype.includes=function(t,e){\"use strict\";return\"number\"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,\"includes\",{value:function(t,e){if(null==this)throw new TypeError('\"this\" is null or not defined');var n=Object(this),o=n.length>>>0;if(0===o)return!1;for(var r=0|e,i=Math.max(r>=0?r:o-Math.abs(r),0);i<o;){if(function(t,e){return t===e||\"number\"==typeof t&&\"number\"==typeof e&&isNaN(t)&&isNaN(e)}(n[i],t))return!0;i++}return!1}}),\"undefined\"!=typeof window&&function(t){t.forEach(function(t){t.hasOwnProperty(\"remove\")||Object.defineProperty(t,\"remove\",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype])},function(t,e,n){(function(e){!function(n){function o(){}function r(t,e){return function(){t.apply(e,arguments)}}function i(t){if(\"object\"!=typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof t)throw new TypeError(\"not a function\");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function a(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?s:c)(e.promise,t._value);var o;try{o=n(t._value)}catch(t){return void c(e.promise,t)}s(e.promise,o)})}function s(t,e){try{if(e===t)throw new TypeError(\"A promise cannot be resolved with itself.\");if(e&&(\"object\"==typeof e||\"function\"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if(\"function\"==typeof n)return void f(r(n,e),t)}t._state=1,t._value=e,l(t)}catch(e){c(t,e)}}function c(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled=\"function\"==typeof t?t:null,this.onRejected=\"function\"==typeof e?e:null,this.promise=n}function f(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){if(n)return;n=!0,c(e,t)}}var d=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new u(t,e,n)),n},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function o(i,a){try{if(a&&(\"object\"==typeof a||\"function\"==typeof a)){var s=a.then;if(\"function\"==typeof s)return void s.call(a,function(t){o(i,t)},n)}e[i]=a,0==--r&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var r=e.length,i=0;i<e.length;i++)o(i,e[i])})},i.resolve=function(t){return t&&\"object\"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var o=0,r=t.length;o<r;o++)t[o].then(e,n)})},i._immediateFn=\"function\"==typeof e&&function(t){e(t)}||function(t){d(t,0)},i._unhandledRejectionFn=function(t){\"undefined\"!=typeof console&&console&&console.warn(\"Possible Unhandled Promise Rejection:\",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(e,n(18).setImmediate)},function(t,e,n){function o(t,e){this._id=t,this._clearFn=e}var r=Function.prototype.apply;e.setTimeout=function(){return new o(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){(function(t,e){!function(t,n){\"use strict\";function o(t){\"function\"!=typeof t&&(t=new Function(\"\"+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return l[c]=o,s(c),c++}function r(t){delete l[t]}function i(t){var e=t.callback,o=t.args;switch(o.length){case 0:e();break;case 1:e(o[0]);break;case 2:e(o[0],o[1]);break;case 3:e(o[0],o[1],o[2]);break;default:e.apply(n,o)}}function a(t){if(u)setTimeout(a,0,t);else{var e=l[t];if(e){u=!0;try{i(e)}finally{r(t),u=!1}}}}if(!t.setImmediate){var s,c=1,l={},u=!1,f=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,\"[object process]\"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage(\"\",\"*\"),t.onmessage=n,e}}()?function(){var e=\"setImmediate$\"+Math.random()+\"$\",n=function(n){n.source===t&&\"string\"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener(\"message\",n,!1):t.attachEvent(\"onmessage\",n),s=function(n){t.postMessage(e+n,\"*\")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():f&&\"onreadystatechange\"in f.createElement(\"script\")?function(){var t=f.documentElement;s=function(e){var n=f.createElement(\"script\");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),d.setImmediate=o,d.clearImmediate=r}}(\"undefined\"==typeof self?void 0===t?this:t:self)}).call(e,n(7),n(20))},function(t,e){function n(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){b&&p&&(b=!1,p.length?m=p.concat(m):v=-1,m.length&&s())}function s(){if(!b){var t=r(a);b=!0;for(var e=m.length;e;){for(p=m,m=[];++v<e;)p&&p[v].run();v=-1,e=m.length}p=null,b=!1,i(t)}}function c(t,e){this.fun=t,this.array=e}function l(){}var u,f,d=t.exports={};!function(){try{u=\"function\"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{f=\"function\"==typeof clearTimeout?clearTimeout:o}catch(t){f=o}}();var p,m=[],b=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new c(t,e)),1!==m.length||b||r(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title=\"browser\",d.browser=!0,d.env={},d.argv=[],d.version=\"\",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(t){return[]},d.binding=function(t){throw new Error(\"process.binding is not supported\")},d.cwd=function(){return\"/\"},d.chdir=function(t){throw new Error(\"process.chdir is not supported\")},d.umask=function(){return 0}},function(t,e,n){\"use strict\";n(22).polyfill()},function(t,e,n){\"use strict\";function o(t,e){if(void 0===t||null===t)throw new TypeError(\"Cannot convert first argument to object\");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(void 0!==r&&null!==r)for(var i=Object.keys(Object(r)),a=0,s=i.length;a<s;a++){var c=i[a],l=Object.getOwnPropertyDescriptor(r,c);void 0!==l&&l.enumerable&&(n[c]=r[c])}}return n}function r(){Object.assign||Object.defineProperty(Object,\"assign\",{enumerable:!1,configurable:!0,writable:!0,value:o})}t.exports={assign:o,polyfill:r}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(24),r=n(6),i=n(5),a=n(36),s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(\"undefined\"!=typeof window){var n=a.getOpts.apply(void 0,t);return new Promise(function(t,e){i.default.promise={resolve:t,reject:e},o.default(n),setTimeout(function(){r.openModal()})})}};s.close=r.onAction,s.getState=r.getState,s.setActionValue=i.setActionValue,s.stopLoading=r.stopLoading,s.setDefaults=a.setDefaults,e.default=s},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(0),i=r.default.MODAL,a=n(4),s=n(34),c=n(35),l=n(1);e.init=function(t){o.getNode(i)||(document.body||l.throwErr(\"You can only use SweetAlert AFTER the DOM has loaded!\"),s.default(),a.default()),a.initModalContent(t),c.default(t)},e.default=e.init},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(0),r=o.default.MODAL;e.modalMarkup='\\n  <div class=\"'+r+'\" role=\"dialog\" aria-modal=\"true\"></div>',e.default=e.modalMarkup},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(0),r=o.default.OVERLAY,i='<div \\n    class=\"'+r+'\"\\n    tabIndex=\"-1\">\\n  </div>';e.default=i},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(0),r=o.default.ICON;e.errorIconMarkup=function(){var t=r+\"--error\",e=t+\"__line\";return'\\n    <div class=\"'+t+'__x-mark\">\\n      <span class=\"'+e+\" \"+e+'--left\"></span>\\n      <span class=\"'+e+\" \"+e+'--right\"></span>\\n    </div>\\n  '},e.warningIconMarkup=function(){var t=r+\"--warning\";return'\\n    <span class=\"'+t+'__body\">\\n      <span class=\"'+t+'__dot\"></span>\\n    </span>\\n  '},e.successIconMarkup=function(){var t=r+\"--success\";return'\\n    <span class=\"'+t+\"__line \"+t+'__line--long\"></span>\\n    <span class=\"'+t+\"__line \"+t+'__line--tip\"></span>\\n\\n    <div class=\"'+t+'__ring\"></div>\\n    <div class=\"'+t+'__hide-corners\"></div>\\n  '}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(0),r=o.default.CONTENT;e.contentMarkup='\\n  <div class=\"'+r+'\">\\n\\n  </div>\\n'},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(0),r=o.default.BUTTON_CONTAINER,i=o.default.BUTTON,a=o.default.BUTTON_LOADER;e.buttonMarkup='\\n  <div class=\"'+r+'\">\\n\\n    <button\\n      class=\"'+i+'\"\\n    ></button>\\n\\n    <div class=\"'+a+'\">\\n      <div></div>\\n      <div></div>\\n      <div></div>\\n    </div>\\n\\n  </div>\\n'},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(4),r=n(2),i=n(0),a=i.default.ICON,s=i.default.ICON_CUSTOM,c=[\"error\",\"warning\",\"success\",\"info\"],l={error:r.errorIconMarkup(),warning:r.warningIconMarkup(),success:r.successIconMarkup()},u=function(t,e){var n=a+\"--\"+t;e.classList.add(n);var o=l[t];o&&(e.innerHTML=o)},f=function(t,e){e.classList.add(s);var n=document.createElement(\"img\");n.src=t,e.appendChild(n)},d=function(t){if(t){var e=o.injectElIntoModal(r.iconMarkup);c.includes(t)?u(t,e):f(t,e)}};e.default=d},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(2),r=n(4),i=function(t){navigator.userAgent.includes(\"AppleWebKit\")&&(t.style.display=\"none\",t.offsetHeight,t.style.display=\"\")};e.initTitle=function(t){if(t){var e=r.injectElIntoModal(o.titleMarkup);e.textContent=t,i(e)}},e.initText=function(t){if(t){var e=document.createDocumentFragment();t.split(\"\\n\").forEach(function(t,n,o){e.appendChild(document.createTextNode(t)),n<o.length-1&&e.appendChild(document.createElement(\"br\"))});var n=r.injectElIntoModal(o.textMarkup);n.appendChild(e),i(n)}}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(4),i=n(0),a=i.default.BUTTON,s=i.default.DANGER_BUTTON,c=n(3),l=n(2),u=n(6),f=n(5),d=function(t,e,n){var r=e.text,i=e.value,d=e.className,p=e.closeModal,m=o.stringToNode(l.buttonMarkup),b=m.querySelector(\".\"+a),v=a+\"--\"+t;if(b.classList.add(v),d){(Array.isArray(d)?d:d.split(\" \")).filter(function(t){return t.length>0}).forEach(function(t){b.classList.add(t)})}n&&t===c.CONFIRM_KEY&&b.classList.add(s),b.textContent=r;var g={};return g[t]=i,f.setActionValue(g),f.setActionOptionsFor(t,{closeModal:p}),b.addEventListener(\"click\",function(){return u.onAction(t)}),m},p=function(t,e){var n=r.injectElIntoModal(l.footerMarkup);for(var o in t){var i=t[o],a=d(o,i,e);i.visible&&n.appendChild(a)}0===n.children.length&&n.remove()};e.default=p},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(3),r=n(4),i=n(2),a=n(5),s=n(6),c=n(0),l=c.default.CONTENT,u=function(t){t.addEventListener(\"input\",function(t){var e=t.target,n=e.value;a.setActionValue(n)}),t.addEventListener(\"keyup\",function(t){if(\"Enter\"===t.key)return s.onAction(o.CONFIRM_KEY)}),setTimeout(function(){t.focus(),a.setActionValue(\"\")},0)},f=function(t,e,n){var o=document.createElement(e),r=l+\"__\"+e;o.classList.add(r);for(var i in n){var a=n[i];o[i]=a}\"input\"===e&&u(o),t.appendChild(o)},d=function(t){if(t){var e=r.injectElIntoModal(i.contentMarkup),n=t.element,o=t.attributes;\"string\"==typeof n?f(e,n,o):e.appendChild(n)}};e.default=d},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(2),i=function(){var t=o.stringToNode(r.overlayMarkup);document.body.appendChild(t)};e.default=i},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(5),r=n(6),i=n(1),a=n(3),s=n(0),c=s.default.MODAL,l=s.default.BUTTON,u=s.default.OVERLAY,f=function(t){t.preventDefault(),v()},d=function(t){t.preventDefault(),g()},p=function(t){if(o.default.isOpen)switch(t.key){case\"Escape\":return r.onAction(a.CANCEL_KEY)}},m=function(t){if(o.default.isOpen)switch(t.key){case\"Tab\":return f(t)}},b=function(t){if(o.default.isOpen)return\"Tab\"===t.key&&t.shiftKey?d(t):void 0},v=function(){var t=i.getNode(l);t&&(t.tabIndex=0,t.focus())},g=function(){var t=i.getNode(c),e=t.querySelectorAll(\".\"+l),n=e.length-1,o=e[n];o&&o.focus()},h=function(t){t[t.length-1].addEventListener(\"keydown\",m)},w=function(t){t[0].addEventListener(\"keydown\",b)},y=function(){var t=i.getNode(c),e=t.querySelectorAll(\".\"+l);e.length&&(h(e),w(e))},x=function(t){if(i.getNode(u)===t.target)return r.onAction(a.CANCEL_KEY)},_=function(t){var e=i.getNode(u);e.removeEventListener(\"click\",x),t&&e.addEventListener(\"click\",x)},k=function(t){o.default.timer&&clearTimeout(o.default.timer),t&&(o.default.timer=window.setTimeout(function(){return r.onAction(a.CANCEL_KEY)},t))},O=function(t){t.closeOnEsc?document.addEventListener(\"keyup\",p):document.removeEventListener(\"keyup\",p),t.dangerMode?v():g(),y(),_(t.closeOnClickOutside),k(t.timer)};e.default=O},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r=n(3),i=n(37),a=n(38),s={title:null,text:null,icon:null,buttons:r.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},c=Object.assign({},s);e.setDefaults=function(t){c=Object.assign({},s,t)};var l=function(t){var e=t&&t.button,n=t&&t.buttons;return void 0!==e&&void 0!==n&&o.throwErr(\"Cannot set both 'button' and 'buttons' options!\"),void 0!==e?{confirm:e}:n},u=function(t){return o.ordinalSuffixOf(t+1)},f=function(t,e){o.throwErr(u(e)+\" argument ('\"+t+\"') is invalid\")},d=function(t,e){var n=t+1,r=e[n];o.isPlainObject(r)||void 0===r||o.throwErr(\"Expected \"+u(n)+\" argument ('\"+r+\"') to be a plain object\")},p=function(t,e){var n=t+1,r=e[n];void 0!==r&&o.throwErr(\"Unexpected \"+u(n)+\" argument (\"+r+\")\")},m=function(t,e,n,r){var i=typeof e,a=\"string\"===i,s=e instanceof Element;if(a){if(0===n)return{text:e};if(1===n)return{text:e,title:r[0]};if(2===n)return d(n,r),{icon:e};f(e,n)}else{if(s&&0===n)return d(n,r),{content:e};if(o.isPlainObject(e))return p(n,r),e;f(e,n)}};e.getOpts=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};t.forEach(function(e,o){var r=m(0,e,o,t);Object.assign(n,r)});var o=l(n);n.buttons=r.getButtonListOpts(o),delete n.button,n.content=i.getContentOpts(n.content);var u=Object.assign({},s,c,n);return Object.keys(u).forEach(function(t){a.DEPRECATED_OPTS[t]&&a.logDeprecation(t)}),u}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(1),r={element:\"input\",attributes:{placeholder:\"\"}};e.getContentOpts=function(t){var e={};return o.isPlainObject(t)?Object.assign(e,t):t instanceof Element?{element:t}:\"input\"===t?r:null}},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.logDeprecation=function(t){var n=e.DEPRECATED_OPTS[t],o=n.onlyRename,r=n.replacement,i=n.subOption,a=n.link,s=o?\"renamed\":\"deprecated\",c='SweetAlert warning: \"'+t+'\" option has been '+s+\".\";if(r){c+=\" Please use\"+(i?' \"'+i+'\" in ':\" \")+'\"'+r+'\" instead.'}var l=\"https://sweetalert.js.org\";c+=a?\" More details: \"+l+a:\" More details: \"+l+\"/guides/#upgrading-from-1x\",console.warn(c)},e.DEPRECATED_OPTS={type:{replacement:\"icon\",link:\"/docs/#icon\"},imageUrl:{replacement:\"icon\",link:\"/docs/#icon\"},customClass:{replacement:\"className\",onlyRename:!0,link:\"/docs/#classname\"},imageSize:{},showCancelButton:{replacement:\"buttons\",link:\"/docs/#buttons\"},showConfirmButton:{replacement:\"button\",link:\"/docs/#button\"},confirmButtonText:{replacement:\"button\",link:\"/docs/#button\"},confirmButtonColor:{},cancelButtonText:{replacement:\"buttons\",link:\"/docs/#buttons\"},closeOnConfirm:{replacement:\"button\",subOption:\"closeModal\",link:\"/docs/#button\"},closeOnCancel:{replacement:\"buttons\",subOption:\"closeModal\",link:\"/docs/#buttons\"},showLoaderOnConfirm:{replacement:\"buttons\"},animation:{},inputType:{replacement:\"content\",link:\"/docs/#content\"},inputValue:{replacement:\"content\",link:\"/docs/#content\"},inputPlaceholder:{replacement:\"content\",link:\"/docs/#content\"},html:{replacement:\"content\",link:\"/docs/#content\"},allowEscapeKey:{replacement:\"closeOnEsc\",onlyRename:!0,link:\"/docs/#closeonesc\"},allowClickOutside:{replacement:\"closeOnClickOutside\",onlyRename:!0,link:\"/docs/#closeonclickoutside\"}}}])});","import swal from \"sweetalert\";\n\nexport default class confirmDialog {\n\n    async alert(heading, body  ) {\n        console.log(\"alert\",heading, body );\n        let message = heading;\n        if(body) message = message+ \"\\n\" + body;\n        await swal(\"Server error\", message);\n    }\n\n}","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier} [start]\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=} start\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0 && stop) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let started = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (started) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        started = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n            // We need to set this to false because callbacks can still happen despite having unsubscribed:\n            // Callbacks might already be placed in the queue which doesn't know it should no longer\n            // invoke this derived store.\n            started = false;\n        };\n    });\n}\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * @param store - store to make readonly\n */\nfunction readonly(store) {\n    return {\n        subscribe: store.subscribe.bind(store)\n    };\n}\n\nexport { derived, readable, readonly, writable };\n","import { writable } from \"svelte/store\";\nexport let transferStore  = writable();\nexport const tasksStore = writable([]);\nexport let readyToLoadStore = writable();\nexport default transferStore;","import confirmDialog from \"./confirmDialog\"\nimport {readyToLoadStore,tasksStore,transferStore} from './TasksStore';\nimport { get,update } from 'svelte/store'\n\n\n\nexport default class Gyre{\n\n\n\n    getWeightsArray(prompt) {\n        let promptArray = []\n\n        let splitPrompt = prompt.split(/(\\([^)]+\\))/)\n        for(let i=0;i<splitPrompt.length;i++) {\n            let p=splitPrompt[i].trim()\n            if (p) {\n                let obj={prompt:p}\n                promptArray.push(obj)\n            }\n        }\n        for(let i=0;i<promptArray.length;i++) {\n            let obj=promptArray[i]\n            let item=obj.prompt\n            let brackets = item.search(/\\([^)]+\\)/)\n            if (!brackets) {\n                let weight\n                let bracketCount=item.split(\"(\").length\n                if (bracketCount>2) {\n                    weight=(bracketCount-1)/10\n                }\n                item=item.replace(/\\(/g,\"\")\n                item=item.replace(/\\)/g,\"\")\n                let arr=item.split(\":\")\n                if (!weight) weight=arr[1]\n                if (!weight) weight=1.0\n                obj.weight=parseFloat(weight)\n                obj.prompt=arr[0]\n            } else {\n                item=item.replace(/\\)/g,\"\")\n                obj.prompt=item\n                obj.weight=1\n            }\n        }\n        console.log(promptArray)\n        return promptArray\n    }\n\n\n    strip(str, remove) {\n        while (str.length > 0 && remove.indexOf(str.charAt(0)) != -1) {\n            str = str.substr(1)\n        }\n        while (str.length > 0 && remove.indexOf(str.charAt(str.length - 1)) != -1) {\n            str = str.substr(0, str.length - 1)\n        }\n        return str\n    }\n\n    constructor() {\n        window.onlyonegrpclocal = false;\n\n    }\n    getStatus() {\n        return this.status\n    }\n    async runSD(SDConfig, p) {\n        SDConfig.url=new URL(SDConfig.url).origin       // remove path at end\n        SDConfig.url.endsWith('/') ? SDConfig.url.slice(0, -1) : SDConfig.url   // remove / at end\n\n        this.status=\"waiting\"\n\n        let newServer=await this.checkNewServer(SDConfig)\n        if (!newServer) window.onlyonegrpclocal=true\n        else  window.onlyonegrpclocal=false\n\n        if(window.onlyonegrpclocal && window.requestlocalgrpcprocessing && window.requestlocalgrpcprocessing == true) return\n        console.log(\"specialLayersImageInfo\",p.specialLayersImageInfo)\n\n        const diffusionMap = {\n            'DDIM': \"SAMPLER_DDIM\",\n            'PLMS' : \"SAMPLER_DDPM\",\n            'Euler' : \"SAMPLER_K_EULER\",\n            'Euler a': \"SAMPLER_K_EULER_ANCESTRAL\",\n            'Heun': \"SAMPLER_K_HEUN\",\n            'DPM2': \"SAMPLER_K_DPM_2\",\n            'DPM2 a': \"SAMPLER_K_DPM_2_ANCESTRAL\",\n            'LMS': \"SAMPLER_K_LMS\",\n            'DPMSolver++ 1 Order': \"SAMPLER_DPMSOLVERPP_1ORDER\",\n            'DPMSolver++ 2 Order': \"SAMPLER_DPMSOLVERPP_2ORDER\",\n            'DPMSolver++ 3 Order': \"SAMPLER_DPMSOLVERPP_3ORDER\",\n            'DPM Fast':\"SAMPLER_DPM_FAST\",\n            'DPM Adaptive':\"SAMPLER_DPM_ADAPTIVE\",\n            'DPMSolver++ 2S a':\"SAMPLER_DPMSOLVERPP_2S_ANCESTRAL\",\n            'DPMSolver++ SDE':\"SAMPLER_DPMSOLVERPP_SDE\",\n            'DPMSolver++ 2M':\"SAMPLER_DPMSOLVERPP_2M\",\n            'DPMSolver++ 2M (Fast)':\"SAMPLER_DPMSOLVERPP_2M\"\n        }\n\n        let images = []\n        p.seedList = []\n        let i = 0\n\n\n        console.log(SDConfig)\n        console.log(\"model\",SDConfig.model)\n        console.log(\"mode\",p.mode)\n\n\n        console.log(\"new server\",newServer)\n        if (!SDConfig.model) SDConfig.model=\"stable-diffusion-v1-5\"\n        if (SDConfig.model===\"stable-diffusion-v1-5-standard\") SDConfig.model=\"stable-diffusion-v1-5\"\n        let modelList=await this.getModels(SDConfig);\n        if (!modelList) {\n            this.status=\"error\"\n            return\n        }\n        console.log(modelList)\n        let found=false\n        for(let i=0;i<modelList.length;i++) {\n            let m=modelList[i]\n            if (m.id===SDConfig.model) found=true\n        }\n        if (!found && p.mode!==\"removeBackground\") {\n            await new confirmDialog().alert(\"Model \"+SDConfig.model+\" not found. Please select model in configuration.\")\n            this.status=\"error\"\n            return\n        }\n\n        this.requestTemplate.engineId = SDConfig.model;\n\n        this.requestTemplate.requestId = Math.floor(Math.random()*1000000000000)+\"\";\n        //??this.requestTemplate.requestedType=  \"ARTIFACT_NONE\";\n\n        let allprompts = [];\n\n        let promptArray=this.getWeightsArray(p.prompt)\n        for(let i=0;i<promptArray.length;i++) {\n            let obj=promptArray[i]\n            if (obj.prompt) {\n                allprompts.push({text:obj.prompt,parameters:{weight:obj.weight}});\n            }\n        }\n\n\n        if (p.negativePrompt) {\n            allprompts.push({text:p.negativePrompt,parameters:{weight:-1}});\n        }\n\n        let uuid=Math.random().toString()\n        let newprompt={}\n\n\n        let isscribletype = false;\n        if (p.specialLayersImageInfo) {\n            for (let specialLayer of p.specialLayersImageInfo) {\n                if(specialLayer.type=='skribble'){\n                    isscribletype = true;\n                }\n\n            }\n        }\n        //  do it diffrent for shapes\n        //if (!isscribletype && p.image64) {\n        if (p.image64) {\n            // @ts-ignore\n            newprompt = {\"parameters\":{\"init\": true}};\n            newprompt.artifact={uuid:uuid,type:\"ARTIFACT_IMAGE\",binary:p.image64}\n            if (p.mode===\"img2img\" || p.mode===\"inpainting\"  || p.mode===\"upscale\") {\n                allprompts.push(newprompt) // special type+img2img - ignore other image data\n\n            }\n        }\n        if (p.mode===\"removeBackground\") {\n            this.requestTemplate.engineId=\"noop\"\n            newprompt.artifact.adjustments=[{\"background_removal\":{ }}]\n            allprompts=[newprompt]\n            console.log(\"removeBackground\",allprompts)\n        }\n        if (p.mode===\"autoMatte\") {\n            this.requestTemplate.engineId=\"noop\"\n            let maskPrompts=[]\n            let erode=0\n            if (p.erode) erode=p.erode\n            if (p.rectangleList) {\n                maskPrompts.push({loi:{rectangles:p.rectangleList } })\n            }\n            if (p.pointList) {\n                maskPrompts.push({loi: {points:p.pointList }})\n            }            \n            \n            newprompt.artifact.adjustments=[\n                {\"mask_predict\":\n                    {\n                        behaviour:0,\n                        mode: 0,\n                        prompt: maskPrompts ,\n                        erode: erode\n                    }\n                }\n            ]\n            allprompts=[newprompt]\n            console.log(\"mask_predict\",allprompts)\n        }\n        if (p.mode===\"upscale\") {\n            this.requestTemplate.engineId=p.upscaleEngine\n            if (p.prompt===\"upscale\") allprompts=[newprompt]    // some upscalers need prompt others not\n        }\n        if (p.mode==\"inpainting\" || p.mode==\"inpainting_original\") {\n            if (p.maskImage64) {\n                let promptMask = {artifact:{type:\"ARTIFACT_MASK\"}}\n                promptMask.artifact.adjustments =  [{levels:{inputLow:0,inputHigh:0.01,outputLow:0,outputHigh:1}}];\n                // gausian is no here ?\n                promptMask.artifact.adjustments.push({blur:{sigma:32,direction:\"DIRECTION_UP\"}})\n\n                promptMask.artifact.binary = p.maskImage64;\n                // @ts-ignore\n                allprompts.push(promptMask);\n            } else {\n                let promptMask = {artifact:{type:\"ARTIFACT_MASK\"}}\n\n                promptMask.artifact.adjustments =  [\n                    {\"channels\":{\n                            \"r\": \"CHANNEL_A\",\n                            \"a\": \"CHANNEL_ONE\"\n                        }}\n                ]\n\n                promptMask.artifact.adjustments.push(\n                    {\"invert\": { }}\n                );\n                promptMask.artifact.adjustments.push(\n                    {\n                        \"blur\": {\n                            \"sigma\": 32,\n                            \"direction\": \"DIRECTION_UP\"\n                        },\n                    });\n                promptMask.artifact.binary = p.image64\n                // @ts-ignore\n                allprompts.push(promptMask)\n            }\n        }\n        // special ControlNet and T2I information *******************************\n        if (p.specialLayersImageInfo) {\n            for (let specialLayer of p.specialLayersImageInfo) {\n                let artifact = {type:\"ARTIFACT_HINT_IMAGE\",\"mime\":\"image/png\"}\n                // not using preprocssor/adjustments\n                if (specialLayer.type===\"skribble\") artifact.hint_image_type=\"sketch\"\n                if (specialLayer.parameters && specialLayer.parameters.method && specialLayer.parameters.method===\"T2I Adapter\") {\n                    artifact.hint_image_type=\"coadapter/sketch\"\n                }\n                if (specialLayer.type===\"segmentation\") artifact.hint_image_type=\"segmentation/ade20k\" // segmentation/coco not supported yet\n                if (specialLayer.type===\"posenet\") artifact.hint_image_type=\"openpose\"\n                if (specialLayer.type===\"depth\") artifact.hint_image_type=\"depth\"\n                if (specialLayer.type===\"inpaint\") artifact.hint_image_type=\"inpaint\"\n\n                // image layer with preprocssor\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"canny_edge\") {\n                    artifact.hint_image_type=\"controlnet/canny\"\n                    if (specialLayer.parameters && specialLayer.parameters.method && specialLayer.parameters.method===\"T2I Adapter\") {\n                        artifact.hint_image_type=\"coadapter/canny\"\n                    }\n                    artifact.adjustments=[{canny_edge :{\n                            low_threshold: parseFloat(specialLayer.parameters.low_threshold),\n                            high_threshold : parseFloat(specialLayer.parameters.high_threshold)\n                        }\n                    }]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"depth\") {\n                    artifact.hint_image_type=\"depth\"\n                    artifact.adjustments=[{depth:{}}]\n                    if (specialLayer.parameters && specialLayer.parameters.method && specialLayer.parameters.method===\"T2I Adapter\") {\n                        artifact.hint_image_type=\"coadapter/depth\"\n                    }\n\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"hed\") {\n                    artifact.hint_image_type=\"hed\"\n                    artifact.adjustments=[{edge_detection:{}}]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"lineart\") {\n                    artifact.hint_image_type=\"lineart\"\n                    artifact.adjustments=[{edge_detection:{},engine_id :\"hinters-lineart-anime\"}]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"pix2pix\") {\n                    artifact.hint_image_type=\"pix2pix\"\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"shuffle\") {\n                    artifact.hint_image_type=\"shuffle\"\n                    artifact.adjustments=[{shuffle:{}}]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"normal\") {\n                    artifact.hint_image_type=\"normal\"\n                    artifact.adjustments=[{normal:{background_threshold:-1,preblur:0,postblur:5,smoothing:0.8}}]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"segmentation\") {\n                    artifact.hint_image_type=\"segmentation/ade20k\"\n                    artifact.adjustments=[{segmentation:{}}]\n                }\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"posenet\") {\n                    artifact.hint_image_type=\"openpose\"\n                    artifact.adjustments=[{openpose:{}}]\n                }\n                if (specialLayer.parameters && specialLayer.parameters.preprocessor && specialLayer.parameters.preprocessor!==\"normal\") { // only preprocessor or skip it\n                    if (specialLayer.parameters.preprocessor===\"skip\") artifact.adjustments=[]\n                    if (specialLayer.parameters.preprocessor===\"only\") {\n                        artifact.type=\"ARTIFACT_IMAGE\"\n                        this.requestTemplate.engineId=\"noop\"\n                        artifact.adjustments.push({\"invert\": { }})\n                    }\n                }\n                // style is special\n                if (specialLayer.type===\"image\" && specialLayer.preprocessorType===\"style\") {\n                    artifact.hint_image_type=\"style\"\n                    if (specialLayer.parameters && specialLayer.parameters.method && specialLayer.parameters.method===\"T2I Adapter\") {\n                        artifact.hint_image_type=\"coadapter/style\"\n                    }\n                }\n                artifact.binary=specialLayer.base64\n                let weight=1.0\n                let control_mode=0\n                if (specialLayer.parameters && specialLayer.parameters.weight) weight=specialLayer.parameters.weight\n                if (specialLayer.parameters && specialLayer.parameters.control_mode) {  // control_mode, https://github.com/hafriedlander/api-interfaces/blob/d2c6cfea753e58c1df408843904977ebeeed3d7e/src/proto/generation.proto#L314\n                    switch(specialLayer.parameters.control_mode) {\n                        case \"Balanced\": \n                            control_mode=0;\n                            break;\n                        case \"My prompt is more important\":\n                            control_mode=1;\n                            break;       \n                        case \"ControlNet is more important\":\n                            control_mode=2;\n                            break;\n                    }\n                }\n                if (specialLayer.type===\"inpaint\") control_mode=2 \n                let prompt={artifact:artifact,parameters:{weight:weight,hint_priority:control_mode}}\n                // @ts-ignore\n                allprompts.push(prompt)\n            }\n        }\n        if (p.loraList && p.mode!==\"upscale\" && p.mode!==\"autoMatte\" && p.mode!==\"removeBackground\"  && p.mode!==\"inpainting\") {\n            for(let lora of p.loraList) {\n                let artifact = {type:\"ARTIFACT_LORA\",url:lora.url}\n                let prompt={artifact:artifact,parameters:{weight:lora.weight}}\n                // @ts-ignore\n                allprompts.push(prompt)\n            }\n\n        }\n        console.log(\"allprompts\",allprompts)\n\n\n        this.requestTemplate.prompt = allprompts\n        let width=parseInt(SDConfig.width)\n        let height=parseInt(SDConfig.height)\n        let imageobj = {}\n        if (p.mode!==\"upscale\") {\n            imageobj.width=width\n            imageobj.height=height\n            if (p.targetWidth && p.targetHeight) {      // not using config\n                imageobj.width=parseInt(p.targetWidth)\n                imageobj.height=parseInt(p.targetHeight)\n\n            }\n        }\n\n        if (p.seed){\n            imageobj.seed=[p.seed];\n        }\n        imageobj.steps = parseInt(p.steps);\n        imageobj.samples = parseInt(p.num);\n\n\n\n        /*            if (p.enable_hr) {  // ignored now\n                        imageobj.hires ={enable:true}\n                    } else {\n                        imageobj.hires ={enable:false}\n                    }*/\n        imageobj.hires={enable:false}\n        // auto activate hires fix\n        if (imageobj.width>512 || imageobj.height>512)  imageobj.hires ={enable:true}\n            //   image.setHiresFixParameters(hr)\n        if (p.tiling){\n            imageobj.tiling = true;\n        }\n\n\n\n        imageobj.transform={diffusion: diffusionMap[p.sampling_method]};\n\n        // name of parameters = step\n        let parameters = {scaledStep:0, sampler:{cfgScale:parseFloat(p.cfg_value)}}\n\n        if (p.sampling_method==='DPMSolver++ 2M (Fast)') {\n            parameters.sampler.sigma = {\"sigmaMin\": 0.1072,\"karrasRho\": 9}\n        }\n\n        if (p.image64 || p.maskImage64) {\n\n            let schedule = {}\n            if (!p.strength) p.strength=0.5\n            if (!p.maskImage64){\n                schedule.start=parseFloat(p.strength);\n            }else{\n                schedule.start=1.0;\n            }\n\n            if (p.inpainting_original) {\n                schedule.start=parseFloat(p.strength);\n            }\n            parameters.schedule = schedule;\n            //   console.log(\"strength set\",p.strength,step.toObject())\n\n        }\n        try {\n            if (p.clip) {\n                parameters.guidance= {guidancePreset:\"GUIDANCE_PRESET_NONE\",}\n                parameters.guidance.instances = [{\"guidanceStrength\": 0.25}];\n            }\n        } catch (e) {\n            console.log(e)\n        }\n        imageobj.parameters = [parameters];\n        this.requestTemplate.image = imageobj;\n        let answers;\n\n\n        let asyncHandleobj;\n        asyncHandleobj = await this.postRest(SDConfig, 'asyncGenerate', this.requestTemplate);\n\n        asyncHandleobj.requestId = this.requestTemplate.requestId;\n        if (!window.asyncHandleobjList) window.asyncHandleobjList = [];\n        window.asyncHandleobjList.push({...asyncHandleobj,taskid:p.taskid});\n        let hasanyresult = false;\n        while(!hasanyresult){\n            let canceledfound = window.asyncHandleobjList.find((el)=>el.requestId==asyncHandleobj.requestId && el.canceled);\n            if (canceledfound) break;\n            try{\n                answers = await this.postRest(SDConfig,'asyncResult',asyncHandleobj)\n            }catch (e) {\n                answers = {error:true,complete:true};\n                throw e;\n                break;\n            }\n            //if (answers && answers.error) return Promise.reject(new Error('Error'));\n            if (answers && answers.answer && answers.answer.length)   hasanyresult = true;\n            if (!hasanyresult){\n                await new Promise(r => setTimeout(r, 1000));\n            }\n        }\n\n        if (!answers.complete){\n            if (window.postMessageAdapter || p.aistudio) {\n                this.getAllOtherImagesStudio(SDConfig, p, asyncHandleobj);\n            } else {\n                this.getAllOtherImages(SDConfig, p, asyncHandleobj);\n            }\n        }\n\n\n        if (answers.answer){\n            answers = answers.answer;\n        }\n\n\n        if(window.onlyonegrpclocal) {\n            window.requestlocalgrpcprocessing = false;\n            readyToLoadStore.set({'ready':true});\n        }\n\n\n        if (!Array.isArray(answers)) answers = [answers];\n        answers.forEach(answer=>{\n            if (answer.artifacts) {\n                answer.artifacts.forEach(\n                    ({  type , binary, seed: innerSeed }) => {\n                        if (type === 'ARTIFACT_IMAGE') {\n                            if (!innerSeed) innerSeed=i\n                            p.seedList[i] = innerSeed\n                            let img = { base64: binary }\n                            img.seed = p.seedList[i]\n                            images.push(img)\n                            i++\n                        }\n                    }\n                )\n                this.status=\"ready\"\n            }\n        });\n        return images;\n\n\n        //return imgs\n    }\n\n    getAllOtherImagesStudio(SDConfig,p,asyncHandleobj){\n        let that = this;\n        let taskid = p.taskid;\n        (async function() {\n            let complete = false;\n            while(!complete){\n                await new Promise(r => setTimeout(r, 1000));\n                let canceledfound = window.asyncHandleobjList.find((el)=>el.requestId==asyncHandleobj.requestId && el.canceled);\n                if (canceledfound){\n                    break;\n                }\n                let answers = await that.postRest(SDConfig,'asyncResult',asyncHandleobj);\n                canceledfound = window.asyncHandleobjList.find((el)=>el.requestId==asyncHandleobj.requestId && el.canceled);\n                let canceledrequest = canceledfound?true:false;\n                if(answers) {\n                    if (answers.answer){\n                        let retobj = {taskid,answers};\n                        if(canceledrequest){\n                            retobj.canceledrequest = true;\n                        }\n                        transferStore.set(retobj);\n                    }\n                    if(answers.complete) complete = true;\n                }\n            }\n        })();\n    }\n\n    async cancelRequest(SDConfig,taskid) {\n        if (!window.asyncHandleobjList || !window.asyncHandleobjList.length) return;\n        let found= window.asyncHandleobjList.find((el)=>el.taskid==taskid);\n        found.canceled = true;\n        let answer;\n        try {\n            answer = await this.postRest(SDConfig, 'asyncCancel',{requestId:found.requestId,asyncHandle:found.asyncHandle});\n        } catch (e) {\n            await new confirmDialog().alert(e.toString());\n        }\n    }\n\n    getAllOtherImages(SDConfig,p,asyncHandleobj){\n        let that = this;\n        let taskid = p.taskid;\n        (async function() {\n            let complete = false;\n            let answers\n            let tasksarray\n            while(!complete){\n                await new Promise(r => setTimeout(r, 1000));\n                let canceledfound = window.asyncHandleobjList.find((el)=>el.requestId==asyncHandleobj.requestId && el.canceled);\n                if (canceledfound) break;\n                try {\n                    answers = await that.postRest(SDConfig, 'asyncResult', asyncHandleobj);\n                }catch (e) {\n                    await new confirmDialog().alert(e.toString());\n                    complete=true;\n                }\n                if(!answers.answer) continue;\n                tasksarray = get(tasksStore);\n                let foundindex = 0 ;\n                let eltoupdate = tasksarray.find((el,idx) => {foundindex= idx;  return el.p.taskid == taskid});\n\n                if (!eltoupdate) continue;\n                let res = answers.answer.map((el)=>{\n                    let im = el.artifacts[0];\n                    let base64 = \"data:image/png;base64,\"+im.binary;\n                    let seed = im.seed;\n                    return {base64,seed}\n                })\n\n                eltoupdate.imagelist = [...eltoupdate.imagelist,...res];\n                if (answers.complete){\n                    complete = true;\n                    eltoupdate.complete = true;\n                }\n                tasksarray[foundindex] =  eltoupdate;\n                tasksStore.set(tasksarray);\n            }\n        })();\n    }\n\n\n    getSpecialFeatures(model,upscalers) {\n        let list=[\"canny\",\"style\",\"skribble\",\"depth\",\"normal\",\"hed\",\"posenet\",\"segmentation\",\"shuffle\",\"pix2pix\",\"normal\",\"T2I_ControlNet_canny_switch\",\"pix2pix\",\"backgroundRemoval\",\"text\",\"control_mode\"]\n        let features=[]\n        if (!model.acceptedHintTypes) {\n            if (upscalers) return list  // default: all features\n            return features             // old 1.1 server has no upscaler -> nothing else as well\n        }\n        for(let hType of model.acceptedHintTypes) {\n            for(let f of list) {\n                let toFind=f\n                if (f===\"skribble\") toFind=\"scribble\"\n                if (f===\"posenet\") toFind=\"openpose\"\n\n                if (hType.type===toFind) {\n                    features.push(f)\n                    if (toFind===\"canny\") features.push(\"T2I_ControlNet_canny_switch\")\n                    if (toFind===\"scribble\") features.push(\"text\")\n\n                } \n            }\n        }\n        if (features) {\n            features.push(\"backgroundRemoval\")\n            features.push(\"control_mode\")\n        }\n\n        return features\n    }\n    async getServerFeatures(SDConfig) {\n        try {\n\n            let models=await this.getModels(SDConfig)\n            console.log(\"models\",models)\n            if (!models) return false\n            let upscalers\n            upscalers=await this.postRest(SDConfig, 'engines', {task_group :\"UPSCALE\"},true);\n            let features={}\n            let modelFound=false\n            for(let i=0;i<models.length;i++) {\n                let model=models[i]\n                if (model.id===SDConfig.model) {\n                     features={artifacts:model.acceptedPromptArtifacts,models:models,model:model.id,upscalers,features:this.getSpecialFeatures(model,upscalers)}\n                     modelFound=true\n                }\n            }\n\n            if (modelFound)       return features\n\n            let model=models[0]\n            if (!model) return false\n            features={artifacts:model.acceptedPromptArtifacts,models:models,model:model.id,upscalers,features:this.getSpecialFeatures(model,upscalers)}\n            return features\n        } catch(e) {\n            return false\n        }\n    }\n\n\n\n\n\n\n\n\n\n\n    async postRest(SDConfig,command,body,ignoreError=false) {\n        SDConfig.url=new URL(SDConfig.url).origin       // remove path at end\n        SDConfig.url.endsWith('/') ? SDConfig.url.slice(0, -1) : SDConfig.url   // remove / at end        \n        let apiKey = \"\";\n        if (SDConfig.token) apiKey = \"/\"+SDConfig.token     // temp quick fix\n\n        let endpoint =SDConfig.url+apiKey+\"/grpcgateway/\"+command;\n        let answer;\n        let answertext;\n        let postRequest\n        if (SDConfig.token)    apiKey = SDConfig.token        \n        try {\n            postRequest= await fetch(endpoint, {\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Accept\": \"application/json\",\n                 //   \"Authorization\": `Bearer ${apiKey}`,\n                    \"Bypass-Tunnel-Reminder\": `true`,                    \n               //     \"Access-Control-Allow-Credentials\": `true`                    \n                },\n                method: 'POST',\n                body: JSON.stringify(body)\n            })\n            //answer=await postRequest.json();\n            answertext =await postRequest.text();\n            try {\n                answer= JSON.parse(answertext);\n            } catch(error) {\n                throw SyntaxError(error);\n            }\n            if (postRequest.status>400){\n                answertext = answer.name+\" \"+answer.messsage;\n                throw SyntaxError();\n                return;\n            }\n            if (answer) {\n                return answer\n            }\n            return false\n\n        } catch(error) {\n            if (ignoreError) return\n            if (error instanceof SyntaxError) {\n                let errortext;\n                if(answertext) errortext = answertext.replace(/<[^>]+>/g, '');\n                if (!errortext && postRequest.statusText) errortext = \"Server error: \"+postRequest.statusText;\n                if(!errortext) errortext = error.toString();\n                await new confirmDialog().alert(errortext);\n                throw error;\n            } else {\n                await new confirmDialog().alert(error.toString())\n                console.log(error,postRequest)\n                this.status=\"error\"\n                throw error;\n            }\n        }\n    }\n\n\n\n\n    async getModels(SDConfig) {\n        SDConfig.url=new URL(SDConfig.url).origin       // remove path at end\n        SDConfig.url.endsWith('/') ? SDConfig.url.slice(0, -1) : SDConfig.url   // remove / at end        \n\n        let answertext;\n        let apiKey = \"\";\n        if (SDConfig.token) apiKey = \"/\"+SDConfig.token\n\n        let endpoint =SDConfig.url+apiKey+\"/grpcgateway/engines\"\n        let answer;\n        let getRequest;\n        try {\n            getRequest= await fetch(endpoint, {\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Accept\": \"application/json\",\n                 //   \"Authorization\": `Bearer ${apiKey}`,\n                    \"Bypass-Tunnel-Reminder\": `true`,\n                //    \"Access-Control-Allow-Credentials\": `true`\n                },\n                method: 'get'\n            })\n            answertext =await getRequest.text();\n            try {\n                answer= JSON.parse(answertext);\n            } catch(error) {\n                throw SyntaxError(error);\n            }\n\n            if (answer.engine) {\n                let res=[]\n                console.log(\"getModels\",answer)\n                for (let i=0;i<answer.engine.length;i++) {\n                    let engine=answer.engine[i]\n                    if (engine.type===\"PICTURE\")    res.push(engine)\n                }\n                return res\n            }\n            return false\n        } catch(error) {\n            if (error instanceof SyntaxError) {\n                let errortext;\n                if(answertext) errortext = answertext.replace(/<[^>]+>/g, '');\n                if (!errortext && getRequest.statusText) errortext = \"Server error: \"+getRequest.statusText;\n                if(!errortext) errortext = error.toString();\n                await new confirmDialog().alert(errortext)\n            } else {\n                await new confirmDialog().alert(error.toString())\n                console.log(error,getRequest)\n                this.status=\"error\"\n                throw error;\n            }\n        }\n    }\n    /* fake method only for compatibility*/\n    async getWorkflowList() {\n        return [];\n    }\n\n    async checkNewServer(SDConfig) {\n        return await this.getModels(SDConfig)\n    }\n\n    requestTemplate={}\n\n}","\nexport default class gyreDocument {\n\n    constructor() {\n        this.prompt=\"\"\n        this.modifiers=\"\"\n        this.presetName=\"\"\n        this.layers=[]\n        this.width=this.height=1024\n        this.id=1\n    }\n    setPrompt(p) {\n        this.prompt=p\n    }\n    setModifiers(m,name) {\n        this.modifiers=m\n        this.presetName=name\n    }\n    setDefaultModifier() {\n        this.modifiers=\"rawphoto of a...\\n#-text\\n-b&amp;w\\n-bad art\\n-poorly drawn\\n-naked\\n-close up\\n-blurry\\n-disfigured\\n-bad anatomy\\n-deformed\\n-extra limbs\\n-ugly\\n-nude\\nbeautiful\\nhighly detailed\\ncinematic\\n#fujifilm\\n#lora:https://civitai.com/api/download/models/16576:1\\n#fuji\"\n        this.presetName=\"Cinematic\"\n    }\n    layerImageEmpty() {\n        let base64=\"data:image/webp;base64,UklGRqQJAABXRUJQVlA4WAoAAAAwAAAA/wMA/wMASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZBTFBIPAAAAAEHEBEREAgk+5tPUET/M/7zn//85z//+c9//vOf//znP//5z3/+85///Oc///nPf/7zn//85z//+c//DVZQOCByBwAAkN8AnQEqAAQABD5tNplJpCMioSAIAIANiWlu4XdhG0AJ7APfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99qwAP7/6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\"\n        return this.layerImage(1024,1024,\"Background Image\",base64)\n    }\n    layer(type,name,width=0,height=0) {\n        if (width) {\n            this.width=width\n            this.height=height\n        }\n        let l={\n            id: this.id++,\n            name:name,\n            type:type,\n            width:this.width,\n            height:this.height,\n            x:0,\n            y:0,\n            visible:true\n        }\n        return l\n    }\n    layerImage(width,height,name,base64) {\n        let l=this.layer(\"image\",name,width,height)\n        \n        l.url=base64\n        return l\n    }\n    async layerText(width=1024,height=1024,name=\"Text\",component,font_size,string,font,letter_spacing=0) {\n        let l=this.layer(\"text\",name,width,height)\n        l.background_type = 'transparent'\n        if (component) l.data = await component.getScene()\n        l.font_size = font_size\n        l.string = string\n        l.letter_spacing = letter_spacing\n        l.font = font\n        return l\n    }\n    async layer3D(width=1024,height=1024,name='3D Scene',component) {\n        let l=this.layer(\"3d\",name,width,height)\n        l.background_type = 'transparent'\n        if (component) l.data = await component.getScene()\n        return l\n    }\n    async layerPose(width=1024,height=1024,name='Pose',component) {\n        let l=this.layer(\"posenet\",name,width,height)\n        l.background_type = 'transparent'\n        l.show_character=\"human\"\n        if (component) l.data = await component.getScene()\n        return l\n    }\n    setToolsLayers(x=0,y=0,width=1024,height=1024) {\n        if (height>this.height) height=this.height\n        if (width>this.width) width=this.width\n        this.toolsLayers=[\n            {\n              \"id\": \"inpaintingBrush\",\n              \"type\": \"inpaintingBrush\",             \n            },\n            {\n              \"id\": \"aiWindow\",\n              \"type\": \"generationWindow\",\n              \"x\": x,\n              \"y\": y,\n              \"width\": width,\n              \"height\": height,           \n              \"dragRestriction\": true,\n              \"resizeRestriction\": { \"width\": 1024, \"height\": 1024 }              \n            },\n            {\n              \"id\": \"aiSelection\",\n              \"type\": \"aiSelection\",\n              \"x\": 0,\n              \"y\": 0,\n              \"width\": 512,\n              \"height\": 512,\n            }\n        ]\n        return \n    }\n    extendImage(direction) {\n        let orgWidth=this.width\n        let orgHeight=this.height\n        if (direction===\"right\") {\n            this.width+=orgWidth/2\n            this.setToolsLayers(orgWidth/2,0,orgWidth,orgHeight) \n        }\n        if (direction===\"bottom\") {\n            this.height+=orgHeight/2\n            this.setToolsLayers(0,orgHeight,orgWidth,orgHeight) \n        }        \n        if (direction===\"left\") {\n            this.width+=orgWidth/2\n            this.setToolsLayers(0,0,orgWidth,orgHeight) \n            this.layers[0].x=orgWidth/2\n        }\n        if (direction===\"top\") {\n            this.height+=orgHeight/2\n            this.setToolsLayers(0,0,orgWidth,orgHeight) \n            this.layers[0].y=orgHeight/2\n        }                  \n    }\n    setMode(mode) {\n        this.mode=mode\n    }\n    make() {\n          \n        let promptInfo = {\n            prompt: this.prompt,\n            modifiers: this.modifiers,\n            presetName: this.presetName\n        }\n        let doc = {\n            layers: this.layers.reverse(),\n            document: {width: this.width, height: this.height},\n            toolsLayers: this.toolsLayers,\n            promptInfo\n        }\n        if (this.mode) doc.setMode=this.mode\n        return doc\n    }\n    async fromWizard(collectedData) {\n        if (collectedData.image.base64) {\n            this.layers.push(this.layerImage(collectedData.image.width,collectedData.image.height,collectedData.image.name,collectedData.image.base64))\n        } else {\n            this.layers.push(this.layerImageEmpty())\n        }\n        if (collectedData.background.base64) {\n            this.layers.push(this.layerImage(collectedData.image.width,collectedData.image.height,collectedData.image.name,collectedData.background.base64))\n            this.layers[0].visible=false\n            this.layers[1].subType=\"background\"\n            this.setMode(\"generationWindow\")\n        }\n        if (collectedData.prompt) this.setPrompt(collectedData.prompt.text)\n        if (collectedData.modifierInfo) this.setModifiers(collectedData.modifierInfo.modifiers,collectedData.modifierInfo.presetName)\n        if (collectedData.scene3d.component) {\n            this.layers.push(await this.layer3D(collectedData.scene3d.width,collectedData.scene3d.height,\"3D Scene\",collectedData.scene3d.component))\n        }\n        if (collectedData.pose.component) {\n            this.layers.push(await this.layerPose(collectedData.pose.width,collectedData.pose.height,\"Pose\",collectedData.pose.component))\n        }        \n        if (collectedData.type===\"text\" && collectedData.text.component) {\n            this.layers.push(await this.layerText(1024,1024,\"Text\",collectedData.text.component,collectedData.text.font_size,collectedData.text.string,collectedData.text.font))\n            this.setMode(\"generationWindow\")\n        } \n        if (collectedData.type!==\"txt2img\") {\n            this.setDefaultModifier()\n        } else {\n            this.setMode(\"generationWindow\")\n        }\n        this.layers[this.layers.length-1].selected=true\n        this.setToolsLayers()\n        if (collectedData.type===\"outpainting\" && collectedData.outpainting.direction ) {\n            this.extendImage(collectedData.outpainting.direction)\n            this.setMode(\"generationWindow\")\n        } \n        \n        return this.make()         \n    }\n}","export let wizards={\n    \"3d\": {\n        description: \"Add an 3D object to the scene as guide for the AI\",\n        steps: [\n        { text: 'Image',type:\"selectImage\" },\n        { text: 'Object',type:\"select3D\" },\n        { text: 'Prompt',type:\"prompt\",promptTitle:\"Describe object\" }\n    ]},\n    \"pose\": {\n        description: \"Add a character to the scene as guide for the AI\",\n        steps: [\n        { text: 'Image',type:\"selectImage\" },\n        { text: 'Pose',type:\"selectPose\" },\n        { text: 'Prompt',type:\"prompt\",promptTitle:\"Describe character (e.g. fashion model, construction worker, robot)\" }\n    ]},\n    \"text\": {\n        description: \"AI generated text\",\n        steps: [\n        { text: 'Text',type:\"text\" },\n        { text: 'Font',type:\"font\" },\n        { text: 'Prompt',type:\"prompt\",promptTitle:\"Describe text\"  }\n    ]},\n    \"txt2img\": {\n        description: \"Text to image\",\n        steps: [\n            { text: 'Prompt',type:\"prompt\",promptTitle:\"Describe what you want to see\"  },\n            { text: 'Style',type:\"selectModifier\" },\n\n    ]},\n    \"outpainting\": {\n        description: \"Generative extend image via Outpainting\",\n        steps: [\n            { text: 'Image',type:\"selectImage\" },\n            { text: 'Direction',type:\"outpainting\" },\n            { text: 'Prompt',type:\"prompt\",promptTitle:\"Optional: Describe new part\" }\n    ]},\n    \"background\": {\n        description: \"Generative extend image via Outpainting\",\n        steps: [\n            { text: 'Image',type:\"selectImage\" },\n            { text: 'Removing background',type:\"removeBackground\" },\n            { text: 'Prompt',type:\"prompt\",promptTitle:\"Describe new background\" }\n    ]}        \n    \n}","<svelte:options tag=\"fds-first-config\"></svelte:options>\n<script>\n    import {onMount} from 'svelte'\n    import { get_current_component} from \"svelte/internal\"\n    import { tutorialsData } from './tutorials'\n    import { quickStartData} from \"./quickStart\"\n    import { newDocumentData } from './newDocument'\n    import Gyre from \"./Gyre\"\n    import gyreDocument from \"./gyreDocument\"\n    import confirmDialog from \"./confirmDialog\";\n    import {wizards} from './wizards'\n\n    let host = get_current_component()\n    export let contentelement;\n    export let openProfile = false\n    export let finishedInit=false\n    export let initwidth = 1024\n    export let initheight = 1024\n    export let serverurl = \"\"\n    export let bearer = \"\"\n    export let servertype = \"\";\n    export let SDConfig\n    // start with image or Gyre document\n    export let file_base64\n    export let file_blob\n    export let file_type\n    export let file_name\n    export let file_uncompressed\n    import { afterUpdate } from 'svelte'\n\n    export let onclosed = () => {\n    };\n\n    export let serverIsAvailable=false\n\n    let serverstatusurl;\n    let posenetselectoropen = false;\n    let search3dopen = false;\n    let scene3DGetPrimitive = false;\n    let selectModifier = false;\n    let reopendialogevent = false;\n    let layerStack=[]\n    let toY=\"100px\"\n\n    $:{\n        if (!onPremise && bearer) {\n            servertype='Gyre';\n            serverurl=\"https://cloud.gyre.ai\"\n            serverstatusurl = serverurl  +\"/\"+bearer+ \"/status\";\n        }\n        if (serverurl || bearer && servertype) {\n            if (serverurl.includes(\"status\")) {\n                serverstatusurl = serverurl \n            } else {\n                if (bearer) {\n                    serverstatusurl = serverurl.replace(/\\/$/, \"\") +\"/\"+bearer+ \"/status\";\n                    if(servertype=='COMFY'){\n                        serverstatusurl = serverurl.replace(/\\/$/, \"\") +\"/\"+bearer+ \"/settings\";\n                    }\n\n                } else {\n                    serverstatusurl = serverurl.replace(/\\/$/, \"\") + \"/status\";\n                    if(servertype=='COMFY'){\n                        serverstatusurl = serverurl.replace(/\\/$/, \"\") + \"/settings\";\n                    }\n                }\n            }\n\n\n\n            if(servertype) {\n                setTimeout(async () => {\n                    let response\n                    try {\n                        response = await fetch(serverstatusurl);\n                    } catch (e) {\n                        serverIsAvailable = false\n                    }\n                    if (response?.ok) serverIsAvailable = true\n                    else serverIsAvailable = false\n                }, 0)\n            }\n             \n        }\n        toY=\"100px\"\n        if (wizard_glb.thumb)  {\n            if (!wizard_image.base64)  {\n                layerStack[0]=wizard_glb.thumb\n                toY=\"100px\"\n            } else {\n                layerStack[0]=wizard_image.base64\n                layerStack[1]=wizard_glb.thumb\n                toY=\"300px\"\n            }\n        }\n        if (wizard_background.base64) {\n            layerStack[0]=wizard_image.base64\n            layerStack[1]=wizard_background.base64\n            toY=\"300px\"\n        }\n        if (wizard_text.thumb)  {\n            layerStack[0]=wizard_text.thumb\n            toY=\"100px\"\n        }        \n        if (wizard_pose.thumb)  {\n            if (!wizard_image.base64)  {\n                layerStack[0]=wizard_pose.thumb\n                toY=\"100px\"\n            } else {\n                layerStack[0]=wizard_image.base64\n                layerStack[1]=wizard_pose.thumb\n                toY=\"300px\"\n            }\n        }        \n        if (wizard_image.base64)  {\n            layerStack[0]=wizard_image.base64\n        }\n    }\n\n    onMount(() => {\n        quickStart()\n    });\n    let setServerToken = () => {      \n        openProfile = false;\n        if (!onPremise) {\n            servertype='Gyre';\n            serverurl=\"https://cloud.gyre.ai\"\n        }\n    }\n    function openLink(url) {\n        window.open(url, '_blank')\n    }\n    afterUpdate(() => {\n        let shadow = host.shadowRoot\n        let links = shadow.querySelectorAll('.link')\n        for (let l of links) {\n            let url = l.getAttribute('href')\n            l.addEventListener('click', () => {\n\n                //  here we run modal of:\n                // scene 3d primitive:\n                //scene3DGetPrimitive = true;\n                // search 3 d object dialog :\n                //search3dopen = true;\n                // modifiers :\n                openmodifiers('link');\n\n\n                openLink(url)\n            })\n        }\n        let stack = shadow.querySelector('.stack')\n        if (!stack) return\n        if (stack.classList.contains(\"stackPos\")) return\n        let rect = stack.getBoundingClientRect();\n    \n        // Set initial position based on current position in the viewport\n        fromX=  `${window.innerWidth - rect.right}px`;\n        fromY = `${rect.top}px`;\n        stack.classList.add(\"stackPos\")\n    })\n    let fromX=0\n    let fromY=0\n\n    function openmodifiers(link){\n        // open modifier dialog\n        if(!link) selectModifier = true;\n        if(link) selectModifier = false;\n        reopendialogevent = true;\n        setTimeout(() => {\n            reopendialogevent = false\n        }, '200')\n    }\n\n    let wizard=\"\"\n    let wizardCurrentStep=0\n    let wizardData={}\n    // start wizard\n    function startWizard(type) {\n        mode=\"wizard\"\n        wizard=type\n        wizardData=wizards[type]\n        data=null\n        wizard_glb={}\n        wizard_image={}\n        wizard_pose={}\n        wizard_text={string:\"\"}\n        wizard_prompt={text:\"\"}\n        wizard_modifier={}\n        wizard_outpainting={}\n        wizard_background={}\n        layerStack=[]\n        gotoWizardStep(0)\n    }\n    let wizardCurrentstepData={}\n    let wizard_background={}\n\n    async function next() {\n        return await gotoWizardStep(wizardCurrentStep+1)\n    }\n\n    async function gotoWizardStep(num) {\n        if (num<0) num=0\n\n        // last step: finished wizard and jump to main application with generated document from collected data of wizard\n        if (num>=wizardData.steps.length) {\n//            wizard=\"\"\n//            quickStart()\n         /*   fadeOut=true \n            stackTop=true\n            await new Promise(resolve => setTimeout(resolve, 800))\n            stackTopFadeOut=true\n            await new Promise(resolve => setTimeout(resolve, 300))\n*/\n            let collectedData= {\n                type: wizard,\n                image: wizard_image,\n                prompt:wizard_prompt,\n                modifierInfo: wizard_modifier,\n                scene3d: wizard_glb,\n                pose: wizard_pose,\n                text: wizard_text,\n                outpainting: wizard_outpainting,\n                background:wizard_background\n            }\n            let g=new gyreDocument()\n            let doc=await g.fromWizard(collectedData)\n            console.log(doc)\n            file_uncompressed= doc              \n            file_type=\"gyre\"              \n            initwidth = g.width\n            initheight = g.height                \n            file_name=\"From Wizard\"\n            if (wizard_image.name) file_name=wizard_image.name\n            setfinishedInitIfServerIsAvailable();\n            return\n        }\n        wizardCurrentStep=num\n        wizardCurrentstepData=wizardData.steps[num]\n        if (num===1 && wizard===\"background\" && wizard_image.base64 && !wizard_background.base64) {  // special case: background removal\n            let base64=wizard_image.base64\n            base64=await convertToPNG(base64)\n            let p={\n                mode: \"removeBackground\",\n                image64: base64.split(\",\")[1], // remove image prefix, pure base64 for AI\n                taskid: (Math.random() + 1).toString(36).substring(3),   // need task-id\n                prompt: \"\"\n            }\n            let g=new Gyre();\n            g.runSD(SDConfig.generalConfig,p).then((result) => {\n                if (!result || !result[0] || !result[0].base64) {                    \n                    wizard_image={}\n                    return\n                }\n                let img=\"data:image/png;base64,\"+result[0].base64\n                wizard_background={base64:img}\n                next()\n            })\n        }\n    }\n    async function convertToPNG(base64Image) {\n  return new Promise((resolve) => {\n    // If it's already a PNG, just resolve with the input\n    if (base64Image.includes(\"data:image/png\")) {\n      resolve(base64Image);\n      return; // Exit early\n    }\n    const img = new Image();\n    img.onload = () => {\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      // Set canvas dimensions to image dimensions (max 16MP)\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0);\n      const pngDataUrl = canvas.toDataURL('image/png')\n      resolve(pngDataUrl)\n    }\n    img.src = base64Image;\n  });\n}\n\n    let wizard_outpainting={}\n    function setOutpaintingDirection(direction) {\n        wizard_outpainting.direction=direction\n        wizard_outpainting.wizard_outpainting\n        next()\n\n    }\n\n    // set modifier for wizard\n    let wizard_modifier={}\n    function modifierSelected(el){\n        wizard_modifier.name=el.detail.key\n        wizard_modifier.modifiers=el.detail.modifiers.replace(/<br\\/>/g, '\\n')\n        next()\n    }\n    // read pose  for wizard\n    let wizard_pose={}\n    let poseComponent\n\n    async function posedowloaded(el){\n        wizard_pose.thumb=el.thumb\n        if (wizard_image.width) wizard_pose.width=wizard_image.width\n        else wizard_pose.width=1024\n        if (wizard_image.height) wizard_pose.height=wizard_image.height\n        else wizard_pose.height=1024\n        poseComponent.width=wizard_pose.width\n        poseComponent.height=wizard_pose.height\n        poseComponent.setScene(el)\n        await new Promise(resolve => setTimeout(resolve, 510))\n        wizard_pose.component=poseComponent\n        next()\n\n    }\n\n    // read glb for wizard\n    let wizard_glb={}\n    let scene3dComponent\n    async function glbbinarydowloaded(binary,thumb,searchstring){\n        wizard_prompt.text=searchstring\n        wizard_glb.thumb=thumb\n        wizard_glb=wizard_glb\n        let sceneparams = {meshes:[]};\n        // eslint-disable-next-line no-undef\n        if(BABYLON){\n            sceneparams.camera = {};\n            // eslint-disable-next-line no-undef\n            sceneparams.camera.position = new BABYLON.Vector3(0, 1, 3)\n            // eslint-disable-next-line no-undef\n            sceneparams.camera.rotation = new BABYLON.Vector3(0, 0, 0)\n        }\n        await scene3dComponent.setScene(sceneparams)  // empty existing scene\n        if (wizard_image.width) wizard_glb.width=wizard_image.width\n        else wizard_glb.width=1024\n        if (wizard_image.height) wizard_glb.height=wizard_image.height\n        else wizard_glb.height=1024\n        scene3dComponent.width=wizard_glb.width\n        scene3dComponent.height=wizard_glb.height\n        scene3dComponent.binary=binary  // add mesh\n        wizard_glb.component=scene3dComponent\n        next()\n    }\n     // read image as import for wizard\n     let wizard_image={}\n     async function importImageWizard(e) {\n        const file = e.target.files[0]\n        if (file.type && !file.type.startsWith('image/')) {\n            alert('File is not an image.', file.type, file)\n            return\n        }\n        wizard_image.name=file.name\n        wizard_background={}        // new image: reset background information\n        const reader = new FileReader()\n        reader.addEventListener('load', async (event) => {\n                wizard_image.base64= event.target.result                \n                let img = new Image()\n                img.src = wizard_image.base64\n                await img.decode()\n                wizard_image.width = img.width\n                wizard_image.height = img.height         \n                next()       \n        })\n        reader.readAsDataURL(file)        \n    }\n    // input text and font for wizard\n    let textComponent\n    let wizard_text={string:\"\"}\n    async function inputText(e) {\n        wizard_prompt.text=e.target.value\n        wizard_prompt.text= wizard_prompt.text.replace(/\\n/g,  ' ')\n        let upperText=e.target.value.toUpperCase()\n   //    \n        textComponent.width=1024\n        textComponent.height=1024\n        textComponent.text=upperText\n\n        await textComponent.autoSize()  \n        textComponent.background=\"white\" \n        let base64=await textComponent.renderForAI()   \n        textComponent.background=\"transparent\" \n\n        wizard_text.string=upperText\n        wizard_text.font_size=textComponent.font_size\n        wizard_text.thumb=base64\n        if (!wizard_text.font) wizard_text.font=\"Chewy\"\n        wizard_text.component=textComponent\n        wizard_text=wizard_text\n    }\n    async function selectFont(font) {\n        textComponent.font=font\n        wizard_text.font=font\n        await textComponent.autoSize()   \n        textComponent.background=\"white\" \n        let base64=await textComponent.renderForAI()  \n        textComponent.background=\"transparent\" \n        wizard_text.thumb=base64\n        wizard_text.font_size=textComponent.font_size\n    }\n    // input prompt and modifier for wizard\n    let wizard_prompt={text:\"\"}\n    async function promptInput(e) {\n        wizard_prompt.text=e.target.value\n    }\n    function startEmpty() {\n        setfinishedInitIfServerIsAvailable();\n    }\n\n    async function setfinishedInitIfServerIsAvailable() {\n     if (!serverIsAvailable){\n         await new confirmDialog().alert(\"Please set up server configuration in 'Profile' menu!\");\n         return\n     }\n        finishedInit=false\n    }\n\n\n\n\n    /**\n     * top menu functions\n     */\n    let mode=\"\"\n    function profile() {\n        mode=\"profile\"\n        openProfile=true\n    }\n\n    let data=[]\n    function myFiles() {\n        mode=\"myFiles\"\n        data=[\n            { \n                \"id\": \"myFiles\",\n                \"title\": \"My files\",\n                \"intro\": \"Not available yet.\",\n                entries: []\n            }\n        ]\n    }\n    function tutorials() {\n        mode=\"tutorials\"\n       data=tutorialsData\n    }\n    function quickStart() {\n        mode=\"quickStart\"\n       data=quickStartData\n    }    \n    function newDocument() {\n        mode=\"newDocument\"\n       data=newDocumentData\n\n    }\n    async function handleClick(entry) {\n        if (entry.type===\"file\") {\n            // load fdsai/gyre document from external URL\n            if (entry.from===\"external\") {\n                let response = await fetch(entry.file)\n                const binaryData = await response.arrayBuffer()\n                file_blob = new Blob([binaryData], { type: 'application/octet-stream' })\n                file_name=entry.title\n                file_type=\"gyre\"\n                setfinishedInitIfServerIsAvailable()\n                // end init screen go top canvas\n                return\n            }\n            // put local gyre file load here\n            return\n        }\n        initwidth=entry.width\n        initheight=entry.height\n    }\n    /**\n     * read gyre document or image as import and stop intro screen and transfer image to canvas\n     * @param e\n     */\n    async function importImage(e) {\n        const file = e.target.files[0]\n        if (file.type && !file.type.startsWith('image/') && !file.name.endsWith('.fdsai') && !file.name.endsWith('.gyre')) {\n            alert('File is not an image.', file.type, file)\n            return\n        }\n        file_name=file.name\n        const reader = new FileReader()\n        reader.addEventListener('load', async (event) => {\n            if (file.name.endsWith('.fdsai') && !file.name.endsWith('.gyre')) {\n                file_base64= event.target.result\n                file_type=\"gyre\"                \n            } else {\n                file_base64= event.target.result                \n                file_type=\"image\"\n                let img = new Image()\n                img.src = file_base64\n                await img.decode()\n                initwidth = img.width\n                initheight = img.height                \n            }\n            setfinishedInitIfServerIsAvailable();\n\n        })\n        reader.readAsDataURL(file)        \n    }\n\n\n\n    let onPremise=false\n\n    let fadeOut=false \n    let stackTop=false\n    let stackTopFadeOut=false\n\n</script>\n{#if false}<div class=\"stackPos\"></div>{/if}\n{#if finishedInit}\n<div class=\"layers colorScheme startScreen\">\n    <div class=\"topMenu\">\n        <div class=\"topLogo\"><img src=\"appdata/logo4.png\" class=\"logo\" alt=\"Gyre AI Logo\"> Gyre AI</div>\n        <div class=\"rightMenu\" class:fadeOut={fadeOut}>\n            <!-- svelte-ignore a11y-click-events-have-key-events -->\n            <div on:click={profile} class:active={mode===\"profile\"}><span class:red={!serverIsAvailable}>Profile</span></div>\n            <div href=\"https://discord.gg/FjSA36bR\" class=\"link\">Community</div>\n            <!-- svelte-ignore a11y-click-events-have-key-events -->\n            <div  on:click={quickStart} class:active={mode===\"quickStart\"}>Quick Start</div>            \n            <!-- svelte-ignore a11y-click-events-have-key-events -->\n            <div  on:click={tutorials} class:active={mode===\"tutorials\"}>Tutorials</div>\n            <div>\n                <label for=\"file-selector\" class=\"bw_button menuItem\">Import</label>\n                <input\n                    type=\"file\"\n                    id=\"file-selector\"\n                    on:change={importImage}\n                    accept=\"*\"\n                    style=\"\twidth: 0.1px;\n                        height: 0.1px;\n                        opacity: 0;\n                        overflow: hidden;\n                        position: absolute;\n                        z-index: -1;\"\n                />\n                </div>\n            <!-- svelte-ignore a11y-click-events-have-key-events -->\n            <div  on:click={myFiles} class:active={mode===\"myFiles\"}>My files</div>\n            <!-- svelte-ignore a11y-click-events-have-key-events -->\n            <div class=\"new\"  on:click={newDocument} class:active={mode===\"newDocument\"}>+</div>\n        </div>\n    </div>\n    <div class=\"content\" class:contentDark={fadeOut}>\n        {#if mode===\"wizard\" && wizard && wizardData && !data}\n     <!--    <button on:click={async () => { fadeOut=true \n       // await new Promise(resolve => setTimeout(resolve, 300))\n         stackTop=true\n\n        }}>Test</button>-->\n        <div class=\"wizard\">\n          \n            <div class=\"wizardColumns\">\n                <div class=\"left\">\n                <div class=\"wizardDescription\" class:fadeOut={fadeOut}>{wizardData.description}</div>\n                <div class=\"wizardSteps\" class:fadeOut={fadeOut}>\n                    <fds-wizard-steps steps={wizardData.steps} current={wizardCurrentStep}/>\n                </div>\n                <div class=\"wizardStepContent\" class:fadeOut={fadeOut}>\n                    {#if wizardCurrentstepData.type===\"selectImage\"}\n                    <label for=\"file-selector-wizard\" >\n                    <fds-image-editor-button  state=\"active\" class=\"centerButton\"  type=\"button\">&nbsp;&nbsp; Import Image &nbsp;&nbsp;</fds-image-editor-button></label>\n                    <input\n                        type=\"file\"\n                        id=\"file-selector-wizard\"\n                        on:change={importImageWizard}\n                        accept=\"*\"\n                        style=\"\twidth: 0.1px;\n                            height: 0.1px;\n                            opacity: 0;\n                            overflow: hidden;\n                            position: absolute;\n                            z-index: -1;\"\n                    />\n                    {/if}\n                    {#if wizardCurrentstepData.type===\"select3D\"}\n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <fds-image-editor-button type=\"button\"  state=\"active\" class=\"centerButton\" on:click={() => {search3dopen=true }}>&nbsp;&nbsp;  Select 3D Object &nbsp;&nbsp; </fds-image-editor-button>\n                    {/if}\n                    {#if wizardCurrentstepData.type===\"selectPose\"}\n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <fds-image-editor-button type=\"button\"  state=\"active\" class=\"centerButton\" on:click={() => {posenetselectoropen=true }}>&nbsp;&nbsp;  Select Pose &nbsp;&nbsp; </fds-image-editor-button>\n                    {/if}\n                    {#if wizardCurrentstepData.type===\"text\"}\n                        <div style=\"margin-bottom:10px\">Input 1-3 words</div>\n                        <textarea  class=\"centerButton textInput\" on:change={inputText} >{wizard_text.string}</textarea>\n                    {/if}                    \n                    {#if wizardCurrentstepData.type===\"font\"}\n                    <div style=\"margin-bottom:10px\">Select Font</div>\n                    <div class=\"fontSelect\">\n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <div on:click={() => {selectFont(\"Chewy\")  }}  style=\"font-family:Chewy\">{wizard_text.string}</div>\n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <div on:click={() => {selectFont(\"Righteous\")  }}  style=\"font-family:Righteous\">{wizard_text.string}</div>                             \n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <div on:click={() => {selectFont(\"Bangers\")  }}  style=\"font-family:Bangers\">{wizard_text.string}</div>    \n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <div on:click={() => {selectFont(\"Sigmar One\")  }}  style=\"font-family:Sigmar One\">{wizard_text.string}</div>                                              \n                    </div>\n                    {/if}                    \n                    {#if wizardCurrentstepData.type===\"prompt\"}\n                        <div style=\"margin-bottom:10px\">{wizardCurrentstepData.promptTitle}</div>\n                        <input type=\"text\" class=\"centerButton promptInput\"\n                        placeholder=\"Enter prompt\" on:change={promptInput} value={wizard_prompt.text}>\n                    {/if}  \n                    {#if wizardCurrentstepData.type===\"selectModifier\"}\n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <fds-image-editor-button type=\"button\"  state=\"active\" class=\"centerButton\" on:click={() => {openmodifiers()}}>&nbsp;&nbsp;  \n                            {#if wizard_modifier.name}{wizard_modifier.name}{:else} Select Style/Modifier{/if} &nbsp;&nbsp; </fds-image-editor-button>\n                    {/if}\n                    {#if wizardCurrentstepData.type===\"outpainting\"}\n                            {#if wizard_image.base64}\n                            <div class=\"containerOutpainting\">\n                                <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                <div class=\"arrow top\" on:click={() => {setOutpaintingDirection(\"top\") }} class:selected={wizard_outpainting.direction===\"top\"} >&#8593;</div>\n                                                                <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                <div class=\"arrow left\" on:click={() => {setOutpaintingDirection(\"left\") }} class:selected={wizard_outpainting.direction===\"left\"} >&#8592;</div>\n                            <!-- svelte-ignore a11y-missing-attribute -->\n                            <img src={wizard_image.base64} class=\"center-image\">                                \n                                                            <!-- svelte-ignore a11y-click-events-have-key-events -->\n                            <div class=\"arrow rightArrow\" on:click={() => {setOutpaintingDirection(\"right\") }} class:selected={wizard_outpainting.direction===\"right\"} >&#8594;</div>\n                                                            <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                <div class=\"arrow bottom\" on:click={() => {setOutpaintingDirection(\"bottom\") }} class:selected={wizard_outpainting.direction===\"bottom\"} >&#8595;</div>\n                            </div>                            \n                            {:else}\n                                Please import an image.\n                            {/if}\n                    {/if}\n                    {#if wizardCurrentstepData.type===\"removeBackground\"}\n                        {#if wizard_image.base64}\n                            {#if !wizard_background.base64}\n                                Removing background - please wait...\n                            {:else}\n                                <!-- svelte-ignore a11y-missing-attribute -->\n                                <img src={wizard_background.base64} width=\"200\">\n                            {/if}\n                        {:else}\n                            Please import an image.\n                        {/if}                    \n                    {/if}                    \n                </div>   \n            </div>\n                <div class=\"right\" style=\"--fromX:{fromX};--fromY:{fromY};--toY:{toY}\">\n                        <fds-layer-stack-3d layers={layerStack} class=\"stack\" class:stackTop={stackTop}  class:stackTopFadeOut={stackTopFadeOut}   state={stackTop ? \"flat\" : \"3d\" }></fds-layer-stack-3d>\n                </div>             \n            </div>\n\n            <div class=\"navigate\" class:fadeOut={fadeOut}>\n                                    <!-- svelte-ignore a11y-click-events-have-key-events -->\n\n                <fds-image-editor-button type=\"button\" class:firstStep={wizardCurrentStep===0}  on:click={() => {gotoWizardStep(wizardCurrentStep-1) }}>&nbsp;&nbsp; Back &nbsp;&nbsp;</fds-image-editor-button>\n                                    <!-- svelte-ignore a11y-click-events-have-key-events -->\n                <fds-image-editor-button type=\"button\"  state=\"active\"  on:click={() => { gotoWizardStep(wizardCurrentStep+1)}}>&nbsp;&nbsp;\n                    {#if wizardCurrentStep===wizardData.steps.length-1}Finish{:else}Next{/if}\n                     &nbsp;&nbsp;</fds-image-editor-button>\n\n            </div>\n        </div>\n        <fds-image-editor-text text=\"\" bind:this={textComponent} style=\"width:1px;height:1px;visibility: hidden;\" background=\"transparent\" font=\"Chewy\"></fds-image-editor-text>\n        <fds-3d-scene background_type=\"grey\" bind:this={scene3dComponent} camera_behaviour=\"\" width=\"1024\" height=\"1024\" style=\"width:1px;height:1px;visibility: hidden;\"></fds-3d-scene>\n        <fds-pose-editor show_character=\"human\" camera_behaviour=\"\"  bind:this={poseComponent} width=\"1024\" height=\"1024\" style=\"width:1px;height:1px;visibility: hidden;\" ></fds-pose-editor>\n\n\n        {/if}\n        <!-- mode: newDocument ask for size -->\n        {#if mode===\"newDocument\"}\n        <div style=\"margin-bottom:20px\">New empty document</div>\n        <div class=\"formLine\" style=\"display: flex;line-height:25px;margin-bottom:20px;\"><div\n            style=\"initwidth: 50%; display: flex; line-height: 30px; vertical-align: middle; padding-right: 10px;\">\n            <label style=\"margin:0; line-height: 40px;\" for=\"width\">Width </label>\n         <input lang=\"en\" type=\"text\" id=\"width\" placeholder=\"1024\" class=\"formInput\" style=\"margin-bottom:0\"\n                bind:value={initwidth}>\n</div> <div style=\"width: 50%; display: flex; line-height: 30px; vertical-align: middle;\">\n<label style=\"margin:0; line-height: 40px;\" for=\"height\">Height </label>\n         <input lang=\"en\" type=\"text\" id=\"height\" placeholder=\"1024\" class=\"formInput\"  style=\"margin-bottom:0\"\n                bind:value={initheight}>\n    <!-- svelte-ignore a11y-click-events-have-key-events -->\n    <fds-image-editor-button type=\"button\" style=\"margin-left:10px\" state=\"active\" on:click={startEmpty}>&nbsp;&nbsp; Create &nbsp;&nbsp;</fds-image-editor-button>\n\n</div>\n</div>\n<hr size=\"1\" style=\"margin-bottom:20px\">\n        {/if}\n        {#if data}\n    {#each data as category}\n        {#if category.id!==\"new\" && category.id!==\"new_social\" }\n           <div class=\"intro\">{category.intro}</div>\n        {:else}\n        {category.intro}\n        {/if}\n        <div class=\"repeater\" style=\"margin-bottom:20px\">\n            {#each category.entries as entry}\n                <!-- external link -->\n                {#if entry.url}\n                <div class=\"repeater-item\">                    \n                    <div class=\"flexrow\" class:square={entry.square}  >\n                          <div class=\"imageel link\" href=\"{entry.url}\">              \n                              <img class=\"imageelins\" alt=\"Source\" src=\"{entry.image}\"/>      \n                              {#if entry.imageHover}      \n                                 <img class=\"imageelins result\" alt=\"Result\" src=\"{entry.imageHover}\"/>\n                              {/if}\n                              {#if entry.play}\n                                 <div class=\"play\"></div>\n                            {/if}\n                          </div>\n                    </div>\n                    <div class=\"name\" style=\"height:45px\">{entry.title}</div>\n                  </div>\n                {/if}         \n                <!-- wizard -->\n                {#if entry.wizard}\n                <div class=\"repeater-item\">                    \n                    <div class=\"flexrow\" class:square={entry.square}  style=\"height:150px\">\n                          <!-- svelte-ignore a11y-click-events-have-key-events -->\n                          <div class=\"imageel\" on:click={() => { startWizard(entry.wizard)}}>              \n                              <img class=\"imageelins\" alt=\"Source\" src=\"{entry.image}\"/>      \n                              {#if entry.imageHover}      \n                                 <img class=\"imageelins result\" alt=\"Result\" src=\"{entry.imageHover}\"/>\n                              {/if}\n                          </div>\n                    </div>\n                    <div class=\"name\" style=\"height:45px\">{entry.title}</div>\n                  </div>\n                {/if}     \n                <!-- open remote or local file -->\n                {#if entry.file}\n                <div class=\"repeater-item\">                    \n                    <div class=\"flexrow\" style=\"width:207px;height:150px\"  >\n                          <div class=\"imageel\" >              \n                              <!-- svelte-ignore a11y-click-events-have-key-events -->\n                              <img class=\"imageelins\"style=\"width:207px\" alt=\"{entry.name}\" src=\"{entry.image}\" on:click={() => { handleClick(entry)}} />\n                          </div>\n                    </div>\n                    <div class=\"name\" style=\"height:45px\">{entry.title}</div>\n                  </div>\n                {/if}\n                <!-- show icon for new document -->\n                {#if entry.icon}\n                <div class=\"repeater-item\" style=\"margin:0; margin-top:20px\">                    \n                    <div class=\"flexrow\" style=\"width:70px;height:70px;padding:0; margin:0\"  >                 \n                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                        <fds-image-editor-button\n                        size=\"50\"\n                        icon={entry.icon}\n                        title={entry.title}\n                        on:click={() => { handleClick(entry)}} \n                        ></fds-image-editor-button>\n                    </div>\n                    <div class=\"name\" style=\"height:45px\">{@html entry.title}</div>\n                  </div>\n                {/if}                \n            {/each}\n        </div>\n    {/each}\n    {/if}\n</div>\n    <fds-image-editor-dialog showclose=\"false\" width=\"600px\" open={openProfile}\n                             onclosed={()=>{openProfile=false; }}>\n        {#if true}\n                        <span slot=\"modalcontent\">\n                            <div class=\"form\">\n\n\n\n                            {#if onPremise}\n                                <div class=\"select-dropdown\" style=\"width:140px; margin-bottom:0\">\n                                    <select\n                                            class=\"formInput samplerInput\"\n                                            on:change={(e) => {\n                                             if(servertype=='COMFY'){\n                                                SDConfig.configList[1].generalConfig.url = serverurl;\n                                             }\n                                             if(servertype=='Gyre'){\n                                                SDConfig.configList[0].generalConfig.url = serverurl;\n                                             }\n\n                                             servertype = e.target.value;\n\n                                             if(servertype=='COMFY'){\n                                                serverurl =   SDConfig.configList[1].generalConfig.url;\n                                             }\n                                             if(servertype=='Gyre'){\n                                                serverurl =   SDConfig.configList[0].generalConfig.url;\n                                             }\n                                        }}\n                                            style=\"width:140px;display:inline-block\"\n                                    >\n                                        {#each ['Gyre','COMFY'] as config}\n                                            {#if config}\n                                                <option selected={config  === servertype ? 'selected' : undefined}\n                                                        value={config}\n                                                >{config}</option\n                                                >\n                                            {/if}\n                                        {/each}\n                                    </select>\n                                </div>\n\n\n\n                                <div class=\"formLine\">\n                                    {#if servertype=='Gyre'}\n                                        <label for=\"serverURL\">URL Gyre Server</label>\n                                    {:else}\n                                        <label for=\"serverURL\">URL Comfy Server</label>\n                                    {/if}\n\n                                    <div style=\"display:flex;  flex-flow: wrap; gap:10px;\">\n\n                                        <input lang=\"en\" type=\"text\" id=\"serverURL\" placeholder=\"Server URL\" class=\"formInput\"\n                                            style=\"flex-grow:1\"\n                                            bind:value={serverurl}\n                                            on:change={() => {serverurl = serverurl.replace(/\\/$/, \"\")}}\n                                        >\n                                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                        <fds-image-editor-button on:click={() => {onPremise=false }} type=\"button\"\n                                           >Gyre Cloud</fds-image-editor-button>                                                \n                                    </div>\n                                </div>\n\n\n\n                                <div class=\"formLine\"><label for=\"token\">Token (optional)</label>\n                                    <input lang=\"en\" id=\"token\" type=\"password\" placeholder=\"Token\" class=\"formInput\"\n                                        style=\"width:100%\"\n                                        bind:value={bearer}>\n                                </div><div >\n                                    {#if serverIsAvailable}\n                                                                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                                                        <fds-image-editor-button on:click={setServerToken}  type=\"button\"\n                                                                        ><div  style=\"width:100px;text-align:center\">Ok</div></fds-image-editor-button>   \n                                    {:else}\n                                    Server not available\n                                    {/if}                                   \n                                    </div>                                              \n                            {:else}\n                                <div class=\"formLine\"><label for=\"token\" >Gyre Cloud Token</label>\n                                <div style=\"display:flex;  flex-flow: wrap; gap:10px;                               \">\n                                              <input lang=\"en\" type=\"password\" placeholder=\"Token\" id=\"token\" class=\"formInput\"\n                                        style=\" flex-grow: 1;\"\n                                        bind:value={bearer}>\n                                        <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                        <fds-image-editor-button on:click={() => {onPremise=true }} type=\"button\"\n                                        style=\" \">On Premise</fds-image-editor-button>    \n                                        <div style=\"display:flex;  width:100%;\">\n                                        {#if serverIsAvailable}\n                                           <!-- svelte-ignore a11y-click-events-have-key-events -->\n                                            <fds-image-editor-button on:click={setServerToken}  type=\"button\"  state=\"active\"\n                                            ><div  style=\"width:100px;text-align:center\">Ok</div></fds-image-editor-button>   \n                                        {:else}\n                                        Input a valid token for access\n                                        {/if}\n                                        </div>\n                                    </div>                  \n                       \n                                </div>\n                              \n                            {/if}\n                           \n\n                                <!-- svelte-ignore a11y-missing-attribute -->\n                         <!--    <iframe id=\"frame\" class=\"statusIframe\"\n                                     src=\"{serverstatusurl}\"\n                                     frameborder=\"1\">\n                            </iframe>\n                            <a href=\"{serverstatusurl}\" target=\"_blank\" class=\"statusLink\">Server Status</a>\n\n                            --> \n                            </div>\n                        </span>\n        {/if}\n    </fds-image-editor-dialog>\n\n    <fds-posenet-select\n            {posedowloaded}\n            onclosed={() => {\n                posenetselectoropen = false\n            }}\n            open={posenetselectoropen}\n    />\n\n    <fds-search-models-3d\n            {glbbinarydowloaded}\n            onclosed={() => {\n                search3dopen = false\n            }}\n            open={search3dopen}\n    />\n    <fds-search-models-3d\n            {glbbinarydowloaded}\n            type=\"primitives\"\n            onclosed={() => {\n                scene3DGetPrimitive = false\n            }}\n            open={scene3DGetPrimitive}\n    />\n    {#if selectModifier}\n        <fds-presets-dialog\n                onlyexternalmodifiers=\"true\"\n                {reopendialogevent}\n                on:select={modifierSelected}\n        />\n    {/if}\n</div>\n{/if}\n<style>\n    .startScreen {\n        touch-action: none;\n\n    }\n    label {\n        display: block;\n        margin-bottom: 10px;\n    }\n    .statusIframe {\n        width: 800px;\n        min-height: 300px;\n        position: fixed;\n        bottom: 20px;\n        left: calc(50% - 400px);\n    }\n\n    .statusLink {\n        display: none;\n        width: 100px;\n        bottom: 20px;\n        position: fixed;\n        display: block;\n        left: calc(50% - 50px);\n    }\n\n    @media only screen and (max-height: 800px) {\n        .statusIframe {\n            display: none;\n        }\n\n        .statusLink {\n            display: block;\n        }\n\n    }\n\n    .ok {\n        width: 300px;\n    }\n\n    .formLine {\n        margin-bottom: 10px;\n    }\n\n    .form {\n        margin-bottom: 20px;\n        font-size: 14px;\n    }\n\n    a {\n        text-decoration: none;\n        color: white;\n    }\n\n\n\n\n    .box {\n        box-shadow: 0 0 20px 0 #333;\n        background-color: rgba(255, 255, 255, 0.2);\n        flex: 1 0 auto;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: var(--text-color);\n    }\n\n    .box:hover {\n        background-color: var(--btn-selected-bgcolor);\n        color: var(--btn-selected-text-color);\n        transition: all .4s ease-in-out;\n    }\n\n\n\n\n    * {\n            box-sizing: border-box;\n        }\n   .logo {\n    height: 40px; \n    vertical-align: middle;\n   }\n  .topLogo {\n    line-height:40px;\n    font-size: 18px;;\n  }\n    .formInput {\n        width: 100px;\n        outline: 0;\n        border: 0;\n        border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n        font-size: 14px;\n        padding: 5px;\n        font-weight: normal;\n        border-radius: 3px;\n        color: rgba(255, 255, 255, 0.9);\n        margin-bottom: 10px;\n        display: block;\n        box-sizing: border-box;\n    }\n\n    .formInput::placeholder {\n        font-weight: normal;\n        opacity: 0.5;\n        color: rgba(255, 255, 255, 0.7);\n    }\n\n\n.topMenu {\n    font-size: 16px;\n    background-color: var(--stage-color);\n    width: 100vw;\n    height: 50px;\n    display: flex;\n    justify-content: space-between;\n    position: fixed;\n    top: 0px;\n    left: 0;\n    padding: 0 15px 0 10px;\n    background-color: rgba(.29,.29,.29,0.5);\n    backdrop-filter: blur(10px);\n}\n.topBlack {\n    height:20px;\n    width: 100vw;        \n    background-color: var(--stage-color);\n    position: fixed;\n    top: 0;\n    left: 0;    \n}\n.rightMenu {\n    line-height:50px;\n    display:flex;\n    width: 540px;\n    gap: 20px;    \n}\n.rightMenu div {\n    cursor: pointer;\n}\n.rightMenu div:hover {\n    color: var(--btn-selected-bgcolor);\n}\n.rightMenu .active {\n    color: var(--btn-selected2-bgcolor);\n}\n.rightMenu .new {\n    line-height: 45px;\n    font-size: 35px;\n}\n.content {\n        padding-left:40px;\n        padding-right: 40px;\n        padding-top: 100px;\n/*        background-color: #323232; */\n        height: 100vh;\n        background: url(appdata/gyreback.png);\n        background-size: cover;\n    }\n.contentDark {\n    transition: all ease 0.3s;\n    background-color: #1d1d1d;\n\n}\n\n    .red {\n        color:red;\n    }\n\n/**\nrepeating items\n*/\n.flexrow {\n        gap: 10px;\n        display: flex;\n        flex-direction: row;\n        justify-content: center;\n        align-items: stretch;\n        text-align: center;\n        cursor: pointer;\n        padding-top: 5px;\n        padding-bottom: 5px;\n        height: 100px;\n        margin-bottom: 10px;\n    }\n    .square {\n        height: 150px;\n    }\n.imageel {\n        position: relative;\n    }\n    .imageel .result {\n        opacity: 0;\n        position: absolute;\n        left: 0;\n        top: 0;\n    }\n    .imageel:hover .result {\n        transition: all ease 0.6s;\n        opacity: 1;\n    }\n\n    .repeater {\n        display: flex;\n        flex-direction: row;\n        flex-wrap: wrap;\n        margin-left: auto;\n        margin-right: auto;\n    }\n\n    .repeater-item {\n        display: flex;\n        flex-direction: column;\n        /*color: black;*/\n        margin: 20px;\n\n        cursor: pointer;\n    }\n    .name {\n        overflow: hidden;\n        margin-bottom: 5px;\n        width: 150px;\n        display: flex;\n        font-size: 14px;\n    }\n    .imageelins {\n        width: 150px;\n    }\n    .play {\n        position: absolute;\n        left: 55px;\n        bottom: 5px;\n        font-size: 40px;\n        color: black;\n    }\n    .imageel .play::after {\n        font-family: 'Inter', sans-serif;\n        content: '';\n    }\n    .imageel:hover .play::after {\n        font-family: 'Inter', sans-serif;\n        content: '';\n    }\n.intro {\n        text-align: left;\n        padding-left:20px;\n    }\n\n    /** Wizard */\n    .wizard {\n        width: fit-content;\n        min-width: 800px;     \n        background-color: #1d1d1d;    \n        padding: 20px;\n        border-radius: 10px;       \n        background-color: rgba(.29,.29,.29,0.5);\n        backdrop-filter: blur(10px);\n        position: fixed;\n        left:50%;\n        transform: translate(-50%);\n    }\n    .wizardDescription {\n        margin-top:10px;\n        margin-bottom: 50px;\n        text-align: center;\n        font-size: 16px;\n    }\n    .wizardSteps {\n        margin-bottom: 10px;;\n\n    }\n\n    .wizardStepContent {\n        margin-top:10px;\n        margin-left:auto;\n        margin-right:auto;\n        height: 200px;\n        display: grid;\n        place-items: center;\n        align-content: center;        \n    }    \n\n    .wizardColumns {\n        display: flex;\n    }\n    .wizard .left {\n        flex: 1;\n    }\n    .wizard .right {\n        width: 200px;\n        padding: 10px;\n        margin-top:250px;\n    }\n    .wizard .centerButton  {\n    width: fit-content;\n    }\n    .wizard .navigate {\n        text-align:right;\n    }\n    .wizard .firstStep {\n        opacity: 0.2;\n    }\n    .wizard .textInput {\n        width:200px;\n        height:80px;\n        text-transform: uppercase;\n        text-align: center;\n        font-size: 20px;  \n        resize: none;     \n        border-radius: 5px; \n        padding: 5px;\n    }\n    .wizard .promptInput {\n        width:350px;\n        font-size: 16px;\n        padding: 5px;\n        border-radius: 5px;\n        border: 1px solid grey;        \n    }    \n    .wizard .fontSelect {\n        background-color: white;\n        font-size: 30px;\n        padding: 10px;    \n        color: black;\n        cursor: pointer;\n        border-radius: 5px;        \n    }\n    .wizard .fontSelect div:hover {\n        color: white;\n        background-color: black;\n    }\n    .containerOutpainting {\n        position: relative;\n    margin-top: 20px;\n    }\n    .containerOutpainting .arrow {\n    position: absolute;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 50px; /* Adjust arrow container size if needed */\n    height: 50px; /* Adjust arrow container size if needed */\n    border-radius: 50%;\n    font-size: 50px;\n    cursor:pointer;\n}\n.containerOutpainting .selected {\n    color: var(--theme-btn-selected2-bgcolor);\n}\n.containerOutpainting .arrow:hover {\n    color: var(--theme-btn-selected-bgcolor);\n}\n.containerOutpainting .center-image {\n    max-width: 150px;\n    max-height: 150px;\n    display: block;\n    width: auto;\n  height: auto;\n\n\n}    \n.containerOutpainting   .top {\n    top: -50px; /* Half of the arrow container height */\n    left: 50%;\n    transform: translateX(-50%);\n}\n\n.containerOutpainting .bottom {\n    bottom: -50px; /* Half of the arrow container height */\n    left: 50%;\n    transform: translateX(-50%);\n}\n\n.containerOutpainting .left {\n    left: -50px; /* Half of the arrow container width */\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.containerOutpainting .rightArrow {\n    right: -50px; /* Half of the arrow container width */\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.fadeOut {\n    transition: all ease 0.3s;\n    opacity: 0.0;\n}\n\n.stack {\n    transition: all ease 0.8s;\n\n}\n.stackPos {\n    right:var(--fromX);\n    top:var(--fromY);\n}\n.stackTop {\n    transition: all ease 0.8s;\n    right:50px;\n    top:var(--toY);\n    zoom: 0.6;\n}\n.stackTopFadeOut {\n    transition: all ease 0.8s;\n    opacity:0.0\n}\n</style>\n\n","<svelte:options tag=\"fds-wizard-steps\"></svelte:options>\n\n<script>\nexport let steps=[]\nexport let current=0\nlet liWidth=\"25%\"\n$: {\n    if (steps) {\n        liWidth=100/steps.length+\"%\"\n    }\n}\n</script>\n<ol>\n    {#each steps as step,i}\n    <li class:current={current===i} style=\"width:{liWidth}\">{step.text}</li>\n    {/each}\n  </ol>\n<style>\n            * {\n            box-sizing: border-box;\n        }\nbody {\n  font-family: monospace;\n  margin: 2em 1em;\n}\nol {\n  position: relative;\n  overflow: hidden;\n  counter-reset: wizard;\n  list-style-type: none;\n}\n\nli {\n  position: relative;\n  float: left;\n  text-align: center;\n  color: #ddb74f;\n}\n\n.current ~ li {\n  color: #ebebeb;\n}\nli::marker {\n  content: '';\n}\n\nli:before {\n  counter-increment: wizard;\n  content: counter(wizard);\n  display: block;\n  color: black;\n  background-color: #ddb74f;\n  border: 2px solid #ddb74f;\n  text-align: center;\n  width: 2em;\n  height: 2em;\n  line-height: 2em;\n  border-radius: 2em;\n  position: relative;\n  left: 50%;\n  margin-bottom: 1em;\n  margin-left: -1em;\n  z-index: 1;\n  transition: all ease 0.6s;\n}\n.current ~ li:before {\n  background-color: #323232;\n  color: #ebebeb;\n  border-color: #555;\n}\n\nli + li:after {\n  content: \"\";\n  display: block;\n  width: 100%;\n  background-color: #ddb74f;\n  height: 2px;\n  position: absolute;\n  left: -50%;\n  top: 1em;\n  z-index: 0;\n  transition: all ease 0.6s;\n}\n\n.current ~ li:after {\n  background-color: #555;\n}\n\n</style>","<svelte:options tag=\"fds-layer-stack-3d\"></svelte:options>\n\n<script>\nexport let layers=[]\nexport let state=\"3d\"\n\n</script>\n<div class=\"layer-container stacked-top\">\n  {#if layers.length===0}\n  <div class=\"layer bottom-layer \" class:bottom-layer-flat={state===\"flat\"} style=\"background: url(/appdata/checker_thumb.png)\"></div>\n  {/if}\n  {#if layers.length===1}\n  <div class=\"layer bottom-layer \"  class:bottom-layer-flat={state===\"flat\"} style=\"background-image: url({layers[0]});\"></div>\n  {/if}  \n  {#if layers.length===2}\n  <div class=\"layer mid-layer \"  class:mid-layer-flat={state===\"flat\"} style=\"background-image: url({layers[1]})\"></div>\n  <div class=\"layer bottom-layer \" class:bottom-layer-flat={state===\"flat\"} style=\"background-image: url({layers[0]})\"></div>\n  {/if}  \n\n  <!-- \n  <div class=\"layer mid-layer light-blue-layer\"></div>\n  <div class=\"layer top-layer white-layer\"></div>\n  -->\n</div>\n<style>\n            * {\n            box-sizing: border-box;\n        }\n\n.layer-container {\n    width: 100px;\n    height: 100px;\n    top: 50%;\n    left: 50%;\n    perspective: 1350px;\n   transform-style: preserve-3d;\n\n}\n\n.layer {\n  background-size: cover;\n  background-position: center;\n    width: 100px;\n    height: 100px;\n    position: absolute;\n    transition: all 0.6s ease-in-out;\n    cursor: pointer;\n    z-index: 1;\n    border-radius: 10px;\n  box-shadow:\n    1px 1px 0 1px #f9f9fb,\n    -1px 0 28px 0 rgba(34, 33, 81, 0.01),\n    28px 28px 28px 0 rgba(34, 33, 81, 0.85);  \n}\n\n\n\n.bottom-layer {\n    transform: rotateX(45deg) rotateZ(45deg) translateZ(50px);\n}\n.bottom-layer:hover, .bottom-layer-flat {\n      transform: translate3d(0px, 50px, 50px);\n\n}\n.mid-layer {\n    transform: rotateX(45deg) rotateZ(45deg) translateZ(100px);\n}\n.mid-layer:hover, .mid-layer-flat  {\n      transform: translate3d(0px, -100px, 50px);\n\n}\n.top-layer {\n    transform: rotateX(45deg) rotateZ(45deg) translateZ(150px);\n}\n\n\n</style>","export default class Config {\n    parameters = {\n        prompt: \"\",\n        steps: 0,\n        seed: 0,\n        num: 0,\n        sampling_method: \"LMS\",\n        seedList: [\"\", \"\", \"\", \"\"],\n        imageDialog: null,\n        regenerate: false,\n        image64: \"\",\n        maskImage64: \"\",\n        inpaint_mask_blur: \"4\",\n        inpaint_mask_content: \"latent noise\",\n        mode: \"txt2img\",\n        strength: \"1\"\n    }\n\n\n\n    generalConfig = {    \n        url: \"\",\n        tokenid: \"\",\n        token: \"\",\n        name: \"local\",\n        type: \"Colab\",\n        inpaint_mask_blur: \"4\",\n        inpaint_mask_content: \"latent noise\",\n        width: '1024',\n        height: '1024',\n        m1fix: false,\n        allVisible:true,\n        dlgData: {\n            \"mode\": \"txt2img\",\n            \"prompt\": \"\",\n            \"seed\": \"\",\n            \"steps\": \"15\",\n            \"steps_update\": \"50\",\n            \"num\": \"2\",\n            \"modifiers\": \"highly detailed\",\n            \"cfg_value\": \"7.5\",\n            \"strength\": \".75\",\n            \"sampling_method\": \"LMS\",\n            \"previewMode\": \"\"\n        }\n    }\n    globalData={\n        prompt:\"\",\n        modifiers:\"\",\n        appRegisteredhash:\"\",\n        dateRegistered:\"\",\n        fingerprint:\"\"\n    }\n    ModifierData = {\n        list: [],\n        tags: []\n    }\n    configList = []\n    currentConfigNum = 0\n\n\n    getDefault(type) {\n        let SDConfig\n        let parameters\n        if (type === \"SDGRPC\") {\n            SDConfig = {\n                inpainting_original:true,\n                url: \"\",\n                tokenid: \"\",\n                token:\"\",\n                name: \"Gyre\",\n                type: \"SDGRPC\",\n                width: '1024',\n                height: '1024',\n                m1fix: false,\n                allVisible:true,\n                dlgData: {\n                    \"mode\": \"txt2img\",\n                    \"prompt\": \"\",\n                    \"seed\": \"\",\n                    \"steps\": \"15\",\n                    \"steps_update\": \"20\",\n                    \"num\": \"2\",\n                    \"modifiers\": \"highly detailed\",\n                    \"cfg_value\": \"7.5\",\n                    \"strength\": \".75\",\n                    \"sampling_method\": \"DPMSolver++ 2M (Fast)\"\n                }\n            }\n            parameters = {\n                prompt: \"\",\n                steps: 0,\n                seed: 0,\n                num: 0,\n                sampling_method: \"LMS\",\n                seedList: [\"\", \"\", \"\", \"\"],\n                imageDialog: null,\n                regenerate: false,\n                image64: \"\",\n                maskImage64: \"\",\n                inpaint_mask_blur: \"4\",\n                inpaint_mask_content: \"latent noise\",\n                mode: \"txt2img\",\n                strength: \"1\"\n            }\n            return { generalConfig: SDConfig, parameters: parameters }\n        }\n        if (type === \"COMFY\") {\n            SDConfig = {\n                inpainting_original:false,\n                url: \"\",\n                tokenid: \"\",\n                token:\"\",\n                name: \"COMFY\",\n                type: \"COMFY\",\n                width: '1024',\n                height: '1024',\n                m1fix: false,\n                allVisible:true,\n                dlgData: {\n                    \"mode\": \"txt2img\",\n                    \"prompt\": \"\",\n                    \"seed\": \"\",\n                    \"steps\": \"15\",\n                    \"steps_update\": \"20\",\n                    \"num\": \"1\",\n                    \"modifiers\": \"highly detailed\",\n                    \"cfg_value\": \"7.5\",\n                    \"strength\": \".75\",\n                    \"sampling_method\": \"DPMSolver++ 2M (Fast)\"\n                }\n            }\n\n            parameters = {\n                prompt: \"\",\n                steps: 0,\n                seed: 0,\n                num: 0,\n                sampling_method: \"LMS\",\n                seedList: [\"\", \"\", \"\", \"\"],\n                imageDialog: null,\n                regenerate: false,\n                image64: \"\",\n                maskImage64: \"\",\n                inpaint_mask_blur: \"4\",\n                inpaint_mask_content: \"latent noise\",\n                mode: \"txt2img\",\n                strength: \"1\"\n            }\n            return { generalConfig: SDConfig, parameters: parameters }\n        }\n\n\n\n\n    }\n    constructor() {\n    //    this.load()\n    }\n    async saveToken(tokenid,token) {\n        if (!token) token=\"\";\n        window.localStorage.setItem(tokenid, token);\n    }\n\n    async loadToken(tokenid) {\n        if (!tokenid) return;\n\n        let result = window.localStorage.getItem(tokenid);\n        return result || \"\";\n    }\n    async updateGlobalData(globalData) {\n        await this.load()\n        this.globalData=globalData\n        await this.save()\n    }\n\n    async save() {\n        let configListClone =  JSON.parse( JSON.stringify(this.configList));\n//        configListClone.forEach((el)=>{   \n  //          el.generalConfig.token = \"\";\n    //    })\n\n        let saveObj = { configList: configListClone, currentConfigNum: this.currentConfigNum, ModifierData: this.ModifierData,globalData: this.globalData }\n        let all = JSON.stringify(saveObj)\n        await window.localStorage.setItem(\"config\", all)\n    }\n    async load() {\n\n        let allconfStr = await localStorage.getItem(\"config\")\n        if (!allconfStr) console.log(\"no config\")\n        if (allconfStr) {\n            let allconf = JSON.parse(allconfStr)\n            this.configList = allconf.configList\n            if (allconf.ModifierData) this.ModifierData = allconf.ModifierData\n            if (allconf.globalData) this.globalData = allconf.globalData\n            this.currentConfigNum = allconf.currentConfigNum\n\n            await this.get()\n\n        }\n        return null  \n    }\n    async add(configType) {\n        let d = this.getDefault(configType)\n        this.configList.push(d)\n        this.currentConfigNum = this.configList.length - 1\n        await this.get()\n        await this.save()\n    }\n    async switch(num) {\n        await this.load()\n        this.currentConfigNum = num\n        await this.save()\n        await this.get()\n        return this\n    }\n\n\n\n    async set() {\n        let obj = JSON.parse( JSON.stringify({ generalConfig: this.generalConfig, parameters: this.parameters }))\n        if (!obj.generalConfig.tokenid){\n            this.generalConfig.tokenid =  obj.generalConfig.tokenid =  (Math.random() + 1).toString(36).substring(2);\n        }\n        if (this.generalConfig.tokenid && this.generalConfig.tokenid.length) {\n            try {\n               await this.saveToken(this.generalConfig.tokenid,this.generalConfig.token)\n            } catch (e) {\n            }\n        }               \n        this.configList[this.currentConfigNum] = obj\n      //  console.log(this.configList,this.generalConfig)\n        if (this.generalConfig.dlgData) {\n            this.globalData.prompt=this.generalConfig.dlgData.prompt\n            this.globalData.modifiers=this.generalConfig.dlgData.modifiers\n        }\n        await this.save()\n    }\n    async get() {\n        let conf = this.configList[this.currentConfigNum]\n        if (!conf) return\n\n        this.generalConfig = conf.generalConfig\n        if (this.generalConfig.tokenid && this.generalConfig.tokenid.length) {\n            try {\n                this.generalConfig.token = await this.loadToken(this.generalConfig.tokenid)\n            } catch (e) {\n            }\n        }\n        if (this.generalConfig.dlgData && this.globalData && this.globalData.prompt) {\n            this.generalConfig.dlgData.prompt=this.globalData.prompt\n            this.generalConfig.dlgData.modifiers=this.globalData.modifiers\n        }\n        this.parameters = conf.parameters        \n    }\n    async delete() {\n        this.configList.splice(this.currentConfigNum,1)\n        this.currentConfigNum=0\n     //   console.log(this.configList)\n        await this.get()\n        await this.save()\n    }\n}","\nexport class mappingsHelper {\n\n    getDefaultFields() {\n               \n        return [{name:\"mergedImage\",type:\"image\",notInRuleEditor:true},{name:\"mask\",type:\"image\",notInRuleEditor:true},{name:\"hasMask\",type:\"boolean\" },{name:\"hasInitImage\",type:\"boolean\" },{name:\"prompt\"},{name:\"negativePrompt\"}\n        ,{name:\"document_width\",type:\"number\"},{name:\"document_height\",type:\"number\"},\n        {name:\"controlnet[].type\"},{name:\"controlnet[].image\",type:\"image\",notInRuleEditor:true},{name:\"controlnet[].strength\"},{name:\"controlnet[].start_percent\"},{name:\"controlnet[].end_percent\"},{name:\"controlnet[].model\"}]\n    }\n/**\n     * get list of fields which can be used for widget mappings of each ComfyUI node:\n     * fields: the form fields, defined by user\n     * defaultFields: the fields whoch are usually available \n     * outputFields: the output fields, like an image or multiple images\n     */\n    getMappingFields(metadata) {\n        let fields= []\n        if (metadata.forms && metadata.forms.default && metadata.forms.default.elements) fields=metadata.forms.default.elements\n        let defaultFields=this.getDefaultFields()\n        let outputFields=[{name:\"resultImage\"}]\n        let res= {fields:JSON.parse(JSON.stringify(fields)),defaultFields,outputFields}\n        for(let i=0;i<fields.length;i++) {\n            let field=fields[i]\n            if (field.split_value_num && field.split_value_type) {\n                for(let k=0;k<field.split_value_num;k++) {\n                    let newField={name:field.name+\"_\"+k,type:field.split_value_type,originalName:field.name,index:k}    // add new fields with underscore\n                    res.fields.push(newField)\n                }\n            }            \n            if (field.type===\"drop_layers\") {\n                if (field.num_layers===1) continue  // only one image\n                for(let k=0;k<field.num_layers;k++) {\n                    let newField={name:field.name+\"_\"+k,type:field.type,originalName:field.name,index:k}    // add new fields with underscore\n                    res.fields.push(newField)\n                }\n            }\n        }\n        return res\n    }\n}","import { mappingsHelper } from './mappingsHelper.js'\n\n\nexport class rulesExecution {\n    constructor() {\n        this.defaultFields=new mappingsHelper().getDefaultFields()\n\n    }\n    /**\n     * @param {string} fieldName \n     * @param {array} fieldList \n     * @returns {object} the field object\n     */\n    getField(fieldName,fieldList) {\n        if (!fieldList) return\n        for(let i=0;i<fieldList.length;i++) {\n            let field=fieldList[i]\n            if (field.name===fieldName) return field\n        }\n        for(let i=0;i<this.defaultFields.length;i++) {\n            let field=this.defaultFields[i]\n            if (field.name===fieldName) return field\n        }        \n    }\n    checkArray(fieldName) {\n        return fieldName.includes(\"[]\")\n    }\n    getArrayName(fieldName) {\n        if (!this.checkArray(fieldName)) return\n        return fieldName.split(\"[\")[0]  // e.g. controlnet\n    }    \n    // type conversion based on field type\n    convertValue(value,field) {\n        if (!field) return \"\"\n        if (field.type===\"checkbox\" || field.type===\"boolean\") {\n            if (value===\"true\") return true\n            if (value===\"false\") return false\n        }\n        if (field.type===\"slider\" || field.type===\"number\") {\n            console.log(\"convertValue\",field)\n            if (this.isFloat(field.step)) {\n                return parseFloat(value)\n            }\n            console.log(\"isInteger\")\n            return parseInt(value)\n\n        }\n        return value\n    }\n    /**\n     * gets value from custim fields and default fields\n     * @param {object} data the data object \n     * @param {string} fieldName the field name including array name\n     * @param {array} fieldList all custom fields\n     * @param {object} arrayIdx array index for each array (e.g. controlnet: 0)\n     * @returns {*}  the value\n     */\n    getValue(data,fieldName,fieldList,arrayIdx) {\n        let field=this.getField(fieldName,fieldList)\n        if (!this.checkArray(fieldName)) {\n            let value= data[fieldName]\n            return this.convertValue(value,field)\n        }\n        let arrayName= fieldName.split(\"[\")[0]  // e.g. controlnet\n        let propertyName= fieldName.split(\".\")[1]  // e.g. image\n        let i=arrayIdx[arrayName]\n        if (!data[arrayName]) throw 'array_not_found ' + arrayName\n        if (!data[arrayName][i]) throw 'index_in_array_not_found ' + arrayName + ' ' + i\n\n        let value= data[arrayName][i][propertyName]\n        return  this.convertValue(value,field)\n    }\n\n    setValue(data,value,fieldName,fieldList,arrayIdx) {\n        let field=this.getField(fieldName,fieldList)\n        if (!this.checkArray(fieldName)) {\n            data[fieldName]= this.convertValue(value,field)\n            return\n        }       \n        let arrayName= fieldName.split(\"[\")[0]  // e.g. controlnet\n        let propertyName= fieldName.split(\".\")[1]  // e.g. image\n        let i=arrayIdx[arrayName]\n        value=this.convertValue(value,field)\n        data[arrayName][i][propertyName]=value\n\n    }\n    \n    isFloat(value) {\n        if (typeof value !== 'number' || isNaN(value)) {\n          return false; // It's not a number or is NaN (Not a Number)\n        }        \n        return value % 1 !== 0; // If there's a decimal part, it's a float\n      } \n    /**\n     * execute rules on real data\n     * @param {object} data the form data \n     * @param {array} fieldList the list of field definitions\n     * @param {array} rules the rules list\n     * @param {object} arrayIdx array index for each array (e.g. controlnet: 0)\n     * @param {string} arrayName optional: limit rules execution to that array only\n     * @returns {object} {data,hiddenFields}  data and list of hidden fields\n     */\n    execute(data,fieldList,rules,arrayIdx={},arrayName=\"\") {\n        if (!rules) rules=[]\n        if (!data) return {data,hiddenFields:{}}\n        let hiddenFields=[]\n        let showFields=[]\n        for(let i=0;i<rules.length;i++) {\n            // { fieldName, condition, actionType, rightValue, targetField, actionValue }\n            let rule=rules[i]\n            let field=this.getField(rule.fieldName,fieldList)\n            if (arrayName===\"__ignore_arrays\" &&  this.checkArray(field.name)) continue \n            let leftValue\n            try {\n                leftValue = this.getValue(data, rule.fieldName, fieldList, arrayIdx)\n            } catch (e) {\n                // value cannot read here because not available in data object\n                continue\n            }\n\n            let rightValue=rule.rightValue\n            if (!field) {\n                console.error(\"rule execution field not found:\",rule.fieldName)\n                continue\n            }\n            if (arrayName && arrayName!==\"__ignore_arrays\" && !this.checkArray(field.name)) continue  // array mode, but field is not an array\n            if (arrayName && arrayName!==\"__ignore_arrays\" &&  this.getArrayName(field.name)!==arrayName) continue    // other arrays ignore\n            rightValue=this.convertValue(rightValue,field)\n            leftValue=this.convertValue(leftValue,field)\n\n            let res=false\n            switch (rule.condition) {   // ['==', '!=', '>', '<', '>=', '<=']\n                case \"===\":\n                case \"==\":\n                    if (leftValue===rightValue) res=true\n                    break\n                case \"!=\":\n                case \"!==\":\n                    if (leftValue!==rightValue) res=true\n                    break                    \n                case \">\":\n                    if (leftValue>rightValue) res=true\n                    break  \n                case \"<=\":\n                    if (leftValue<=rightValue) res=true\n                    break                             \n                case \">=\":\n                    if (leftValue>=rightValue) res=true\n                    break \n                case \"<\":\n                    if (leftValue<rightValue) res=true\n                    break \n\n            }\n            console.log(\"executed:\",leftValue,rule.condition,rightValue,res)\n            if (!res) continue // rule will be not executed because condition is false\n\n            let targetFieldName\n            let targetField\n            if (rule.targetField) {\n                targetFieldName=rule.targetField\n                targetField=this.getField(targetFieldName,fieldList)\n                if (!targetField) {\n                    console.error(\"rule execution target field not found:\",targetFieldName)\n                    continue                    \n                }                  \n            }\n          \n            if (rule.actionType===\"setValue\") {\n                let value=rule.actionValue\n                this.setValue(data,value,targetFieldName,fieldList,arrayIdx)\n            }\n            if (rule.actionType===\"hideField\") {\n                hiddenFields.push(rule.targetField)        \n                targetField.hideIt=true  \n                targetField.showIt=false         \n\n            }\n            if (rule.actionType===\"showField\") {\n                showFields.push(rule.targetField) \n                targetField.showIt=true         \n                targetField.hideIt=false  \n            }  \n            if (rule.actionType===\"copyValue\") {\n                let fromFieldName=rule.actionValue\n                let fromField=this.getField(rule.actionValue,fieldList)\n                if (!fromField) {\n                    console.error(\"rule execution from field not found:\",fromFieldName)\n                    continue                    \n                }\n                let value=this.getValue(data,fromFieldName,fieldList,arrayIdx)\n                this.setValue(data,value,targetFieldName,fieldList,arrayIdx)\n            }\n            if (rule.actionType === 'copyParameter') {\n                let fromFieldName = rule.actionValue\n                let fromField = this.getField(rule.actionValue, fieldList)\n                if (!fromField) {\n                    console.error('rule execution from field not found:', fromFieldName)\n                    continue\n                }\n                let value = this.getValue(data, fromFieldName, fieldList, arrayIdx)\n                let field = this.getField(targetFieldName, fieldList)\n                field._force_render = true\n                field[rule.targetParameter] = value\n            }            \n\n        }        \n        return {data,hiddenFields}\n    }\n\n}","export class loopPreparser {\n\n  constructor(workflow) {\n    this.workflow = workflow\n    this.nodeMapping = {}\n  }\n\n  getGroup(node, groups) {\n    return groups.find(group => {\n      const [gx, gy, gWidth, gHeight] = group.bounding;\n      let  nx, ny;\n      nx = node.pos[0];\n      ny = node.pos[1];\n      return nx >= gx && nx <= gx + gWidth && ny >= gy && ny <= gy + gHeight;\n    });\n  }\n  getNodeById(nodeId) {\n    return this.workflow.nodes.find(node => node.id === nodeId)\n  }\n  getGroupByName(groupName) {\n    return this.workflow.groups.find(group => group.title === groupName)\n  }\n  isNodeInGroup(nodeId, groupName) {\n    const node = this.workflow.nodes.find(n => n.id === nodeId);\n    if (!node) return false; // Node not found\n\n    const group = this.workflow.groups.find(group => group.title === groupName && group.bounding);\n    if (!group) return false; // Group not found\n\n    const [gx, gy, gWidth, gHeight] = group.bounding;\n\n    let  nx, ny;\n    nx = node.pos[0];\n    ny = node.pos[1];\n    return nx >= gx && nx <= gx + gWidth && ny >= gy && ny <= gy + gHeight;\n  }\n  /**\n   * link data structures are redudant in ComfyUI so re-generate link infos from global linkk structure\n   */\n  updateNodeLinks() {\n    // Step 1: Clear existing link IDs from inputs and outputs\n    this.workflow.nodes.forEach(node => {\n      if (node.inputs) {\n        node.inputs.forEach(input => {\n          input.link = null;\n        });\n      }\n      if (node.outputs) {\n        node.outputs.forEach(output => {\n          output.links = [];\n        });\n      }\n    });\n\n    // Step 2: Iterate over links to update inputs and outputs\n    this.workflow.links.forEach(link => {\n      const [linkID, fromNodeID, fromSlot, toNodeID, toSlot, type] = link\n      const fromNode = this.workflow.nodes.find(node => node.id === fromNodeID)\n      const toNode = this.workflow.nodes.find(node => node.id === toNodeID)\n\n      if (fromNode && fromNode.outputs && fromNode.outputs[fromSlot]) {\n        if (!fromNode.outputs[fromSlot].links) {\n          fromNode.outputs[fromSlot].links = []\n        }\n        fromNode.outputs[fromSlot].links.push(linkID)\n      }\n\n      if (toNode && toNode.inputs && toNode.inputs[toSlot]) {\n        toNode.inputs[toSlot].link = linkID\n      }\n    })\n  }\n\n removeGyreNodesAndLinkDirectly() {\n    // Iterate backwards to avoid indexing issues after removal\n    for (let i = this.workflow.nodes.length - 1; i >= 0; i--) {\n      const node = this.workflow.nodes[i];\n      if (node.type === \"GyreLoopStart\" || node.type === \"GyreLoopEnd\") {\n        const outgoingLink = this.workflow.links.find(link => link[1] === node.id);\n        const incomingLink = this.workflow.links.find(link => link[3] === node.id);\n        \n        if (outgoingLink && incomingLink) {\n          // Create a new link replacing the GyreNode\n          const newLink = [this.workflow.last_link_id + 1, incomingLink[1], incomingLink[2], outgoingLink[3], outgoingLink[4], outgoingLink[5]];\n          this.workflow.last_link_id++; // Update last link ID\n          this.workflow.links.push(newLink);\n          // Remove the original links\n          this.workflow.links = this.workflow.links.filter(link => link[0] !== outgoingLink[0] && link[0] !== incomingLink[0]);\n  \n          // Remove the GyreLoop node\n          this.workflow.nodes.splice(i, 1);\n        }\n      }\n    }\n  }\n  \n\n  /*\n  for the conections between the groups add a GyreLoopStart node in-between so it is easier to make another group \n   */\n  splitLinkWithGyreStartNode(linkID) {\n    const linkIndex = this.workflow.links.findIndex(link => link[0] === linkID)\n    if (linkIndex === -1) return // Link not found\n    const originalLink = this.workflow.links[linkIndex];\n    const [_, fromNodeID, fromSlot, toNodeID, toSlot, type] = originalLink\n  \n    // Assuming workflow.last_node_id and workflow.last_link_id are correctly set\n    const newGyreStartNodeID = ++this.workflow.last_node_id\n    const newLink1ID = ++this.workflow.last_link_id\n    const newLink2ID = ++this.workflow.last_link_id\n  \n    // Create GyreStartNode\n    const gyreStartNode = {\n      id: newGyreStartNodeID,\n      type: 'GyreLoopStart',\n      pos: [0, 0],    // willbe removed anyway\n      inputs:[\n        {\n            \"name\": \"ANY\",\n            \"type\": \"*\",\n            \"link\": 16\n        }\n    ]}\n    this.workflow.nodes.push(gyreStartNode);\n    // Create the first new link from the original source to the GyreStartNode\n    const newLink1 = [newLink1ID, fromNodeID, fromSlot, newGyreStartNodeID, 0 /* Assuming slot 0 for GyreStartNode */, type]\n    // Create the second new link from the GyreStartNode to the original destination\n    const newLink2 = [newLink2ID, newGyreStartNodeID, 0 /* Assuming slot 0 for output */, toNodeID, toSlot, type]  \n    // Add the new links to the workflow\n    this.workflow.links.push(newLink1, newLink2)\n    // Remove the original link\n    this.workflow.links.splice(linkIndex, 1)\n  }\n  /* Gyre loops: reroute end loop link and make new link between groups\n  */\n  adjustLinksForSpecialNodes(groupName) {\n    // 1. reroute to end loop\n    // Assuming `this.nodeMapping` maps original node IDs to their new duplicated IDs\n    const gyreLoopEndNodes = this.workflow.nodes.filter(node => node.type === \"GyreLoopEnd\").map(node => node.id);\n\n    const linksToRemove = []; // Ids only\n    let removedLinks = [];  // store link objects for new links between groups\n    const newLinks = [];\n  \n    this.workflow.links.forEach(link => {\n      const [linkID, fromNodeID, fromSlot, toNodeID, toSlot, type] = link;\n\n      if (gyreLoopEndNodes.includes(toNodeID) && this.isNodeInGroup(fromNodeID, groupName)) {\n        // Mark this link for removal\n        linksToRemove.push(linkID);\n        removedLinks.push([...link]); \n        // Create a new link from the cloned node to the \"GyreLoopEnd\" node\n        const newLink = [this.workflow.last_link_id + 1, this.nodeMapping[fromNodeID], fromSlot, toNodeID, toSlot, type];\n        newLinks.push(newLink);\n        this.workflow.last_link_id++;\n      }\n    });\n\n    // Remove identified links\n    this.workflow.links = this.workflow.links.filter(link => !linksToRemove.includes(link[0]));\n\n    // Add new links\n    this.workflow.links.push(...newLinks)\n\n\n    // For each link removed earlier...\n    // Assuming removedLinks and nodeMapping are already defined\n    // generate connections between groups\n    removedLinks.forEach(removedLink => {\n      const [removedLinkID, fromNodeID, fromSlot, toNodeID, toSlot, type] = removedLink;\n      // Find a link where the toNode is the destination of a link from a \"GyreLoopStart\"\n      let linkFromGyreLoopStart \n      this.workflow.links.forEach(link => {\n        const [_, linkFromNodeID, __, linkToNodeID, slot, linkType] = link;\n        if (this.getNodeById(linkFromNodeID).type===\"GyreLoopStart\" && this.isNodeInGroup(linkToNodeID,groupName)) {\n          if (fromSlot===slot) linkFromGyreLoopStart=link\n        }\n      })\n      if (linkFromGyreLoopStart) {\n        // Assuming you can find the cloned node ID for the node that was linked to by the GyreLoopStart\n        const clonedToNodeID = this.nodeMapping[linkFromGyreLoopStart[3]]; // Use the toNodeID of the linkFromGyreLoopStart for mapping\n        if (clonedToNodeID) {\n          const newLinkID = ++this.workflow.last_link_id;\n          const newLink = [newLinkID, fromNodeID, fromSlot, clonedToNodeID, fromSlot, type] // same slot here, this is current limitation\n    //      console.log(\"new between groups link\",newLink)\n          this.workflow.links.push(newLink)\n          this.splitLinkWithGyreStartNode(newLinkID)\n        }\n      }\n    })\n  }\n\n  duplicateGroupWithNodesAndLinks(groupName,groupNameClone) {\n    // Assuming getGroupByName and isNodeInGroup functions are defined elsewhere\n    const originalGroup = this.getGroupByName(groupName);\n    if (!originalGroup) return; // Exit if group not found\n\n    let maxNodeId = this.workflow.last_node_id;\n    let maxLinkId = this.workflow.last_link_id;\n\n    // Duplicate group\n    const newGroup = JSON.parse(JSON.stringify(originalGroup))\n    newGroup.title = groupNameClone \n    newGroup.bounding[0] += originalGroup.bounding[2]+70 // Shift the new group to prevent overlap\n    this.workflow.groups.push(newGroup);\n\n    this.nodeMapping = {} // Map old node IDs to new node IDs\n\n    // Duplicate nodes\n    this.workflow.nodes.forEach(node => {\n      if (this.isNodeInGroup(node.id, groupName)) {\n        const newNode = JSON.parse(JSON.stringify(node));\n        newNode.id = ++maxNodeId;\n        newNode.pos[0] += originalGroup.bounding[2]+70 // Shift the new group to prevent overlap\n        this.nodeMapping[node.id] = newNode.id; // Map old ID to new ID\n        this.workflow.nodes.push(newNode);\n        console.log(\"add node\", newNode)\n      }\n    });\n\n    this.workflow.links.forEach(link => {\n      const [linkID, fromNodeID, fromSlot, toNodeID, toSlot, type] = link; // Destructure the original link array\n      // Check if both source and target nodes are within the group being duplicated\n      if (this.nodeMapping[fromNodeID] && this.nodeMapping[toNodeID]) {\n        // Create a new link for the duplicated nodes\n        const newLink = [\n          ++maxLinkId, // Assign a new unique ID for the link\n          this.nodeMapping[fromNodeID], // Map old source node ID to new\n          fromSlot, // Preserve the original fromSlot\n          this.nodeMapping[toNodeID], // Map old target node ID to new\n          toSlot, // Preserve the original toSlot\n          type // Preserve the link type\n        ];\n        this.workflow.links.push(newLink); // Add this new link to the workflow\n      }\n    });\n\n    // outside links going inside group nodes duplication\n    this.workflow.links.forEach(link => {\n      const [linkID, fromNodeID, fromSlot, toNodeID, toSlot, type] = link\n      const fromNode = this.workflow.nodes.find(node => node.id === fromNodeID)\n      const toNode = this.workflow.nodes.find(node => node.id === toNodeID)\n\n      // Check if the toNode is inside the group and fromNode is outside and not of specific types\n      if (this.isNodeInGroup(toNodeID, groupName) && !this.isNodeInGroup(fromNodeID, groupName) &&\n        fromNode.type !== 'GyreLoopStart' && fromNode.type !== 'GyreLoopEnd') {\n        // Logic to duplicate the link here\n        const newLinkID = ++maxLinkId; // Increment and assign new max link ID\n        const newLink = [newLinkID, fromNodeID, fromSlot, this.nodeMapping[toNodeID], toSlot, type]\n        this.workflow.links.push(newLink)\n      }\n    })\n    this.workflow.last_link_id = maxLinkId\n    this.workflow.last_node_id = maxNodeId\n  \n    this.adjustLinksForSpecialNodes(groupName)\n    this.cloneMappings(groupName)\n\n  }\n\n  /**\n   * clone mappings\n   * @param string groupName \n   * @returns \n   */\n  cloneMappings(groupName) {\n    let mappings=this.workflow.extra.gyre.mappings\n    if (!mappings) return\n    for (let i = this.workflow.nodes.length - 1; i >= 0; i--) {\n      const node = this.workflow.nodes[i]\n      if (this.isNodeInGroup(node.id,groupName)) {\n        let nodeMappings=mappings[node.id]\n        if (nodeMappings) {\n          let newNodeID=this.nodeMapping[node.id]\n          if (newNodeID) {\n            mappings[newNodeID]=JSON.parse(JSON.stringify(nodeMappings))\n          }\n          \n        }\n      }\n    }\n\n    this.workflow.extra.gyre.mappings=mappings\n  }\n  deactivateGroup(groupName) {\n    for (let i = this.workflow.nodes.length - 1; i >= 0; i--) {\n      const node = this.workflow.nodes[i]\n      if (this.isNodeInGroup(node.id,groupName)) {\n        node.mode=4 // deactivate it\n      }\n    }\n    \n  }\n  generateLoop(arrayName,arraySize) {\n    let group=this.getGroupByName(arrayName+\"[]\")\n    if (!group) return\n    group.title=arrayName+\"[0]\"\n\n    if (arraySize===0) {  // deactivate group nodes\n      this.deactivateGroup(arrayName+\"[0]\")\n      this.removeGyreNodesAndLinkDirectly()    \n      this.updateNodeLinks()\n      return\n    }\n    if (arraySize>1) {  // only rename group and remove loop nodes\n      for(let i=0;i<arraySize-1;i++) {  \n        this.duplicateGroupWithNodesAndLinks(arrayName+\"[\"+i+\"]\",arrayName+\"[\"+(i+1)+\"]\")    \n      }\n    }\n    this.removeGyreNodesAndLinkDirectly()    \n    this.updateNodeLinks()\n  }\n\n}","import { rulesExecution } from './rulesExecution.js'\nimport { loopPreparser } from './loopPreparser.js'\nimport { mappingsHelper } from './mappingsHelper.js'\n\n\nexport class valuePreparser {\n\n    constructor(workflow) {\n      this.workflow = workflow\n      this.loopParser=new loopPreparser(workflow)\n      this.rules=new rulesExecution()\n      if (!workflow.extra.gyre) return\n      this.metadata=workflow.extra.gyre\n      this.fieldList=[]\n      if (this.metadata.forms && this.metadata.forms.default)  {\n        this.fieldList=new mappingsHelper().getMappingFields(this.metadata).fields\n        //this.fieldList=this.metadata.forms.default.elements\n      }\n    }\n\n    getWidgetIndex(nodeId,name) {\n        let nodeWidgets=this.workflow.extra.gyre.nodeWidgets\n        for(let nId in nodeWidgets) {\n            if (parseInt(nId)===nodeId) {\n                let widgets=nodeWidgets[nId]\n                for(let i=0;i<widgets.length;i++) {\n                    let widget=widgets[i]\n                    if (widget.name===name) return i\n                }\n            }\n        }\n        return -1\n    }\n    getLinkById(linkId) {\n        return this.workflow.links.find(linkArr => linkArr[0] === linkId)\n\n    }\n    getNodeById(nodeId) {\n        return this.workflow.nodes.find(node => node.id === nodeId)\n      }\n    /* mergedImage, mask, controlnet[].image\n    */\n    async getImage(propertyName, arrayName=\"\",index=0) {\n        if(window.postMessageAdapter){\n            let instance = window.postMessageAdapter.getWorkflowImageRequestServerInstance();\n            let res = await instance.getSingleImage(propertyName, arrayName,index);\n            return res;\n        }\n        return null;\n    }\n    /**\n     * get layer image\n     * @param {string} layerName , special names: currentLayer, currentLayerAbove, currentLayerBelow\n     * @param {string} layerID , as alternative select layer by ID\n     */\n    async getLayerImage(layerName,layerID) {\n        if(window.postMessageAdapter){\n            let instance = window.postMessageAdapter.getWorkflowImageRequestServerInstance();\n            let res = await instance.getLayerImage(layerName,layerID);\n            return res;\n        }\n        return null;\n    }\n    /**\n     * get file \n     * @param {string} fieldName , the field name in form object\n     */\n    async getFile(fieldName) {\n        if(window.postMessageAdapter){\n            let instance = window.postMessageAdapter.getWorkflowImageRequestServerInstance()\n            let res = await instance.getFile(fieldName)\n            return res\n        }\n        return null        \n    }\n\n    /**\n     * convert value (e.g. boolean) also get images from frontend\n     * @param {*} value \n     * @param {object} field \n     * @param {string} arrayName \n     * @param {number} index \n     * @returns \n     */\n    async convertValue(value,field,arrayName=\"\",index=0) {\n        if (field.type===\"image\") {\n\n                if (!arrayName) {\n                    console.log(\"get image for field\",field.name)\n                    return await this.getImage(field.name)\n                } else {\n                    let propertyName= field.name.split(\".\")[1]  // e.g. image from controlnet[].image\n                    return await this.getImage(propertyName,arrayName,index) // e.g. image,controlnet,0 for controlnet[0].image            \n                }\n        }\n        if (field.type===\"layer_image\") {\n            return await this.getLayerImage(field.name)\n        }\n        if (field.type===\"file\") {\n            return await this.getFile(field.name)\n        }        \n        if (field.type===\"drop_layers\") {\n            let idx=0\n            if (field.originalName) {\n                idx=field.index\n            }\n            let arr=value.split(\",\")\n            let layerID=arr[idx]\n            return await this.getLayerImage(null,layerID)\n        }\n        if(field.type==\"number\" && !field.step && value) field.step=value;\n        return  this.rules.convertValue(value,field)\n    }\n    /**\n     * find all nodes which are connected to a mapping (nodeId, fieldFrom,toField) and set value\n     * @param {object} field the field object {name,type,min,max,...}\n     * @param {string} fromFieldName full name with array name and index (e.g. \"steps\" or \"controlnet[0].model\")\n     * @param {*} value \n     */\n    async setNodesValue(field,fromFieldName,value) {\n        for (let nodeId in this.metadata.mappings) {\n            let mappingList=this.metadata.mappings[nodeId]\n\n            if (!mappingList || !mappingList.length) continue\n            let nodeIdInt=parseInt(nodeId)\n            let node=this.loopParser.getNodeById(nodeIdInt)\n            if (!node) {\n                console.log(\"could not find node with id \",nodeIdInt,fromFieldName,value)\n                continue\n            }\n\n            /**\n             * workaround for ComfyUI bug: linked values are not transferred to target node, have to do it manually\n             */\n            let targetFieldName=\"\"\n            let targetIndex=-1\n            let targetNode=null\n            if (node.outputs && node.outputs.length && node.outputs[0].widget) {\n                targetFieldName=node.outputs[0].widget.name\n                let linkId=node.outputs[0].links[0]\n                let link=this.getLinkById(linkId)\n                let targetNodeId=link[3]\n                targetIndex=this.getWidgetIndex(targetNodeId,targetFieldName)\n                if (targetIndex>=0) {\n                    targetNode=this.getNodeById(targetNodeId)\n                }\n            }\n            if (node) {\n                for(let i=0;i<mappingList.length;i++) {\n                    let mapping=mappingList[i]\n                    \n                    if (mapping && mapping.fromField===fromFieldName) {\n                        value=await this.convertValue(value,field)\n                        console.log(\"setNodesValue\",node,value,mapping.toIndex)\n                        node.widgets_values[parseInt(mapping.toIndex)]=value\n                        if (targetNode) {\n                            targetNode.widgets_values[targetIndex]=value\n                        }\n                    }                \n                }\n            }\n\n        }\n    }\n    /**\n     * find all nodes which are connected to a mapping (nodeId, fieldFrom,toField) inside a group and set value\n     * @param {object} field the field object {name,type,min,max,...}\n     * @param {string} fromFieldName full name with array name without index \"controlnet[].model\")\n     * @param {string} groupName the group name - e.g. controlnet[0], controlnet[1],...\n     * @param {string} arrayName  the array name - e.g. controlnet\n     * @param {number} arrayName  the index in array (0,1,...)\n    * @param {*} value \n     */\n    async setNodesValueGroup(field,fromFieldName,groupName,value,arrayName,index) {\n        for (let i=0;i<this.workflow.nodes.length;i++) {\n            let node=this.workflow.nodes[i]\n            if (this.loopParser.isNodeInGroup(node.id,groupName)) { // only nodes in group\n                let mappingList=this.metadata.mappings[node.id]\n                if(mappingList && mappingList.length) {\n                    for (let i = 0; i < mappingList.length; i++) {\n                        let mapping = mappingList[i]\n                        if (mapping && mapping.fromField === fromFieldName) {\n                            value = await this.convertValue(value, field, arrayName, index)\n                            node.widgets_values[parseInt(mapping.toIndex)] = value\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    removeVirtualNodes() {\n\n        // Iterate backwards to avoid indexing issues after removal\n        for (let i = this.workflow.nodes.length - 1; i >= 0; i--) {\n            const node = this.workflow.nodes[i];\n            let isVirtualNode = false;\n            if(this.workflow.extra.gyre.virtualNodes && this.workflow.extra.gyre.virtualNodes.length){\n                isVirtualNode =  this.workflow.extra.gyre.virtualNodes.includes(node.type);\n            }\n\n            if (isVirtualNode || node.type === \"PrimitiveNode\") {\n                const outgoingLink = this.workflow.links.find(link => link[1] === node.id);\n        \n                // Remove the  link\n                if (outgoingLink) this.workflow.links = this.workflow.links.filter(link => link[0] !== outgoingLink[0])\n        \n                // Remove the GyreLoop node\n                this.workflow.nodes.splice(i, 1)\n            }\n        }\n    }\n    /**\n     * Modify workflow values by using mapping and data from image editor\n     * data object has to be filled with\n     *  prompt\n     *  negativePrompt\n     *  hasMask\n     *  optional: controlnet array\n     * @param {object} data \n     */\n    async setValues(data) {\n        if (!this.metadata) return\n        if (!this.metadata.mappings) return\n        for (let name in data) {\n            let value=data[name]\n            if (!Array.isArray(value)) {\n                let field=this.rules.getField(name,this.fieldList)\n                if (field) await this.setNodesValue(field,field.name,value)\n            } else {\n                // replace array of object values\n                let arrayName=name\n                for(let i=0;i<data[arrayName].length;i++) {\n                    let element=data[arrayName][i]\n                    for(let propName in element) {\n                        let fieldName=arrayName+\"[].\"+propName      // e.g. controlnet[].type\n                        let fieldNameIndex=arrayName+\"[\"+i+\"].\"+propName      // e.g. controlnet[0].type\n                        let value=element[propName]\n                        let field=this.rules.getField(fieldName,this.fieldList)\n                        await this.setNodesValue(field,fieldNameIndex,value)\n                        let groupName=arrayName+\"[\"+i+\"]\"                // e.g. controlnet[0]\n                        await this.setNodesValueGroup(field,fieldName,groupName,value,arrayName,i)\n                    }\n                }\n            }\n        }\n\n    }\n\n    /**\n     * split values in CSV format from string into seperate values with field_0, field_1\n     * values are separated by ;\n     * Definition by split_value_num and split_value_type\n     * @param {*} data \n     */\n    splitCustomValues(data) {\n        for (let name in data) {\n            let value=data[name]\n            let field=this.rules.getField(name,this.fieldList)\n            if (field && field.split_value_num && field.split_value_type) {\n                let arr=value.split(\";\")\n                for(let i=0;i<field.split_value_num;i++) {\n                    let v=arr[i]\n                    // type conversion\n                    let splitField={name:name+\"_\"+i,type:field.split_value_type,step:parseFloat(v)}\n\n                    v=this.rules.convertValue( v,splitField)  \n                    data[name+\"_\"+i]=v\n                }\n            }\n        }\n    } \n}","import { rulesExecution } from './rulesExecution.js'\nimport { loopPreparser } from './loopPreparser.js'\nimport { valuePreparser } from './valuePreparser.js'\nimport { mappingsHelper } from './mappingsHelper.js'\n\nexport class ComfyUIPreparser {\n\n    constructor(workflow) {\n        this.workflow=workflow\n        if (!workflow.extra.gyre) return\n        this.metadata=workflow.extra.gyre\n        this.fieldList=[]\n        if (this.metadata.forms && this.metadata.forms.default)  {\n            this.fieldList=new mappingsHelper().getMappingFields(this.metadata).fields\n          }    \n    }\n    /**\n     * extend workflow to set all loop nodes\n     * @param {object} data \n     */\n    generateLoops(data) {\n        let loop=new loopPreparser(this.workflow)\n        for (let name in data) {\n            let value=data[name]\n            if (Array.isArray(value)) {     // e.g. controlnet\n                loop.generateLoop(name,data[name].length)\n            }\n        }\n    }\n    /**\n     * execute rules on \n     * @param {object} data \n     */\n    executeAllRules(data) {\n        let rules=new rulesExecution()\n        // marcin\n        if(!this.metadata.rules) return;\n        rules.execute(data,this.fieldList,this.metadata.rules,{},\"__ignore_arrays\") // first execute rules on non array props\n\n        for (let name in data) {\n            let value=data[name]\n            if (Array.isArray(value)) {     // e.g. controlnet\n                for(let i=0;i<data[name].length;i++) {\n                    rules=new rulesExecution()\n                    let arrayIdx={}\n                    arrayIdx[name]=i\n                    rules.execute(data,this.fieldList,this.metadata.rules,arrayIdx,name)    // execute rules on array\n                }\n            }\n        }\n\n    }\n   \n    /**\n     * replace all mappings with real values\n     * @param {object} data \n     */\n    async setValues(data) {\n        let vp=new valuePreparser(this.workflow)\n        await vp.setValues(data)\n        //vp.removeVirtualNodes();\n    }\n    splitCustomValues(data) {\n        let vp=new valuePreparser(this.workflow)\n        vp.splitCustomValues(data)\n    }     \n    async execute(data) {\n        this.generateLoops(data)\n        this.executeAllRules(data)\n        this.splitCustomValues(data)\n        await this.setValues(data)\n    }\n\n    getTestData() {\n        return {\n            prompt: \"fashion dog\",\n            negativePrompt: \"ugly\",\n            hasMask: false,\n            controlnet:[\n                { type:\"pose\",image:\"empty\"},\n                { type:\"depth\",image:\"empty\"},\n                { type:\"scribble\",image:\"empty\"}\n            ],\n            // some custom fields\n            seed: 123,\n            steps: 20\n        }\n    }\n\n}\n\n\n\n","import {litegraph}  from \"../litegraph/litegraph.js\";\nlet gyre;\nexport let convertToApiJson = async (datajson,systemstats)=>{\n    let iswindows = systemstats=='nt'?true:false;\n    datajson = fixJsonPathsForOs(datajson,iswindows);\n    datajson = fixDataJson(datajson);\n\n    let graph = new window.LGraph();\n    graph.start();\n    graph.configure(datajson);\n    let res = await createApiJson(graph);\n    return res;\n}\n\n\nlet fixJsonPathsForOs=(datajson,iswindows)=>{\n    try {\n        datajson.nodes.forEach((el,idx1) => {\n            if (el.widgets_values) {\n                el.widgets_values.forEach((el1,idx) => {\n                    if (iswindows && el1 && !isValidUrl(el1) && el1.includes!=void 0 &&  el1.includes('/')) {\n                        el1 = el1.replaceAll('/', '\\\\');\n                        datajson.nodes[idx1].widgets_values[idx] = el1;\n                    }\n                    if (!iswindows && el1 && !isValidUrl(el1) && el1.includes!=void 0 && el1.includes('\\\\')) {\n                        el1 = el1.replaceAll('\\\\', '/');\n                        datajson.nodes[idx1].widgets_values[idx] = el1;\n                    }\n                })\n            }\n        })\n        return datajson;\n    } catch (error) {\n        console.error(\"Error saving workspace:\", error);\n    }\n}\n\n\nlet isValidUrl = (url)=>{\n    // Regular expression for URL validation\n    const urlRegex = /^(?:https?:\\/\\/|ftp:\\/\\/|www\\.)[a-z0-9-]+(?:\\.[a-z0-9-]+)+[^\\s]*$/i;\n    // Test the given URL against the regex\n    return urlRegex.test(url);\n}\n\nlet fixDataJson = (datajson)=>{\n    datajson.nodes = datajson.nodes.map((el)=>{\n        let widgets = datajson.extra.gyre.nodeWidgets[el.id];\n        return{...el,widgets}\n    })\n    gyre = datajson.extra.gyre;\n    return datajson;\n}\n\n\nlet checkIsVirtualNode = (node)=> {\n    let isVirtualNode = false;\n    if(gyre.virtualNodes &&  gyre.virtualNodes.length){\n        isVirtualNode =   gyre.virtualNodes.includes(node.type);\n    }\n    return isVirtualNode;\n}\n\n\nlet prepareGraph = async(graph)=> {\n    try {\n    for (const outer of graph.computeExecutionOrder(false)) {\n        if (outer.widgets) {\n            for (const w of outer.widgets) {\n                if(w && w.beforeQueued) w.beforeQueued();\n            }\n        }\n        let  inner =  [outer];\n        if(outer.getInnerNodes) {inner =  outer.getInnerNodes();}\n\n        for (let n of inner) {\n            if (checkIsVirtualNode(n) && n.applyToGraph) {\n                n.applyToGraph();\n            }\n        }\n    }\n    } catch (err) {\n        console.error(err);\n\n    }\n    return graph;\n}\n\n\nlet createApiJson = async(graph)=> {\n\n    graph = await prepareGraph(graph);\n    const apiJsonOutput = {};\n\n    try{\n    for (const outerNode of graph.computeExecutionOrder(false)) {\n        const skipNode = outerNode.mode === 2 || outerNode.mode === 4;\n        const innerNodes = (!skipNode && outerNode.getInnerNodes) ? outerNode.getInnerNodes() : [outerNode];\n        for (let node of innerNodes) {\n            if (checkIsVirtualNode(node)){\n                continue;\n            }\n\n            if ([2,4].includes(node.mode)) continue;\n\n            let nodeInputs = {};\n            let nodewidgets = node.widgets;\n\n\n            if (nodewidgets) {\n                for (let idx in nodewidgets) {\n                    let  wdgt = nodewidgets[idx];\n                    if (wdgt && (!wdgt.options || wdgt.options.serialize !== false)) {\n                        if(wdgt.serializeValue){\n                            nodeInputs[wdgt.name] =   await wdgt.serializeValue(node, idx)\n                        } else {\n                            nodeInputs[wdgt.name] = wdgt.value;\n                        }\n                    }\n                }\n            }\n\n\n            for (let idx in node.inputs) {\n                let parentnode = node.getInputNode(idx);\n                if (parentnode) {\n                    let nodelink = node.getInputLink(idx);\n                    while (parentnode.mode === 4 || checkIsVirtualNode(parentnode)) {\n                        let nodefound = false;\n                        if (checkIsVirtualNode(parentnode)){\n                            nodelink = parentnode.getInputLink(nodelink.origin_slot);\n                            if (nodelink) {\n                                parentnode = parentnode.getInputNode(nodelink.target_slot);\n                                if (parentnode) {\n                                    nodefound = true;\n                                }\n                            }\n                        } else if (nodelink && parentnode.mode === 4) {\n                            let allInp = [nodelink.origin_slot, ...Object.keys(parentnode.inputs)];\n                            for (let inpParent of allInp) {\n                                if (parentnode.inputs[inpParent]?.type === node.inputs[idx].type) {\n                                    nodelink = parentnode.getInputLink(inpParent);\n                                    if (nodelink) {\n                                        parentnode = parentnode.getInputNode(inpParent);\n                                    }\n                                    nodefound = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        if (!nodefound) {\n                            break;\n                        }\n                    }\n\n                    if (nodelink && parentnode?.updateLink) {\n                        nodelink = parentnode.updateLink(nodelink);\n                    }\n\n                    if (nodelink) {\n                        nodeInputs[node.inputs[idx].name] = [String(nodelink.origin_id), parseInt(nodelink.origin_slot)];\n                    }\n                }\n            }\n            let ntitle = node.type;\n            if(node.properties && node.properties['Node name for S&R']) ntitle = node.properties['Node name for S&R'];\n            apiJsonOutput[String(node.id)] =  {\n                inputs: nodeInputs,\n                class_type: node.type,\n                _meta: {\n                    title: ntitle,\n                }\n            };\n        }\n    }\n\n    for (let nId in apiJsonOutput) {\n        for (const inputName in apiJsonOutput[nId].inputs) {\n            const input = apiJsonOutput[nId].inputs[inputName];\n            if (Array.isArray(input) && input.length === 2 && !apiJsonOutput[input[0]]) {\n                delete apiJsonOutput[nId].inputs[inputName];\n            }\n        }\n    }\n} catch (err) {\n    console.error(err);\n\n}\n    return  apiJsonOutput;\n}\n\n\n","//packer version\n\n\nexport let litegraph = (function(global) {\n    // *************************************************************\n    //   LiteGraph CLASS                                     *******\n    // *************************************************************\n\n    /**\n     * The Global Scope. It contains all the registered node classes.\n     *\n     * @class LiteGraph\n     * @constructor\n     */\n\n    var LiteGraph = (global.LiteGraph = {\n        VERSION: 0.4,\n\n        CANVAS_GRID_SIZE: 10,\n\n        NODE_TITLE_HEIGHT: 30,\n        NODE_TITLE_TEXT_Y: 20,\n        NODE_SLOT_HEIGHT: 20,\n        NODE_WIDGET_HEIGHT: 20,\n        NODE_WIDTH: 140,\n        NODE_MIN_WIDTH: 50,\n        NODE_COLLAPSED_RADIUS: 10,\n        NODE_COLLAPSED_WIDTH: 80,\n        NODE_TITLE_COLOR: \"#999\",\n        NODE_SELECTED_TITLE_COLOR: \"#FFF\",\n        NODE_TEXT_SIZE: 14,\n        NODE_TEXT_COLOR: \"#AAA\",\n        NODE_SUBTEXT_SIZE: 12,\n        NODE_DEFAULT_COLOR: \"#333\",\n        NODE_DEFAULT_BGCOLOR: \"#353535\",\n        NODE_DEFAULT_BOXCOLOR: \"#666\",\n        NODE_DEFAULT_SHAPE: \"box\",\n        NODE_BOX_OUTLINE_COLOR: \"#FFF\",\n        DEFAULT_SHADOW_COLOR: \"rgba(0,0,0,0.5)\",\n        DEFAULT_GROUP_FONT: 24,\n\n        WIDGET_BGCOLOR: \"#222\",\n        WIDGET_OUTLINE_COLOR: \"#666\",\n        WIDGET_TEXT_COLOR: \"#DDD\",\n        WIDGET_SECONDARY_TEXT_COLOR: \"#999\",\n\n        LINK_COLOR: \"#9A9\",\n        EVENT_LINK_COLOR: \"#A86\",\n        CONNECTING_LINK_COLOR: \"#AFA\",\n\n        MAX_NUMBER_OF_NODES: 10000, //avoid infinite loops\n        DEFAULT_POSITION: [100, 100], //default node position\n        VALID_SHAPES: [\"default\", \"box\", \"round\", \"card\"], //,\"circle\"\n\n        //shapes are used for nodes but also for slots\n        BOX_SHAPE: 1,\n        ROUND_SHAPE: 2,\n        CIRCLE_SHAPE: 3,\n        CARD_SHAPE: 4,\n        ARROW_SHAPE: 5,\n        GRID_SHAPE: 6, // intended for slot arrays\n\n        //enums\n        INPUT: 1,\n        OUTPUT: 2,\n\n        EVENT: -1, //for outputs\n        ACTION: -1, //for inputs\n\n        NODE_MODES: [\"Always\", \"On Event\", \"Never\", \"On Trigger\"], // helper, will add \"On Request\" and more in the future\n        NODE_MODES_COLORS:[\"#666\",\"#422\",\"#333\",\"#224\",\"#626\"], // use with node_box_coloured_by_mode\n        ALWAYS: 0,\n        ON_EVENT: 1,\n        NEVER: 2,\n        ON_TRIGGER: 3,\n\n        UP: 1,\n        DOWN: 2,\n        LEFT: 3,\n        RIGHT: 4,\n        CENTER: 5,\n\n        LINK_RENDER_MODES: [\"Straight\", \"Linear\", \"Spline\"], // helper\n        STRAIGHT_LINK: 0,\n        LINEAR_LINK: 1,\n        SPLINE_LINK: 2,\n\n        NORMAL_TITLE: 0,\n        NO_TITLE: 1,\n        TRANSPARENT_TITLE: 2,\n        AUTOHIDE_TITLE: 3,\n        VERTICAL_LAYOUT: \"vertical\", // arrange nodes vertically\n\n        proxy: null, //used to redirect calls\n        node_images_path: \"\",\n\n        debug: false,\n        catch_exceptions: true,\n        throw_errors: true,\n        allow_scripts: false, //if set to true some nodes like Formula would be allowed to evaluate code that comes from unsafe sources (like node configuration), which could lead to exploits\n        registered_node_types: {}, //nodetypes by string\n        node_types_by_file_extension: {}, //used for dropping files in the canvas\n        Nodes: {}, //node types by classname\n        Globals: {}, //used to store vars between graphs\n\n        searchbox_extras: {}, //used to add extra features to the search box\n        auto_sort_node_types: false, // [true!] If set to true, will automatically sort node types / categories in the context menus\n\n        node_box_coloured_when_on: false, // [true!] this make the nodes box (top left circle) coloured when triggered (execute/action), visual feedback\n        node_box_coloured_by_mode: false, // [true!] nodebox based on node mode, visual feedback\n\n        dialog_close_on_mouse_leave: false, // [false on mobile] better true if not touch device, TODO add an helper/listener to close if false\n        dialog_close_on_mouse_leave_delay: 500,\n\n        shift_click_do_break_link_from: false, // [false!] prefer false if results too easy to break links - implement with ALT or TODO custom keys\n        click_do_break_link_to: false, // [false!]prefer false, way too easy to break links\n\n        search_hide_on_mouse_leave: true, // [false on mobile] better true if not touch device, TODO add an helper/listener to close if false\n        search_filter_enabled: false, // [true!] enable filtering slots type in the search widget, !requires auto_load_slot_types or manual set registered_slot_[in/out]_types and slot_types_[in/out]\n        search_show_all_on_open: true, // [true!] opens the results list when opening the search widget\n\n        auto_load_slot_types: false, // [if want false, use true, run, get vars values to be statically set, than disable] nodes types and nodeclass association with node types need to be calculated, if dont want this, calculate once and set registered_slot_[in/out]_types and slot_types_[in/out]\n\n        // set these values if not using auto_load_slot_types\n        registered_slot_in_types: {}, // slot types for nodeclass\n        registered_slot_out_types: {}, // slot types for nodeclass\n        slot_types_in: [], // slot types IN\n        slot_types_out: [], // slot types OUT\n        slot_types_default_in: [], // specify for each IN slot type a(/many) default node(s), use single string, array, or object (with node, title, parameters, ..) like for search\n        slot_types_default_out: [], // specify for each OUT slot type a(/many) default node(s), use single string, array, or object (with node, title, parameters, ..) like for search\n\n        alt_drag_do_clone_nodes: false, // [true!] very handy, ALT click to clone and drag the new node\n\n        do_add_triggers_slots: false, // [true!] will create and connect event slots when using action/events connections, !WILL CHANGE node mode when using onTrigger (enable mode colors), onExecuted does not need this\n\n        allow_multi_output_for_events: true, // [false!] being events, it is strongly reccomended to use them sequentially, one by one\n\n        middle_click_slot_add_default_node: false, //[true!] allows to create and connect a ndoe clicking with the third button (wheel)\n\n        release_link_on_empty_shows_menu: false, //[true!] dragging a link to empty space will open a menu, add from list, search or defaults\n\n        pointerevents_method: \"pointer\", // \"mouse\"|\"pointer\" use mouse for retrocompatibility issues? (none found @ now)\n        // TODO implement pointercancel, gotpointercapture, lostpointercapture, (pointerover, pointerout if necessary)\n\n        ctrl_shift_v_paste_connect_unselected_outputs: true, //[true!] allows ctrl + shift + v to paste nodes with the outputs of the unselected nodes connected with the inputs of the newly pasted nodes\n\n        // if true, all newly created nodes/links will use string UUIDs for their id fields instead of integers.\n        // use this if you must have node IDs that are unique across all graphs and subgraphs.\n        use_uuids: false,\n\n        /**\n         * Register a node class so it can be listed when the user wants to create a new one\n         * @method registerNodeType\n         * @param {String} type name of the node and path\n         * @param {Class} base_class class containing the structure of a node\n         */\n\n        registerNodeType: function(type, base_class) {\n            if (!base_class.prototype) {\n                throw \"Cannot register a simple object, it must be a class with a prototype\";\n            }\n            base_class.type = type;\n\n            if (LiteGraph.debug) {\n                console.log(\"Node registered: \" + type);\n            }\n\n            const classname = base_class.name;\n\n            const pos = type.lastIndexOf(\"/\");\n            base_class.category = type.substring(0, pos);\n\n            if (!base_class.title) {\n                base_class.title = classname;\n            }\n\n            //extend class\n            for (var i in LGraphNode.prototype) {\n                if (!base_class.prototype[i]) {\n                    base_class.prototype[i] = LGraphNode.prototype[i];\n                }\n            }\n\n            const prev = this.registered_node_types[type];\n            if(prev) {\n                console.log(\"replacing node type: \" + type);\n            }\n            if( !Object.prototype.hasOwnProperty.call( base_class.prototype, \"shape\") ) {\n                Object.defineProperty(base_class.prototype, \"shape\", {\n                    set: function(v) {\n                        switch (v) {\n                            case \"default\":\n                                delete this._shape;\n                                break;\n                            case \"box\":\n                                this._shape = LiteGraph.BOX_SHAPE;\n                                break;\n                            case \"round\":\n                                this._shape = LiteGraph.ROUND_SHAPE;\n                                break;\n                            case \"circle\":\n                                this._shape = LiteGraph.CIRCLE_SHAPE;\n                                break;\n                            case \"card\":\n                                this._shape = LiteGraph.CARD_SHAPE;\n                                break;\n                            default:\n                                this._shape = v;\n                        }\n                    },\n                    get: function() {\n                        return this._shape;\n                    },\n                    enumerable: true,\n                    configurable: true\n                });\n\n\n                //used to know which nodes to create when dragging files to the canvas\n                if (base_class.supported_extensions) {\n                    for (let i in base_class.supported_extensions) {\n                        const ext = base_class.supported_extensions[i];\n                        if(ext && ext.constructor === String) {\n                            this.node_types_by_file_extension[ ext.toLowerCase() ] = base_class;\n                        }\n                    }\n                }\n            }\n\n            this.registered_node_types[type] = base_class;\n            if (base_class.constructor.name) {\n                this.Nodes[classname] = base_class;\n            }\n            if (LiteGraph.onNodeTypeRegistered) {\n                LiteGraph.onNodeTypeRegistered(type, base_class);\n            }\n            if (prev && LiteGraph.onNodeTypeReplaced) {\n                LiteGraph.onNodeTypeReplaced(type, base_class, prev);\n            }\n\n            //warnings\n            if (base_class.prototype.onPropertyChange) {\n                console.warn(\n                    \"LiteGraph node class \" +\n                    type +\n                    \" has onPropertyChange method, it must be called onPropertyChanged with d at the end\"\n                );\n            }\n\n            // TODO one would want to know input and ouput :: this would allow through registerNodeAndSlotType to get all the slots types\n            if (this.auto_load_slot_types) {\n                new base_class(base_class.title || \"tmpnode\");\n            }\n        },\n\n        /**\n         * removes a node type from the system\n         * @method unregisterNodeType\n         * @param {String|Object} type name of the node or the node constructor itself\n         */\n        unregisterNodeType: function(type) {\n            const base_class =\n                type.constructor === String\n                    ? this.registered_node_types[type]\n                    : type;\n            if (!base_class) {\n                throw \"node type not found: \" + type;\n            }\n            delete this.registered_node_types[base_class.type];\n            if (base_class.constructor.name) {\n                delete this.Nodes[base_class.constructor.name];\n            }\n        },\n\n        /**\n         * Save a slot type and his node\n         * @method registerSlotType\n         * @param {String|Object} type name of the node or the node constructor itself\n         * @param {String} slot_type name of the slot type (variable type), eg. string, number, array, boolean, ..\n         */\n        registerNodeAndSlotType: function(type, slot_type, out){\n            out = out || false;\n            const base_class =\n                type.constructor === String &&\n                this.registered_node_types[type] !== \"anonymous\"\n                    ? this.registered_node_types[type]\n                    : type;\n\n            const class_type = base_class.constructor.type;\n\n            let allTypes = [];\n            if (typeof slot_type === \"string\") {\n                allTypes = slot_type.split(\",\");\n            } else if (slot_type == this.EVENT || slot_type == this.ACTION) {\n                allTypes = [\"_event_\"];\n            } else {\n                allTypes = [\"*\"];\n            }\n\n            for (let i = 0; i < allTypes.length; ++i) {\n                let slotType = allTypes[i];\n                if (slotType === \"\") {\n                    slotType = \"*\";\n                }\n                const registerTo = out\n                    ? \"registered_slot_out_types\"\n                    : \"registered_slot_in_types\";\n                if (this[registerTo][slotType] === undefined) {\n                    this[registerTo][slotType] = { nodes: [] };\n                }\n                if (!this[registerTo][slotType].nodes.includes(class_type)) {\n                    this[registerTo][slotType].nodes.push(class_type);\n                }\n\n                // check if is a new type\n                if (!out) {\n                    if (!this.slot_types_in.includes(slotType.toLowerCase())) {\n                        this.slot_types_in.push(slotType.toLowerCase());\n                        this.slot_types_in.sort();\n                    }\n                } else {\n                    if (!this.slot_types_out.includes(slotType.toLowerCase())) {\n                        this.slot_types_out.push(slotType.toLowerCase());\n                        this.slot_types_out.sort();\n                    }\n                }\n            }\n        },\n\n        /**\n         * Create a new nodetype by passing a function, it wraps it with a proper class and generates inputs according to the parameters of the function.\n         * Useful to wrap simple methods that do not require properties, and that only process some input to generate an output.\n         * @method wrapFunctionAsNode\n         * @param {String} name node name with namespace (p.e.: 'math/sum')\n         * @param {Function} func\n         * @param {Array} param_types [optional] an array containing the type of every parameter, otherwise parameters will accept any type\n         * @param {String} return_type [optional] string with the return type, otherwise it will be generic\n         * @param {Object} properties [optional] properties to be configurable\n         */\n        wrapFunctionAsNode: function(\n            name,\n            func,\n            param_types,\n            return_type,\n            properties\n        ) {\n            var params = Array(func.length);\n            var code = \"\";\n            var names = LiteGraph.getParameterNames(func);\n            for (var i = 0; i < names.length; ++i) {\n                code +=\n                    \"this.addInput('\" +\n                    names[i] +\n                    \"',\" +\n                    (param_types && param_types[i]\n                        ? \"'\" + param_types[i] + \"'\"\n                        : \"0\") +\n                    \");\\n\";\n            }\n            code +=\n                \"this.addOutput('out',\" +\n                (return_type ? \"'\" + return_type + \"'\" : 0) +\n                \");\\n\";\n            if (properties) {\n                code +=\n                    \"this.properties = \" + JSON.stringify(properties) + \";\\n\";\n            }\n            var classobj = Function(code);\n            classobj.title = name.split(\"/\").pop();\n            classobj.desc = \"Generated from \" + func.name;\n            classobj.prototype.onExecute = function onExecute() {\n                for (var i = 0; i < params.length; ++i) {\n                    params[i] = this.getInputData(i);\n                }\n                var r = func.apply(this, params);\n                this.setOutputData(0, r);\n            };\n            this.registerNodeType(name, classobj);\n        },\n\n        /**\n         * Removes all previously registered node's types\n         */\n        clearRegisteredTypes: function() {\n            this.registered_node_types = {};\n            this.node_types_by_file_extension = {};\n            this.Nodes = {};\n            this.searchbox_extras = {};\n        },\n\n        /**\n         * Adds this method to all nodetypes, existing and to be created\n         * (You can add it to LGraphNode.prototype but then existing node types wont have it)\n         * @method addNodeMethod\n         * @param {Function} func\n         */\n        addNodeMethod: function(name, func) {\n            LGraphNode.prototype[name] = func;\n            for (var i in this.registered_node_types) {\n                var type = this.registered_node_types[i];\n                if (type.prototype[name]) {\n                    type.prototype[\"_\" + name] = type.prototype[name];\n                } //keep old in case of replacing\n                type.prototype[name] = func;\n            }\n        },\n\n        /**\n         * Create a node of a given type with a name. The node is not attached to any graph yet.\n         * @method createNode\n         * @param {String} type full name of the node class. p.e. \"math/sin\"\n         * @param {String} name a name to distinguish from other nodes\n         * @param {Object} options to set options\n         */\n\n        createNode: function(type, title, options) {\n            var base_class = this.registered_node_types[type];\n            if (!base_class) {\n                if (LiteGraph.debug) {\n                    console.log(\n                        'GraphNode type \"' + type + '\" not registered.'\n                    );\n                }\n                return null;\n            }\n\n            var prototype = base_class.prototype || base_class;\n\n            title = title || base_class.title || type;\n\n            var node = null;\n\n            if (LiteGraph.catch_exceptions) {\n                try {\n                    node = new base_class(title);\n                } catch (err) {\n                    console.error(err);\n                    return null;\n                }\n            } else {\n                node = new base_class(title);\n            }\n\n            node.type = type;\n\n            if (!node.title && title) {\n                node.title = title;\n            }\n            if (!node.properties) {\n                node.properties = {};\n            }\n            if (!node.properties_info) {\n                node.properties_info = [];\n            }\n            if (!node.flags) {\n                node.flags = {};\n            }\n            if (!node.size) {\n                node.size = node.computeSize();\n                //call onresize?\n            }\n            if (!node.pos) {\n                node.pos = LiteGraph.DEFAULT_POSITION.concat();\n            }\n            if (!node.mode) {\n                node.mode = LiteGraph.ALWAYS;\n            }\n\n            //extra options\n            if (options) {\n                for (var i in options) {\n                    node[i] = options[i];\n                }\n            }\n\n            // callback\n            if ( node.onNodeCreated ) {\n                node.onNodeCreated();\n            }\n\n            return node;\n        },\n\n        /**\n         * Returns a registered node type with a given name\n         * @method getNodeType\n         * @param {String} type full name of the node class. p.e. \"math/sin\"\n         * @return {Class} the node class\n         */\n        getNodeType: function(type) {\n            return this.registered_node_types[type];\n        },\n\n        /**\n         * Returns a list of node types matching one category\n         * @method getNodeType\n         * @param {String} category category name\n         * @return {Array} array with all the node classes\n         */\n\n        getNodeTypesInCategory: function(category, filter) {\n            var r = [];\n            for (var i in this.registered_node_types) {\n                var type = this.registered_node_types[i];\n                if (type.filter != filter) {\n                    continue;\n                }\n\n                if (category == \"\") {\n                    if (type.category == null) {\n                        r.push(type);\n                    }\n                } else if (type.category == category) {\n                    r.push(type);\n                }\n            }\n\n            if (this.auto_sort_node_types) {\n                r.sort(function(a,b){return a.title.localeCompare(b.title)});\n            }\n\n            return r;\n        },\n\n        /**\n         * Returns a list with all the node type categories\n         * @method getNodeTypesCategories\n         * @param {String} filter only nodes with ctor.filter equal can be shown\n         * @return {Array} array with all the names of the categories\n         */\n        getNodeTypesCategories: function( filter ) {\n            var categories = { \"\": 1 };\n            for (var i in this.registered_node_types) {\n                var type = this.registered_node_types[i];\n                if ( type.category && !type.skip_list )\n                {\n                    if(type.filter != filter)\n                        continue;\n                    categories[type.category] = 1;\n                }\n            }\n            var result = [];\n            for (var i in categories) {\n                result.push(i);\n            }\n            return this.auto_sort_node_types ? result.sort() : result;\n        },\n\n        //debug purposes: reloads all the js scripts that matches a wildcard\n        reloadNodes: function(folder_wildcard) {\n            var tmp = document.getElementsByTagName(\"script\");\n            //weird, this array changes by its own, so we use a copy\n            var script_files = [];\n            for (var i=0; i < tmp.length; i++) {\n                script_files.push(tmp[i]);\n            }\n\n            var docHeadObj = document.getElementsByTagName(\"head\")[0];\n            folder_wildcard = document.location.href + folder_wildcard;\n\n            for (var i=0; i < script_files.length; i++) {\n                var src = script_files[i].src;\n                if (\n                    !src ||\n                    src.substr(0, folder_wildcard.length) != folder_wildcard\n                ) {\n                    continue;\n                }\n\n                try {\n                    if (LiteGraph.debug) {\n                        console.log(\"Reloading: \" + src);\n                    }\n                    var dynamicScript = document.createElement(\"script\");\n                    dynamicScript.type = \"text/javascript\";\n                    dynamicScript.src = src;\n                    docHeadObj.appendChild(dynamicScript);\n                    docHeadObj.removeChild(script_files[i]);\n                } catch (err) {\n                    if (LiteGraph.throw_errors) {\n                        throw err;\n                    }\n                    if (LiteGraph.debug) {\n                        console.log(\"Error while reloading \" + src);\n                    }\n                }\n            }\n\n            if (LiteGraph.debug) {\n                console.log(\"Nodes reloaded\");\n            }\n        },\n\n        //separated just to improve if it doesn't work\n        cloneObject: function(obj, target) {\n            if (obj == null) {\n                return null;\n            }\n            var r = JSON.parse(JSON.stringify(obj));\n            if (!target) {\n                return r;\n            }\n\n            for (var i in r) {\n                target[i] = r[i];\n            }\n            return target;\n        },\n\n        /*\n         * https://gist.github.com/jed/982883?permalink_comment_id=852670#gistcomment-852670\n         */\n        uuidv4: function() {\n            return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16));\n        },\n\n        /**\n         * Returns if the types of two slots are compatible (taking into account wildcards, etc)\n         * @method isValidConnection\n         * @param {String} type_a\n         * @param {String} type_b\n         * @return {Boolean} true if they can be connected\n         */\n        isValidConnection: function(type_a, type_b) {\n            if (type_a==\"\" || type_a===\"*\") type_a = 0;\n            if (type_b==\"\" || type_b===\"*\") type_b = 0;\n            if (\n                !type_a //generic output\n                || !type_b // generic input\n                || type_a == type_b //same type (is valid for triggers)\n                || (type_a == LiteGraph.EVENT && type_b == LiteGraph.ACTION)\n            ) {\n                return true;\n            }\n\n            // Enforce string type to handle toLowerCase call (-1 number not ok)\n            type_a = String(type_a);\n            type_b = String(type_b);\n            type_a = type_a.toLowerCase();\n            type_b = type_b.toLowerCase();\n\n            // For nodes supporting multiple connection types\n            if (type_a.indexOf(\",\") == -1 && type_b.indexOf(\",\") == -1) {\n                return type_a == type_b;\n            }\n\n            // Check all permutations to see if one is valid\n            var supported_types_a = type_a.split(\",\");\n            var supported_types_b = type_b.split(\",\");\n            for (var i = 0; i < supported_types_a.length; ++i) {\n                for (var j = 0; j < supported_types_b.length; ++j) {\n                    if(this.isValidConnection(supported_types_a[i],supported_types_b[j])){\n                        //if (supported_types_a[i] == supported_types_b[j]) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Register a string in the search box so when the user types it it will recommend this node\n         * @method registerSearchboxExtra\n         * @param {String} node_type the node recommended\n         * @param {String} description text to show next to it\n         * @param {Object} data it could contain info of how the node should be configured\n         * @return {Boolean} true if they can be connected\n         */\n        registerSearchboxExtra: function(node_type, description, data) {\n            this.searchbox_extras[description.toLowerCase()] = {\n                type: node_type,\n                desc: description,\n                data: data\n            };\n        },\n\n        /**\n         * Wrapper to load files (from url using fetch or from file using FileReader)\n         * @method fetchFile\n         * @param {String|File|Blob} url the url of the file (or the file itself)\n         * @param {String} type an string to know how to fetch it: \"text\",\"arraybuffer\",\"json\",\"blob\"\n         * @param {Function} on_complete callback(data)\n         * @param {Function} on_error in case of an error\n         * @return {FileReader|Promise} returns the object used to\n         */\n        fetchFile: function( url, type, on_complete, on_error ) {\n            var that = this;\n            if(!url)\n                return null;\n\n            type = type || \"text\";\n            if( url.constructor === String )\n            {\n                if (url.substr(0, 4) == \"http\" && LiteGraph.proxy) {\n                    url = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n                }\n                return fetch(url)\n                    .then(function(response) {\n                        if(!response.ok)\n                            throw new Error(\"File not found\"); //it will be catch below\n                        if(type == \"arraybuffer\")\n                            return response.arrayBuffer();\n                        else if(type == \"text\" || type == \"string\")\n                            return response.text();\n                        else if(type == \"json\")\n                            return response.json();\n                        else if(type == \"blob\")\n                            return response.blob();\n                    })\n                    .then(function(data) {\n                        if(on_complete)\n                            on_complete(data);\n                    })\n                    .catch(function(error) {\n                        console.error(\"error fetching file:\",url);\n                        if(on_error)\n                            on_error(error);\n                    });\n            }\n            else if( url.constructor === File || url.constructor === Blob)\n            {\n                var reader = new FileReader();\n                reader.onload = function(e)\n                {\n                    var v = e.target.result;\n                    if( type == \"json\" )\n                        v = JSON.parse(v);\n                    if(on_complete)\n                        on_complete(v);\n                }\n                if(type == \"arraybuffer\")\n                    return reader.readAsArrayBuffer(url);\n                else if(type == \"text\" || type == \"json\")\n                    return reader.readAsText(url);\n                else if(type == \"blob\")\n                    return reader.readAsBinaryString(url);\n            }\n            return null;\n        }\n    });\n\n    //timer that works everywhere\n    if (typeof performance != \"undefined\") {\n        LiteGraph.getTime = performance.now.bind(performance);\n    } else if (typeof Date != \"undefined\" && Date.now) {\n        LiteGraph.getTime = Date.now.bind(Date);\n    } else if (typeof process != \"undefined\") {\n        LiteGraph.getTime = function() {\n            var t = process.hrtime();\n            return t[0] * 0.001 + t[1] * 1e-6;\n        };\n    } else {\n        LiteGraph.getTime = function getTime() {\n            return new Date().getTime();\n        };\n    }\n\n    //*********************************************************************************\n    // LGraph CLASS\n    //*********************************************************************************\n\n    /**\n     * LGraph is the class that contain a full graph. We instantiate one and add nodes to it, and then we can run the execution loop.\n     * supported callbacks:\n     + onNodeAdded: when a new node is added to the graph\n     + onNodeRemoved: when a node inside this graph is removed\n     + onNodeConnectionChange: some connection has changed in the graph (connected or disconnected)\n     *\n     * @class LGraph\n     * @constructor\n     * @param {Object} o data from previous serialization [optional]\n     */\n\n    function LGraph(o) {\n        if (LiteGraph.debug) {\n            console.log(\"Graph created\");\n        }\n        this.list_of_graphcanvas = null;\n        this.clear();\n\n        if (o) {\n            this.configure(o);\n        }\n    }\n\n    global.LGraph = LiteGraph.LGraph = LGraph;\n\n    //default supported types\n    LGraph.supported_types = [\"number\", \"string\", \"boolean\"];\n\n    //used to know which types of connections support this graph (some graphs do not allow certain types)\n    LGraph.prototype.getSupportedTypes = function() {\n        return this.supported_types || LGraph.supported_types;\n    };\n\n    LGraph.STATUS_STOPPED = 1;\n    LGraph.STATUS_RUNNING = 2;\n\n    /**\n     * Removes all nodes from this graph\n     * @method clear\n     */\n\n    LGraph.prototype.clear = function() {\n        this.stop();\n        this.status = LGraph.STATUS_STOPPED;\n\n        this.last_node_id = 0;\n        this.last_link_id = 0;\n\n        this._version = -1; //used to detect changes\n\n        //safe clear\n        if (this._nodes) {\n            for (var i = 0; i < this._nodes.length; ++i) {\n                var node = this._nodes[i];\n                if (node.onRemoved) {\n                    node.onRemoved();\n                }\n            }\n        }\n\n        //nodes\n        this._nodes = [];\n        this._nodes_by_id = {};\n        this._nodes_in_order = []; //nodes sorted in execution order\n        this._nodes_executable = null; //nodes that contain onExecute sorted in execution order\n\n        //other scene stuff\n        this._groups = [];\n\n        //links\n        this.links = {}; //container with all the links\n\n        //iterations\n        this.iteration = 0;\n\n        //custom data\n        this.config = {};\n        this.vars = {};\n        this.extra = {}; //to store custom data\n\n        //timing\n        this.globaltime = 0;\n        this.runningtime = 0;\n        this.fixedtime = 0;\n        this.fixedtime_lapse = 0.01;\n        this.elapsed_time = 0.01;\n        this.last_update_time = 0;\n        this.starttime = 0;\n\n        this.catch_errors = true;\n\n        this.nodes_executing = [];\n        this.nodes_actioning = [];\n        this.nodes_executedAction = [];\n\n        //subgraph_data\n        this.inputs = {};\n        this.outputs = {};\n\n        //notify canvas to redraw\n        this.change();\n\n        this.sendActionToCanvas(\"clear\");\n    };\n\n    /**\n     * Attach Canvas to this graph\n     * @method attachCanvas\n     * @param {GraphCanvas} graph_canvas\n     */\n\n    LGraph.prototype.attachCanvas = function(graphcanvas) {\n        if (graphcanvas.constructor != LGraphCanvas) {\n            throw \"attachCanvas expects a LGraphCanvas instance\";\n        }\n        if (graphcanvas.graph && graphcanvas.graph != this) {\n            graphcanvas.graph.detachCanvas(graphcanvas);\n        }\n\n        graphcanvas.graph = this;\n\n        if (!this.list_of_graphcanvas) {\n            this.list_of_graphcanvas = [];\n        }\n        this.list_of_graphcanvas.push(graphcanvas);\n    };\n\n    /**\n     * Detach Canvas from this graph\n     * @method detachCanvas\n     * @param {GraphCanvas} graph_canvas\n     */\n    LGraph.prototype.detachCanvas = function(graphcanvas) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        var pos = this.list_of_graphcanvas.indexOf(graphcanvas);\n        if (pos == -1) {\n            return;\n        }\n        graphcanvas.graph = null;\n        this.list_of_graphcanvas.splice(pos, 1);\n    };\n\n    /**\n     * Starts running this graph every interval milliseconds.\n     * @method start\n     * @param {number} interval amount of milliseconds between executions, if 0 then it renders to the monitor refresh rate\n     */\n\n    LGraph.prototype.start = function(interval) {\n        if (this.status == LGraph.STATUS_RUNNING) {\n            return;\n        }\n        this.status = LGraph.STATUS_RUNNING;\n\n        if (this.onPlayEvent) {\n            this.onPlayEvent();\n        }\n\n        this.sendEventToAllNodes(\"onStart\");\n\n        //launch\n        this.starttime = LiteGraph.getTime();\n        this.last_update_time = this.starttime;\n        interval = interval || 0;\n        var that = this;\n\n        //execute once per frame\n        if ( interval == 0 && typeof window != \"undefined\" && window.requestAnimationFrame ) {\n            function on_frame() {\n                if (that.execution_timer_id != -1) {\n                    return;\n                }\n                window.requestAnimationFrame(on_frame);\n                if(that.onBeforeStep)\n                    that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if(that.onAfterStep)\n                    that.onAfterStep();\n            }\n            this.execution_timer_id = -1;\n            on_frame();\n        } else { //execute every 'interval' ms\n            this.execution_timer_id = setInterval(function() {\n                //execute\n                if(that.onBeforeStep)\n                    that.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n                if(that.onAfterStep)\n                    that.onAfterStep();\n            }, interval);\n        }\n    };\n\n    /**\n     * Stops the execution loop of the graph\n     * @method stop execution\n     */\n\n    LGraph.prototype.stop = function() {\n        if (this.status == LGraph.STATUS_STOPPED) {\n            return;\n        }\n\n        this.status = LGraph.STATUS_STOPPED;\n\n        if (this.onStopEvent) {\n            this.onStopEvent();\n        }\n\n        if (this.execution_timer_id != null) {\n            if (this.execution_timer_id != -1) {\n                clearInterval(this.execution_timer_id);\n            }\n            this.execution_timer_id = null;\n        }\n\n        this.sendEventToAllNodes(\"onStop\");\n    };\n\n    /**\n     * Run N steps (cycles) of the graph\n     * @method runStep\n     * @param {number} num number of steps to run, default is 1\n     * @param {Boolean} do_not_catch_errors [optional] if you want to try/catch errors\n     * @param {number} limit max number of nodes to execute (used to execute from start to a node)\n     */\n\n    LGraph.prototype.runStep = function(num, do_not_catch_errors, limit ) {\n        num = num || 1;\n\n        var start = LiteGraph.getTime();\n        this.globaltime = 0.001 * (start - this.starttime);\n\n        var nodes = this._nodes_executable\n            ? this._nodes_executable\n            : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        limit = limit || nodes.length;\n\n        if (do_not_catch_errors) {\n            //iterations\n            for (var i = 0; i < num; i++) {\n                for (var j = 0; j < limit; ++j) {\n                    var node = nodes[j];\n                    if (node.mode == LiteGraph.ALWAYS && node.onExecute) {\n                        //wrap node.onExecute();\n                        node.doExecute();\n                    }\n                }\n\n                this.fixedtime += this.fixedtime_lapse;\n                if (this.onExecuteStep) {\n                    this.onExecuteStep();\n                }\n            }\n\n            if (this.onAfterExecute) {\n                this.onAfterExecute();\n            }\n        } else {\n            try {\n                //iterations\n                for (var i = 0; i < num; i++) {\n                    for (var j = 0; j < limit; ++j) {\n                        var node = nodes[j];\n                        if (node.mode == LiteGraph.ALWAYS && node.onExecute) {\n                            node.onExecute();\n                        }\n                    }\n\n                    this.fixedtime += this.fixedtime_lapse;\n                    if (this.onExecuteStep) {\n                        this.onExecuteStep();\n                    }\n                }\n\n                if (this.onAfterExecute) {\n                    this.onAfterExecute();\n                }\n                this.errors_in_execution = false;\n            } catch (err) {\n                this.errors_in_execution = true;\n                if (LiteGraph.throw_errors) {\n                    throw err;\n                }\n                if (LiteGraph.debug) {\n                    console.log(\"Error during execution: \" + err);\n                }\n                this.stop();\n            }\n        }\n\n        var now = LiteGraph.getTime();\n        var elapsed = now - start;\n        if (elapsed == 0) {\n            elapsed = 1;\n        }\n        this.execution_time = 0.001 * elapsed;\n        this.globaltime += 0.001 * elapsed;\n        this.iteration += 1;\n        this.elapsed_time = (now - this.last_update_time) * 0.001;\n        this.last_update_time = now;\n        this.nodes_executing = [];\n        this.nodes_actioning = [];\n        this.nodes_executedAction = [];\n    };\n\n    /**\n     * Updates the graph execution order according to relevance of the nodes (nodes with only outputs have more relevance than\n     * nodes with only inputs.\n     * @method updateExecutionOrder\n     */\n    LGraph.prototype.updateExecutionOrder = function() {\n        this._nodes_in_order = this.computeExecutionOrder(false);\n        this._nodes_executable = [];\n        for (var i = 0; i < this._nodes_in_order.length; ++i) {\n            if (this._nodes_in_order[i].onExecute) {\n                this._nodes_executable.push(this._nodes_in_order[i]);\n            }\n        }\n    };\n\n    //This is more internal, it computes the executable nodes in order and returns it\n    LGraph.prototype.computeExecutionOrder = function(\n        only_onExecute,\n        set_level\n    ) {\n        var L = [];\n        var S = [];\n        var M = {};\n        var visited_links = {}; //to avoid repeating links\n        var remaining_links = {}; //to a\n\n        //search for the nodes without inputs (starting nodes)\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            var node = this._nodes[i];\n            if (only_onExecute && !node.onExecute) {\n                continue;\n            }\n\n            M[node.id] = node; //add to pending nodes\n\n            var num = 0; //num of input connections\n            if (node.inputs) {\n                for (var j = 0, l2 = node.inputs.length; j < l2; j++) {\n                    if (node.inputs[j] && node.inputs[j].link != null) {\n                        num += 1;\n                    }\n                }\n            }\n\n            if (num == 0) {\n                //is a starting node\n                S.push(node);\n                if (set_level) {\n                    node._level = 1;\n                }\n            } //num of input links\n            else {\n                if (set_level) {\n                    node._level = 0;\n                }\n                remaining_links[node.id] = num;\n            }\n        }\n\n        while (true) {\n            if (S.length == 0) {\n                break;\n            }\n\n            //get an starting node\n            var node = S.shift();\n            L.push(node); //add to ordered list\n            delete M[node.id]; //remove from the pending nodes\n\n            if (!node.outputs) {\n                continue;\n            }\n\n            //for every output\n            for (var i = 0; i < node.outputs.length; i++) {\n                var output = node.outputs[i];\n                //not connected\n                if (\n                    output == null ||\n                    output.links == null ||\n                    output.links.length == 0\n                ) {\n                    continue;\n                }\n\n                //for every connection\n                for (var j = 0; j < output.links.length; j++) {\n                    var link_id = output.links[j];\n                    var link = this.links[link_id];\n                    if (!link) {\n                        continue;\n                    }\n\n                    //already visited link (ignore it)\n                    if (visited_links[link.id]) {\n                        continue;\n                    }\n\n                    var target_node = this.getNodeById(link.target_id);\n                    if (target_node == null) {\n                        visited_links[link.id] = true;\n                        continue;\n                    }\n\n                    if (\n                        set_level &&\n                        (!target_node._level ||\n                            target_node._level <= node._level)\n                    ) {\n                        target_node._level = node._level + 1;\n                    }\n\n                    visited_links[link.id] = true; //mark as visited\n                    remaining_links[target_node.id] -= 1; //reduce the number of links remaining\n                    if (remaining_links[target_node.id] == 0) {\n                        S.push(target_node);\n                    } //if no more links, then add to starters array\n                }\n            }\n        }\n\n        //the remaining ones (loops)\n        for (var i in M) {\n            L.push(M[i]);\n        }\n\n        if (L.length != this._nodes.length && LiteGraph.debug) {\n            console.warn(\"something went wrong, nodes missing\");\n        }\n\n        var l = L.length;\n\n        //save order number in the node\n        for (var i = 0; i < l; ++i) {\n            L[i].order = i;\n        }\n\n        //sort now by priority\n        L = L.sort(function(A, B) {\n            var Ap = A.constructor.priority || A.priority || 0;\n            var Bp = B.constructor.priority || B.priority || 0;\n            if (Ap == Bp) {\n                //if same priority, sort by order\n                return A.order - B.order;\n            }\n            return Ap - Bp; //sort by priority\n        });\n\n        //save order number in the node, again...\n        for (var i = 0; i < l; ++i) {\n            L[i].order = i;\n        }\n\n        return L;\n    };\n\n    /**\n     * Returns all the nodes that could affect this one (ancestors) by crawling all the inputs recursively.\n     * It doesn't include the node itself\n     * @method getAncestors\n     * @return {Array} an array with all the LGraphNodes that affect this node, in order of execution\n     */\n    LGraph.prototype.getAncestors = function(node) {\n        var ancestors = [];\n        var pending = [node];\n        var visited = {};\n\n        while (pending.length) {\n            var current = pending.shift();\n            if (!current.inputs) {\n                continue;\n            }\n            if (!visited[current.id] && current != node) {\n                visited[current.id] = true;\n                ancestors.push(current);\n            }\n\n            for (var i = 0; i < current.inputs.length; ++i) {\n                var input = current.getInputNode(i);\n                if (input && ancestors.indexOf(input) == -1) {\n                    pending.push(input);\n                }\n            }\n        }\n\n        ancestors.sort(function(a, b) {\n            return a.order - b.order;\n        });\n        return ancestors;\n    };\n\n    /**\n     * Positions every node in a more readable manner\n     * @method arrange\n     */\n    LGraph.prototype.arrange = function (margin, layout) {\n        margin = margin || 100;\n\n        const nodes = this.computeExecutionOrder(false, true);\n        const columns = [];\n        for (let i = 0; i < nodes.length; ++i) {\n            const node = nodes[i];\n            const col = node._level || 1;\n            if (!columns[col]) {\n                columns[col] = [];\n            }\n            columns[col].push(node);\n        }\n\n        let x = margin;\n\n        for (let i = 0; i < columns.length; ++i) {\n            const column = columns[i];\n            if (!column) {\n                continue;\n            }\n            let max_size = 100;\n            let y = margin + LiteGraph.NODE_TITLE_HEIGHT;\n            for (let j = 0; j < column.length; ++j) {\n                const node = column[j];\n                node.pos[0] = (layout == LiteGraph.VERTICAL_LAYOUT) ? y : x;\n                node.pos[1] = (layout == LiteGraph.VERTICAL_LAYOUT) ? x : y;\n                const max_size_index = (layout == LiteGraph.VERTICAL_LAYOUT) ? 1 : 0;\n                if (node.size[max_size_index] > max_size) {\n                    max_size = node.size[max_size_index];\n                }\n                const node_size_index = (layout == LiteGraph.VERTICAL_LAYOUT) ? 0 : 1;\n                y += node.size[node_size_index] + margin + LiteGraph.NODE_TITLE_HEIGHT;\n            }\n            x += max_size + margin;\n        }\n\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * Returns the amount of time the graph has been running in milliseconds\n     * @method getTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n    LGraph.prototype.getTime = function() {\n        return this.globaltime;\n    };\n\n    /**\n     * Returns the amount of time accumulated using the fixedtime_lapse var. This is used in context where the time increments should be constant\n     * @method getFixedTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n\n    LGraph.prototype.getFixedTime = function() {\n        return this.fixedtime;\n    };\n\n    /**\n     * Returns the amount of time it took to compute the latest iteration. Take into account that this number could be not correct\n     * if the nodes are using graphical actions\n     * @method getElapsedTime\n     * @return {number} number of milliseconds it took the last cycle\n     */\n\n    LGraph.prototype.getElapsedTime = function() {\n        return this.elapsed_time;\n    };\n\n    /**\n     * Sends an event to all the nodes, useful to trigger stuff\n     * @method sendEventToAllNodes\n     * @param {String} eventname the name of the event (function to be called)\n     * @param {Array} params parameters in array format\n     */\n    LGraph.prototype.sendEventToAllNodes = function(eventname, params, mode) {\n        mode = mode || LiteGraph.ALWAYS;\n\n        var nodes = this._nodes_in_order ? this._nodes_in_order : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        for (var j = 0, l = nodes.length; j < l; ++j) {\n            var node = nodes[j];\n\n            if (\n                node.constructor === LiteGraph.Subgraph &&\n                eventname != \"onExecute\"\n            ) {\n                if (node.mode == mode) {\n                    node.sendEventToAllNodes(eventname, params, mode);\n                }\n                continue;\n            }\n\n            if (!node[eventname] || node.mode != mode) {\n                continue;\n            }\n            if (params === undefined) {\n                node[eventname]();\n            } else if (params && params.constructor === Array) {\n                node[eventname].apply(node, params);\n            } else {\n                node[eventname](params);\n            }\n        }\n    };\n\n    LGraph.prototype.sendActionToCanvas = function(action, params) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            var c = this.list_of_graphcanvas[i];\n            if (c[action]) {\n                c[action].apply(c, params);\n            }\n        }\n    };\n\n    /**\n     * Adds a new node instance to this graph\n     * @method add\n     * @param {LGraphNode} node the instance of the node\n     */\n\n    LGraph.prototype.add = function(node, skip_compute_order) {\n        if (!node) {\n            return;\n        }\n\n        //groups\n        if (node.constructor === LGraphGroup) {\n            this._groups.push(node);\n            this.setDirtyCanvas(true);\n            this.change();\n            node.graph = this;\n            this._version++;\n            return;\n        }\n\n        //nodes\n        if (node.id != -1 && this._nodes_by_id[node.id] != null) {\n            console.warn(\n                \"LiteGraph: there is already a node with this ID, changing it\"\n            );\n            if (LiteGraph.use_uuids) {\n                node.id = LiteGraph.uuidv4();\n            }\n            else {\n                node.id = ++this.last_node_id;\n            }\n        }\n\n        if (this._nodes.length >= LiteGraph.MAX_NUMBER_OF_NODES) {\n            throw \"LiteGraph: max number of nodes in a graph reached\";\n        }\n\n        //give him an id\n        if (LiteGraph.use_uuids) {\n            if (node.id == null || node.id == -1)\n                node.id = LiteGraph.uuidv4();\n        }\n        else {\n            if (node.id == null || node.id == -1) {\n                node.id = ++this.last_node_id;\n            } else if (this.last_node_id < node.id) {\n                this.last_node_id = node.id;\n            }\n        }\n\n        node.graph = this;\n        this._version++;\n\n        this._nodes.push(node);\n        this._nodes_by_id[node.id] = node;\n\n        if (node.onAdded) {\n            node.onAdded(this);\n        }\n\n        if (this.config.align_to_grid) {\n            node.alignToGrid();\n        }\n\n        if (!skip_compute_order) {\n            this.updateExecutionOrder();\n        }\n\n        if (this.onNodeAdded) {\n            this.onNodeAdded(node);\n        }\n\n        this.setDirtyCanvas(true);\n        this.change();\n\n        return node; //to chain actions\n    };\n\n    /**\n     * Removes a node from the graph\n     * @method remove\n     * @param {LGraphNode} node the instance of the node\n     */\n\n    LGraph.prototype.remove = function(node) {\n        if (node.constructor === LiteGraph.LGraphGroup) {\n            var index = this._groups.indexOf(node);\n            if (index != -1) {\n                this._groups.splice(index, 1);\n            }\n            node.graph = null;\n            this._version++;\n            this.setDirtyCanvas(true, true);\n            this.change();\n            return;\n        }\n\n        if (this._nodes_by_id[node.id] == null) {\n            return;\n        } //not found\n\n        if (node.ignore_remove) {\n            return;\n        } //cannot be removed\n\n        this.beforeChange(); //sure? - almost sure is wrong\n\n        //disconnect inputs\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; i++) {\n                var slot = node.inputs[i];\n                if (slot.link != null) {\n                    node.disconnectInput(i);\n                }\n            }\n        }\n\n        //disconnect outputs\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; i++) {\n                var slot = node.outputs[i];\n                if (slot.links != null && slot.links.length) {\n                    node.disconnectOutput(i);\n                }\n            }\n        }\n\n        //node.id = -1; //why?\n\n        //callback\n        if (node.onRemoved) {\n            node.onRemoved();\n        }\n\n        node.graph = null;\n        this._version++;\n\n        //remove from canvas render\n        if (this.list_of_graphcanvas) {\n            for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n                var canvas = this.list_of_graphcanvas[i];\n                if (canvas.selected_nodes[node.id]) {\n                    delete canvas.selected_nodes[node.id];\n                }\n                if (canvas.node_dragged == node) {\n                    canvas.node_dragged = null;\n                }\n            }\n        }\n\n        //remove from containers\n        var pos = this._nodes.indexOf(node);\n        if (pos != -1) {\n            this._nodes.splice(pos, 1);\n        }\n        delete this._nodes_by_id[node.id];\n\n        if (this.onNodeRemoved) {\n            this.onNodeRemoved(node);\n        }\n\n        //close panels\n        this.sendActionToCanvas(\"checkPanels\");\n\n        this.setDirtyCanvas(true, true);\n        this.afterChange(); //sure? - almost sure is wrong\n        this.change();\n\n        this.updateExecutionOrder();\n    };\n\n    /**\n     * Returns a node by its id.\n     * @method getNodeById\n     * @param {Number} id\n     */\n\n    LGraph.prototype.getNodeById = function(id) {\n        if (id == null) {\n            return null;\n        }\n        return this._nodes_by_id[id];\n    };\n\n    /**\n     * Returns a list of nodes that matches a class\n     * @method findNodesByClass\n     * @param {Class} classObject the class itself (not an string)\n     * @return {Array} a list with all the nodes of this type\n     */\n    LGraph.prototype.findNodesByClass = function(classObject, result) {\n        result = result || [];\n        result.length = 0;\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].constructor === classObject) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns a list of nodes that matches a type\n     * @method findNodesByType\n     * @param {String} type the name of the node type\n     * @return {Array} a list with all the nodes of this type\n     */\n    LGraph.prototype.findNodesByType = function(type, result) {\n        var type = type.toLowerCase();\n        result = result || [];\n        result.length = 0;\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].type.toLowerCase() == type) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns the first node that matches a name in its title\n     * @method findNodeByTitle\n     * @param {String} name the name of the node to search\n     * @return {Node} the node or null\n     */\n    LGraph.prototype.findNodeByTitle = function(title) {\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].title == title) {\n                return this._nodes[i];\n            }\n        }\n        return null;\n    };\n\n    /**\n     * Returns a list of nodes that matches a name\n     * @method findNodesByTitle\n     * @param {String} name the name of the node to search\n     * @return {Array} a list with all the nodes with this name\n     */\n    LGraph.prototype.findNodesByTitle = function(title) {\n        var result = [];\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].title == title) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns the top-most node in this position of the canvas\n     * @method getNodeOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @param {Array} nodes_list a list with all the nodes to search from, by default is all the nodes in the graph\n     * @return {LGraphNode} the node at this position or null\n     */\n    LGraph.prototype.getNodeOnPos = function(x, y, nodes_list, margin) {\n        nodes_list = nodes_list || this._nodes;\n        var nRet = null;\n        for (var i = nodes_list.length - 1; i >= 0; i--) {\n            var n = nodes_list[i];\n            var skip_title = n.constructor.title_mode == LiteGraph.NO_TITLE;\n            if (n.isPointInside(x, y, margin, skip_title)) {\n                // check for lesser interest nodes (TODO check for overlapping, use the top)\n                /*if (typeof n == \"LGraphGroup\"){\n                    nRet = n;\n                }else{*/\n                return n;\n                /*}*/\n            }\n        }\n        return nRet;\n    };\n\n    /**\n     * Returns the top-most group in that position\n     * @method getGroupOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @return {LGraphGroup} the group or null\n     */\n    LGraph.prototype.getGroupOnPos = function(x, y) {\n        for (var i = this._groups.length - 1; i >= 0; i--) {\n            var g = this._groups[i];\n            if (g.isPointInside(x, y, 2, true)) {\n                return g;\n            }\n        }\n        return null;\n    };\n\n    /**\n     * Checks that the node type matches the node type registered, used when replacing a nodetype by a newer version during execution\n     * this replaces the ones using the old version with the new version\n     * @method checkNodeTypes\n     */\n    LGraph.prototype.checkNodeTypes = function() {\n        var changes = false;\n        for (var i = 0; i < this._nodes.length; i++) {\n            var node = this._nodes[i];\n            var ctor = LiteGraph.registered_node_types[node.type];\n            if (node.constructor == ctor) {\n                continue;\n            }\n            console.log(\"node being replaced by newer version: \" + node.type);\n            var newnode = LiteGraph.createNode(node.type);\n            changes = true;\n            this._nodes[i] = newnode;\n            newnode.configure(node.serialize());\n            newnode.graph = this;\n            this._nodes_by_id[newnode.id] = newnode;\n            if (node.inputs) {\n                newnode.inputs = node.inputs.concat();\n            }\n            if (node.outputs) {\n                newnode.outputs = node.outputs.concat();\n            }\n        }\n        this.updateExecutionOrder();\n    };\n\n    // ********** GLOBALS *****************\n\n    LGraph.prototype.onAction = function(action, param, options) {\n        this._input_nodes = this.findNodesByClass(\n            LiteGraph.GraphInput,\n            this._input_nodes\n        );\n        for (var i = 0; i < this._input_nodes.length; ++i) {\n            var node = this._input_nodes[i];\n            if (node.properties.name != action) {\n                continue;\n            }\n            //wrap node.onAction(action, param);\n            node.actionDo(action, param, options);\n            break;\n        }\n    };\n\n    LGraph.prototype.trigger = function(action, param) {\n        if (this.onTrigger) {\n            this.onTrigger(action, param);\n        }\n    };\n\n    /**\n     * Tell this graph it has a global graph input of this type\n     * @method addGlobalInput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value [optional]\n     */\n    LGraph.prototype.addInput = function(name, type, value) {\n        var input = this.inputs[name];\n        if (input) {\n            //already exist\n            return;\n        }\n\n        this.beforeChange();\n        this.inputs[name] = { name: name, type: type, value: value };\n        this._version++;\n        this.afterChange();\n\n        if (this.onInputAdded) {\n            this.onInputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Assign a data to the global graph input\n     * @method setGlobalInputData\n     * @param {String} name\n     * @param {*} data\n     */\n    LGraph.prototype.setInputData = function(name, data) {\n        var input = this.inputs[name];\n        if (!input) {\n            return;\n        }\n        input.value = data;\n    };\n\n    /**\n     * Returns the current value of a global graph input\n     * @method getInputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    LGraph.prototype.getInputData = function(name) {\n        var input = this.inputs[name];\n        if (!input) {\n            return null;\n        }\n        return input.value;\n    };\n\n    /**\n     * Changes the name of a global graph input\n     * @method renameInput\n     * @param {String} old_name\n     * @param {String} new_name\n     */\n    LGraph.prototype.renameInput = function(old_name, name) {\n        if (name == old_name) {\n            return;\n        }\n\n        if (!this.inputs[old_name]) {\n            return false;\n        }\n\n        if (this.inputs[name]) {\n            console.error(\"there is already one input with that name\");\n            return false;\n        }\n\n        this.inputs[name] = this.inputs[old_name];\n        delete this.inputs[old_name];\n        this._version++;\n\n        if (this.onInputRenamed) {\n            this.onInputRenamed(old_name, name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Changes the type of a global graph input\n     * @method changeInputType\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.changeInputType = function(name, type) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        if (\n            this.inputs[name].type &&\n            String(this.inputs[name].type).toLowerCase() ==\n            String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.inputs[name].type = type;\n        this._version++;\n        if (this.onInputTypeChanged) {\n            this.onInputTypeChanged(name, type);\n        }\n    };\n\n    /**\n     * Removes a global graph input\n     * @method removeInput\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.removeInput = function(name) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        delete this.inputs[name];\n        this._version++;\n\n        if (this.onInputRemoved) {\n            this.onInputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    };\n\n    /**\n     * Creates a global graph output\n     * @method addOutput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value\n     */\n    LGraph.prototype.addOutput = function(name, type, value) {\n        this.outputs[name] = { name: name, type: type, value: value };\n        this._version++;\n\n        if (this.onOutputAdded) {\n            this.onOutputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Assign a data to the global output\n     * @method setOutputData\n     * @param {String} name\n     * @param {String} value\n     */\n    LGraph.prototype.setOutputData = function(name, value) {\n        var output = this.outputs[name];\n        if (!output) {\n            return;\n        }\n        output.value = value;\n    };\n\n    /**\n     * Returns the current value of a global graph output\n     * @method getOutputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    LGraph.prototype.getOutputData = function(name) {\n        var output = this.outputs[name];\n        if (!output) {\n            return null;\n        }\n        return output.value;\n    };\n\n    /**\n     * Renames a global graph output\n     * @method renameOutput\n     * @param {String} old_name\n     * @param {String} new_name\n     */\n    LGraph.prototype.renameOutput = function(old_name, name) {\n        if (!this.outputs[old_name]) {\n            return false;\n        }\n\n        if (this.outputs[name]) {\n            console.error(\"there is already one output with that name\");\n            return false;\n        }\n\n        this.outputs[name] = this.outputs[old_name];\n        delete this.outputs[old_name];\n        this._version++;\n\n        if (this.onOutputRenamed) {\n            this.onOutputRenamed(old_name, name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Changes the type of a global graph output\n     * @method changeOutputType\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.changeOutputType = function(name, type) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n\n        if (\n            this.outputs[name].type &&\n            String(this.outputs[name].type).toLowerCase() ==\n            String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.outputs[name].type = type;\n        this._version++;\n        if (this.onOutputTypeChanged) {\n            this.onOutputTypeChanged(name, type);\n        }\n    };\n\n    /**\n     * Removes a global graph output\n     * @method removeOutput\n     * @param {String} name\n     */\n    LGraph.prototype.removeOutput = function(name) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n        delete this.outputs[name];\n        this._version++;\n\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    };\n\n    LGraph.prototype.triggerInput = function(name, value) {\n        var nodes = this.findNodesByTitle(name);\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].onTrigger(value);\n        }\n    };\n\n    LGraph.prototype.setCallback = function(name, func) {\n        var nodes = this.findNodesByTitle(name);\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].setTrigger(func);\n        }\n    };\n\n    //used for undo, called before any change is made to the graph\n    LGraph.prototype.beforeChange = function(info) {\n        if (this.onBeforeChange) {\n            this.onBeforeChange(this,info);\n        }\n        this.sendActionToCanvas(\"onBeforeChange\", this);\n    };\n\n    //used to resend actions, called after any change is made to the graph\n    LGraph.prototype.afterChange = function(info) {\n        if (this.onAfterChange) {\n            this.onAfterChange(this,info);\n        }\n        this.sendActionToCanvas(\"onAfterChange\", this);\n    };\n\n    LGraph.prototype.connectionChange = function(node, link_info) {\n        this.updateExecutionOrder();\n        if (this.onConnectionChange) {\n            this.onConnectionChange(node);\n        }\n        this._version++;\n        this.sendActionToCanvas(\"onConnectionChange\");\n    };\n\n    /**\n     * returns if the graph is in live mode\n     * @method isLive\n     */\n\n    LGraph.prototype.isLive = function() {\n        if (!this.list_of_graphcanvas) {\n            return false;\n        }\n\n        for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            var c = this.list_of_graphcanvas[i];\n            if (c.live_mode) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * clears the triggered slot animation in all links (stop visual animation)\n     * @method clearTriggeredSlots\n     */\n    LGraph.prototype.clearTriggeredSlots = function() {\n        for (var i in this.links) {\n            var link_info = this.links[i];\n            if (!link_info) {\n                continue;\n            }\n            if (link_info._last_time) {\n                link_info._last_time = 0;\n            }\n        }\n    };\n\n    /* Called when something visually changed (not the graph!) */\n    LGraph.prototype.change = function() {\n        if (LiteGraph.debug) {\n            console.log(\"Graph changed\");\n        }\n        this.sendActionToCanvas(\"setDirty\", [true, true]);\n        if (this.on_change) {\n            this.on_change(this);\n        }\n    };\n\n    LGraph.prototype.setDirtyCanvas = function(fg, bg) {\n        this.sendActionToCanvas(\"setDirty\", [fg, bg]);\n    };\n\n    /**\n     * Destroys a link\n     * @method removeLink\n     * @param {Number} link_id\n     */\n    LGraph.prototype.removeLink = function(link_id) {\n        var link = this.links[link_id];\n        if (!link) {\n            return;\n        }\n        var node = this.getNodeById(link.target_id);\n        if (node) {\n            node.disconnectInput(link.target_slot);\n        }\n    };\n\n    //save and recover app state ***************************************\n    /**\n     * Creates a Object containing all the info about this graph, it can be serialized\n     * @method serialize\n     * @return {Object} value of the node\n     */\n    LGraph.prototype.serialize = function() {\n        var nodes_info = [];\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            nodes_info.push(this._nodes[i].serialize());\n        }\n\n        //pack link info into a non-verbose format\n        var links = [];\n        for (var i in this.links) {\n            //links is an OBJECT\n            var link = this.links[i];\n            if (!link.serialize) {\n                //weird bug I havent solved yet\n                console.warn(\n                    \"weird LLink bug, link info is not a LLink but a regular object\"\n                );\n                var link2 = new LLink();\n                for (var j in link) {\n                    link2[j] = link[j];\n                }\n                this.links[i] = link2;\n                link = link2;\n            }\n\n            links.push(link.serialize());\n        }\n\n        var groups_info = [];\n        for (var i = 0; i < this._groups.length; ++i) {\n            groups_info.push(this._groups[i].serialize());\n        }\n\n        var data = {\n            last_node_id: this.last_node_id,\n            last_link_id: this.last_link_id,\n            nodes: nodes_info,\n            links: links,\n            groups: groups_info,\n            config: this.config,\n            extra: this.extra,\n            version: LiteGraph.VERSION\n        };\n\n        if(this.onSerialize)\n            this.onSerialize(data);\n\n        return data;\n    };\n\n    /**\n     * Configure a graph from a JSON string\n     * @method configure\n     * @param {String} str configure a graph from a JSON string\n     * @param {Boolean} returns if there was any error parsing\n     */\n    LGraph.prototype.configure = function(data, keep_old) {\n        if (!data) {\n            return;\n        }\n\n        if (!keep_old) {\n            this.clear();\n        }\n\n        var nodes = data.nodes;\n\n        //decode links info (they are very verbose)\n        if (data.links && data.links.constructor === Array) {\n            var links = [];\n            for (var i = 0; i < data.links.length; ++i) {\n                var link_data = data.links[i];\n                if(!link_data) //weird bug\n                {\n                    console.warn(\"serialized graph link data contains errors, skipping.\");\n                    continue;\n                }\n                var link = new LLink();\n                link.configure(link_data);\n                links[link.id] = link;\n            }\n            data.links = links;\n        }\n\n        //copy all stored fields\n        for (var i in data) {\n            if(i == \"nodes\" || i == \"groups\" ) //links must be accepted\n                continue;\n            this[i] = data[i];\n        }\n\n        var error = false;\n\n        //create nodes\n        this._nodes = [];\n        if (nodes) {\n            for (var i = 0, l = nodes.length; i < l; ++i) {\n                var n_info = nodes[i]; //stored info\n                var node = LiteGraph.createNode(n_info.type, n_info.title);\n                if (!node) {\n                    if (LiteGraph.debug) {\n                        console.log(\n                            \"Node not found or has errors: \" + n_info.type\n                        );\n                    }\n\n                    //in case of error we create a replacement node to avoid losing info\n                    node = new LGraphNode();\n                    node.last_serialization = n_info;\n                    node.has_errors = true;\n                    error = true;\n                    //continue;\n                }\n\n                node.id = n_info.id; //id it or it will create a new id\n                this.add(node, true); //add before configure, otherwise configure cannot create links\n            }\n\n            //configure nodes afterwards so they can reach each other\n            for (var i = 0, l = nodes.length; i < l; ++i) {\n                var n_info = nodes[i];\n                var node = this.getNodeById(n_info.id);\n                if (node) {\n                    node.configure(n_info);\n                }\n            }\n        }\n\n        //groups\n        this._groups.length = 0;\n        if (data.groups) {\n            for (var i = 0; i < data.groups.length; ++i) {\n                var group = new LiteGraph.LGraphGroup();\n                group.configure(data.groups[i]);\n                this.add(group);\n            }\n        }\n\n        this.updateExecutionOrder();\n\n        this.extra = data.extra || {};\n\n        if(this.onConfigure)\n            this.onConfigure(data);\n\n        this._version++;\n        this.setDirtyCanvas(true, true);\n        return error;\n    };\n\n    LGraph.prototype.load = function(url, callback) {\n        var that = this;\n\n        //from file\n        if(url.constructor === File || url.constructor === Blob)\n        {\n            var reader = new FileReader();\n            reader.addEventListener('load', function(event) {\n                var data = JSON.parse(event.target.result);\n                that.configure(data);\n                if(callback)\n                    callback();\n            });\n\n            reader.readAsText(url);\n            return;\n        }\n\n        //is a string, then an URL\n        var req = new XMLHttpRequest();\n        req.open(\"GET\", url, true);\n        req.send(null);\n        req.onload = function(oEvent) {\n            if (req.status !== 200) {\n                console.error(\"Error loading graph:\", req.status, req.response);\n                return;\n            }\n            var data = JSON.parse( req.response );\n            that.configure(data);\n            if(callback)\n                callback();\n        };\n        req.onerror = function(err) {\n            console.error(\"Error loading graph:\", err);\n        };\n    };\n\n    LGraph.prototype.onNodeTrace = function(node, msg, color) {\n        //TODO\n    };\n\n    //this is the class in charge of storing link information\n    function LLink(id, type, origin_id, origin_slot, target_id, target_slot) {\n        this.id = id;\n        this.type = type;\n        this.origin_id = origin_id;\n        this.origin_slot = origin_slot;\n        this.target_id = target_id;\n        this.target_slot = target_slot;\n\n        this._data = null;\n        this._pos = new Float32Array(2); //center\n    }\n\n    LLink.prototype.configure = function(o) {\n        if (o.constructor === Array) {\n            this.id = o[0];\n            this.origin_id = o[1];\n            this.origin_slot = o[2];\n            this.target_id = o[3];\n            this.target_slot = o[4];\n            this.type = o[5];\n        } else {\n            this.id = o.id;\n            this.type = o.type;\n            this.origin_id = o.origin_id;\n            this.origin_slot = o.origin_slot;\n            this.target_id = o.target_id;\n            this.target_slot = o.target_slot;\n        }\n    };\n\n    LLink.prototype.serialize = function() {\n        return [\n            this.id,\n            this.origin_id,\n            this.origin_slot,\n            this.target_id,\n            this.target_slot,\n            this.type\n        ];\n    };\n\n    LiteGraph.LLink = LLink;\n\n    // *************************************************************\n    //   Node CLASS                                          *******\n    // *************************************************************\n\n    /*\n\ttitle: string\n\tpos: [x,y]\n\tsize: [x,y]\n\n\tinput|output: every connection\n\t\t+  { name:string, type:string, pos: [x,y]=Optional, direction: \"input\"|\"output\", links: Array });\n\n\tgeneral properties:\n\t\t+ clip_area: if you render outside the node, it will be clipped\n\t\t+ unsafe_execution: not allowed for safe execution\n\t\t+ skip_repeated_outputs: when adding new outputs, it wont show if there is one already connected\n\t\t+ resizable: if set to false it wont be resizable with the mouse\n\t\t+ horizontal: slots are distributed horizontally\n\t\t+ widgets_start_y: widgets start at y distance from the top of the node\n\n\tflags object:\n\t\t+ collapsed: if it is collapsed\n\n\tsupported callbacks:\n\t\t+ onAdded: when added to graph (warning: this is called BEFORE the node is configured when loading)\n\t\t+ onRemoved: when removed from graph\n\t\t+ onStart:\twhen the graph starts playing\n\t\t+ onStop:\twhen the graph stops playing\n\t\t+ onDrawForeground: render the inside widgets inside the node\n\t\t+ onDrawBackground: render the background area inside the node (only in edit mode)\n\t\t+ onMouseDown\n\t\t+ onMouseMove\n\t\t+ onMouseUp\n\t\t+ onMouseEnter\n\t\t+ onMouseLeave\n\t\t+ onExecute: execute the node\n\t\t+ onPropertyChanged: when a property is changed in the panel (return true to skip default behaviour)\n\t\t+ onGetInputs: returns an array of possible inputs\n\t\t+ onGetOutputs: returns an array of possible outputs\n\t\t+ onBounding: in case this node has a bigger bounding than the node itself (the callback receives the bounding as [x,y,w,h])\n\t\t+ onDblClick: double clicked in the node\n\t\t+ onInputDblClick: input slot double clicked (can be used to automatically create a node connected)\n\t\t+ onOutputDblClick: output slot double clicked (can be used to automatically create a node connected)\n\t\t+ onConfigure: called after the node has been configured\n\t\t+ onSerialize: to add extra info when serializing (the callback receives the object that should be filled with the data)\n\t\t+ onSelected\n\t\t+ onDeselected\n\t\t+ onDropItem : DOM item dropped over the node\n\t\t+ onDropFile : file dropped over the node\n\t\t+ onConnectInput : if returns false the incoming connection will be canceled\n\t\t+ onConnectionsChange : a connection changed (new one or removed) (LiteGraph.INPUT or LiteGraph.OUTPUT, slot, true if connected, link_info, input_info )\n\t\t+ onAction: action slot triggered\n\t\t+ getExtraMenuOptions: to add option to context menu\n*/\n\n    /**\n     * Base Class for all the node type classes\n     * @class LGraphNode\n     * @param {String} name a name for the node\n     */\n\n    function LGraphNode(title) {\n        this._ctor(title);\n    }\n\n    global.LGraphNode = LiteGraph.LGraphNode = LGraphNode;\n\n    LGraphNode.prototype._ctor = function(title) {\n        this.title = title || \"Unnamed\";\n        this.size = [LiteGraph.NODE_WIDTH, 60];\n        this.graph = null;\n\n        this._pos = new Float32Array(10, 10);\n\n        Object.defineProperty(this, \"pos\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get: function() {\n                return this._pos;\n            },\n            enumerable: true\n        });\n\n        if (LiteGraph.use_uuids) {\n            this.id = LiteGraph.uuidv4();\n        }\n        else {\n            this.id = -1; //not know till not added\n        }\n        this.type = null;\n\n        //inputs available: array of inputs\n        this.inputs = [];\n        this.outputs = [];\n        this.connections = [];\n\n        //local data\n        this.properties = {}; //for the values\n        this.properties_info = []; //for the info\n\n        this.flags = {};\n    };\n\n    /**\n     * configure a node from an object containing the serialized info\n     * @method configure\n     */\n    LGraphNode.prototype.configure = function(info) {\n        if (this.graph) {\n            this.graph._version++;\n        }\n        for (var j in info) {\n            if (j == \"properties\") {\n                //i don't want to clone properties, I want to reuse the old container\n                for (var k in info.properties) {\n                    this.properties[k] = info.properties[k];\n                    if (this.onPropertyChanged) {\n                        this.onPropertyChanged( k, info.properties[k] );\n                    }\n                }\n                continue;\n            }\n\n            if (info[j] == null) {\n                continue;\n            } else if (typeof info[j] == \"object\") {\n                //object\n                if (this[j] && this[j].configure) {\n                    this[j].configure(info[j]);\n                } else {\n                    this[j] = LiteGraph.cloneObject(info[j], this[j]);\n                }\n            } //value\n            else {\n                this[j] = info[j];\n            }\n        }\n\n        if (!info.title) {\n            this.title = this.constructor.title;\n        }\n\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; ++i) {\n                var input = this.inputs[i];\n                var link_info = this.graph ? this.graph.links[input.link] : null;\n                if (this.onConnectionsChange)\n                    this.onConnectionsChange( LiteGraph.INPUT, i, true, link_info, input ); //link_info has been created now, so its updated\n\n                if( this.onInputAdded )\n                    this.onInputAdded(input);\n\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; ++i) {\n                var output = this.outputs[i];\n                if (!output.links) {\n                    continue;\n                }\n                for (var j = 0; j < output.links.length; ++j) {\n                    var link_info = this.graph \t? this.graph.links[output.links[j]] : null;\n                    if (this.onConnectionsChange)\n                        this.onConnectionsChange( LiteGraph.OUTPUT, i, true, link_info, output ); //link_info has been created now, so its updated\n                }\n\n                if( this.onOutputAdded )\n                    this.onOutputAdded(output);\n            }\n        }\n\n        if( this.widgets )\n        {\n            for (var i = 0; i < this.widgets.length; ++i)\n            {\n                var w = this.widgets[i];\n                if(!w)\n                    continue;\n                if(w.options && w.options.property && (this.properties[ w.options.property ] != undefined))\n                    w.value = JSON.parse( JSON.stringify( this.properties[ w.options.property ] ) );\n            }\n            if (info.widgets_values) {\n                for (var i = 0; i < info.widgets_values.length; ++i) {\n                    if (this.widgets[i]) {\n                        this.widgets[i].value = info.widgets_values[i];\n                    }\n                }\n            }\n        }\n\n        if (this.onConfigure) {\n            this.onConfigure(info);\n        }\n    };\n\n    /**\n     * serialize the content\n     * @method serialize\n     */\n\n    LGraphNode.prototype.serialize = function() {\n        //create serialization object\n        var o = {\n            id: this.id,\n            type: this.type,\n            pos: this.pos,\n            size: this.size,\n            flags: LiteGraph.cloneObject(this.flags),\n            order: this.order,\n            mode: this.mode\n        };\n\n        //special case for when there were errors\n        if (this.constructor === LGraphNode && this.last_serialization) {\n            return this.last_serialization;\n        }\n\n        if (this.inputs) {\n            o.inputs = this.inputs;\n        }\n\n        if (this.outputs) {\n            //clear outputs last data (because data in connections is never serialized but stored inside the outputs info)\n            for (var i = 0; i < this.outputs.length; i++) {\n                delete this.outputs[i]._data;\n            }\n            o.outputs = this.outputs;\n        }\n\n        if (this.title && this.title != this.constructor.title) {\n            o.title = this.title;\n        }\n\n        if (this.properties) {\n            o.properties = LiteGraph.cloneObject(this.properties);\n        }\n\n        if (this.widgets && this.serialize_widgets) {\n            o.widgets_values = [];\n            for (var i = 0; i < this.widgets.length; ++i) {\n                if(this.widgets[i])\n                    o.widgets_values[i] = this.widgets[i].value;\n                else\n                    o.widgets_values[i] = null;\n            }\n        }\n\n        if (!o.type) {\n            o.type = this.constructor.type;\n        }\n\n        if (this.color) {\n            o.color = this.color;\n        }\n        if (this.bgcolor) {\n            o.bgcolor = this.bgcolor;\n        }\n        if (this.boxcolor) {\n            o.boxcolor = this.boxcolor;\n        }\n        if (this.shape) {\n            o.shape = this.shape;\n        }\n\n        if (this.onSerialize) {\n            if (this.onSerialize(o)) {\n                console.warn(\n                    \"node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter\"\n                );\n            }\n        }\n\n        return o;\n    };\n\n    /* Creates a clone of this node */\n    LGraphNode.prototype.clone = function() {\n        var node = LiteGraph.createNode(this.type);\n        if (!node) {\n            return null;\n        }\n\n        //we clone it because serialize returns shared containers\n        var data = LiteGraph.cloneObject(this.serialize());\n\n        //remove links\n        if (data.inputs) {\n            for (var i = 0; i < data.inputs.length; ++i) {\n                data.inputs[i].link = null;\n            }\n        }\n\n        if (data.outputs) {\n            for (var i = 0; i < data.outputs.length; ++i) {\n                if (data.outputs[i].links) {\n                    data.outputs[i].links.length = 0;\n                }\n            }\n        }\n\n        delete data[\"id\"];\n\n        if (LiteGraph.use_uuids) {\n            data[\"id\"] = LiteGraph.uuidv4()\n        }\n\n        //remove links\n        node.configure(data);\n\n        return node;\n    };\n\n    /**\n     * serialize and stringify\n     * @method toString\n     */\n\n    LGraphNode.prototype.toString = function() {\n        return JSON.stringify(this.serialize());\n    };\n    //LGraphNode.prototype.deserialize = function(info) {} //this cannot be done from within, must be done in LiteGraph\n\n    /**\n     * get the title string\n     * @method getTitle\n     */\n\n    LGraphNode.prototype.getTitle = function() {\n        return this.title || this.constructor.title;\n    };\n\n    /**\n     * sets the value of a property\n     * @method setProperty\n     * @param {String} name\n     * @param {*} value\n     */\n    LGraphNode.prototype.setProperty = function(name, value) {\n        if (!this.properties) {\n            this.properties = {};\n        }\n        if( value === this.properties[name] )\n            return;\n        var prev_value = this.properties[name];\n        this.properties[name] = value;\n        if (this.onPropertyChanged) {\n            if( this.onPropertyChanged(name, value, prev_value) === false ) //abort change\n                this.properties[name] = prev_value;\n        }\n        if(this.widgets) //widgets could be linked to properties\n            for(var i = 0; i < this.widgets.length; ++i)\n            {\n                var w = this.widgets[i];\n                if(!w)\n                    continue;\n                if(w.options.property == name)\n                {\n                    w.value = value;\n                    break;\n                }\n            }\n    };\n\n    // Execution *************************\n    /**\n     * sets the output data\n     * @method setOutputData\n     * @param {number} slot\n     * @param {*} data\n     */\n    LGraphNode.prototype.setOutputData = function(slot, data) {\n        if (!this.outputs) {\n            return;\n        }\n\n        //this maybe slow and a niche case\n        //if(slot && slot.constructor === String)\n        //\tslot = this.findOutputSlot(slot);\n\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n\n        var output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n\n        //store data in the output itself in case we want to debug\n        output_info._data = data;\n\n        //if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (var i = 0; i < this.outputs[slot].links.length; i++) {\n                var link_id = this.outputs[slot].links[i];\n                var link = this.graph.links[link_id];\n                if(link)\n                    link.data = data;\n            }\n        }\n    };\n\n    /**\n     * sets the output data type, useful when you want to be able to overwrite the data type\n     * @method setOutputDataType\n     * @param {number} slot\n     * @param {String} datatype\n     */\n    LGraphNode.prototype.setOutputDataType = function(slot, type) {\n        if (!this.outputs) {\n            return;\n        }\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n        var output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n        //store data in the output itself in case we want to debug\n        output_info.type = type;\n\n        //if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (var i = 0; i < this.outputs[slot].links.length; i++) {\n                var link_id = this.outputs[slot].links[i];\n                this.graph.links[link_id].type = type;\n            }\n        }\n    };\n\n    /**\n     * Retrieves the input data (data traveling through the connection) from one slot\n     * @method getInputData\n     * @param {number} slot\n     * @param {boolean} force_update if set to true it will force the connected node of this slot to output data into this link\n     * @return {*} data or if it is not connected returns undefined\n     */\n    LGraphNode.prototype.getInputData = function(slot, force_update) {\n        if (!this.inputs) {\n            return;\n        } //undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return;\n        }\n\n        var link_id = this.inputs[slot].link;\n        var link = this.graph.links[link_id];\n        if (!link) {\n            //bug: weird case but it happens sometimes\n            return null;\n        }\n\n        if (!force_update) {\n            return link.data;\n        }\n\n        //special case: used to extract data from the incoming connection before the graph has been executed\n        var node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.data;\n        }\n\n        if (node.updateOutputData) {\n            node.updateOutputData(link.origin_slot);\n        } else if (node.onExecute) {\n            node.onExecute();\n        }\n\n        return link.data;\n    };\n\n    /**\n     * Retrieves the input data type (in case this supports multiple input types)\n     * @method getInputDataType\n     * @param {number} slot\n     * @return {String} datatype in string format\n     */\n    LGraphNode.prototype.getInputDataType = function(slot) {\n        if (!this.inputs) {\n            return null;\n        } //undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return null;\n        }\n        var link_id = this.inputs[slot].link;\n        var link = this.graph.links[link_id];\n        if (!link) {\n            //bug: weird case but it happens sometimes\n            return null;\n        }\n        var node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.type;\n        }\n        var output_info = node.outputs[link.origin_slot];\n        if (output_info) {\n            return output_info.type;\n        }\n        return null;\n    };\n\n    /**\n     * Retrieves the input data from one slot using its name instead of slot number\n     * @method getInputDataByName\n     * @param {String} slot_name\n     * @param {boolean} force_update if set to true it will force the connected node of this slot to output data into this link\n     * @return {*} data or if it is not connected returns null\n     */\n    LGraphNode.prototype.getInputDataByName = function(\n        slot_name,\n        force_update\n    ) {\n        var slot = this.findInputSlot(slot_name);\n        if (slot == -1) {\n            return null;\n        }\n        return this.getInputData(slot, force_update);\n    };\n\n    /**\n     * tells you if there is a connection in one input slot\n     * @method isInputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isInputConnected = function(slot) {\n        if (!this.inputs) {\n            return false;\n        }\n        return slot < this.inputs.length && this.inputs[slot].link != null;\n    };\n\n    /**\n     * tells you info about an input connection (which node, type, etc)\n     * @method getInputInfo\n     * @param {number} slot\n     * @return {Object} object or null { link: id, name: string, type: string or 0 }\n     */\n    LGraphNode.prototype.getInputInfo = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            return this.inputs[slot];\n        }\n        return null;\n    };\n\n    /**\n     * Returns the link info in the connection of an input slot\n     * @method getInputLink\n     * @param {number} slot\n     * @return {LLink} object or null\n     */\n    LGraphNode.prototype.getInputLink = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            var slot_info = this.inputs[slot];\n            return this.graph.links[ slot_info.link ];\n        }\n        return null;\n    };\n\n    /**\n     * returns the node connected in the input slot\n     * @method getInputNode\n     * @param {number} slot\n     * @return {LGraphNode} node or null\n     */\n    LGraphNode.prototype.getInputNode = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot >= this.inputs.length) {\n            return null;\n        }\n        var input = this.inputs[slot];\n        if (!input || input.link === null) {\n            return null;\n        }\n        var link_info = this.graph.links[input.link];\n        if (!link_info) {\n            return null;\n        }\n        return this.graph.getNodeById(link_info.origin_id);\n    };\n\n    /**\n     * returns the value of an input with this name, otherwise checks if there is a property with that name\n     * @method getInputOrProperty\n     * @param {string} name\n     * @return {*} value\n     */\n    LGraphNode.prototype.getInputOrProperty = function(name) {\n        if (!this.inputs || !this.inputs.length) {\n            return this.properties ? this.properties[name] : null;\n        }\n\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            var input_info = this.inputs[i];\n            if (name == input_info.name && input_info.link != null) {\n                var link = this.graph.links[input_info.link];\n                if (link) {\n                    return link.data;\n                }\n            }\n        }\n        return this.properties[name];\n    };\n\n    /**\n     * tells you the last output data that went in that slot\n     * @method getOutputData\n     * @param {number} slot\n     * @return {Object}  object or null\n     */\n    LGraphNode.prototype.getOutputData = function(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        var info = this.outputs[slot];\n        return info._data;\n    };\n\n    /**\n     * tells you info about an output connection (which node, type, etc)\n     * @method getOutputInfo\n     * @param {number} slot\n     * @return {Object}  object or null { name: string, type: string, links: [ ids of links in number ] }\n     */\n    LGraphNode.prototype.getOutputInfo = function(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot < this.outputs.length) {\n            return this.outputs[slot];\n        }\n        return null;\n    };\n\n    /**\n     * tells you if there is a connection in one output slot\n     * @method isOutputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isOutputConnected = function(slot) {\n        if (!this.outputs) {\n            return false;\n        }\n        return (\n            slot < this.outputs.length &&\n            this.outputs[slot].links &&\n            this.outputs[slot].links.length\n        );\n    };\n\n    /**\n     * tells you if there is any connection in the output slots\n     * @method isAnyOutputConnected\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isAnyOutputConnected = function() {\n        if (!this.outputs) {\n            return false;\n        }\n        for (var i = 0; i < this.outputs.length; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links.length) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * retrieves all the nodes connected to this output slot\n     * @method getOutputNodes\n     * @param {number} slot\n     * @return {array}\n     */\n    LGraphNode.prototype.getOutputNodes = function(slot) {\n        if (!this.outputs || this.outputs.length == 0) {\n            return null;\n        }\n\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        var output = this.outputs[slot];\n        if (!output.links || output.links.length == 0) {\n            return null;\n        }\n\n        var r = [];\n        for (var i = 0; i < output.links.length; i++) {\n            var link_id = output.links[i];\n            var link = this.graph.links[link_id];\n            if (link) {\n                var target_node = this.graph.getNodeById(link.target_id);\n                if (target_node) {\n                    r.push(target_node);\n                }\n            }\n        }\n        return r;\n    };\n\n    LGraphNode.prototype.addOnTriggerInput = function(){\n        var trigS = this.findInputSlot(\"onTrigger\");\n        if (trigS == -1){ //!trigS ||\n            var input = this.addInput(\"onTrigger\", LiteGraph.EVENT, {optional: true, nameLocked: true});\n            return this.findInputSlot(\"onTrigger\");\n        }\n        return trigS;\n    }\n\n    LGraphNode.prototype.addOnExecutedOutput = function(){\n        var trigS = this.findOutputSlot(\"onExecuted\");\n        if (trigS == -1){ //!trigS ||\n            var output = this.addOutput(\"onExecuted\", LiteGraph.ACTION, {optional: true, nameLocked: true});\n            return this.findOutputSlot(\"onExecuted\");\n        }\n        return trigS;\n    }\n\n    LGraphNode.prototype.onAfterExecuteNode = function(param, options){\n        var trigS = this.findOutputSlot(\"onExecuted\");\n        if (trigS != -1){\n\n            //console.debug(this.id+\":\"+this.order+\" triggering slot onAfterExecute\");\n            //console.debug(param);\n            //console.debug(options);\n            this.triggerSlot(trigS, param, null, options);\n\n        }\n    }\n\n    LGraphNode.prototype.changeMode = function(modeTo){\n        switch(modeTo){\n            case LiteGraph.ON_EVENT:\n                // this.addOnExecutedOutput();\n                break;\n\n            case LiteGraph.ON_TRIGGER:\n                this.addOnTriggerInput();\n                this.addOnExecutedOutput();\n                break;\n\n            case LiteGraph.NEVER:\n                break;\n\n            case LiteGraph.ALWAYS:\n                break;\n\n            case LiteGraph.ON_REQUEST:\n                break;\n\n            default:\n                return false;\n                break;\n        }\n        this.mode = modeTo;\n        return true;\n    };\n\n    /**\n     * Triggers the node code execution, place a boolean/counter to mark the node as being executed\n     * @method execute\n     * @param {*} param\n     * @param {*} options\n     */\n    LGraphNode.prototype.doExecute = function(param, options) {\n        options = options || {};\n        if (this.onExecute){\n\n            // enable this to give the event an ID\n            if (!options.action_call) options.action_call = this.id+\"_exec_\"+Math.floor(Math.random()*9999);\n\n            this.graph.nodes_executing[this.id] = true; //.push(this.id);\n\n            this.onExecute(param, options);\n\n            this.graph.nodes_executing[this.id] = false; //.pop();\n\n            // save execution/action ref\n            this.exec_version = this.graph.iteration;\n            if(options && options.action_call){\n                this.action_call = options.action_call; // if (param)\n                this.graph.nodes_executedAction[this.id] = options.action_call;\n            }\n        }\n        this.execute_triggered = 2; // the nFrames it will be used (-- each step), means \"how old\" is the event\n        if(this.onAfterExecuteNode) this.onAfterExecuteNode(param, options); // callback\n    };\n\n    /**\n     * Triggers an action, wrapped by logics to control execution flow\n     * @method actionDo\n     * @param {String} action name\n     * @param {*} param\n     */\n    LGraphNode.prototype.actionDo = function(action, param, options) {\n        options = options || {};\n        if (this.onAction){\n\n            // enable this to give the event an ID\n            if (!options.action_call) options.action_call = this.id+\"_\"+(action?action:\"action\")+\"_\"+Math.floor(Math.random()*9999);\n\n            this.graph.nodes_actioning[this.id] = (action?action:\"actioning\"); //.push(this.id);\n\n            this.onAction(action, param, options);\n\n            this.graph.nodes_actioning[this.id] = false; //.pop();\n\n            // save execution/action ref\n            if(options && options.action_call){\n                this.action_call = options.action_call; // if (param)\n                this.graph.nodes_executedAction[this.id] = options.action_call;\n            }\n        }\n        this.action_triggered = 2; // the nFrames it will be used (-- each step), means \"how old\" is the event\n        if(this.onAfterExecuteNode) this.onAfterExecuteNode(param, options);\n    };\n\n    /**\n     * Triggers an event in this node, this will trigger any output with the same name\n     * @method trigger\n     * @param {String} event name ( \"on_play\", ... ) if action is equivalent to false then the event is send to all\n     * @param {*} param\n     */\n    LGraphNode.prototype.trigger = function(action, param, options) {\n        if (!this.outputs || !this.outputs.length) {\n            return;\n        }\n\n        if (this.graph)\n            this.graph._last_trigger_time = LiteGraph.getTime();\n\n        for (var i = 0; i < this.outputs.length; ++i) {\n            var output = this.outputs[i];\n            if ( !output || output.type !== LiteGraph.EVENT || (action && output.name != action) )\n                continue;\n            this.triggerSlot(i, param, null, options);\n        }\n    };\n\n    /**\n     * Triggers a slot event in this node: cycle output slots and launch execute/action on connected nodes\n     * @method triggerSlot\n     * @param {Number} slot the index of the output slot\n     * @param {*} param\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a slot\n     */\n    LGraphNode.prototype.triggerSlot = function(slot, param, link_id, options) {\n        options = options || {};\n        if (!this.outputs) {\n            return;\n        }\n\n        if(slot == null)\n        {\n            console.error(\"slot must be a number\");\n            return;\n        }\n\n        if(slot.constructor !== Number)\n            console.warn(\"slot must be a number, use node.trigger('name') if you want to use a string\");\n\n        var output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        var links = output.links;\n        if (!links || !links.length) {\n            return;\n        }\n\n        if (this.graph) {\n            this.graph._last_trigger_time = LiteGraph.getTime();\n        }\n\n        //for every link attached here\n        for (var k = 0; k < links.length; ++k) {\n            var id = links[k];\n            if (link_id != null && link_id != id) {\n                //to skip links\n                continue;\n            }\n            var link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                //not connected\n                continue;\n            }\n            link_info._last_time = LiteGraph.getTime();\n            var node = this.graph.getNodeById(link_info.target_id);\n            if (!node) {\n                //node not found?\n                continue;\n            }\n\n            //used to mark events in graph\n            var target_connection = node.inputs[link_info.target_slot];\n\n            if (node.mode === LiteGraph.ON_TRIGGER)\n            {\n                // generate unique trigger ID if not present\n                if (!options.action_call) options.action_call = this.id+\"_trigg_\"+Math.floor(Math.random()*9999);\n                if (node.onExecute) {\n                    // -- wrapping node.onExecute(param); --\n                    node.doExecute(param, options);\n                }\n            }\n            else if (node.onAction) {\n                // generate unique action ID if not present\n                if (!options.action_call) options.action_call = this.id+\"_act_\"+Math.floor(Math.random()*9999);\n                //pass the action name\n                var target_connection = node.inputs[link_info.target_slot];\n                // wrap node.onAction(target_connection.name, param);\n                node.actionDo(target_connection.name, param, options);\n            }\n        }\n    };\n\n    /**\n     * clears the trigger slot animation\n     * @method clearTriggeredSlot\n     * @param {Number} slot the index of the output slot\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a slot\n     */\n    LGraphNode.prototype.clearTriggeredSlot = function(slot, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        var output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        var links = output.links;\n        if (!links || !links.length) {\n            return;\n        }\n\n        //for every link attached here\n        for (var k = 0; k < links.length; ++k) {\n            var id = links[k];\n            if (link_id != null && link_id != id) {\n                //to skip links\n                continue;\n            }\n            var link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                //not connected\n                continue;\n            }\n            link_info._last_time = 0;\n        }\n    };\n\n    /**\n     * changes node size and triggers callback\n     * @method setSize\n     * @param {vec2} size\n     */\n    LGraphNode.prototype.setSize = function(size)\n    {\n        this.size = size;\n        if(this.onResize)\n            this.onResize(this.size);\n    }\n\n    /**\n     * add a new property to this node\n     * @method addProperty\n     * @param {string} name\n     * @param {*} default_value\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of the property (like values, etc)\n     */\n    LGraphNode.prototype.addProperty = function(\n        name,\n        default_value,\n        type,\n        extra_info\n    ) {\n        var o = { name: name, type: type, default_value: default_value };\n        if (extra_info) {\n            for (var i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n        if (!this.properties_info) {\n            this.properties_info = [];\n        }\n        this.properties_info.push(o);\n        if (!this.properties) {\n            this.properties = {};\n        }\n        this.properties[name] = default_value;\n        return o;\n    };\n\n    //connections\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutput\n     * @param {string} name\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of an output (label, special color, position, etc)\n     */\n    LGraphNode.prototype.addOutput = function(name, type, extra_info) {\n        var output = { name: name, type: type, links: null };\n        if (extra_info) {\n            for (var i in extra_info) {\n                output[i] = extra_info[i];\n            }\n        }\n\n        if (!this.outputs) {\n            this.outputs = [];\n        }\n        this.outputs.push(output);\n        if (this.onOutputAdded) {\n            this.onOutputAdded(output);\n        }\n\n        if (LiteGraph.auto_load_slot_types) LiteGraph.registerNodeAndSlotType(this,type,true);\n\n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n        return output;\n    };\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    LGraphNode.prototype.addOutputs = function(array) {\n        for (var i = 0; i < array.length; ++i) {\n            var info = array[i];\n            var o = { name: info[0], type: info[1], link: null };\n            if (array[2]) {\n                for (var j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.outputs) {\n                this.outputs = [];\n            }\n            this.outputs.push(o);\n            if (this.onOutputAdded) {\n                this.onOutputAdded(o);\n            }\n\n            if (LiteGraph.auto_load_slot_types) LiteGraph.registerNodeAndSlotType(this,info[1],true);\n\n        }\n\n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * remove an existing output slot\n     * @method removeOutput\n     * @param {number} slot\n     */\n    LGraphNode.prototype.removeOutput = function(slot) {\n        this.disconnectOutput(slot);\n        this.outputs.splice(slot, 1);\n        for (var i = slot; i < this.outputs.length; ++i) {\n            if (!this.outputs[i] || !this.outputs[i].links) {\n                continue;\n            }\n            var links = this.outputs[i].links;\n            for (var j = 0; j < links.length; ++j) {\n                var link = this.graph.links[links[j]];\n                if (!link) {\n                    continue;\n                }\n                link.origin_slot -= 1;\n            }\n        }\n\n        this.setSize( this.computeSize() );\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(slot);\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * add a new input slot to use in this node\n     * @method addInput\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...), it its a generic one use 0\n     * @param {Object} extra_info this can be used to have special properties of an input (label, color, position, etc)\n     */\n    LGraphNode.prototype.addInput = function(name, type, extra_info) {\n        type = type || 0;\n        var input = { name: name, type: type, link: null };\n        if (extra_info) {\n            for (var i in extra_info) {\n                input[i] = extra_info[i];\n            }\n        }\n\n        if (!this.inputs) {\n            this.inputs = [];\n        }\n\n        this.inputs.push(input);\n        this.setSize( this.computeSize() );\n\n        if (this.onInputAdded) {\n            this.onInputAdded(input);\n        }\n\n        LiteGraph.registerNodeAndSlotType(this,type);\n\n        this.setDirtyCanvas(true, true);\n        return input;\n    };\n\n    /**\n     * add several new input slots in this node\n     * @method addInputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    LGraphNode.prototype.addInputs = function(array) {\n        for (var i = 0; i < array.length; ++i) {\n            var info = array[i];\n            var o = { name: info[0], type: info[1], link: null };\n            if (array[2]) {\n                for (var j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.inputs) {\n                this.inputs = [];\n            }\n            this.inputs.push(o);\n            if (this.onInputAdded) {\n                this.onInputAdded(o);\n            }\n\n            LiteGraph.registerNodeAndSlotType(this,info[1]);\n        }\n\n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * remove an existing input slot\n     * @method removeInput\n     * @param {number} slot\n     */\n    LGraphNode.prototype.removeInput = function(slot) {\n        this.disconnectInput(slot);\n        var slot_info = this.inputs.splice(slot, 1);\n        for (var i = slot; i < this.inputs.length; ++i) {\n            if (!this.inputs[i]) {\n                continue;\n            }\n            var link = this.graph.links[this.inputs[i].link];\n            if (!link) {\n                continue;\n            }\n            link.target_slot -= 1;\n        }\n        this.setSize( this.computeSize() );\n        if (this.onInputRemoved) {\n            this.onInputRemoved(slot, slot_info[0] );\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * add an special connection to this node (used for special kinds of graphs)\n     * @method addConnection\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...)\n     * @param {[x,y]} pos position of the connection inside the node\n     * @param {string} direction if is input or output\n     */\n    LGraphNode.prototype.addConnection = function(name, type, pos, direction) {\n        var o = {\n            name: name,\n            type: type,\n            pos: pos,\n            direction: direction,\n            links: null\n        };\n        this.connections.push(o);\n        return o;\n    };\n\n    /**\n     * computes the minimum size of a node according to its inputs and output slots\n     * @method computeSize\n     * @param {vec2} minHeight\n     * @return {vec2} the total size\n     */\n    LGraphNode.prototype.computeSize = function(out) {\n        if (this.constructor.size) {\n            return this.constructor.size.concat();\n        }\n\n        var rows = Math.max(\n            this.inputs ? this.inputs.length : 1,\n            this.outputs ? this.outputs.length : 1\n        );\n        var size = out || new Float32Array([0, 0]);\n        rows = Math.max(rows, 1);\n        var font_size = LiteGraph.NODE_TEXT_SIZE; //although it should be graphcanvas.inner_text_font size\n\n        var title_width = compute_text_size(this.title);\n        var input_width = 0;\n        var output_width = 0;\n\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                var input = this.inputs[i];\n                var text = input.label || input.name || \"\";\n                var text_width = compute_text_size(text);\n                if (input_width < text_width) {\n                    input_width = text_width;\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                var output = this.outputs[i];\n                var text = output.label || output.name || \"\";\n                var text_width = compute_text_size(text);\n                if (output_width < text_width) {\n                    output_width = text_width;\n                }\n            }\n        }\n\n        size[0] = Math.max(input_width + output_width + 10, title_width);\n        size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH);\n        if (this.widgets && this.widgets.length) {\n            size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH * 1.5);\n        }\n\n        size[1] = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n\n        var widgets_height = 0;\n        if (this.widgets && this.widgets.length) {\n            for (var i = 0, l = this.widgets.length; i < l; ++i) {\n                if (this.widgets[i].computeSize)\n                    widgets_height += this.widgets[i].computeSize(size[0])[1] + 4;\n                else\n                    widgets_height += LiteGraph.NODE_WIDGET_HEIGHT + 4;\n            }\n            widgets_height += 8;\n        }\n\n        //compute height using widgets height\n        if( this.widgets_up )\n            size[1] = Math.max( size[1], widgets_height );\n        else if( this.widgets_start_y != null )\n            size[1] = Math.max( size[1], widgets_height + this.widgets_start_y );\n        else\n            size[1] += widgets_height;\n\n        function compute_text_size(text) {\n            if (!text) {\n                return 0;\n            }\n            return font_size * text.length * 0.6;\n        }\n\n        if (\n            this.constructor.min_height &&\n            size[1] < this.constructor.min_height\n        ) {\n            size[1] = this.constructor.min_height;\n        }\n\n        size[1] += 6; //margin\n\n        return size;\n    };\n\n    LGraphNode.prototype.inResizeCorner = function(canvasX, canvasY) {\n        var rows = this.outputs ? this.outputs.length : 1;\n        var outputs_offset = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n        return isInsideRectangle(canvasX,\n            canvasY,\n            this.pos[0] + this.size[0] - 15,\n            this.pos[1] + Math.max(this.size[1] - 15, outputs_offset),\n            20,\n            20\n        );\n    }\n\n    /**\n     * returns all the info available about a property of this node.\n     *\n     * @method getPropertyInfo\n     * @param {String} property name of the property\n     * @return {Object} the object with all the available info\n     */\n    LGraphNode.prototype.getPropertyInfo = function( property )\n    {\n        var info = null;\n\n        //there are several ways to define info about a property\n        //legacy mode\n        if (this.properties_info) {\n            for (var i = 0; i < this.properties_info.length; ++i) {\n                if (this.properties_info[i].name == property) {\n                    info = this.properties_info[i];\n                    break;\n                }\n            }\n        }\n        //litescene mode using the constructor\n        if(this.constructor[\"@\" + property])\n            info = this.constructor[\"@\" + property];\n\n        if(this.constructor.widgets_info && this.constructor.widgets_info[property])\n            info = this.constructor.widgets_info[property];\n\n        //litescene mode using the constructor\n        if (!info && this.onGetPropertyInfo) {\n            info = this.onGetPropertyInfo(property);\n        }\n\n        if (!info)\n            info = {};\n        if(!info.type)\n            info.type = typeof this.properties[property];\n        if(info.widget == \"combo\")\n            info.type = \"enum\";\n\n        return info;\n    }\n\n    /**\n     * Defines a widget inside the node, it will be rendered on top of the node, you can control lots of properties\n     *\n     * @method addWidget\n     * @param {String} type the widget type (could be \"number\",\"string\",\"combo\"\n     * @param {String} name the text to show on the widget\n     * @param {String} value the default value\n     * @param {Function|String} callback function to call when it changes (optionally, it can be the name of the property to modify)\n     * @param {Object} options the object that contains special properties of this widget\n     * @return {Object} the created widget object\n     */\n    LGraphNode.prototype.addWidget = function( type, name, value, callback, options )\n    {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n\n        if(!options && callback && callback.constructor === Object)\n        {\n            options = callback;\n            callback = null;\n        }\n\n        if(options && options.constructor === String) //options can be the property name\n            options = { property: options };\n\n        if(callback && callback.constructor === String) //callback can be the property name\n        {\n            if(!options)\n                options = {};\n            options.property = callback;\n            callback = null;\n        }\n\n        if(callback && callback.constructor !== Function)\n        {\n            console.warn(\"addWidget: callback must be a function\");\n            callback = null;\n        }\n\n        var w = {\n            type: type.toLowerCase(),\n            name: name,\n            value: value,\n            callback: callback,\n            options: options || {}\n        };\n\n        if (w.options.y !== undefined) {\n            w.y = w.options.y;\n        }\n\n        if (!callback && !w.options.callback && !w.options.property) {\n            console.warn(\"LiteGraph addWidget(...) without a callback or property assigned\");\n        }\n        if (type == \"combo\" && !w.options.values) {\n            throw \"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }\";\n        }\n        this.widgets.push(w);\n        this.setSize( this.computeSize() );\n        return w;\n    };\n\n    LGraphNode.prototype.addCustomWidget = function(custom_widget) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n        this.widgets.push(custom_widget);\n        return custom_widget;\n    };\n\n    /**\n     * returns the bounding of the object, used for rendering purposes\n     * @method getBounding\n     * @param out {Float32Array[4]?} [optional] a place to store the output, to free garbage\n     * @param compute_outer {boolean?} [optional] set to true to include the shadow and connection points in the bounding calculation\n     * @return {Float32Array[4]} the bounding box in format of [topleft_cornerx, topleft_cornery, width, height]\n     */\n    LGraphNode.prototype.getBounding = function(out, compute_outer) {\n        out = out || new Float32Array(4);\n        const nodePos = this.pos;\n        const isCollapsed = this.flags.collapsed;\n        const nodeSize = this.size;\n\n        let left_offset = 0;\n        // 1 offset due to how nodes are rendered\n        let right_offset =  1 ;\n        let top_offset = 0;\n        let bottom_offset = 0;\n\n        if (compute_outer) {\n            // 4 offset for collapsed node connection points\n            left_offset = 4;\n            // 6 offset for right shadow and collapsed node connection points\n            right_offset = 6 + left_offset;\n            // 4 offset for collapsed nodes top connection points\n            top_offset = 4;\n            // 5 offset for bottom shadow and collapsed node connection points\n            bottom_offset = 5 + top_offset;\n        }\n\n        out[0] = nodePos[0] - left_offset;\n        out[1] = nodePos[1] - LiteGraph.NODE_TITLE_HEIGHT - top_offset;\n        out[2] = isCollapsed ?\n            (this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH) + right_offset :\n            nodeSize[0] + right_offset;\n        out[3] = isCollapsed ?\n            LiteGraph.NODE_TITLE_HEIGHT + bottom_offset :\n            nodeSize[1] + LiteGraph.NODE_TITLE_HEIGHT + bottom_offset;\n\n        if (this.onBounding) {\n            this.onBounding(out);\n        }\n        return out;\n    };\n\n    /**\n     * checks if a point is inside the shape of a node\n     * @method isPointInside\n     * @param {number} x\n     * @param {number} y\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isPointInside = function(x, y, margin, skip_title) {\n        margin = margin || 0;\n\n        var margin_top = this.graph && this.graph.isLive() ? 0 : LiteGraph.NODE_TITLE_HEIGHT;\n        if (skip_title) {\n            margin_top = 0;\n        }\n        if (this.flags && this.flags.collapsed) {\n            //if ( distance([x,y], [this.pos[0] + this.size[0]*0.5, this.pos[1] + this.size[1]*0.5]) < LiteGraph.NODE_COLLAPSED_RADIUS)\n            if (\n                isInsideRectangle(\n                    x,\n                    y,\n                    this.pos[0] - margin,\n                    this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT - margin,\n                    (this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH) +\n                    2 * margin,\n                    LiteGraph.NODE_TITLE_HEIGHT + 2 * margin\n                )\n            ) {\n                return true;\n            }\n        } else if (\n            this.pos[0] - 4 - margin < x &&\n            this.pos[0] + this.size[0] + 4 + margin > x &&\n            this.pos[1] - margin_top - margin < y &&\n            this.pos[1] + this.size[1] + margin > y\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * checks if a point is inside a node slot, and returns info about which slot\n     * @method getSlotInPosition\n     * @param {number} x\n     * @param {number} y\n     * @return {Object} if found the object contains { input|output: slot object, slot: number, link_pos: [x,y] }\n     */\n    LGraphNode.prototype.getSlotInPosition = function(x, y) {\n        //search for inputs\n        var link_pos = new Float32Array(2);\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                var input = this.inputs[i];\n                this.getConnectionPos(true, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10\n                    )\n                ) {\n                    return { input: input, slot: i, link_pos: link_pos };\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                var output = this.outputs[i];\n                this.getConnectionPos(false, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10\n                    )\n                ) {\n                    return { output: output, slot: i, link_pos: link_pos };\n                }\n            }\n        }\n\n        return null;\n    };\n\n    /**\n     * returns the input slot with a given name (used for dynamic slots), -1 if not found\n     * @method findInputSlot\n     * @param {string} name the name of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findInputSlot = function(name,  returnObj) {\n        if (!this.inputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            if (name == this.inputs[i].name) {\n                return !returnObj ? i : this.inputs[i];\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * returns the output slot with a given name (used for dynamic slots), -1 if not found\n     * @method findOutputSlot\n     * @param {string} name the name of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findOutputSlot = function(name, returnObj) {\n        returnObj = returnObj || false;\n        if (!this.outputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            if (name == this.outputs[i].name) {\n                return !returnObj ? i : this.outputs[i];\n            }\n        }\n        return -1;\n    };\n\n    // TODO refactor: USE SINGLE findInput/findOutput functions! :: merge options\n\n    /**\n     * returns the first free input slot\n     * @method findInputSlotFree\n     * @param {object} options\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findInputSlotFree = function(optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = {returnObj: false\n            ,typesNotAccepted: []\n        };\n        var opts = Object.assign(optsDef,optsIn);\n        if (!this.inputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            if (this.inputs[i].link && this.inputs[i].link != null) {\n                continue;\n            }\n            if (opts.typesNotAccepted && opts.typesNotAccepted.includes && opts.typesNotAccepted.includes(this.inputs[i].type)){\n                continue;\n            }\n            return !opts.returnObj ? i : this.inputs[i];\n        }\n        return -1;\n    };\n\n    /**\n     * returns the first output slot free\n     * @method findOutputSlotFree\n     * @param {object} options\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findOutputSlotFree = function(optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { returnObj: false\n            ,typesNotAccepted: []\n        };\n        var opts = Object.assign(optsDef,optsIn);\n        if (!this.outputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links != null) {\n                continue;\n            }\n            if (opts.typesNotAccepted && opts.typesNotAccepted.includes && opts.typesNotAccepted.includes(this.outputs[i].type)){\n                continue;\n            }\n            return !opts.returnObj ? i : this.outputs[i];\n        }\n        return -1;\n    };\n\n    /**\n     * findSlotByType for INPUTS\n     */\n    LGraphNode.prototype.findInputSlotByType = function(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        return this.findSlotByType(true, type, returnObj, preferFreeSlot, doNotUseOccupied);\n    };\n\n    /**\n     * findSlotByType for OUTPUTS\n     */\n    LGraphNode.prototype.findOutputSlotByType = function(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        return this.findSlotByType(false, type, returnObj, preferFreeSlot, doNotUseOccupied);\n    };\n\n    /**\n     * returns the output (or input) slot with a given type, -1 if not found\n     * @method findSlotByType\n     * @param {boolean} input uise inputs instead of outputs\n     * @param {string} type the type of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @param {boolean} preferFreeSlot if we want a free slot (if not found, will return the first of the type anyway)\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findSlotByType = function(input, type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        input = input || false;\n        returnObj = returnObj || false;\n        preferFreeSlot = preferFreeSlot || false;\n        doNotUseOccupied = doNotUseOccupied || false;\n        var aSlots = input ? this.inputs : this.outputs;\n        if (!aSlots) {\n            return -1;\n        }\n        // !! empty string type is considered 0, * !!\n        if (type == \"\" || type == \"*\") type = 0;\n        for (var i = 0, l = aSlots.length; i < l; ++i) {\n            var tFound = false;\n            var aSource = (type+\"\").toLowerCase().split(\",\");\n            var aDest = aSlots[i].type==\"0\"||aSlots[i].type==\"*\"?\"0\":aSlots[i].type;\n            aDest = (aDest+\"\").toLowerCase().split(\",\");\n            for(var sI=0;sI<aSource.length;sI++){\n                for(var dI=0;dI<aDest.length;dI++){\n                    if (aSource[sI]==\"_event_\") aSource[sI] = LiteGraph.EVENT;\n                    if (aDest[sI]==\"_event_\") aDest[sI] = LiteGraph.EVENT;\n                    if (aSource[sI]==\"*\") aSource[sI] = 0;\n                    if (aDest[sI]==\"*\") aDest[sI] = 0;\n                    if (aSource[sI] == aDest[dI]) {\n                        if (preferFreeSlot && aSlots[i].links && aSlots[i].links !== null) continue;\n                        return !returnObj ? i : aSlots[i];\n                    }\n                }\n            }\n        }\n        // if didnt find some, stop checking for free slots\n        if (preferFreeSlot && !doNotUseOccupied){\n            for (var i = 0, l = aSlots.length; i < l; ++i) {\n                var tFound = false;\n                var aSource = (type+\"\").toLowerCase().split(\",\");\n                var aDest = aSlots[i].type==\"0\"||aSlots[i].type==\"*\"?\"0\":aSlots[i].type;\n                aDest = (aDest+\"\").toLowerCase().split(\",\");\n                for(var sI=0;sI<aSource.length;sI++){\n                    for(var dI=0;dI<aDest.length;dI++){\n                        if (aSource[sI]==\"*\") aSource[sI] = 0;\n                        if (aDest[sI]==\"*\") aDest[sI] = 0;\n                        if (aSource[sI] == aDest[dI]) {\n                            return !returnObj ? i : aSlots[i];\n                        }\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * connect this node output to the input of another node BY TYPE\n     * @method connectByType\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {string} target_type the input slot type of the target node\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connectByType = function(slot, target_node, target_slotType, optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { createEventInCase: true\n            ,firstFreeIfOutputGeneralInCase: true\n            ,generalTypeInCase: true\n        };\n        var opts = Object.assign(optsDef,optsIn);\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        var target_slot = target_node.findInputSlotByType(target_slotType, false, true);\n        if (target_slot >= 0 && target_slot !== null){\n            //console.debug(\"CONNbyTYPE type \"+target_slotType+\" for \"+target_slot)\n            return this.connect(slot, target_node, target_slot);\n        }else{\n            //console.log(\"type \"+target_slotType+\" not found or not free?\")\n            if (opts.createEventInCase && target_slotType == LiteGraph.EVENT){\n                // WILL CREATE THE onTrigger IN SLOT\n                //console.debug(\"connect WILL CREATE THE onTrigger \"+target_slotType+\" to \"+target_node);\n                return this.connect(slot, target_node, -1);\n            }\n            // connect to the first general output slot if not found a specific type and\n            if (opts.generalTypeInCase){\n                var target_slot = target_node.findInputSlotByType(0, false, true, true);\n                //console.debug(\"connect TO a general type (*, 0), if not found the specific type \",target_slotType,\" to \",target_node,\"RES_SLOT:\",target_slot);\n                if (target_slot >= 0){\n                    return this.connect(slot, target_node, target_slot);\n                }\n            }\n            // connect to the first free input slot if not found a specific type and this output is general\n            if (opts.firstFreeIfOutputGeneralInCase && (target_slotType == 0 || target_slotType == \"*\" || target_slotType == \"\")){\n                var target_slot = target_node.findInputSlotFree({typesNotAccepted: [LiteGraph.EVENT] });\n                //console.debug(\"connect TO TheFirstFREE \",target_slotType,\" to \",target_node,\"RES_SLOT:\",target_slot);\n                if (target_slot >= 0){\n                    return this.connect(slot, target_node, target_slot);\n                }\n            }\n\n            console.debug(\"no way to connect type: \",target_slotType,\" to targetNODE \",target_node);\n            //TODO filter\n\n            return null;\n        }\n    }\n\n    /**\n     * connect this node input to the output of another node BY TYPE\n     * @method connectByType\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {string} target_type the output slot type of the target node\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connectByTypeOutput = function(slot, source_node, source_slotType, optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { createEventInCase: true\n            ,firstFreeIfInputGeneralInCase: true\n            ,generalTypeInCase: true\n        };\n        var opts = Object.assign(optsDef,optsIn);\n        if (source_node && source_node.constructor === Number) {\n            source_node = this.graph.getNodeById(source_node);\n        }\n        var source_slot = source_node.findOutputSlotByType(source_slotType, false, true);\n        if (source_slot >= 0 && source_slot !== null){\n            //console.debug(\"CONNbyTYPE OUT! type \"+source_slotType+\" for \"+source_slot)\n            return source_node.connect(source_slot, this, slot);\n        }else{\n\n            // connect to the first general output slot if not found a specific type and\n            if (opts.generalTypeInCase){\n                var source_slot = source_node.findOutputSlotByType(0, false, true, true);\n                if (source_slot >= 0){\n                    return source_node.connect(source_slot, this, slot);\n                }\n            }\n\n            if (opts.createEventInCase && source_slotType == LiteGraph.EVENT){\n                // WILL CREATE THE onExecuted OUT SLOT\n                if (LiteGraph.do_add_triggers_slots){\n                    var source_slot = source_node.addOnExecutedOutput();\n                    return source_node.connect(source_slot, this, slot);\n                }\n            }\n            // connect to the first free output slot if not found a specific type and this input is general\n            if (opts.firstFreeIfInputGeneralInCase && (source_slotType == 0 || source_slotType == \"*\" || source_slotType == \"\")){\n                var source_slot = source_node.findOutputSlotFree({typesNotAccepted: [LiteGraph.EVENT] });\n                if (source_slot >= 0){\n                    return source_node.connect(source_slot, this, slot);\n                }\n            }\n\n            console.debug(\"no way to connect byOUT type: \",source_slotType,\" to sourceNODE \",source_node);\n            //TODO filter\n\n            //console.log(\"type OUT! \"+source_slotType+\" not found or not free?\")\n            return null;\n        }\n    }\n\n    /**\n     * connect this node output to the input of another node\n     * @method connect\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {number_or_string} target_slot the input slot of the target node (could be the number of the slot or the string with the name of the slot, or -1 to connect a trigger)\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connect = function(slot, target_node, target_slot) {\n        target_slot = target_slot || 0;\n\n        if (!this.graph) {\n            //could be connected before adding it to a graph\n            console.log(\n                \"Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them.\"\n            ); //due to link ids being associated with graphs\n            return null;\n        }\n\n        //seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return null;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        if (!target_node) {\n            throw \"target node is null\";\n        }\n\n        //avoid loopback\n        if (target_node == this) {\n            return null;\n        }\n\n        //you can specify the slot by name\n        if (target_slot.constructor === String) {\n            target_slot = target_node.findInputSlot(target_slot);\n            if (target_slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\n                        \"Connect: Error, no slot of name \" + target_slot\n                    );\n                }\n                return null;\n            }\n        } else if (target_slot === LiteGraph.EVENT) {\n\n            if (LiteGraph.do_add_triggers_slots){\n                //search for first slot with event? :: NO this is done outside\n                //console.log(\"Connect: Creating triggerEvent\");\n                // force mode\n                target_node.changeMode(LiteGraph.ON_TRIGGER);\n                target_slot = target_node.findInputSlot(\"onTrigger\");\n            }else{\n                return null; // -- break --\n            }\n        } else if (\n            !target_node.inputs ||\n            target_slot >= target_node.inputs.length\n        ) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        var changed = false;\n\n        var input = target_node.inputs[target_slot];\n        var link_info = null;\n        var output = this.outputs[slot];\n\n        if (!this.outputs[slot]){\n            /*console.debug(\"Invalid slot passed: \"+slot);\n            console.debug(this.outputs);*/\n            return null;\n        }\n\n        // allow target node to change slot\n        if (target_node.onBeforeConnectInput) {\n            // This way node can choose another slot (or make a new one?)\n            target_slot = target_node.onBeforeConnectInput(target_slot); //callback\n        }\n\n        //check target_slot and check connection types\n        if (target_slot===false || target_slot===null || !LiteGraph.isValidConnection(output.type, input.type))\n        {\n            this.setDirtyCanvas(false, true);\n            if(changed)\n                this.graph.connectionChange(this, link_info);\n            return null;\n        }else{\n            //console.debug(\"valid connection\",output.type, input.type);\n        }\n\n        //allows nodes to block connection, callback\n        if (target_node.onConnectInput) {\n            if ( target_node.onConnectInput(target_slot, output.type, output, this, slot) === false ) {\n                return null;\n            }\n        }\n        if (this.onConnectOutput) { // callback\n            if ( this.onConnectOutput(slot, input.type, input, target_node, target_slot) === false ) {\n                return null;\n            }\n        }\n\n        //if there is something already plugged there, disconnect\n        if (target_node.inputs[target_slot] && target_node.inputs[target_slot].link != null) {\n            this.graph.beforeChange();\n            target_node.disconnectInput(target_slot, {doProcessChange: false});\n            changed = true;\n        }\n        if (output.links !== null && output.links.length){\n            switch(output.type){\n                case LiteGraph.EVENT:\n                    if (!LiteGraph.allow_multi_output_for_events){\n                        this.graph.beforeChange();\n                        this.disconnectOutput(slot, false, {doProcessChange: false}); // Input(target_slot, {doProcessChange: false});\n                        changed = true;\n                    }\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        var nextId\n        if (LiteGraph.use_uuids)\n            nextId = LiteGraph.uuidv4();\n        else\n            nextId = ++this.graph.last_link_id;\n\n        //create link class\n        link_info = new LLink(\n            nextId,\n            input.type || output.type,\n            this.id,\n            slot,\n            target_node.id,\n            target_slot\n        );\n\n        //add to graph links list\n        this.graph.links[link_info.id] = link_info;\n\n        //connect in output\n        if (output.links == null) {\n            output.links = [];\n        }\n        output.links.push(link_info.id);\n        //connect in input\n        target_node.inputs[target_slot].link = link_info.id;\n        if (this.graph) {\n            this.graph._version++;\n        }\n        if (this.onConnectionsChange) {\n            this.onConnectionsChange(\n                LiteGraph.OUTPUT,\n                slot,\n                true,\n                link_info,\n                output\n            );\n        } //link_info has been created now, so its updated\n        if (target_node.onConnectionsChange) {\n            target_node.onConnectionsChange(\n                LiteGraph.INPUT,\n                target_slot,\n                true,\n                link_info,\n                input\n            );\n        }\n        if (this.graph && this.graph.onNodeConnectionChange) {\n            this.graph.onNodeConnectionChange(\n                LiteGraph.INPUT,\n                target_node,\n                target_slot,\n                this,\n                slot\n            );\n            this.graph.onNodeConnectionChange(\n                LiteGraph.OUTPUT,\n                this,\n                slot,\n                target_node,\n                target_slot\n            );\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.afterChange();\n        this.graph.connectionChange(this, link_info);\n\n        return link_info;\n    };\n\n    /**\n     * disconnect one output to an specific node\n     * @method disconnectOutput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} target_node the target node to which this slot is connected [Optional, if not target_node is specified all nodes will be disconnected]\n     * @return {boolean} if it was disconnected successfully\n     */\n    LGraphNode.prototype.disconnectOutput = function(slot, target_node) {\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return false;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        //get output slot\n        var output = this.outputs[slot];\n        if (!output || !output.links || output.links.length == 0) {\n            return false;\n        }\n\n        //one of the output links in this slot\n        if (target_node) {\n            if (target_node.constructor === Number) {\n                target_node = this.graph.getNodeById(target_node);\n            }\n            if (!target_node) {\n                throw \"Target Node not found\";\n            }\n\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n\n                //is the link we are searching for...\n                if (link_info.target_id == target_node.id) {\n                    output.links.splice(i, 1); //remove here\n                    var input = target_node.inputs[link_info.target_slot];\n                    input.link = null; //remove there\n                    delete this.graph.links[link_id]; //remove the link from the links pool\n                    if (this.graph) {\n                        this.graph._version++;\n                    }\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input\n                        );\n                    } //link_info hasn't been modified so its ok\n                    if (this.onConnectionsChange) {\n                        this.onConnectionsChange(\n                            LiteGraph.OUTPUT,\n                            slot,\n                            false,\n                            link_info,\n                            output\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot\n                        );\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot\n                        );\n                    }\n                    break;\n                }\n            }\n        } //all the links in this output slot\n        else {\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n                if (!link_info) {\n                    //bug: it happens sometimes\n                    continue;\n                }\n\n                var target_node = this.graph.getNodeById(link_info.target_id);\n                var input = null;\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (target_node) {\n                    input = target_node.inputs[link_info.target_slot];\n                    input.link = null; //remove other side link\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input\n                        );\n                    } //link_info hasn't been modified so its ok\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot\n                        );\n                    }\n                }\n                delete this.graph.links[link_id]; //remove the link from the links pool\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        LiteGraph.OUTPUT,\n                        slot,\n                        false,\n                        link_info,\n                        output\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.OUTPUT,\n                        this,\n                        slot\n                    );\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.INPUT,\n                        target_node,\n                        link_info.target_slot\n                    );\n                }\n            }\n            output.links = null;\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.connectionChange(this);\n        return true;\n    };\n\n    /**\n     * disconnect one input\n     * @method disconnectInput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @return {boolean} if it was disconnected successfully\n     */\n    LGraphNode.prototype.disconnectInput = function(slot) {\n        //seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findInputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return false;\n            }\n        } else if (!this.inputs || slot >= this.inputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        var input = this.inputs[slot];\n        if (!input) {\n            return false;\n        }\n\n        var link_id = this.inputs[slot].link;\n        if(link_id != null)\n        {\n            this.inputs[slot].link = null;\n\n            //remove other side\n            var link_info = this.graph.links[link_id];\n            if (link_info) {\n                var target_node = this.graph.getNodeById(link_info.origin_id);\n                if (!target_node) {\n                    return false;\n                }\n\n                var output = target_node.outputs[link_info.origin_slot];\n                if (!output || !output.links || output.links.length == 0) {\n                    return false;\n                }\n\n                //search in the inputs list for this link\n                for (var i = 0, l = output.links.length; i < l; i++) {\n                    if (output.links[i] == link_id) {\n                        output.links.splice(i, 1);\n                        break;\n                    }\n                }\n\n                delete this.graph.links[link_id]; //remove from the pool\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        LiteGraph.INPUT,\n                        slot,\n                        false,\n                        link_info,\n                        input\n                    );\n                }\n                if (target_node.onConnectionsChange) {\n                    target_node.onConnectionsChange(\n                        LiteGraph.OUTPUT,\n                        i,\n                        false,\n                        link_info,\n                        output\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.OUTPUT,\n                        target_node,\n                        i\n                    );\n                    this.graph.onNodeConnectionChange(LiteGraph.INPUT, this, slot);\n                }\n            }\n        } //link != null\n\n        this.setDirtyCanvas(false, true);\n        if(this.graph)\n            this.graph.connectionChange(this);\n        return true;\n    };\n\n    /**\n     * returns the center of a connection point in canvas coords\n     * @method getConnectionPos\n     * @param {boolean} is_input true if if a input slot, false if it is an output\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {vec2} out [optional] a place to store the output, to free garbage\n     * @return {[x,y]} the position\n     **/\n    LGraphNode.prototype.getConnectionPos = function(\n        is_input,\n        slot_number,\n        out\n    ) {\n        out = out || new Float32Array(2);\n        var num_slots = 0;\n        if (is_input && this.inputs) {\n            num_slots = this.inputs.length;\n        }\n        if (!is_input && this.outputs) {\n            num_slots = this.outputs.length;\n        }\n\n        var offset = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n\n        if (this.flags.collapsed) {\n            var w = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n            if (this.horizontal) {\n                out[0] = this.pos[0] + w * 0.5;\n                if (is_input) {\n                    out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n                } else {\n                    out[1] = this.pos[1];\n                }\n            } else {\n                if (is_input) {\n                    out[0] = this.pos[0];\n                } else {\n                    out[0] = this.pos[0] + w;\n                }\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            }\n            return out;\n        }\n\n        //weird feature that never got finished\n        if (is_input && slot_number == -1) {\n            out[0] = this.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            out[1] = this.pos[1] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            return out;\n        }\n\n        //hard-coded pos\n        if (\n            is_input &&\n            num_slots > slot_number &&\n            this.inputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.inputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.inputs[slot_number].pos[1];\n            return out;\n        } else if (\n            !is_input &&\n            num_slots > slot_number &&\n            this.outputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.outputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.outputs[slot_number].pos[1];\n            return out;\n        }\n\n        //horizontal distributed slots\n        if (this.horizontal) {\n            out[0] =\n                this.pos[0] + (slot_number + 0.5) * (this.size[0] / num_slots);\n            if (is_input) {\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n            } else {\n                out[1] = this.pos[1] + this.size[1];\n            }\n            return out;\n        }\n\n        //default vertical slots\n        if (is_input) {\n            out[0] = this.pos[0] + offset;\n        } else {\n            out[0] = this.pos[0] + this.size[0] + 1 - offset;\n        }\n        out[1] =\n            this.pos[1] +\n            (slot_number + 0.7) * LiteGraph.NODE_SLOT_HEIGHT +\n            (this.constructor.slot_start_y || 0);\n        return out;\n    };\n\n    /* Force align to grid */\n    LGraphNode.prototype.alignToGrid = function() {\n        this.pos[0] =\n            LiteGraph.CANVAS_GRID_SIZE *\n            Math.round(this.pos[0] / LiteGraph.CANVAS_GRID_SIZE);\n        this.pos[1] =\n            LiteGraph.CANVAS_GRID_SIZE *\n            Math.round(this.pos[1] / LiteGraph.CANVAS_GRID_SIZE);\n    };\n\n    /* Console output */\n    LGraphNode.prototype.trace = function(msg) {\n        if (!this.console) {\n            this.console = [];\n        }\n\n        this.console.push(msg);\n        if (this.console.length > LGraphNode.MAX_CONSOLE) {\n            this.console.shift();\n        }\n\n        if(this.graph.onNodeTrace)\n            this.graph.onNodeTrace(this, msg);\n    };\n\n    /* Forces to redraw or the main canvas (LGraphNode) or the bg canvas (links) */\n    LGraphNode.prototype.setDirtyCanvas = function(\n        dirty_foreground,\n        dirty_background\n    ) {\n        if (!this.graph) {\n            return;\n        }\n        this.graph.sendActionToCanvas(\"setDirty\", [\n            dirty_foreground,\n            dirty_background\n        ]);\n    };\n\n    LGraphNode.prototype.loadImage = function(url) {\n        var img = new Image();\n        img.src = LiteGraph.node_images_path + url;\n        img.ready = false;\n\n        var that = this;\n        img.onload = function() {\n            this.ready = true;\n            that.setDirtyCanvas(true);\n        };\n        return img;\n    };\n\n    //safe LGraphNode action execution (not sure if safe)\n    /*\nLGraphNode.prototype.executeAction = function(action)\n{\n\tif(action == \"\") return false;\n\n\tif( action.indexOf(\";\") != -1 || action.indexOf(\"}\") != -1)\n\t{\n\t\tthis.trace(\"Error: Action contains unsafe characters\");\n\t\treturn false;\n\t}\n\n\tvar tokens = action.split(\"(\");\n\tvar func_name = tokens[0];\n\tif( typeof(this[func_name]) != \"function\")\n\t{\n\t\tthis.trace(\"Error: Action not found on node: \" + func_name);\n\t\treturn false;\n\t}\n\n\tvar code = action;\n\n\ttry\n\t{\n\t\tvar _foo = eval;\n\t\teval = null;\n\t\t(new Function(\"with(this) { \" + code + \"}\")).call(this);\n\t\teval = _foo;\n\t}\n\tcatch (err)\n\t{\n\t\tthis.trace(\"Error executing action {\" + action + \"} :\" + err);\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n*/\n\n    /* Allows to get onMouseMove and onMouseUp events even if the mouse is out of focus */\n    LGraphNode.prototype.captureInput = function(v) {\n        if (!this.graph || !this.graph.list_of_graphcanvas) {\n            return;\n        }\n\n        var list = this.graph.list_of_graphcanvas;\n\n        for (var i = 0; i < list.length; ++i) {\n            var c = list[i];\n            //releasing somebody elses capture?!\n            if (!v && c.node_capturing_input != this) {\n                continue;\n            }\n\n            //change\n            c.node_capturing_input = v ? this : null;\n        }\n    };\n\n    /**\n     * Collapse the node to make it smaller on the canvas\n     * @method collapse\n     **/\n    LGraphNode.prototype.collapse = function(force) {\n        this.graph._version++;\n        if (this.constructor.collapsable === false && !force) {\n            return;\n        }\n        if (!this.flags.collapsed) {\n            this.flags.collapsed = true;\n        } else {\n            this.flags.collapsed = false;\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * Forces the node to do not move or realign on Z\n     * @method pin\n     **/\n\n    LGraphNode.prototype.pin = function(v) {\n        this.graph._version++;\n        if (v === undefined) {\n            this.flags.pinned = !this.flags.pinned;\n        } else {\n            this.flags.pinned = v;\n        }\n    };\n\n    LGraphNode.prototype.localToScreen = function(x, y, graphcanvas) {\n        return [\n            (x + this.pos[0]) * graphcanvas.scale + graphcanvas.offset[0],\n            (y + this.pos[1]) * graphcanvas.scale + graphcanvas.offset[1]\n        ];\n    };\n\n    function LGraphGroup(title) {\n        this._ctor(title);\n    }\n\n    global.LGraphGroup = LiteGraph.LGraphGroup = LGraphGroup;\n\n    LGraphGroup.prototype._ctor = function(title) {\n        this.title = title || \"Group\";\n        this.font_size = 24;\n        this.color = LGraphCanvas.node_colors.pale_blue\n            ? LGraphCanvas.node_colors.pale_blue.groupcolor\n            : \"#AAA\";\n        this._bounding = new Float32Array([10, 10, 140, 80]);\n        this._pos = this._bounding.subarray(0, 2);\n        this._size = this._bounding.subarray(2, 4);\n        this._nodes = [];\n        this.graph = null;\n\n        Object.defineProperty(this, \"pos\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get: function() {\n                return this._pos;\n            },\n            enumerable: true\n        });\n\n        Object.defineProperty(this, \"size\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._size[0] = Math.max(140, v[0]);\n                this._size[1] = Math.max(80, v[1]);\n            },\n            get: function() {\n                return this._size;\n            },\n            enumerable: true\n        });\n    };\n\n    LGraphGroup.prototype.configure = function(o) {\n        this.title = o.title;\n        this._bounding.set(o.bounding);\n        this.color = o.color;\n        if (o.font_size) {\n            this.font_size = o.font_size;\n        }\n    };\n\n    LGraphGroup.prototype.serialize = function() {\n        var b = this._bounding;\n        return {\n            title: this.title,\n            bounding: [\n                Math.round(b[0]),\n                Math.round(b[1]),\n                Math.round(b[2]),\n                Math.round(b[3])\n            ],\n            color: this.color,\n            font_size: this.font_size\n        };\n    };\n\n    LGraphGroup.prototype.move = function(deltax, deltay, ignore_nodes) {\n        this._pos[0] += deltax;\n        this._pos[1] += deltay;\n        if (ignore_nodes) {\n            return;\n        }\n        for (var i = 0; i < this._nodes.length; ++i) {\n            var node = this._nodes[i];\n            node.pos[0] += deltax;\n            node.pos[1] += deltay;\n        }\n    };\n\n    LGraphGroup.prototype.recomputeInsideNodes = function() {\n        this._nodes.length = 0;\n        var nodes = this.graph._nodes;\n        var node_bounding = new Float32Array(4);\n\n        for (var i = 0; i < nodes.length; ++i) {\n            var node = nodes[i];\n            node.getBounding(node_bounding);\n            if (!overlapBounding(this._bounding, node_bounding)) {\n                continue;\n            } //out of the visible area\n            this._nodes.push(node);\n        }\n    };\n\n    LGraphGroup.prototype.isPointInside = LGraphNode.prototype.isPointInside;\n    LGraphGroup.prototype.setDirtyCanvas = LGraphNode.prototype.setDirtyCanvas;\n\n    //****************************************\n\n    //Scale and Offset\n    function DragAndScale(element, skip_events) {\n        this.offset = new Float32Array([0, 0]);\n        this.scale = 1;\n        this.max_scale = 10;\n        this.min_scale = 0.1;\n        this.onredraw = null;\n        this.enabled = true;\n        this.last_mouse = [0, 0];\n        this.element = null;\n        this.visible_area = new Float32Array(4);\n\n        if (element) {\n            this.element = element;\n            if (!skip_events) {\n                this.bindEvents(element);\n            }\n        }\n    }\n\n    LiteGraph.DragAndScale = DragAndScale;\n\n    DragAndScale.prototype.bindEvents = function(element) {\n        this.last_mouse = new Float32Array(2);\n\n        this._binded_mouse_callback = this.onMouse.bind(this);\n\n        LiteGraph.pointerListenerAdd(element,\"down\", this._binded_mouse_callback);\n        LiteGraph.pointerListenerAdd(element,\"move\", this._binded_mouse_callback);\n        LiteGraph.pointerListenerAdd(element,\"up\", this._binded_mouse_callback);\n\n        element.addEventListener(\n            \"mousewheel\",\n            this._binded_mouse_callback,\n            false\n        );\n        element.addEventListener(\"wheel\", this._binded_mouse_callback, false);\n    };\n\n    DragAndScale.prototype.computeVisibleArea = function( viewport ) {\n        if (!this.element) {\n            this.visible_area[0] = this.visible_area[1] = this.visible_area[2] = this.visible_area[3] = 0;\n            return;\n        }\n        var width = this.element.width;\n        var height = this.element.height;\n        var startx = -this.offset[0];\n        var starty = -this.offset[1];\n        if( viewport )\n        {\n            startx += viewport[0] / this.scale;\n            starty += viewport[1] / this.scale;\n            width = viewport[2];\n            height = viewport[3];\n        }\n        var endx = startx + width / this.scale;\n        var endy = starty + height / this.scale;\n        this.visible_area[0] = startx;\n        this.visible_area[1] = starty;\n        this.visible_area[2] = endx - startx;\n        this.visible_area[3] = endy - starty;\n    };\n\n    DragAndScale.prototype.onMouse = function(e) {\n        if (!this.enabled) {\n            return;\n        }\n\n        var canvas = this.element;\n        var rect = canvas.getBoundingClientRect();\n        var x = e.clientX - rect.left;\n        var y = e.clientY - rect.top;\n        e.canvasx = x;\n        e.canvasy = y;\n        e.dragging = this.dragging;\n\n        var is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\n        //console.log(\"pointerevents: DragAndScale onMouse \"+e.type+\" \"+is_inside);\n\n        var ignore = false;\n        if (this.onmouse) {\n            ignore = this.onmouse(e);\n        }\n\n        if (e.type == LiteGraph.pointerevents_method+\"down\" && is_inside) {\n            this.dragging = true;\n            LiteGraph.pointerListenerRemove(canvas,\"move\",this._binded_mouse_callback);\n            LiteGraph.pointerListenerAdd(document,\"move\",this._binded_mouse_callback);\n            LiteGraph.pointerListenerAdd(document,\"up\",this._binded_mouse_callback);\n        } else if (e.type == LiteGraph.pointerevents_method+\"move\") {\n            if (!ignore) {\n                var deltax = x - this.last_mouse[0];\n                var deltay = y - this.last_mouse[1];\n                if (this.dragging) {\n                    this.mouseDrag(deltax, deltay);\n                }\n            }\n        } else if (e.type == LiteGraph.pointerevents_method+\"up\") {\n            this.dragging = false;\n            LiteGraph.pointerListenerRemove(document,\"move\",this._binded_mouse_callback);\n            LiteGraph.pointerListenerRemove(document,\"up\",this._binded_mouse_callback);\n            LiteGraph.pointerListenerAdd(canvas,\"move\",this._binded_mouse_callback);\n        } else if ( is_inside &&\n            (e.type == \"mousewheel\" ||\n                e.type == \"wheel\" ||\n                e.type == \"DOMMouseScroll\")\n        ) {\n            e.eventType = \"mousewheel\";\n            if (e.type == \"wheel\") {\n                e.wheel = -e.deltaY;\n            } else {\n                e.wheel =\n                    e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n            }\n\n            //from stack overflow\n            e.delta = e.wheelDelta\n                ? e.wheelDelta / 40\n                : e.deltaY\n                    ? -e.deltaY / 3\n                    : 0;\n            this.changeDeltaScale(1.0 + e.delta * 0.05);\n        }\n\n        this.last_mouse[0] = x;\n        this.last_mouse[1] = y;\n\n        if(is_inside)\n        {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        }\n    };\n\n    DragAndScale.prototype.toCanvasContext = function(ctx) {\n        ctx.scale(this.scale, this.scale);\n        ctx.translate(this.offset[0], this.offset[1]);\n    };\n\n    DragAndScale.prototype.convertOffsetToCanvas = function(pos) {\n        //return [pos[0] / this.scale - this.offset[0], pos[1] / this.scale - this.offset[1]];\n        return [\n            (pos[0] + this.offset[0]) * this.scale,\n            (pos[1] + this.offset[1]) * this.scale\n        ];\n    };\n\n    DragAndScale.prototype.convertCanvasToOffset = function(pos, out) {\n        out = out || [0, 0];\n        out[0] = pos[0] / this.scale - this.offset[0];\n        out[1] = pos[1] / this.scale - this.offset[1];\n        return out;\n    };\n\n    DragAndScale.prototype.mouseDrag = function(x, y) {\n        this.offset[0] += x / this.scale;\n        this.offset[1] += y / this.scale;\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    };\n\n    DragAndScale.prototype.changeScale = function(value, zooming_center) {\n        if (value < this.min_scale) {\n            value = this.min_scale;\n        } else if (value > this.max_scale) {\n            value = this.max_scale;\n        }\n\n        if (value == this.scale) {\n            return;\n        }\n\n        if (!this.element) {\n            return;\n        }\n\n        var rect = this.element.getBoundingClientRect();\n        if (!rect) {\n            return;\n        }\n\n        zooming_center = zooming_center || [\n            rect.width * 0.5,\n            rect.height * 0.5\n        ];\n        var center = this.convertCanvasToOffset(zooming_center);\n        this.scale = value;\n        if (Math.abs(this.scale - 1) < 0.01) {\n            this.scale = 1;\n        }\n\n        var new_center = this.convertCanvasToOffset(zooming_center);\n        var delta_offset = [\n            new_center[0] - center[0],\n            new_center[1] - center[1]\n        ];\n\n        this.offset[0] += delta_offset[0];\n        this.offset[1] += delta_offset[1];\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    };\n\n    DragAndScale.prototype.changeDeltaScale = function(value, zooming_center) {\n        this.changeScale(this.scale * value, zooming_center);\n    };\n\n    DragAndScale.prototype.reset = function() {\n        this.scale = 1;\n        this.offset[0] = 0;\n        this.offset[1] = 0;\n    };\n\n    //*********************************************************************************\n    // LGraphCanvas: LGraph renderer CLASS\n    //*********************************************************************************\n\n    /**\n     * This class is in charge of rendering one graph inside a canvas. And provides all the interaction required.\n     * Valid callbacks are: onNodeSelected, onNodeDeselected, onShowNodePanel, onNodeDblClicked\n     *\n     * @class LGraphCanvas\n     * @constructor\n     * @param {HTMLCanvas} canvas the canvas where you want to render (it accepts a selector in string format or the canvas element itself)\n     * @param {LGraph} graph [optional]\n     * @param {Object} options [optional] { skip_rendering, autoresize, viewport }\n     */\n    function LGraphCanvas(canvas, graph, options) {\n        this.options = options = options || {};\n\n        //if(graph === undefined)\n        //\tthrow (\"No graph assigned\");\n        this.background_image = LGraphCanvas.DEFAULT_BACKGROUND_IMAGE;\n\n        if (canvas && canvas.constructor === String) {\n            canvas = document.querySelector(canvas);\n        }\n\n        this.ds = new DragAndScale();\n        this.zoom_modify_alpha = true; //otherwise it generates ugly patterns when scaling down too much\n\n        this.title_text_font = \"\" + LiteGraph.NODE_TEXT_SIZE + \"px Arial\";\n        this.inner_text_font =\n            \"normal \" + LiteGraph.NODE_SUBTEXT_SIZE + \"px Arial\";\n        this.node_title_color = LiteGraph.NODE_TITLE_COLOR;\n        this.default_link_color = LiteGraph.LINK_COLOR;\n        this.default_connection_color = {\n            input_off: \"#778\",\n            input_on: \"#7F7\", //\"#BBD\"\n            output_off: \"#778\",\n            output_on: \"#7F7\" //\"#BBD\"\n        };\n        this.default_connection_color_byType = {\n            /*number: \"#7F7\",\n            string: \"#77F\",\n            boolean: \"#F77\",*/\n        }\n        this.default_connection_color_byTypeOff = {\n            /*number: \"#474\",\n            string: \"#447\",\n            boolean: \"#744\",*/\n        };\n\n        this.highquality_render = true;\n        this.use_gradients = false; //set to true to render titlebar with gradients\n        this.editor_alpha = 1; //used for transition\n        this.pause_rendering = false;\n        this.clear_background = true;\n        this.clear_background_color = \"#222\";\n\n        this.read_only = false; //if set to true users cannot modify the graph\n        this.render_only_selected = true;\n        this.live_mode = false;\n        this.show_info = true;\n        this.allow_dragcanvas = true;\n        this.allow_dragnodes = true;\n        this.allow_interaction = true; //allow to control widgets, buttons, collapse, etc\n        this.multi_select = false; //allow selecting multi nodes without pressing extra keys\n        this.allow_searchbox = true;\n        this.allow_reconnect_links = true; //allows to change a connection with having to redo it again\n        this.align_to_grid = false; //snap to grid\n\n        this.drag_mode = false;\n        this.dragging_rectangle = null;\n\n        this.filter = null; //allows to filter to only accept some type of nodes in a graph\n\n        this.set_canvas_dirty_on_mouse_event = true; //forces to redraw the canvas if the mouse does anything\n        this.always_render_background = false;\n        this.render_shadows = true;\n        this.render_canvas_border = true;\n        this.render_connections_shadows = false; //too much cpu\n        this.render_connections_border = true;\n        this.render_curved_connections = false;\n        this.render_connection_arrows = false;\n        this.render_collapsed_slots = true;\n        this.render_execution_order = false;\n        this.render_title_colored = true;\n        this.render_link_tooltip = true;\n\n        this.links_render_mode = LiteGraph.SPLINE_LINK;\n\n        this.mouse = [0, 0]; //mouse in canvas coordinates, where 0,0 is the top-left corner of the blue rectangle\n        this.graph_mouse = [0, 0]; //mouse in graph coordinates, where 0,0 is the top-left corner of the blue rectangle\n        this.canvas_mouse = this.graph_mouse; //LEGACY: REMOVE THIS, USE GRAPH_MOUSE INSTEAD\n\n        //to personalize the search box\n        this.onSearchBox = null;\n        this.onSearchBoxSelection = null;\n\n        //callbacks\n        this.onMouse = null;\n        this.onDrawBackground = null; //to render background objects (behind nodes and connections) in the canvas affected by transform\n        this.onDrawForeground = null; //to render foreground objects (above nodes and connections) in the canvas affected by transform\n        this.onDrawOverlay = null; //to render foreground objects not affected by transform (for GUIs)\n        this.onDrawLinkTooltip = null; //called when rendering a tooltip\n        this.onNodeMoved = null; //called after moving a node\n        this.onSelectionChange = null; //called if the selection changes\n        this.onConnectingChange = null; //called before any link changes\n        this.onBeforeChange = null; //called before modifying the graph\n        this.onAfterChange = null; //called after modifying the graph\n\n        this.connections_width = 3;\n        this.round_radius = 8;\n\n        this.current_node = null;\n        this.node_widget = null; //used for widgets\n        this.over_link_center = null;\n        this.last_mouse_position = [0, 0];\n        this.visible_area = this.ds.visible_area;\n        this.visible_links = [];\n\n        this.viewport = options.viewport || null; //to constraint render area to a portion of the canvas\n\n        //link canvas and graph\n        if (graph) {\n            graph.attachCanvas(this);\n        }\n\n        this.setCanvas(canvas,options.skip_events);\n        this.clear();\n\n        if (!options.skip_render) {\n            this.startRendering();\n        }\n\n        this.autoresize = options.autoresize;\n    }\n\n    global.LGraphCanvas = LiteGraph.LGraphCanvas = LGraphCanvas;\n\n    LGraphCanvas.DEFAULT_BACKGROUND_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=\";\n\n    LGraphCanvas.link_type_colors = {\n        \"-1\": LiteGraph.EVENT_LINK_COLOR,\n        number: \"#AAA\",\n        node: \"#DCA\"\n    };\n    LGraphCanvas.gradients = {}; //cache of gradients\n\n    /**\n     * clears all the data inside\n     *\n     * @method clear\n     */\n    LGraphCanvas.prototype.clear = function() {\n        this.frame = 0;\n        this.last_draw_time = 0;\n        this.render_time = 0;\n        this.fps = 0;\n\n        //this.scale = 1;\n        //this.offset = [0,0];\n\n        this.dragging_rectangle = null;\n\n        this.selected_nodes = {};\n        this.selected_group = null;\n\n        this.visible_nodes = [];\n        this.node_dragged = null;\n        this.node_over = null;\n        this.node_capturing_input = null;\n        this.connecting_node = null;\n        this.highlighted_links = {};\n\n        this.dragging_canvas = false;\n\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n        this.dirty_area = null;\n\n        this.node_in_panel = null;\n        this.node_widget = null;\n\n        this.last_mouse = [0, 0];\n        this.last_mouseclick = 0;\n        this.pointer_is_down = false;\n        this.pointer_is_double = false;\n        this.visible_area.set([0, 0, 0, 0]);\n\n        if (this.onClear) {\n            this.onClear();\n        }\n    };\n\n    /**\n     * assigns a graph, you can reassign graphs to the same canvas\n     *\n     * @method setGraph\n     * @param {LGraph} graph\n     */\n    LGraphCanvas.prototype.setGraph = function(graph, skip_clear) {\n        if (this.graph == graph) {\n            return;\n        }\n\n        if (!skip_clear) {\n            this.clear();\n        }\n\n        if (!graph && this.graph) {\n            this.graph.detachCanvas(this);\n            return;\n        }\n\n        graph.attachCanvas(this);\n\n        //remove the graph stack in case a subgraph was open\n        if (this._graph_stack)\n            this._graph_stack = null;\n\n        this.setDirty(true, true);\n    };\n\n    /**\n     * returns the top level graph (in case there are subgraphs open on the canvas)\n     *\n     * @method getTopGraph\n     * @return {LGraph} graph\n     */\n    LGraphCanvas.prototype.getTopGraph = function()\n    {\n        if(this._graph_stack.length)\n            return this._graph_stack[0];\n        return this.graph;\n    }\n\n    /**\n     * opens a graph contained inside a node in the current graph\n     *\n     * @method openSubgraph\n     * @param {LGraph} graph\n     */\n    LGraphCanvas.prototype.openSubgraph = function(graph) {\n        if (!graph) {\n            throw \"graph cannot be null\";\n        }\n\n        if (this.graph == graph) {\n            throw \"graph cannot be the same\";\n        }\n\n        this.clear();\n\n        if (this.graph) {\n            if (!this._graph_stack) {\n                this._graph_stack = [];\n            }\n            this._graph_stack.push(this.graph);\n        }\n\n        graph.attachCanvas(this);\n        this.checkPanels();\n        this.setDirty(true, true);\n    };\n\n    /**\n     * closes a subgraph contained inside a node\n     *\n     * @method closeSubgraph\n     * @param {LGraph} assigns a graph\n     */\n    LGraphCanvas.prototype.closeSubgraph = function() {\n        if (!this._graph_stack || this._graph_stack.length == 0) {\n            return;\n        }\n        var subgraph_node = this.graph._subgraph_node;\n        var graph = this._graph_stack.pop();\n        this.selected_nodes = {};\n        this.highlighted_links = {};\n        graph.attachCanvas(this);\n        this.setDirty(true, true);\n        if (subgraph_node) {\n            this.centerOnNode(subgraph_node);\n            this.selectNodes([subgraph_node]);\n        }\n        // when close sub graph back to offset [0, 0] scale 1\n        this.ds.offset = [0, 0]\n        this.ds.scale = 1\n    };\n\n    /**\n     * returns the visually active graph (in case there are more in the stack)\n     * @method getCurrentGraph\n     * @return {LGraph} the active graph\n     */\n    LGraphCanvas.prototype.getCurrentGraph = function() {\n        return this.graph;\n    };\n\n    /**\n     * assigns a canvas\n     *\n     * @method setCanvas\n     * @param {Canvas} assigns a canvas (also accepts the ID of the element (not a selector)\n     */\n    LGraphCanvas.prototype.setCanvas = function(canvas, skip_events) {\n        var that = this;\n\n        if (canvas) {\n            if (canvas.constructor === String) {\n                canvas = document.getElementById(canvas);\n                if (!canvas) {\n                    throw \"Error creating LiteGraph canvas: Canvas not found\";\n                }\n            }\n        }\n\n        if (canvas === this.canvas) {\n            return;\n        }\n\n        if (!canvas && this.canvas) {\n            //maybe detach events from old_canvas\n            if (!skip_events) {\n                this.unbindEvents();\n            }\n        }\n\n        this.canvas = canvas;\n        this.ds.element = canvas;\n\n        if (!canvas) {\n            return;\n        }\n\n        //this.canvas.tabindex = \"1000\";\n        canvas.className += \" lgraphcanvas\";\n        canvas.data = this;\n        canvas.tabindex = \"1\"; //to allow key events\n\n        //bg canvas: used for non changing stuff\n        this.bgcanvas = null;\n        if (!this.bgcanvas) {\n            this.bgcanvas = document.createElement(\"canvas\");\n            this.bgcanvas.width = this.canvas.width;\n            this.bgcanvas.height = this.canvas.height;\n        }\n\n        if (canvas.getContext == null) {\n            if (canvas.localName != \"canvas\") {\n                throw \"Element supplied for LGraphCanvas must be a <canvas> element, you passed a \" +\n                canvas.localName;\n            }\n            throw \"This browser doesn't support Canvas\";\n        }\n\n        var ctx = (this.ctx = canvas.getContext(\"2d\"));\n        if (ctx == null) {\n            if (!canvas.webgl_enabled) {\n                console.warn(\n                    \"This canvas seems to be WebGL, enabling WebGL renderer\"\n                );\n            }\n            this.enableWebGL();\n        }\n\n        //input:  (move and up could be unbinded)\n        // why here? this._mousemove_callback = this.processMouseMove.bind(this);\n        // why here? this._mouseup_callback = this.processMouseUp.bind(this);\n\n        if (!skip_events) {\n            this.bindEvents();\n        }\n    };\n\n    //used in some events to capture them\n    LGraphCanvas.prototype._doNothing = function doNothing(e) {\n        //console.log(\"pointerevents: _doNothing \"+e.type);\n        e.preventDefault();\n        return false;\n    };\n    LGraphCanvas.prototype._doReturnTrue = function doNothing(e) {\n        e.preventDefault();\n        return true;\n    };\n\n    /**\n     * binds mouse, keyboard, touch and drag events to the canvas\n     * @method bindEvents\n     **/\n    LGraphCanvas.prototype.bindEvents = function() {\n        if (this._events_binded) {\n            console.warn(\"LGraphCanvas: events already binded\");\n            return;\n        }\n\n        //console.log(\"pointerevents: bindEvents\");\n\n        var canvas = this.canvas;\n\n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document; //hack used when moving canvas between windows\n\n        this._mousedown_callback = this.processMouseDown.bind(this);\n        this._mousewheel_callback = this.processMouseWheel.bind(this);\n        // why mousemove and mouseup were not binded here?\n        this._mousemove_callback = this.processMouseMove.bind(this);\n        this._mouseup_callback = this.processMouseUp.bind(this);\n\n        //touch events -- TODO IMPLEMENT\n        //this._touch_callback = this.touchHandler.bind(this);\n\n        LiteGraph.pointerListenerAdd(canvas,\"down\", this._mousedown_callback, true); //down do not need to store the binded\n        canvas.addEventListener(\"mousewheel\", this._mousewheel_callback, false);\n\n        LiteGraph.pointerListenerAdd(canvas,\"up\", this._mouseup_callback, true); // CHECK: ??? binded or not\n        LiteGraph.pointerListenerAdd(canvas,\"move\", this._mousemove_callback);\n\n        canvas.addEventListener(\"contextmenu\", this._doNothing);\n        canvas.addEventListener(\n            \"DOMMouseScroll\",\n            this._mousewheel_callback,\n            false\n        );\n\n        //touch events -- THIS WAY DOES NOT WORK, finish implementing pointerevents, than clean the touchevents\n        /*if( 'touchstart' in document.documentElement )\n        {\n            canvas.addEventListener(\"touchstart\", this._touch_callback, true);\n            canvas.addEventListener(\"touchmove\", this._touch_callback, true);\n            canvas.addEventListener(\"touchend\", this._touch_callback, true);\n            canvas.addEventListener(\"touchcancel\", this._touch_callback, true);\n        }*/\n\n        //Keyboard ******************\n        this._key_callback = this.processKey.bind(this);\n\n        canvas.addEventListener(\"keydown\", this._key_callback, true);\n        document.addEventListener(\"keyup\", this._key_callback, true); //in document, otherwise it doesn't fire keyup\n\n        //Dropping Stuff over nodes ************************************\n        this._ondrop_callback = this.processDrop.bind(this);\n\n        canvas.addEventListener(\"dragover\", this._doNothing, false);\n        canvas.addEventListener(\"dragend\", this._doNothing, false);\n        canvas.addEventListener(\"drop\", this._ondrop_callback, false);\n        canvas.addEventListener(\"dragenter\", this._doReturnTrue, false);\n\n        this._events_binded = true;\n    };\n\n    /**\n     * unbinds mouse events from the canvas\n     * @method unbindEvents\n     **/\n    LGraphCanvas.prototype.unbindEvents = function() {\n        if (!this._events_binded) {\n            console.warn(\"LGraphCanvas: no events binded\");\n            return;\n        }\n\n        //console.log(\"pointerevents: unbindEvents\");\n\n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document;\n\n        LiteGraph.pointerListenerRemove(this.canvas,\"move\", this._mousedown_callback);\n        LiteGraph.pointerListenerRemove(this.canvas,\"up\", this._mousedown_callback);\n        LiteGraph.pointerListenerRemove(this.canvas,\"down\", this._mousedown_callback);\n        this.canvas.removeEventListener(\n            \"mousewheel\",\n            this._mousewheel_callback\n        );\n        this.canvas.removeEventListener(\n            \"DOMMouseScroll\",\n            this._mousewheel_callback\n        );\n        this.canvas.removeEventListener(\"keydown\", this._key_callback);\n        document.removeEventListener(\"keyup\", this._key_callback);\n        this.canvas.removeEventListener(\"contextmenu\", this._doNothing);\n        this.canvas.removeEventListener(\"drop\", this._ondrop_callback);\n        this.canvas.removeEventListener(\"dragenter\", this._doReturnTrue);\n\n        //touch events -- THIS WAY DOES NOT WORK, finish implementing pointerevents, than clean the touchevents\n        /*this.canvas.removeEventListener(\"touchstart\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchmove\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchend\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchcancel\", this._touch_callback );*/\n\n        this._mousedown_callback = null;\n        this._mousewheel_callback = null;\n        this._key_callback = null;\n        this._ondrop_callback = null;\n\n        this._events_binded = false;\n    };\n\n    LGraphCanvas.getFileExtension = function(url) {\n        var question = url.indexOf(\"?\");\n        if (question != -1) {\n            url = url.substr(0, question);\n        }\n        var point = url.lastIndexOf(\".\");\n        if (point == -1) {\n            return \"\";\n        }\n        return url.substr(point + 1).toLowerCase();\n    };\n\n    /**\n     * this function allows to render the canvas using WebGL instead of Canvas2D\n     * this is useful if you plant to render 3D objects inside your nodes, it uses litegl.js for webgl and canvas2DtoWebGL to emulate the Canvas2D calls in webGL\n     * @method enableWebGL\n     **/\n    LGraphCanvas.prototype.enableWebGL = function() {\n        if (typeof GL === \"undefined\") {\n            throw \"litegl.js must be included to use a WebGL canvas\";\n        }\n        if (typeof enableWebGLCanvas === \"undefined\") {\n            throw \"webglCanvas.js must be included to use this feature\";\n        }\n\n        this.gl = this.ctx = enableWebGLCanvas(this.canvas);\n        this.ctx.webgl = true;\n        this.bgcanvas = this.canvas;\n        this.bgctx = this.gl;\n        this.canvas.webgl_enabled = true;\n\n        /*\n\tGL.create({ canvas: this.bgcanvas });\n\tthis.bgctx = enableWebGLCanvas( this.bgcanvas );\n\twindow.gl = this.gl;\n\t*/\n    };\n\n    /**\n     * marks as dirty the canvas, this way it will be rendered again\n     *\n     * @class LGraphCanvas\n     * @method setDirty\n     * @param {bool} fgcanvas if the foreground canvas is dirty (the one containing the nodes)\n     * @param {bool} bgcanvas if the background canvas is dirty (the one containing the wires)\n     */\n    LGraphCanvas.prototype.setDirty = function(fgcanvas, bgcanvas) {\n        if (fgcanvas) {\n            this.dirty_canvas = true;\n        }\n        if (bgcanvas) {\n            this.dirty_bgcanvas = true;\n        }\n    };\n\n    /**\n     * Used to attach the canvas in a popup\n     *\n     * @method getCanvasWindow\n     * @return {window} returns the window where the canvas is attached (the DOM root node)\n     */\n    LGraphCanvas.prototype.getCanvasWindow = function() {\n        if (!this.canvas) {\n            return window;\n        }\n        var doc = this.canvas.ownerDocument;\n        return doc.defaultView || doc.parentWindow;\n    };\n\n    /**\n     * starts rendering the content of the canvas when needed\n     *\n     * @method startRendering\n     */\n    LGraphCanvas.prototype.startRendering = function() {\n        if (this.is_rendering) {\n            return;\n        } //already rendering\n\n        this.is_rendering = true;\n        renderFrame.call(this);\n\n        function renderFrame() {\n            if (!this.pause_rendering) {\n                this.draw();\n            }\n\n            var window = this.getCanvasWindow();\n            if (this.is_rendering) {\n                window.requestAnimationFrame(renderFrame.bind(this));\n            }\n        }\n    };\n\n    /**\n     * stops rendering the content of the canvas (to save resources)\n     *\n     * @method stopRendering\n     */\n    LGraphCanvas.prototype.stopRendering = function() {\n        this.is_rendering = false;\n        /*\n\tif(this.rendering_timer_id)\n\t{\n\t\tclearInterval(this.rendering_timer_id);\n\t\tthis.rendering_timer_id = null;\n\t}\n\t*/\n    };\n\n    /* LiteGraphCanvas input */\n\n    //used to block future mouse events (because of im gui)\n    LGraphCanvas.prototype.blockClick = function()\n    {\n        this.block_click = true;\n        this.last_mouseclick = 0;\n    }\n\n    LGraphCanvas.prototype.processMouseDown = function(e) {\n\n        if( this.set_canvas_dirty_on_mouse_event )\n            this.dirty_canvas = true;\n\n        if (!this.graph) {\n            return;\n        }\n\n        this.adjustMouseEvent(e);\n\n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document;\n        LGraphCanvas.active_canvas = this;\n        var that = this;\n\n        var x = e.clientX;\n        var y = e.clientY;\n        //console.log(y,this.viewport);\n        //console.log(\"pointerevents: processMouseDown pointerId:\"+e.pointerId+\" which:\"+e.which+\" isPrimary:\"+e.isPrimary+\" :: x y \"+x+\" \"+y);\n\n        this.ds.viewport = this.viewport;\n        var is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\n        //move mouse move event to the window in case it drags outside of the canvas\n        if(!this.options.skip_events)\n        {\n            LiteGraph.pointerListenerRemove(this.canvas,\"move\", this._mousemove_callback);\n            LiteGraph.pointerListenerAdd(ref_window.document,\"move\", this._mousemove_callback,true); //catch for the entire window\n            LiteGraph.pointerListenerAdd(ref_window.document,\"up\", this._mouseup_callback,true);\n        }\n\n        if(!is_inside){\n            return;\n        }\n\n        var node = this.graph.getNodeOnPos( e.canvasX, e.canvasY, this.visible_nodes, 5 );\n        var skip_dragging = false;\n        var skip_action = false;\n        var now = LiteGraph.getTime();\n        var is_primary = (e.isPrimary === undefined || !e.isPrimary);\n        var is_double_click = (now - this.last_mouseclick < 300);\n        this.mouse[0] = e.clientX;\n        this.mouse[1] = e.clientY;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n        this.last_click_position = [this.mouse[0],this.mouse[1]];\n\n        if (this.pointer_is_down && is_primary ){\n            this.pointer_is_double = true;\n            //console.log(\"pointerevents: pointer_is_double start\");\n        }else{\n            this.pointer_is_double = false;\n        }\n        this.pointer_is_down = true;\n\n\n        this.canvas.focus();\n\n        LiteGraph.closeAllContextMenus(ref_window);\n\n        if (this.onMouse)\n        {\n            if (this.onMouse(e) == true)\n                return;\n        }\n\n        //left button mouse / single finger\n        if (e.which == 1 && !this.pointer_is_double)\n        {\n            if (e.ctrlKey)\n            {\n                this.dragging_rectangle = new Float32Array(4);\n                this.dragging_rectangle[0] = e.canvasX;\n                this.dragging_rectangle[1] = e.canvasY;\n                this.dragging_rectangle[2] = 1;\n                this.dragging_rectangle[3] = 1;\n                skip_action = true;\n            }\n\n            // clone node ALT dragging\n            if (LiteGraph.alt_drag_do_clone_nodes && e.altKey && node && this.allow_interaction && !skip_action && !this.read_only)\n            {\n                if (cloned = node.clone()){\n                    cloned.pos[0] += 5;\n                    cloned.pos[1] += 5;\n                    this.graph.add(cloned,false,{doCalcSize: false});\n                    node = cloned;\n                    skip_action = true;\n                    if (!block_drag_node) {\n                        if (this.allow_dragnodes) {\n                            this.graph.beforeChange();\n                            this.node_dragged = node;\n                        }\n                        if (!this.selected_nodes[node.id]) {\n                            this.processNodeSelected(node, e);\n                        }\n                    }\n                }\n            }\n\n            var clicking_canvas_bg = false;\n\n            //when clicked on top of a node\n            //and it is not interactive\n            if (node && (this.allow_interaction || node.flags.allow_interaction) && !skip_action && !this.read_only) {\n                if (!this.live_mode && !node.flags.pinned) {\n                    this.bringToFront(node);\n                } //if it wasn't selected?\n\n                //not dragging mouse to connect two slots\n                if ( this.allow_interaction && !this.connecting_node && !node.flags.collapsed && !this.live_mode ) {\n                    //Search for corner for resize\n                    if ( !skip_action &&\n                        node.resizable !== false && node.inResizeCorner(e.canvasX, e.canvasY)\n                    ) {\n                        this.graph.beforeChange();\n                        this.resizing_node = node;\n                        this.canvas.style.cursor = \"se-resize\";\n                        skip_action = true;\n                    } else {\n                        //search for outputs\n                        if (node.outputs) {\n                            for ( var i = 0, l = node.outputs.length; i < l; ++i ) {\n                                var output = node.outputs[i];\n                                var link_pos = node.getConnectionPos(false, i);\n                                if (\n                                    isInsideRectangle(\n                                        e.canvasX,\n                                        e.canvasY,\n                                        link_pos[0] - 15,\n                                        link_pos[1] - 10,\n                                        30,\n                                        20\n                                    )\n                                ) {\n                                    this.connecting_node = node;\n                                    this.connecting_output = output;\n                                    this.connecting_output.slot_index = i;\n                                    this.connecting_pos = node.getConnectionPos( false, i );\n                                    this.connecting_slot = i;\n\n                                    if (LiteGraph.shift_click_do_break_link_from){\n                                        if (e.shiftKey) {\n                                            node.disconnectOutput(i);\n                                        }\n                                    }\n\n                                    if (is_double_click) {\n                                        if (node.onOutputDblClick) {\n                                            node.onOutputDblClick(i, e);\n                                        }\n                                    } else {\n                                        if (node.onOutputClick) {\n                                            node.onOutputClick(i, e);\n                                        }\n                                    }\n\n                                    skip_action = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        //search for inputs\n                        if (node.inputs) {\n                            for ( var i = 0, l = node.inputs.length; i < l; ++i ) {\n                                var input = node.inputs[i];\n                                var link_pos = node.getConnectionPos(true, i);\n                                if (\n                                    isInsideRectangle(\n                                        e.canvasX,\n                                        e.canvasY,\n                                        link_pos[0] - 15,\n                                        link_pos[1] - 10,\n                                        30,\n                                        20\n                                    )\n                                ) {\n                                    if (is_double_click) {\n                                        if (node.onInputDblClick) {\n                                            node.onInputDblClick(i, e);\n                                        }\n                                    } else {\n                                        if (node.onInputClick) {\n                                            node.onInputClick(i, e);\n                                        }\n                                    }\n\n                                    if (input.link !== null) {\n                                        var link_info = this.graph.links[\n                                            input.link\n                                            ]; //before disconnecting\n                                        if (LiteGraph.click_do_break_link_to){\n                                            node.disconnectInput(i);\n                                            this.dirty_bgcanvas = true;\n                                            skip_action = true;\n                                        }else{\n                                            // do same action as has not node ?\n                                        }\n\n                                        if (\n                                            this.allow_reconnect_links ||\n                                            //this.move_destination_link_without_shift ||\n                                            e.shiftKey\n                                        ) {\n                                            if (!LiteGraph.click_do_break_link_to){\n                                                node.disconnectInput(i);\n                                            }\n                                            this.connecting_node = this.graph._nodes_by_id[\n                                                link_info.origin_id\n                                                ];\n                                            this.connecting_slot =\n                                                link_info.origin_slot;\n                                            this.connecting_output = this.connecting_node.outputs[\n                                                this.connecting_slot\n                                                ];\n                                            this.connecting_pos = this.connecting_node.getConnectionPos( false, this.connecting_slot );\n\n                                            this.dirty_bgcanvas = true;\n                                            skip_action = true;\n                                        }\n\n\n                                    }else{\n                                        // has not node\n                                    }\n\n                                    if (!skip_action){\n                                        // connect from in to out, from to to from\n                                        this.connecting_node = node;\n                                        this.connecting_input = input;\n                                        this.connecting_input.slot_index = i;\n                                        this.connecting_pos = node.getConnectionPos( true, i );\n                                        this.connecting_slot = i;\n\n                                        this.dirty_bgcanvas = true;\n                                        skip_action = true;\n                                    }\n                                }\n                            }\n                        }\n                    } //not resizing\n                }\n\n                //it wasn't clicked on the links boxes\n                if (!skip_action) {\n                    var block_drag_node = false;\n                    if(node && node.flags && node.flags.pinned) {\n                        block_drag_node = true;\n                    }\n                    var pos = [e.canvasX - node.pos[0], e.canvasY - node.pos[1]];\n\n                    //widgets\n                    var widget = this.processNodeWidgets( node, this.graph_mouse, e );\n                    if (widget) {\n                        block_drag_node = true;\n                        this.node_widget = [node, widget];\n                    }\n\n                    //double clicking\n                    if (this.allow_interaction && is_double_click && this.selected_nodes[node.id]) {\n                        //double click node\n                        if (node.onDblClick) {\n                            node.onDblClick( e, pos, this );\n                        }\n                        this.processNodeDblClicked(node);\n                        block_drag_node = true;\n                    }\n\n                    //if do not capture mouse\n                    if ( node.onMouseDown && node.onMouseDown( e, pos, this ) ) {\n                        block_drag_node = true;\n                    } else {\n                        //open subgraph button\n                        if(node.subgraph && !node.skip_subgraph_button)\n                        {\n                            if ( !node.flags.collapsed && pos[0] > node.size[0] - LiteGraph.NODE_TITLE_HEIGHT && pos[1] < 0 ) {\n                                var that = this;\n                                setTimeout(function() {\n                                    that.openSubgraph(node.subgraph);\n                                }, 10);\n                            }\n                        }\n\n                        if (this.live_mode) {\n                            clicking_canvas_bg = true;\n                            block_drag_node = true;\n                        }\n                    }\n\n                    if (!block_drag_node) {\n                        if (this.allow_dragnodes) {\n                            this.graph.beforeChange();\n                            this.node_dragged = node;\n                        }\n                        this.processNodeSelected(node, e);\n                    } else { // double-click\n                        /**\n                         * Don't call the function if the block is already selected.\n                         * Otherwise, it could cause the block to be unselected while its panel is open.\n                         */\n                        if (!node.is_selected) this.processNodeSelected(node, e);\n                    }\n\n                    this.dirty_canvas = true;\n                }\n            } //clicked outside of nodes\n            else {\n                if (!skip_action){\n                    //search for link connector\n                    if(!this.read_only) {\n                        for (var i = 0; i < this.visible_links.length; ++i) {\n                            var link = this.visible_links[i];\n                            var center = link._pos;\n                            if (\n                                !center ||\n                                e.canvasX < center[0] - 4 ||\n                                e.canvasX > center[0] + 4 ||\n                                e.canvasY < center[1] - 4 ||\n                                e.canvasY > center[1] + 4\n                            ) {\n                                continue;\n                            }\n                            //link clicked\n                            this.showLinkMenu(link, e);\n                            this.over_link_center = null; //clear tooltip\n                            break;\n                        }\n                    }\n\n                    this.selected_group = this.graph.getGroupOnPos( e.canvasX, e.canvasY );\n                    this.selected_group_resizing = false;\n                    if (this.selected_group && !this.read_only ) {\n                        if (e.ctrlKey) {\n                            this.dragging_rectangle = null;\n                        }\n\n                        var dist = distance( [e.canvasX, e.canvasY], [ this.selected_group.pos[0] + this.selected_group.size[0], this.selected_group.pos[1] + this.selected_group.size[1] ] );\n                        if (dist * this.ds.scale < 10) {\n                            this.selected_group_resizing = true;\n                        } else {\n                            this.selected_group.recomputeInsideNodes();\n                        }\n                    }\n\n                    if (is_double_click && !this.read_only && this.allow_searchbox) {\n                        this.showSearchBox(e);\n                        e.preventDefault();\n                        e.stopPropagation();\n                    }\n\n                    clicking_canvas_bg = true;\n                }\n            }\n\n            if (!skip_action && clicking_canvas_bg && this.allow_dragcanvas) {\n                //console.log(\"pointerevents: dragging_canvas start\");\n                this.dragging_canvas = true;\n            }\n\n        } else if (e.which == 2) {\n            //middle button\n\n            if (LiteGraph.middle_click_slot_add_default_node){\n                if (node && this.allow_interaction && !skip_action && !this.read_only){\n                    //not dragging mouse to connect two slots\n                    if (\n                        !this.connecting_node &&\n                        !node.flags.collapsed &&\n                        !this.live_mode\n                    ) {\n                        var mClikSlot = false;\n                        var mClikSlot_index = false;\n                        var mClikSlot_isOut = false;\n                        //search for outputs\n                        if (node.outputs) {\n                            for ( var i = 0, l = node.outputs.length; i < l; ++i ) {\n                                var output = node.outputs[i];\n                                var link_pos = node.getConnectionPos(false, i);\n                                if (isInsideRectangle(e.canvasX,e.canvasY,link_pos[0] - 15,link_pos[1] - 10,30,20)) {\n                                    mClikSlot = output;\n                                    mClikSlot_index = i;\n                                    mClikSlot_isOut = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        //search for inputs\n                        if (node.inputs) {\n                            for ( var i = 0, l = node.inputs.length; i < l; ++i ) {\n                                var input = node.inputs[i];\n                                var link_pos = node.getConnectionPos(true, i);\n                                if (isInsideRectangle(e.canvasX,e.canvasY,link_pos[0] - 15,link_pos[1] - 10,30,20)) {\n                                    mClikSlot = input;\n                                    mClikSlot_index = i;\n                                    mClikSlot_isOut = false;\n                                    break;\n                                }\n                            }\n                        }\n                        //console.log(\"middleClickSlots? \"+mClikSlot+\" & \"+(mClikSlot_index!==false));\n                        if (mClikSlot && mClikSlot_index!==false){\n\n                            var alphaPosY = 0.5-((mClikSlot_index+1)/((mClikSlot_isOut?node.outputs.length:node.inputs.length)));\n                            var node_bounding = node.getBounding();\n                            // estimate a position: this is a bad semi-bad-working mess .. REFACTOR with a correct autoplacement that knows about the others slots and nodes\n                            var posRef = [\t(!mClikSlot_isOut?node_bounding[0]:node_bounding[0]+node_bounding[2])// + node_bounding[0]/this.canvas.width*150\n                                ,e.canvasY-80// + node_bounding[0]/this.canvas.width*66 // vertical \"derive\"\n                            ];\n                            var nodeCreated = this.createDefaultNodeForSlot({   \tnodeFrom: !mClikSlot_isOut?null:node\n                                ,slotFrom: !mClikSlot_isOut?null:mClikSlot_index\n                                ,nodeTo: !mClikSlot_isOut?node:null\n                                ,slotTo: !mClikSlot_isOut?mClikSlot_index:null\n                                ,position: posRef //,e: e\n                                ,nodeType: \"AUTO\" //nodeNewType\n                                ,posAdd:[!mClikSlot_isOut?-30:30, -alphaPosY*130] //-alphaPosY*30]\n                                ,posSizeFix:[!mClikSlot_isOut?-1:0, 0] //-alphaPosY*2*/\n                            });\n                            skip_action = true;\n                        }\n                    }\n                }\n            }\n\n            if (!skip_action && this.allow_dragcanvas) {\n                //console.log(\"pointerevents: dragging_canvas start from middle button\");\n                this.dragging_canvas = true;\n            }\n\n\n        } else if (e.which == 3 || this.pointer_is_double) {\n\n            //right button\n            if (this.allow_interaction && !skip_action && !this.read_only){\n\n                // is it hover a node ?\n                if (node){\n                    if(Object.keys(this.selected_nodes).length\n                        && (this.selected_nodes[node.id] || e.shiftKey || e.ctrlKey || e.metaKey)\n                    ){\n                        // is multiselected or using shift to include the now node\n                        if (!this.selected_nodes[node.id]) this.selectNodes([node],true); // add this if not present\n                    }else{\n                        // update selection\n                        this.selectNodes([node]);\n                    }\n                }\n\n                // show menu on this node\n                this.processContextMenu(node, e);\n            }\n\n        }\n\n        //TODO\n        //if(this.node_selected != prev_selected)\n        //\tthis.onNodeSelectionChange(this.node_selected);\n\n        this.last_mouse[0] = e.clientX;\n        this.last_mouse[1] = e.clientY;\n        this.last_mouseclick = LiteGraph.getTime();\n        this.last_mouse_dragging = true;\n\n        /*\n\tif( (this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\n\t\tthis.draw();\n\t*/\n\n        this.graph.change();\n\n        //this is to ensure to defocus(blur) if a text input element is on focus\n        if (\n            !ref_window.document.activeElement ||\n            (ref_window.document.activeElement.nodeName.toLowerCase() !=\n                \"input\" &&\n                ref_window.document.activeElement.nodeName.toLowerCase() !=\n                \"textarea\")\n        ) {\n            e.preventDefault();\n        }\n        e.stopPropagation();\n\n        if (this.onMouseDown) {\n            this.onMouseDown(e);\n        }\n\n        return false;\n    };\n\n    /**\n     * Called when a mouse move event has to be processed\n     * @method processMouseMove\n     **/\n    LGraphCanvas.prototype.processMouseMove = function(e) {\n        if (this.autoresize) {\n            this.resize();\n        }\n\n        if( this.set_canvas_dirty_on_mouse_event )\n            this.dirty_canvas = true;\n\n        if (!this.graph) {\n            return;\n        }\n\n        LGraphCanvas.active_canvas = this;\n        this.adjustMouseEvent(e);\n        var mouse = [e.clientX, e.clientY];\n        this.mouse[0] = mouse[0];\n        this.mouse[1] = mouse[1];\n        var delta = [\n            mouse[0] - this.last_mouse[0],\n            mouse[1] - this.last_mouse[1]\n        ];\n        this.last_mouse = mouse;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n\n        //console.log(\"pointerevents: processMouseMove \"+e.pointerId+\" \"+e.isPrimary);\n\n        if(this.block_click)\n        {\n            //console.log(\"pointerevents: processMouseMove block_click\");\n            e.preventDefault();\n            return false;\n        }\n\n        e.dragging = this.last_mouse_dragging;\n\n        if (this.node_widget) {\n            this.processNodeWidgets(\n                this.node_widget[0],\n                this.graph_mouse,\n                e,\n                this.node_widget[1]\n            );\n            this.dirty_canvas = true;\n        }\n\n        //get node over\n        var node = this.graph.getNodeOnPos(e.canvasX,e.canvasY,this.visible_nodes);\n\n        if (this.dragging_rectangle)\n        {\n            this.dragging_rectangle[2] = e.canvasX - this.dragging_rectangle[0];\n            this.dragging_rectangle[3] = e.canvasY - this.dragging_rectangle[1];\n            this.dirty_canvas = true;\n        }\n        else if (this.selected_group && !this.read_only)\n        {\n            //moving/resizing a group\n            if (this.selected_group_resizing) {\n                this.selected_group.size = [\n                    e.canvasX - this.selected_group.pos[0],\n                    e.canvasY - this.selected_group.pos[1]\n                ];\n            } else {\n                var deltax = delta[0] / this.ds.scale;\n                var deltay = delta[1] / this.ds.scale;\n                this.selected_group.move(deltax, deltay, e.ctrlKey);\n                if (this.selected_group._nodes.length) {\n                    this.dirty_canvas = true;\n                }\n            }\n            this.dirty_bgcanvas = true;\n        } else if (this.dragging_canvas) {\n            ////console.log(\"pointerevents: processMouseMove is dragging_canvas\");\n            this.ds.offset[0] += delta[0] / this.ds.scale;\n            this.ds.offset[1] += delta[1] / this.ds.scale;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n        } else if ((this.allow_interaction || (node && node.flags.allow_interaction)) && !this.read_only) {\n            if (this.connecting_node) {\n                this.dirty_canvas = true;\n            }\n\n            //remove mouseover flag\n            for (var i = 0, l = this.graph._nodes.length; i < l; ++i) {\n                if (this.graph._nodes[i].mouseOver && node != this.graph._nodes[i] ) {\n                    //mouse leave\n                    this.graph._nodes[i].mouseOver = false;\n                    if (this.node_over && this.node_over.onMouseLeave) {\n                        this.node_over.onMouseLeave(e);\n                    }\n                    this.node_over = null;\n                    this.dirty_canvas = true;\n                }\n            }\n\n            //mouse over a node\n            if (node) {\n\n                if(node.redraw_on_mouse)\n                    this.dirty_canvas = true;\n\n                //this.canvas.style.cursor = \"move\";\n                if (!node.mouseOver) {\n                    //mouse enter\n                    node.mouseOver = true;\n                    this.node_over = node;\n                    this.dirty_canvas = true;\n\n                    if (node.onMouseEnter) {\n                        node.onMouseEnter(e);\n                    }\n                }\n\n                //in case the node wants to do something\n                if (node.onMouseMove) {\n                    node.onMouseMove( e, [e.canvasX - node.pos[0], e.canvasY - node.pos[1]], this );\n                }\n\n                //if dragging a link\n                if (this.connecting_node) {\n\n                    if (this.connecting_output){\n\n                        var pos = this._highlight_input || [0, 0]; //to store the output of isOverNodeInput\n\n                        //on top of input\n                        if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                            //mouse on top of the corner box, don't know what to do\n                        } else {\n                            //check if I have a slot below de mouse\n                            var slot = this.isOverNodeInput( node, e.canvasX, e.canvasY, pos );\n                            if (slot != -1 && node.inputs[slot]) {\n                                var slot_type = node.inputs[slot].type;\n                                if ( LiteGraph.isValidConnection( this.connecting_output.type, slot_type ) ) {\n                                    this._highlight_input = pos;\n                                    this._highlight_input_slot = node.inputs[slot]; // XXX CHECK THIS\n                                }\n                            } else {\n                                this._highlight_input = null;\n                                this._highlight_input_slot = null;  // XXX CHECK THIS\n                            }\n                        }\n\n                    }else if(this.connecting_input){\n\n                        var pos = this._highlight_output || [0, 0]; //to store the output of isOverNodeOutput\n\n                        //on top of output\n                        if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                            //mouse on top of the corner box, don't know what to do\n                        } else {\n                            //check if I have a slot below de mouse\n                            var slot = this.isOverNodeOutput( node, e.canvasX, e.canvasY, pos );\n                            if (slot != -1 && node.outputs[slot]) {\n                                var slot_type = node.outputs[slot].type;\n                                if ( LiteGraph.isValidConnection( this.connecting_input.type, slot_type ) ) {\n                                    this._highlight_output = pos;\n                                }\n                            } else {\n                                this._highlight_output = null;\n                            }\n                        }\n                    }\n                }\n\n                //Search for corner\n                if (this.canvas) {\n                    if (node.inResizeCorner(e.canvasX, e.canvasY)) {\n                        this.canvas.style.cursor = \"se-resize\";\n                    } else {\n                        this.canvas.style.cursor = \"crosshair\";\n                    }\n                }\n            } else { //not over a node\n\n                //search for link connector\n                var over_link = null;\n                for (var i = 0; i < this.visible_links.length; ++i) {\n                    var link = this.visible_links[i];\n                    var center = link._pos;\n                    if (\n                        !center ||\n                        e.canvasX < center[0] - 4 ||\n                        e.canvasX > center[0] + 4 ||\n                        e.canvasY < center[1] - 4 ||\n                        e.canvasY > center[1] + 4\n                    ) {\n                        continue;\n                    }\n                    over_link = link;\n                    break;\n                }\n                if( over_link != this.over_link_center )\n                {\n                    this.over_link_center = over_link;\n                    this.dirty_canvas = true;\n                }\n\n                if (this.canvas) {\n                    this.canvas.style.cursor = \"\";\n                }\n            } //end\n\n            //send event to node if capturing input (used with widgets that allow drag outside of the area of the node)\n            if ( this.node_capturing_input && this.node_capturing_input != node && this.node_capturing_input.onMouseMove ) {\n                this.node_capturing_input.onMouseMove(e,[e.canvasX - this.node_capturing_input.pos[0],e.canvasY - this.node_capturing_input.pos[1]], this);\n            }\n\n            //node being dragged\n            if (this.node_dragged && !this.live_mode) {\n                //console.log(\"draggin!\",this.selected_nodes);\n                for (var i in this.selected_nodes) {\n                    var n = this.selected_nodes[i];\n                    n.pos[0] += delta[0] / this.ds.scale;\n                    n.pos[1] += delta[1] / this.ds.scale;\n                    if (!n.is_selected) this.processNodeSelected(n, e); /*\n                     * Don't call the function if the block is already selected.\n                     * Otherwise, it could cause the block to be unselected while dragging.\n                     */\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n\n            if (this.resizing_node && !this.live_mode) {\n                //convert mouse to node space\n                var desired_size = [ e.canvasX - this.resizing_node.pos[0], e.canvasY - this.resizing_node.pos[1] ];\n                var min_size = this.resizing_node.computeSize();\n                desired_size[0] = Math.max( min_size[0], desired_size[0] );\n                desired_size[1] = Math.max( min_size[1], desired_size[1] );\n                this.resizing_node.setSize( desired_size );\n\n                this.canvas.style.cursor = \"se-resize\";\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n        }\n\n        e.preventDefault();\n        return false;\n    };\n\n    /**\n     * Called when a mouse up event has to be processed\n     * @method processMouseUp\n     **/\n    LGraphCanvas.prototype.processMouseUp = function(e) {\n\n        var is_primary = ( e.isPrimary === undefined || e.isPrimary );\n\n        //early exit for extra pointer\n        if(!is_primary){\n            /*e.stopPropagation();\n            e.preventDefault();*/\n            //console.log(\"pointerevents: processMouseUp pointerN_stop \"+e.pointerId+\" \"+e.isPrimary);\n            return false;\n        }\n\n        //console.log(\"pointerevents: processMouseUp \"+e.pointerId+\" \"+e.isPrimary+\" :: \"+e.clientX+\" \"+e.clientY);\n\n        if( this.set_canvas_dirty_on_mouse_event )\n            this.dirty_canvas = true;\n\n        if (!this.graph)\n            return;\n\n        var window = this.getCanvasWindow();\n        var document = window.document;\n        LGraphCanvas.active_canvas = this;\n\n        //restore the mousemove event back to the canvas\n        if(!this.options.skip_events)\n        {\n            //console.log(\"pointerevents: processMouseUp adjustEventListener\");\n            LiteGraph.pointerListenerRemove(document,\"move\", this._mousemove_callback,true);\n            LiteGraph.pointerListenerAdd(this.canvas,\"move\", this._mousemove_callback,true);\n            LiteGraph.pointerListenerRemove(document,\"up\", this._mouseup_callback,true);\n        }\n\n        this.adjustMouseEvent(e);\n        var now = LiteGraph.getTime();\n        e.click_time = now - this.last_mouseclick;\n        this.last_mouse_dragging = false;\n        this.last_click_position = null;\n\n        if(this.block_click)\n        {\n            //console.log(\"pointerevents: processMouseUp block_clicks\");\n            this.block_click = false; //used to avoid sending twice a click in a immediate button\n        }\n\n        //console.log(\"pointerevents: processMouseUp which: \"+e.which);\n\n        if (e.which == 1) {\n\n            if( this.node_widget )\n            {\n                this.processNodeWidgets( this.node_widget[0], this.graph_mouse, e );\n            }\n\n            //left button\n            this.node_widget = null;\n\n            if (this.selected_group) {\n                var diffx =\n                    this.selected_group.pos[0] -\n                    Math.round(this.selected_group.pos[0]);\n                var diffy =\n                    this.selected_group.pos[1] -\n                    Math.round(this.selected_group.pos[1]);\n                this.selected_group.move(diffx, diffy, e.ctrlKey);\n                this.selected_group.pos[0] = Math.round(\n                    this.selected_group.pos[0]\n                );\n                this.selected_group.pos[1] = Math.round(\n                    this.selected_group.pos[1]\n                );\n                if (this.selected_group._nodes.length) {\n                    this.dirty_canvas = true;\n                }\n                this.selected_group = null;\n            }\n            this.selected_group_resizing = false;\n\n            var node = this.graph.getNodeOnPos(\n                e.canvasX,\n                e.canvasY,\n                this.visible_nodes\n            );\n\n            if (this.dragging_rectangle) {\n                if (this.graph) {\n                    var nodes = this.graph._nodes;\n                    var node_bounding = new Float32Array(4);\n\n                    //compute bounding and flip if left to right\n                    var w = Math.abs(this.dragging_rectangle[2]);\n                    var h = Math.abs(this.dragging_rectangle[3]);\n                    var startx =\n                        this.dragging_rectangle[2] < 0\n                            ? this.dragging_rectangle[0] - w\n                            : this.dragging_rectangle[0];\n                    var starty =\n                        this.dragging_rectangle[3] < 0\n                            ? this.dragging_rectangle[1] - h\n                            : this.dragging_rectangle[1];\n                    this.dragging_rectangle[0] = startx;\n                    this.dragging_rectangle[1] = starty;\n                    this.dragging_rectangle[2] = w;\n                    this.dragging_rectangle[3] = h;\n\n                    // test dragging rect size, if minimun simulate a click\n                    if (!node || (w > 10 && h > 10 )){\n                        //test against all nodes (not visible because the rectangle maybe start outside\n                        var to_select = [];\n                        for (var i = 0; i < nodes.length; ++i) {\n                            var nodeX = nodes[i];\n                            nodeX.getBounding(node_bounding);\n                            if (\n                                !overlapBounding(\n                                    this.dragging_rectangle,\n                                    node_bounding\n                                )\n                            ) {\n                                continue;\n                            } //out of the visible area\n                            to_select.push(nodeX);\n                        }\n                        if (to_select.length) {\n                            this.selectNodes(to_select,e.shiftKey); // add to selection with shift\n                        }\n                    }else{\n                        // will select of update selection\n                        this.selectNodes([node],e.shiftKey||e.ctrlKey); // add to selection add to selection with ctrlKey or shiftKey\n                    }\n\n                }\n                this.dragging_rectangle = null;\n            } else if (this.connecting_node) {\n                //dragging a connection\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n\n                var connInOrOut = this.connecting_output || this.connecting_input;\n                var connType = connInOrOut.type;\n\n                //node below mouse\n                if (node) {\n\n                    /* no need to condition on event type.. just another type\n                    if (\n                        connType == LiteGraph.EVENT &&\n                        this.isOverNodeBox(node, e.canvasX, e.canvasY)\n                    ) {\n\n                        this.connecting_node.connect(\n                            this.connecting_slot,\n                            node,\n                            LiteGraph.EVENT\n                        );\n\n                    } else {*/\n\n                    //slot below mouse? connect\n\n                    if (this.connecting_output){\n\n                        var slot = this.isOverNodeInput(\n                            node,\n                            e.canvasX,\n                            e.canvasY\n                        );\n                        if (slot != -1) {\n                            this.connecting_node.connect(this.connecting_slot, node, slot);\n                        } else {\n                            //not on top of an input\n                            // look for a good slot\n                            this.connecting_node.connectByType(this.connecting_slot,node,connType);\n                        }\n\n                    }else if (this.connecting_input){\n\n                        var slot = this.isOverNodeOutput(\n                            node,\n                            e.canvasX,\n                            e.canvasY\n                        );\n\n                        if (slot != -1) {\n                            node.connect(slot, this.connecting_node, this.connecting_slot); // this is inverted has output-input nature like\n                        } else {\n                            //not on top of an input\n                            // look for a good slot\n                            this.connecting_node.connectByTypeOutput(this.connecting_slot,node,connType);\n                        }\n\n                    }\n\n\n                    //}\n\n                }else{\n\n                    // add menu when releasing link in empty space\n                    if (LiteGraph.release_link_on_empty_shows_menu){\n                        if (e.shiftKey && this.allow_searchbox){\n                            if(this.connecting_output){\n                                this.showSearchBox(e,{node_from: this.connecting_node, slot_from: this.connecting_output, type_filter_in: this.connecting_output.type});\n                            }else if(this.connecting_input){\n                                this.showSearchBox(e,{node_to: this.connecting_node, slot_from: this.connecting_input, type_filter_out: this.connecting_input.type});\n                            }\n                        }else{\n                            if(this.connecting_output){\n                                this.showConnectionMenu({nodeFrom: this.connecting_node, slotFrom: this.connecting_output, e: e});\n                            }else if(this.connecting_input){\n                                this.showConnectionMenu({nodeTo: this.connecting_node, slotTo: this.connecting_input, e: e});\n                            }\n                        }\n                    }\n                }\n\n                this.connecting_output = null;\n                this.connecting_input = null;\n                this.connecting_pos = null;\n                this.connecting_node = null;\n                this.connecting_slot = -1;\n            } //not dragging connection\n            else if (this.resizing_node) {\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n                this.graph.afterChange(this.resizing_node);\n                this.resizing_node = null;\n            } else if (this.node_dragged) {\n                //node being dragged?\n                var node = this.node_dragged;\n                if (\n                    node &&\n                    e.click_time < 300 &&\n                    isInsideRectangle( e.canvasX, e.canvasY, node.pos[0], node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT )\n                ) {\n                    node.collapse();\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n                this.node_dragged.pos[0] = Math.round(this.node_dragged.pos[0]);\n                this.node_dragged.pos[1] = Math.round(this.node_dragged.pos[1]);\n                if (this.graph.config.align_to_grid || this.align_to_grid ) {\n                    this.node_dragged.alignToGrid();\n                }\n                if( this.onNodeMoved )\n                    this.onNodeMoved( this.node_dragged );\n                this.graph.afterChange(this.node_dragged);\n                this.node_dragged = null;\n            } //no node being dragged\n            else {\n                //get node over\n                var node = this.graph.getNodeOnPos(\n                    e.canvasX,\n                    e.canvasY,\n                    this.visible_nodes\n                );\n\n                if (!node && e.click_time < 300) {\n                    this.deselectAllNodes();\n                }\n\n                this.dirty_canvas = true;\n                this.dragging_canvas = false;\n\n                if (this.node_over && this.node_over.onMouseUp) {\n                    this.node_over.onMouseUp( e, [ e.canvasX - this.node_over.pos[0], e.canvasY - this.node_over.pos[1] ], this );\n                }\n                if (\n                    this.node_capturing_input &&\n                    this.node_capturing_input.onMouseUp\n                ) {\n                    this.node_capturing_input.onMouseUp(e, [\n                        e.canvasX - this.node_capturing_input.pos[0],\n                        e.canvasY - this.node_capturing_input.pos[1]\n                    ]);\n                }\n            }\n        } else if (e.which == 2) {\n            //middle button\n            //trace(\"middle\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        } else if (e.which == 3) {\n            //right button\n            //trace(\"right\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        }\n\n        /*\n\t\tif((this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\n\t\t\tthis.draw();\n\t\t*/\n\n        if (is_primary)\n        {\n            this.pointer_is_down = false;\n            this.pointer_is_double = false;\n        }\n\n        this.graph.change();\n\n        //console.log(\"pointerevents: processMouseUp stopPropagation\");\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n    };\n\n    /**\n     * Called when a mouse wheel event has to be processed\n     * @method processMouseWheel\n     **/\n    LGraphCanvas.prototype.processMouseWheel = function(e) {\n        if (!this.graph || !this.allow_dragcanvas) {\n            return;\n        }\n\n        var delta = e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n\n        this.adjustMouseEvent(e);\n\n        var x = e.clientX;\n        var y = e.clientY;\n        var is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n        if(!is_inside)\n            return;\n\n        var scale = this.ds.scale;\n\n        if (delta > 0) {\n            scale *= 1.1;\n        } else if (delta < 0) {\n            scale *= 1 / 1.1;\n        }\n\n        //this.setZoom( scale, [ e.clientX, e.clientY ] );\n        this.ds.changeScale(scale, [e.clientX, e.clientY]);\n\n        this.graph.change();\n\n        e.preventDefault();\n        return false; // prevent default\n    };\n\n    /**\n     * returns true if a position (in graph space) is on top of a node little corner box\n     * @method isOverNodeBox\n     **/\n    LGraphCanvas.prototype.isOverNodeBox = function(node, canvasx, canvasy) {\n        var title_height = LiteGraph.NODE_TITLE_HEIGHT;\n        if (\n            isInsideRectangle(\n                canvasx,\n                canvasy,\n                node.pos[0] + 2,\n                node.pos[1] + 2 - title_height,\n                title_height - 4,\n                title_height - 4\n            )\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * returns the INDEX if a position (in graph space) is on top of a node input slot\n     * @method isOverNodeInput\n     **/\n    LGraphCanvas.prototype.isOverNodeInput = function(\n        node,\n        canvasx,\n        canvasy,\n        slot_pos\n    ) {\n        if (node.inputs) {\n            for (var i = 0, l = node.inputs.length; i < l; ++i) {\n                var input = node.inputs[i];\n                var link_pos = node.getConnectionPos(true, i);\n                var is_inside = false;\n                if (node.horizontal) {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 5,\n                        link_pos[1] - 10,\n                        10,\n                        20\n                    );\n                } else {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        40,\n                        10\n                    );\n                }\n                if (is_inside) {\n                    if (slot_pos) {\n                        slot_pos[0] = link_pos[0];\n                        slot_pos[1] = link_pos[1];\n                    }\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * returns the INDEX if a position (in graph space) is on top of a node output slot\n     * @method isOverNodeOuput\n     **/\n    LGraphCanvas.prototype.isOverNodeOutput = function(\n        node,\n        canvasx,\n        canvasy,\n        slot_pos\n    ) {\n        if (node.outputs) {\n            for (var i = 0, l = node.outputs.length; i < l; ++i) {\n                var output = node.outputs[i];\n                var link_pos = node.getConnectionPos(false, i);\n                var is_inside = false;\n                if (node.horizontal) {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 5,\n                        link_pos[1] - 10,\n                        10,\n                        20\n                    );\n                } else {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        40,\n                        10\n                    );\n                }\n                if (is_inside) {\n                    if (slot_pos) {\n                        slot_pos[0] = link_pos[0];\n                        slot_pos[1] = link_pos[1];\n                    }\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * process a key event\n     * @method processKey\n     **/\n    LGraphCanvas.prototype.processKey = function(e) {\n        if (!this.graph) {\n            return;\n        }\n\n        var block_default = false;\n        //console.log(e); //debug\n\n        if (e.target.localName == \"input\") {\n            return;\n        }\n\n        if (e.type == \"keydown\") {\n            if (e.keyCode == 32) {\n                //space\n                this.dragging_canvas = true;\n                block_default = true;\n            }\n\n            if (e.keyCode == 27) {\n                //esc\n                if(this.node_panel) this.node_panel.close();\n                if(this.options_panel) this.options_panel.close();\n                block_default = true;\n            }\n\n            //select all Control A\n            if (e.keyCode == 65 && e.ctrlKey) {\n                this.selectNodes();\n                block_default = true;\n            }\n\n            if ((e.keyCode === 67) && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n                //copy\n                if (this.selected_nodes) {\n                    this.copyToClipboard();\n                    block_default = true;\n                }\n            }\n\n            if ((e.keyCode === 86) && (e.metaKey || e.ctrlKey)) {\n                //paste\n                this.pasteFromClipboard(e.shiftKey);\n            }\n\n            //delete or backspace\n            if (e.keyCode == 46 || e.keyCode == 8) {\n                if (\n                    e.target.localName != \"input\" &&\n                    e.target.localName != \"textarea\"\n                ) {\n                    this.deleteSelectedNodes();\n                    block_default = true;\n                }\n            }\n\n            //collapse\n            //...\n\n            //TODO\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyDown) {\n                        this.selected_nodes[i].onKeyDown(e);\n                    }\n                }\n            }\n        } else if (e.type == \"keyup\") {\n            if (e.keyCode == 32) {\n                // space\n                this.dragging_canvas = false;\n            }\n\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyUp) {\n                        this.selected_nodes[i].onKeyUp(e);\n                    }\n                }\n            }\n        }\n\n        this.graph.change();\n\n        if (block_default) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            return false;\n        }\n    };\n\n    LGraphCanvas.prototype.copyToClipboard = function(nodes) {\n        var clipboard_info = {\n            nodes: [],\n            links: []\n        };\n        var index = 0;\n        var selected_nodes_array = [];\n        if (!nodes) nodes = this.selected_nodes;\n        for (var i in nodes) {\n            var node = nodes[i];\n            if (node.clonable === false)\n                continue;\n            node._relative_id = index;\n            selected_nodes_array.push(node);\n            index += 1;\n        }\n\n        for (var i = 0; i < selected_nodes_array.length; ++i) {\n            var node = selected_nodes_array[i];\n            var cloned = node.clone();\n            if(!cloned)\n            {\n                console.warn(\"node type not found: \" + node.type );\n                continue;\n            }\n            clipboard_info.nodes.push(cloned.serialize());\n            if (node.inputs && node.inputs.length) {\n                for (var j = 0; j < node.inputs.length; ++j) {\n                    var input = node.inputs[j];\n                    if (!input || input.link == null) {\n                        continue;\n                    }\n                    var link_info = this.graph.links[input.link];\n                    if (!link_info) {\n                        continue;\n                    }\n                    var target_node = this.graph.getNodeById(\n                        link_info.origin_id\n                    );\n                    if (!target_node) {\n                        continue;\n                    }\n                    clipboard_info.links.push([\n                        target_node._relative_id,\n                        link_info.origin_slot, //j,\n                        node._relative_id,\n                        link_info.target_slot,\n                        target_node.id\n                    ]);\n                }\n            }\n        }\n        localStorage.setItem(\n            \"litegrapheditor_clipboard\",\n            JSON.stringify(clipboard_info)\n        );\n    };\n\n    LGraphCanvas.prototype.pasteFromClipboard = function(isConnectUnselected = false) {\n        // if ctrl + shift + v is off, return when isConnectUnselected is true (shift is pressed) to maintain old behavior\n        if (!LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs && isConnectUnselected) {\n            return;\n        }\n        var data = localStorage.getItem(\"litegrapheditor_clipboard\");\n        if (!data) {\n            return;\n        }\n\n        this.graph.beforeChange();\n\n        //create nodes\n        var clipboard_info = JSON.parse(data);\n        // calculate top-left node, could work without this processing but using diff with last node pos :: clipboard_info.nodes[clipboard_info.nodes.length-1].pos\n        var posMin = false;\n        var posMinIndexes = false;\n        for (var i = 0; i < clipboard_info.nodes.length; ++i) {\n            if (posMin){\n                if(posMin[0]>clipboard_info.nodes[i].pos[0]){\n                    posMin[0] = clipboard_info.nodes[i].pos[0];\n                    posMinIndexes[0] = i;\n                }\n                if(posMin[1]>clipboard_info.nodes[i].pos[1]){\n                    posMin[1] = clipboard_info.nodes[i].pos[1];\n                    posMinIndexes[1] = i;\n                }\n            }\n            else{\n                posMin = [clipboard_info.nodes[i].pos[0], clipboard_info.nodes[i].pos[1]];\n                posMinIndexes = [i, i];\n            }\n        }\n        var nodes = [];\n        for (var i = 0; i < clipboard_info.nodes.length; ++i) {\n            var node_data = clipboard_info.nodes[i];\n            var node = LiteGraph.createNode(node_data.type);\n            if (node) {\n                node.configure(node_data);\n\n                //paste in last known mouse position\n                node.pos[0] += this.graph_mouse[0] - posMin[0]; //+= 5;\n                node.pos[1] += this.graph_mouse[1] - posMin[1]; //+= 5;\n\n                this.graph.add(node,{doProcessChange:false});\n\n                nodes.push(node);\n            }\n        }\n\n        //create links\n        for (var i = 0; i < clipboard_info.links.length; ++i) {\n            var link_info = clipboard_info.links[i];\n            var origin_node;\n            var origin_node_relative_id = link_info[0];\n            if (origin_node_relative_id != null) {\n                origin_node = nodes[origin_node_relative_id];\n            } else if (LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs && isConnectUnselected) {\n                var origin_node_id = link_info[4];\n                if (origin_node_id) {\n                    origin_node = this.graph.getNodeById(origin_node_id);\n                }\n            }\n            var target_node = nodes[link_info[2]];\n            if( origin_node && target_node )\n                origin_node.connect(link_info[1], target_node, link_info[3]);\n            else\n                console.warn(\"Warning, nodes missing on pasting\");\n        }\n\n        this.selectNodes(nodes);\n\n        this.graph.afterChange();\n    };\n\n    /**\n     * process a item drop event on top the canvas\n     * @method processDrop\n     **/\n    LGraphCanvas.prototype.processDrop = function(e) {\n        e.preventDefault();\n        this.adjustMouseEvent(e);\n        var x = e.clientX;\n        var y = e.clientY;\n        var is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n        if(!is_inside){\n            return;\n            // --- BREAK ---\n        }\n\n        var pos = [e.canvasX, e.canvasY];\n\n\n        var node = this.graph ? this.graph.getNodeOnPos(pos[0], pos[1]) : null;\n\n        if (!node) {\n            var r = null;\n            if (this.onDropItem) {\n                r = this.onDropItem(event);\n            }\n            if (!r) {\n                this.checkDropItem(e);\n            }\n            return;\n        }\n\n        if (node.onDropFile || node.onDropData) {\n            var files = e.dataTransfer.files;\n            if (files && files.length) {\n                for (var i = 0; i < files.length; i++) {\n                    var file = e.dataTransfer.files[0];\n                    var filename = file.name;\n                    var ext = LGraphCanvas.getFileExtension(filename);\n                    //console.log(file);\n\n                    if (node.onDropFile) {\n                        node.onDropFile(file);\n                    }\n\n                    if (node.onDropData) {\n                        //prepare reader\n                        var reader = new FileReader();\n                        reader.onload = function(event) {\n                            //console.log(event.target);\n                            var data = event.target.result;\n                            node.onDropData(data, filename, file);\n                        };\n\n                        //read data\n                        var type = file.type.split(\"/\")[0];\n                        if (type == \"text\" || type == \"\") {\n                            reader.readAsText(file);\n                        } else if (type == \"image\") {\n                            reader.readAsDataURL(file);\n                        } else {\n                            reader.readAsArrayBuffer(file);\n                        }\n                    }\n                }\n            }\n        }\n\n        if (node.onDropItem) {\n            if (node.onDropItem(event)) {\n                return true;\n            }\n        }\n\n        if (this.onDropItem) {\n            return this.onDropItem(event);\n        }\n\n        return false;\n    };\n\n    //called if the graph doesn't have a default drop item behaviour\n    LGraphCanvas.prototype.checkDropItem = function(e) {\n        if (e.dataTransfer.files.length) {\n            var file = e.dataTransfer.files[0];\n            var ext = LGraphCanvas.getFileExtension(file.name).toLowerCase();\n            var nodetype = LiteGraph.node_types_by_file_extension[ext];\n            if (nodetype) {\n                this.graph.beforeChange();\n                var node = LiteGraph.createNode(nodetype.type);\n                node.pos = [e.canvasX, e.canvasY];\n                this.graph.add(node);\n                if (node.onDropFile) {\n                    node.onDropFile(file);\n                }\n                this.graph.afterChange();\n            }\n        }\n    };\n\n    LGraphCanvas.prototype.processNodeDblClicked = function(n) {\n        if (this.onShowNodePanel) {\n            this.onShowNodePanel(n);\n        }\n\n        if (this.onNodeDblClicked) {\n            this.onNodeDblClicked(n);\n        }\n\n        this.setDirty(true);\n    };\n\n    LGraphCanvas.prototype.processNodeSelected = function(node, e) {\n        this.selectNode(node, e && (e.shiftKey || e.ctrlKey || this.multi_select));\n        if (this.onNodeSelected) {\n            this.onNodeSelected(node);\n        }\n    };\n\n    /**\n     * selects a given node (or adds it to the current selection)\n     * @method selectNode\n     **/\n    LGraphCanvas.prototype.selectNode = function(\n        node,\n        add_to_current_selection\n    ) {\n        if (node == null) {\n            this.deselectAllNodes();\n        } else {\n            this.selectNodes([node], add_to_current_selection);\n        }\n    };\n\n    /**\n     * selects several nodes (or adds them to the current selection)\n     * @method selectNodes\n     **/\n    LGraphCanvas.prototype.selectNodes = function( nodes, add_to_current_selection )\n    {\n        if (!add_to_current_selection) {\n            this.deselectAllNodes();\n        }\n\n        nodes = nodes || this.graph._nodes;\n        if (typeof nodes == \"string\") nodes = [nodes];\n        for (var i in nodes) {\n            var node = nodes[i];\n            if (node.is_selected) {\n                this.deselectNode(node);\n                continue;\n            }\n\n            if (!node.is_selected && node.onSelected) {\n                node.onSelected();\n            }\n            node.is_selected = true;\n            this.selected_nodes[node.id] = node;\n\n            if (node.inputs) {\n                for (var j = 0; j < node.inputs.length; ++j) {\n                    this.highlighted_links[node.inputs[j].link] = true;\n                }\n            }\n            if (node.outputs) {\n                for (var j = 0; j < node.outputs.length; ++j) {\n                    var out = node.outputs[j];\n                    if (out.links) {\n                        for (var k = 0; k < out.links.length; ++k) {\n                            this.highlighted_links[out.links[k]] = true;\n                        }\n                    }\n                }\n            }\n        }\n\n        if(\tthis.onSelectionChange )\n            this.onSelectionChange( this.selected_nodes );\n\n        this.setDirty(true);\n    };\n\n    /**\n     * removes a node from the current selection\n     * @method deselectNode\n     **/\n    LGraphCanvas.prototype.deselectNode = function(node) {\n        if (!node.is_selected) {\n            return;\n        }\n        if (node.onDeselected) {\n            node.onDeselected();\n        }\n        node.is_selected = false;\n\n        if (this.onNodeDeselected) {\n            this.onNodeDeselected(node);\n        }\n\n        //remove highlighted\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; ++i) {\n                delete this.highlighted_links[node.inputs[i].link];\n            }\n        }\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; ++i) {\n                var out = node.outputs[i];\n                if (out.links) {\n                    for (var j = 0; j < out.links.length; ++j) {\n                        delete this.highlighted_links[out.links[j]];\n                    }\n                }\n            }\n        }\n    };\n\n    /**\n     * removes all nodes from the current selection\n     * @method deselectAllNodes\n     **/\n    LGraphCanvas.prototype.deselectAllNodes = function() {\n        if (!this.graph) {\n            return;\n        }\n        var nodes = this.graph._nodes;\n        for (var i = 0, l = nodes.length; i < l; ++i) {\n            var node = nodes[i];\n            if (!node.is_selected) {\n                continue;\n            }\n            if (node.onDeselected) {\n                node.onDeselected();\n            }\n            node.is_selected = false;\n            if (this.onNodeDeselected) {\n                this.onNodeDeselected(node);\n            }\n        }\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n        if(\tthis.onSelectionChange )\n            this.onSelectionChange( this.selected_nodes );\n        this.setDirty(true);\n    };\n\n    /**\n     * deletes all nodes in the current selection from the graph\n     * @method deleteSelectedNodes\n     **/\n    LGraphCanvas.prototype.deleteSelectedNodes = function() {\n\n        this.graph.beforeChange();\n\n        for (var i in this.selected_nodes) {\n            var node = this.selected_nodes[i];\n\n            if(node.block_delete)\n                continue;\n\n            //autoconnect when possible (very basic, only takes into account first input-output)\n            if(node.inputs && node.inputs.length && node.outputs && node.outputs.length && LiteGraph.isValidConnection( node.inputs[0].type, node.outputs[0].type ) && node.inputs[0].link && node.outputs[0].links && node.outputs[0].links.length )\n            {\n                var input_link = node.graph.links[ node.inputs[0].link ];\n                var output_link = node.graph.links[ node.outputs[0].links[0] ];\n                var input_node = node.getInputNode(0);\n                var output_node = node.getOutputNodes(0)[0];\n                if(input_node && output_node)\n                    input_node.connect( input_link.origin_slot, output_node, output_link.target_slot );\n            }\n            this.graph.remove(node);\n            if (this.onNodeDeselected) {\n                this.onNodeDeselected(node);\n            }\n        }\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n        this.setDirty(true);\n        this.graph.afterChange();\n    };\n\n    /**\n     * centers the camera on a given node\n     * @method centerOnNode\n     **/\n    LGraphCanvas.prototype.centerOnNode = function(node) {\n        this.ds.offset[0] =\n            -node.pos[0] -\n            node.size[0] * 0.5 +\n            (this.canvas.width * 0.5) / this.ds.scale;\n        this.ds.offset[1] =\n            -node.pos[1] -\n            node.size[1] * 0.5 +\n            (this.canvas.height * 0.5) / this.ds.scale;\n        this.setDirty(true, true);\n    };\n\n    /**\n     * adds some useful properties to a mouse event, like the position in graph coordinates\n     * @method adjustMouseEvent\n     **/\n    LGraphCanvas.prototype.adjustMouseEvent = function(e) {\n        var clientX_rel = 0;\n        var clientY_rel = 0;\n\n        if (this.canvas) {\n            var b = this.canvas.getBoundingClientRect();\n            clientX_rel = e.clientX - b.left;\n            clientY_rel = e.clientY - b.top;\n        } else {\n            clientX_rel = e.clientX;\n            clientY_rel = e.clientY;\n        }\n\n        e.deltaX = clientX_rel - this.last_mouse_position[0];\n        e.deltaY = clientY_rel- this.last_mouse_position[1];\n\n        this.last_mouse_position[0] = clientX_rel;\n        this.last_mouse_position[1] = clientY_rel;\n\n        e.canvasX = clientX_rel / this.ds.scale - this.ds.offset[0];\n        e.canvasY = clientY_rel / this.ds.scale - this.ds.offset[1];\n\n        //console.log(\"pointerevents: adjustMouseEvent \"+e.clientX+\":\"+e.clientY+\" \"+clientX_rel+\":\"+clientY_rel+\" \"+e.canvasX+\":\"+e.canvasY);\n    };\n\n    /**\n     * changes the zoom level of the graph (default is 1), you can pass also a place used to pivot the zoom\n     * @method setZoom\n     **/\n    LGraphCanvas.prototype.setZoom = function(value, zooming_center) {\n        this.ds.changeScale(value, zooming_center);\n        /*\n\tif(!zooming_center && this.canvas)\n\t\tzooming_center = [this.canvas.width * 0.5,this.canvas.height * 0.5];\n\n\tvar center = this.convertOffsetToCanvas( zooming_center );\n\n\tthis.ds.scale = value;\n\n\tif(this.scale > this.max_zoom)\n\t\tthis.scale = this.max_zoom;\n\telse if(this.scale < this.min_zoom)\n\t\tthis.scale = this.min_zoom;\n\n\tvar new_center = this.convertOffsetToCanvas( zooming_center );\n\tvar delta_offset = [new_center[0] - center[0], new_center[1] - center[1]];\n\n\tthis.offset[0] += delta_offset[0];\n\tthis.offset[1] += delta_offset[1];\n\t*/\n\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n    };\n\n    /**\n     * converts a coordinate from graph coordinates to canvas2D coordinates\n     * @method convertOffsetToCanvas\n     **/\n    LGraphCanvas.prototype.convertOffsetToCanvas = function(pos, out) {\n        return this.ds.convertOffsetToCanvas(pos, out);\n    };\n\n    /**\n     * converts a coordinate from Canvas2D coordinates to graph space\n     * @method convertCanvasToOffset\n     **/\n    LGraphCanvas.prototype.convertCanvasToOffset = function(pos, out) {\n        return this.ds.convertCanvasToOffset(pos, out);\n    };\n\n    //converts event coordinates from canvas2D to graph coordinates\n    LGraphCanvas.prototype.convertEventToCanvasOffset = function(e) {\n        var rect = this.canvas.getBoundingClientRect();\n        return this.convertCanvasToOffset([\n            e.clientX - rect.left,\n            e.clientY - rect.top\n        ]);\n    };\n\n    /**\n     * brings a node to front (above all other nodes)\n     * @method bringToFront\n     **/\n    LGraphCanvas.prototype.bringToFront = function(node) {\n        var i = this.graph._nodes.indexOf(node);\n        if (i == -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.push(node);\n    };\n\n    /**\n     * sends a node to the back (below all other nodes)\n     * @method sendToBack\n     **/\n    LGraphCanvas.prototype.sendToBack = function(node) {\n        var i = this.graph._nodes.indexOf(node);\n        if (i == -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.unshift(node);\n    };\n\n    /* Interaction */\n\n    /* LGraphCanvas render */\n    var temp = new Float32Array(4);\n\n    /**\n     * checks which nodes are visible (inside the camera area)\n     * @method computeVisibleNodes\n     **/\n    LGraphCanvas.prototype.computeVisibleNodes = function(nodes, out) {\n        var visible_nodes = out || [];\n        visible_nodes.length = 0;\n        nodes = nodes || this.graph._nodes;\n        for (var i = 0, l = nodes.length; i < l; ++i) {\n            var n = nodes[i];\n\n            //skip rendering nodes in live mode\n            if (this.live_mode && !n.onDrawBackground && !n.onDrawForeground) {\n                continue;\n            }\n\n            if (!overlapBounding(this.visible_area, n.getBounding(temp, true))) {\n                continue;\n            } //out of the visible area\n\n            visible_nodes.push(n);\n        }\n        return visible_nodes;\n    };\n\n    /**\n     * renders the whole canvas content, by rendering in two separated canvas, one containing the background grid and the connections, and one containing the nodes)\n     * @method draw\n     **/\n    LGraphCanvas.prototype.draw = function(force_canvas, force_bgcanvas) {\n        if (!this.canvas || this.canvas.width == 0 || this.canvas.height == 0) {\n            return;\n        }\n\n        //fps counting\n        var now = LiteGraph.getTime();\n        this.render_time = (now - this.last_draw_time) * 0.001;\n        this.last_draw_time = now;\n\n        if (this.graph) {\n            this.ds.computeVisibleArea(this.viewport);\n        }\n\n        if (\n            this.dirty_bgcanvas ||\n            force_bgcanvas ||\n            this.always_render_background ||\n            (this.graph &&\n                this.graph._last_trigger_time &&\n                now - this.graph._last_trigger_time < 1000)\n        ) {\n            this.drawBackCanvas();\n        }\n\n        if (this.dirty_canvas || force_canvas) {\n            this.drawFrontCanvas();\n        }\n\n        this.fps = this.render_time ? 1.0 / this.render_time : 0;\n        this.frame += 1;\n    };\n\n    /**\n     * draws the front canvas (the one containing all the nodes)\n     * @method drawFrontCanvas\n     **/\n    LGraphCanvas.prototype.drawFrontCanvas = function() {\n        this.dirty_canvas = false;\n\n        if (!this.ctx) {\n            this.ctx = this.bgcanvas.getContext(\"2d\");\n        }\n        var ctx = this.ctx;\n        if (!ctx) {\n            //maybe is using webgl...\n            return;\n        }\n\n        var canvas = this.canvas;\n        if ( ctx.start2D && !this.viewport ) {\n            ctx.start2D();\n            ctx.restore();\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n        }\n\n        //clip dirty area if there is one, otherwise work in full canvas\n        var area = this.viewport || this.dirty_area;\n        if (area) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.rect( area[0],area[1],area[2],area[3] );\n            ctx.clip();\n        }\n\n        //clear\n        //canvas.width = canvas.width;\n        if (this.clear_background) {\n            if(area)\n                ctx.clearRect( area[0],area[1],area[2],area[3] );\n            else\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\n        }\n\n        //draw bg canvas\n        if (this.bgcanvas == this.canvas) {\n            this.drawBackCanvas();\n        } else {\n            ctx.drawImage( this.bgcanvas, 0, 0 );\n        }\n\n        //rendering\n        if (this.onRender) {\n            this.onRender(canvas, ctx);\n        }\n\n        //info widget\n        if (this.show_info) {\n            this.renderInfo(ctx, area ? area[0] : 0, area ? area[1] : 0 );\n        }\n\n        if (this.graph) {\n            //apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            //draw nodes\n            var drawn_nodes = 0;\n            var visible_nodes = this.computeVisibleNodes(\n                null,\n                this.visible_nodes\n            );\n\n            for (var i = 0; i < visible_nodes.length; ++i) {\n                var node = visible_nodes[i];\n\n                //transform coords system\n                ctx.save();\n                ctx.translate(node.pos[0], node.pos[1]);\n\n                //Draw\n                this.drawNode(node, ctx);\n                drawn_nodes += 1;\n\n                //Restore\n                ctx.restore();\n            }\n\n            //on top (debug)\n            if (this.render_execution_order) {\n                this.drawExecutionOrder(ctx);\n            }\n\n            //connections ontop?\n            if (this.graph.config.links_ontop) {\n                if (!this.live_mode) {\n                    this.drawConnections(ctx);\n                }\n            }\n\n            //current connection (the one being dragged by the mouse)\n            if (this.connecting_pos != null) {\n                ctx.lineWidth = this.connections_width;\n                var link_color = null;\n\n                var connInOrOut = this.connecting_output || this.connecting_input;\n\n                var connType = connInOrOut.type;\n                var connDir = connInOrOut.dir;\n                if(connDir == null)\n                {\n                    if (this.connecting_output)\n                        connDir = this.connecting_node.horizontal ? LiteGraph.DOWN : LiteGraph.RIGHT;\n                    else\n                        connDir = this.connecting_node.horizontal ? LiteGraph.UP : LiteGraph.LEFT;\n                }\n                var connShape = connInOrOut.shape;\n\n                switch (connType) {\n                    case LiteGraph.EVENT:\n                        link_color = LiteGraph.EVENT_LINK_COLOR;\n                        break;\n                    default:\n                        link_color = LiteGraph.CONNECTING_LINK_COLOR;\n                }\n\n                //the connection being dragged by the mouse\n                this.renderLink(\n                    ctx,\n                    this.connecting_pos,\n                    [this.graph_mouse[0], this.graph_mouse[1]],\n                    null,\n                    false,\n                    null,\n                    link_color,\n                    connDir,\n                    LiteGraph.CENTER\n                );\n\n                ctx.beginPath();\n                if (\n                    connType === LiteGraph.EVENT ||\n                    connShape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(\n                        this.connecting_pos[0] - 6 + 0.5,\n                        this.connecting_pos[1] - 5 + 0.5,\n                        14,\n                        10\n                    );\n                    ctx.fill();\n                    ctx.beginPath();\n                    ctx.rect(\n                        this.graph_mouse[0] - 6 + 0.5,\n                        this.graph_mouse[1] - 5 + 0.5,\n                        14,\n                        10\n                    );\n                } else if (connShape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(this.connecting_pos[0] + 8, this.connecting_pos[1] + 0.5);\n                    ctx.lineTo(this.connecting_pos[0] - 4, this.connecting_pos[1] + 6 + 0.5);\n                    ctx.lineTo(this.connecting_pos[0] - 4, this.connecting_pos[1] - 6 + 0.5);\n                    ctx.closePath();\n                }\n                else {\n                    ctx.arc(\n                        this.connecting_pos[0],\n                        this.connecting_pos[1],\n                        4,\n                        0,\n                        Math.PI * 2\n                    );\n                    ctx.fill();\n                    ctx.beginPath();\n                    ctx.arc(\n                        this.graph_mouse[0],\n                        this.graph_mouse[1],\n                        4,\n                        0,\n                        Math.PI * 2\n                    );\n                }\n                ctx.fill();\n\n                ctx.fillStyle = \"#ffcc00\";\n                if (this._highlight_input) {\n                    ctx.beginPath();\n                    var shape = this._highlight_input_slot.shape;\n                    if (shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(this._highlight_input[0] + 8, this._highlight_input[1] + 0.5);\n                        ctx.lineTo(this._highlight_input[0] - 4, this._highlight_input[1] + 6 + 0.5);\n                        ctx.lineTo(this._highlight_input[0] - 4, this._highlight_input[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else {\n                        ctx.arc(\n                            this._highlight_input[0],\n                            this._highlight_input[1],\n                            6,\n                            0,\n                            Math.PI * 2\n                        );\n                    }\n                    ctx.fill();\n                }\n                if (this._highlight_output) {\n                    ctx.beginPath();\n                    if (shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(this._highlight_output[0] + 8, this._highlight_output[1] + 0.5);\n                        ctx.lineTo(this._highlight_output[0] - 4, this._highlight_output[1] + 6 + 0.5);\n                        ctx.lineTo(this._highlight_output[0] - 4, this._highlight_output[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else {\n                        ctx.arc(\n                            this._highlight_output[0],\n                            this._highlight_output[1],\n                            6,\n                            0,\n                            Math.PI * 2\n                        );\n                    }\n                    ctx.fill();\n                }\n            }\n\n            //the selection rectangle\n            if (this.dragging_rectangle) {\n                ctx.strokeStyle = \"#FFF\";\n                ctx.strokeRect(\n                    this.dragging_rectangle[0],\n                    this.dragging_rectangle[1],\n                    this.dragging_rectangle[2],\n                    this.dragging_rectangle[3]\n                );\n            }\n\n            //on top of link center\n            if(this.over_link_center && this.render_link_tooltip)\n                this.drawLinkTooltip( ctx, this.over_link_center );\n            else\n            if(this.onDrawLinkTooltip) //to remove\n                this.onDrawLinkTooltip(ctx,null);\n\n            //custom info\n            if (this.onDrawForeground) {\n                this.onDrawForeground(ctx, this.visible_rect);\n            }\n\n            ctx.restore();\n        }\n\n        //draws panel in the corner\n        if (this._graph_stack && this._graph_stack.length) {\n            this.drawSubgraphPanel( ctx );\n        }\n\n\n        if (this.onDrawOverlay) {\n            this.onDrawOverlay(ctx);\n        }\n\n        if (area){\n            ctx.restore();\n        }\n\n        if (ctx.finish2D) {\n            //this is a function I use in webgl renderer\n            ctx.finish2D();\n        }\n    };\n\n    /**\n     * draws the panel in the corner that shows subgraph properties\n     * @method drawSubgraphPanel\n     **/\n    LGraphCanvas.prototype.drawSubgraphPanel = function (ctx) {\n        var subgraph = this.graph;\n        var subnode = subgraph._subgraph_node;\n        if (!subnode) {\n            console.warn(\"subgraph without subnode\");\n            return;\n        }\n        this.drawSubgraphPanelLeft(subgraph, subnode, ctx)\n        this.drawSubgraphPanelRight(subgraph, subnode, ctx)\n    }\n\n    LGraphCanvas.prototype.drawSubgraphPanelLeft = function (subgraph, subnode, ctx) {\n        var num = subnode.inputs ? subnode.inputs.length : 0;\n        var w = 200;\n        var h = Math.floor(LiteGraph.NODE_SLOT_HEIGHT * 1.6);\n\n        ctx.fillStyle = \"#111\";\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        ctx.roundRect(10, 10, w, (num + 1) * h + 50, [8]);\n        ctx.fill();\n        ctx.globalAlpha = 1;\n\n        ctx.fillStyle = \"#888\";\n        ctx.font = \"14px Arial\";\n        ctx.textAlign = \"left\";\n        ctx.fillText(\"Graph Inputs\", 20, 34);\n        // var pos = this.mouse;\n\n        if (this.drawButton(w - 20, 20, 20, 20, \"X\", \"#151515\")) {\n            this.closeSubgraph();\n            return;\n        }\n\n        var y = 50;\n        ctx.font = \"14px Arial\";\n        if (subnode.inputs)\n            for (var i = 0; i < subnode.inputs.length; ++i) {\n                var input = subnode.inputs[i];\n                if (input.not_subgraph_input)\n                    continue;\n\n                //input button clicked\n                if (this.drawButton(20, y + 2, w - 20, h - 2)) {\n                    var type = subnode.constructor.input_node_type || \"graph/input\";\n                    this.graph.beforeChange();\n                    var newnode = LiteGraph.createNode(type);\n                    if (newnode) {\n                        subgraph.add(newnode);\n                        this.block_click = false;\n                        this.last_click_position = null;\n                        this.selectNodes([newnode]);\n                        this.node_dragged = newnode;\n                        this.dragging_canvas = false;\n                        newnode.setProperty(\"name\", input.name);\n                        newnode.setProperty(\"type\", input.type);\n                        this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                        this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                        this.graph.afterChange();\n                    }\n                    else\n                        console.error(\"graph input node not found:\", type);\n                }\n                ctx.fillStyle = \"#9C9\";\n                ctx.beginPath();\n                ctx.arc(w - 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n                ctx.fill();\n                ctx.fillStyle = \"#AAA\";\n                ctx.fillText(input.name, 30, y + h * 0.75);\n                // var tw = ctx.measureText(input.name);\n                ctx.fillStyle = \"#777\";\n                ctx.fillText(input.type, 130, y + h * 0.75);\n                y += h;\n            }\n        //add + button\n        if (this.drawButton(20, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n            this.showSubgraphPropertiesDialog(subnode);\n        }\n    }\n    LGraphCanvas.prototype.drawSubgraphPanelRight = function (subgraph, subnode, ctx) {\n        var num = subnode.outputs ? subnode.outputs.length : 0;\n        var canvas_w = this.bgcanvas.width\n        var w = 200;\n        var h = Math.floor(LiteGraph.NODE_SLOT_HEIGHT * 1.6);\n\n        ctx.fillStyle = \"#111\";\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        ctx.roundRect(canvas_w - w - 10, 10, w, (num + 1) * h + 50, [8]);\n        ctx.fill();\n        ctx.globalAlpha = 1;\n\n        ctx.fillStyle = \"#888\";\n        ctx.font = \"14px Arial\";\n        ctx.textAlign = \"left\";\n        var title_text = \"Graph Outputs\"\n        var tw = ctx.measureText(title_text).width\n        ctx.fillText(title_text, (canvas_w - tw) - 20, 34);\n        // var pos = this.mouse;\n        if (this.drawButton(canvas_w - w, 20, 20, 20, \"X\", \"#151515\")) {\n            this.closeSubgraph();\n            return;\n        }\n\n        var y = 50;\n        ctx.font = \"14px Arial\";\n        if (subnode.outputs)\n            for (var i = 0; i < subnode.outputs.length; ++i) {\n                var output = subnode.outputs[i];\n                if (output.not_subgraph_input)\n                    continue;\n\n                //output button clicked\n                if (this.drawButton(canvas_w - w, y + 2, w - 20, h - 2)) {\n                    var type = subnode.constructor.output_node_type || \"graph/output\";\n                    this.graph.beforeChange();\n                    var newnode = LiteGraph.createNode(type);\n                    if (newnode) {\n                        subgraph.add(newnode);\n                        this.block_click = false;\n                        this.last_click_position = null;\n                        this.selectNodes([newnode]);\n                        this.node_dragged = newnode;\n                        this.dragging_canvas = false;\n                        newnode.setProperty(\"name\", output.name);\n                        newnode.setProperty(\"type\", output.type);\n                        this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                        this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                        this.graph.afterChange();\n                    }\n                    else\n                        console.error(\"graph input node not found:\", type);\n                }\n                ctx.fillStyle = \"#9C9\";\n                ctx.beginPath();\n                ctx.arc(canvas_w - w + 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n                ctx.fill();\n                ctx.fillStyle = \"#AAA\";\n                ctx.fillText(output.name, canvas_w - w + 30, y + h * 0.75);\n                // var tw = ctx.measureText(input.name);\n                ctx.fillStyle = \"#777\";\n                ctx.fillText(output.type, canvas_w - w + 130, y + h * 0.75);\n                y += h;\n            }\n        //add + button\n        if (this.drawButton(canvas_w - w, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n            this.showSubgraphPropertiesDialogRight(subnode);\n        }\n    }\n    //Draws a button into the canvas overlay and computes if it was clicked using the immediate gui paradigm\n    LGraphCanvas.prototype.drawButton = function( x,y,w,h, text, bgcolor, hovercolor, textcolor )\n    {\n        var ctx = this.ctx;\n        bgcolor = bgcolor || LiteGraph.NODE_DEFAULT_COLOR;\n        hovercolor = hovercolor || \"#555\";\n        textcolor = textcolor || LiteGraph.NODE_TEXT_COLOR;\n        var pos = this.ds.convertOffsetToCanvas(this.graph_mouse);\n        var hover = LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n        pos = this.last_click_position ? [this.last_click_position[0], this.last_click_position[1]] : null;\n        if(pos) {\n            var rect = this.canvas.getBoundingClientRect();\n            pos[0] -= rect.left;\n            pos[1] -= rect.top;\n        }\n        var clicked = pos && LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n\n        ctx.fillStyle = hover ? hovercolor : bgcolor;\n        if(clicked)\n            ctx.fillStyle = \"#AAA\";\n        ctx.beginPath();\n        ctx.roundRect(x,y,w,h,[4] );\n        ctx.fill();\n\n        if(text != null)\n        {\n            if(text.constructor == String)\n            {\n                ctx.fillStyle = textcolor;\n                ctx.textAlign = \"center\";\n                ctx.font = ((h * 0.65)|0) + \"px Arial\";\n                ctx.fillText( text, x + w * 0.5,y + h * 0.75 );\n                ctx.textAlign = \"left\";\n            }\n        }\n\n        var was_clicked = clicked && !this.block_click;\n        if(clicked)\n            this.blockClick();\n        return was_clicked;\n    }\n\n    LGraphCanvas.prototype.isAreaClicked = function( x,y,w,h, hold_click )\n    {\n        var pos = this.mouse;\n        var hover = LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n        pos = this.last_click_position;\n        var clicked = pos && LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n        var was_clicked = clicked && !this.block_click;\n        if(clicked && hold_click)\n            this.blockClick();\n        return was_clicked;\n    }\n\n    /**\n     * draws some useful stats in the corner of the canvas\n     * @method renderInfo\n     **/\n    LGraphCanvas.prototype.renderInfo = function(ctx, x, y) {\n        x = x || 10;\n        y = y || this.canvas.offsetHeight - 80;\n\n        ctx.save();\n        ctx.translate(x, y);\n\n        ctx.font = \"10px Arial\";\n        ctx.fillStyle = \"#888\";\n        ctx.textAlign = \"left\";\n        if (this.graph) {\n            ctx.fillText( \"T: \" + this.graph.globaltime.toFixed(2) + \"s\", 5, 13 * 1 );\n            ctx.fillText(\"I: \" + this.graph.iteration, 5, 13 * 2 );\n            ctx.fillText(\"N: \" + this.graph._nodes.length + \" [\" + this.visible_nodes.length + \"]\", 5, 13 * 3 );\n            ctx.fillText(\"V: \" + this.graph._version, 5, 13 * 4);\n            ctx.fillText(\"FPS:\" + this.fps.toFixed(2), 5, 13 * 5);\n        } else {\n            ctx.fillText(\"No graph selected\", 5, 13 * 1);\n        }\n        ctx.restore();\n    };\n\n    /**\n     * draws the back canvas (the one containing the background and the connections)\n     * @method drawBackCanvas\n     **/\n    LGraphCanvas.prototype.drawBackCanvas = function() {\n        var canvas = this.bgcanvas;\n        if (\n            canvas.width != this.canvas.width ||\n            canvas.height != this.canvas.height\n        ) {\n            canvas.width = this.canvas.width;\n            canvas.height = this.canvas.height;\n        }\n\n        if (!this.bgctx) {\n            this.bgctx = this.bgcanvas.getContext(\"2d\");\n        }\n        var ctx = this.bgctx;\n        if (ctx.start) {\n            ctx.start();\n        }\n\n        var viewport = this.viewport || [0,0,ctx.canvas.width,ctx.canvas.height];\n\n        //clear\n        if (this.clear_background) {\n            ctx.clearRect( viewport[0], viewport[1], viewport[2], viewport[3] );\n        }\n\n        //show subgraph stack header\n        if (this._graph_stack && this._graph_stack.length) {\n            ctx.save();\n            var parent_graph = this._graph_stack[this._graph_stack.length - 1];\n            var subgraph_node = this.graph._subgraph_node;\n            ctx.strokeStyle = subgraph_node.bgcolor;\n            ctx.lineWidth = 10;\n            ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);\n            ctx.lineWidth = 1;\n            ctx.font = \"40px Arial\";\n            ctx.textAlign = \"center\";\n            ctx.fillStyle = subgraph_node.bgcolor || \"#AAA\";\n            var title = \"\";\n            for (var i = 1; i < this._graph_stack.length; ++i) {\n                title +=\n                    this._graph_stack[i]._subgraph_node.getTitle() + \" >> \";\n            }\n            ctx.fillText(\n                title + subgraph_node.getTitle(),\n                canvas.width * 0.5,\n                40\n            );\n            ctx.restore();\n        }\n\n        var bg_already_painted = false;\n        if (this.onRenderBackground) {\n            bg_already_painted = this.onRenderBackground(canvas, ctx);\n        }\n\n        //reset in case of error\n        if ( !this.viewport )\n        {\n            ctx.restore();\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n        }\n        this.visible_links.length = 0;\n\n        if (this.graph) {\n            //apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            //render BG\n            if ( this.ds.scale < 1.5 && !bg_already_painted && this.clear_background_color )\n            {\n                ctx.fillStyle = this.clear_background_color;\n                ctx.fillRect(\n                    this.visible_area[0],\n                    this.visible_area[1],\n                    this.visible_area[2],\n                    this.visible_area[3]\n                );\n            }\n\n            if (\n                this.background_image &&\n                this.ds.scale > 0.5 &&\n                !bg_already_painted\n            ) {\n                if (this.zoom_modify_alpha) {\n                    ctx.globalAlpha =\n                        (1.0 - 0.5 / this.ds.scale) * this.editor_alpha;\n                } else {\n                    ctx.globalAlpha = this.editor_alpha;\n                }\n                ctx.imageSmoothingEnabled = ctx.imageSmoothingEnabled = false; // ctx.mozImageSmoothingEnabled =\n                if (\n                    !this._bg_img ||\n                    this._bg_img.name != this.background_image\n                ) {\n                    this._bg_img = new Image();\n                    this._bg_img.name = this.background_image;\n                    this._bg_img.src = this.background_image;\n                    var that = this;\n                    this._bg_img.onload = function() {\n                        that.draw(true, true);\n                    };\n                }\n\n                var pattern = null;\n                if (this._pattern == null && this._bg_img.width > 0) {\n                    pattern = ctx.createPattern(this._bg_img, \"repeat\");\n                    this._pattern_img = this._bg_img;\n                    this._pattern = pattern;\n                } else {\n                    pattern = this._pattern;\n                }\n                if (pattern) {\n                    ctx.fillStyle = pattern;\n                    ctx.fillRect(\n                        this.visible_area[0],\n                        this.visible_area[1],\n                        this.visible_area[2],\n                        this.visible_area[3]\n                    );\n                    ctx.fillStyle = \"transparent\";\n                }\n\n                ctx.globalAlpha = 1.0;\n                ctx.imageSmoothingEnabled = ctx.imageSmoothingEnabled = true; //= ctx.mozImageSmoothingEnabled\n            }\n\n            //groups\n            if (this.graph._groups.length && !this.live_mode) {\n                this.drawGroups(canvas, ctx);\n            }\n\n            if (this.onDrawBackground) {\n                this.onDrawBackground(ctx, this.visible_area);\n            }\n            if (this.onBackgroundRender) {\n                //LEGACY\n                console.error(\n                    \"WARNING! onBackgroundRender deprecated, now is named onDrawBackground \"\n                );\n                this.onBackgroundRender = null;\n            }\n\n            //DEBUG: show clipping area\n            //ctx.fillStyle = \"red\";\n            //ctx.fillRect( this.visible_area[0] + 10, this.visible_area[1] + 10, this.visible_area[2] - 20, this.visible_area[3] - 20);\n\n            //bg\n            if (this.render_canvas_border) {\n                ctx.strokeStyle = \"#235\";\n                ctx.strokeRect(0, 0, canvas.width, canvas.height);\n            }\n\n            if (this.render_connections_shadows) {\n                ctx.shadowColor = \"#000\";\n                ctx.shadowOffsetX = 0;\n                ctx.shadowOffsetY = 0;\n                ctx.shadowBlur = 6;\n            } else {\n                ctx.shadowColor = \"rgba(0,0,0,0)\";\n            }\n\n            //draw connections\n            if (!this.live_mode) {\n                this.drawConnections(ctx);\n            }\n\n            ctx.shadowColor = \"rgba(0,0,0,0)\";\n\n            //restore state\n            ctx.restore();\n        }\n\n        if (ctx.finish) {\n            ctx.finish();\n        }\n\n        this.dirty_bgcanvas = false;\n        this.dirty_canvas = true; //to force to repaint the front canvas with the bgcanvas\n    };\n\n    var temp_vec2 = new Float32Array(2);\n\n    /**\n     * draws the given node inside the canvas\n     * @method drawNode\n     **/\n    LGraphCanvas.prototype.drawNode = function(node, ctx) {\n        var glow = false;\n        this.current_node = node;\n\n        var color = node.color || node.constructor.color || LiteGraph.NODE_DEFAULT_COLOR;\n        var bgcolor = node.bgcolor || node.constructor.bgcolor || LiteGraph.NODE_DEFAULT_BGCOLOR;\n\n        //shadow and glow\n        if (node.mouseOver) {\n            glow = true;\n        }\n\n        var low_quality = this.ds.scale < 0.6; //zoomed out\n\n        //only render if it forces it to do it\n        if (this.live_mode) {\n            if (!node.flags.collapsed) {\n                ctx.shadowColor = \"transparent\";\n                if (node.onDrawForeground) {\n                    node.onDrawForeground(ctx, this, this.canvas);\n                }\n            }\n            return;\n        }\n\n        var editor_alpha = this.editor_alpha;\n        ctx.globalAlpha = editor_alpha;\n\n        if (this.render_shadows && !low_quality) {\n            ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n            ctx.shadowOffsetX = 2 * this.ds.scale;\n            ctx.shadowOffsetY = 2 * this.ds.scale;\n            ctx.shadowBlur = 3 * this.ds.scale;\n        } else {\n            ctx.shadowColor = \"transparent\";\n        }\n\n        //custom draw collapsed method (draw after shadows because they are affected)\n        if (\n            node.flags.collapsed &&\n            node.onDrawCollapsed &&\n            node.onDrawCollapsed(ctx, this) == true\n        ) {\n            return;\n        }\n\n        //clip if required (mask)\n        var shape = node._shape || LiteGraph.BOX_SHAPE;\n        var size = temp_vec2;\n        temp_vec2.set(node.size);\n        var horizontal = node.horizontal; // || node.flags.horizontal;\n\n        if (node.flags.collapsed) {\n            ctx.font = this.inner_text_font;\n            var title = node.getTitle ? node.getTitle() : node.title;\n            if (title != null) {\n                node._collapsed_width = Math.min(\n                    node.size[0],\n                    ctx.measureText(title).width +\n                    LiteGraph.NODE_TITLE_HEIGHT * 2\n                ); //LiteGraph.NODE_COLLAPSED_WIDTH;\n                size[0] = node._collapsed_width;\n                size[1] = 0;\n            }\n        }\n\n        if (node.clip_area) {\n            //Start clipping\n            ctx.save();\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE) {\n                ctx.rect(0, 0, size[0], size[1]);\n            } else if (shape == LiteGraph.ROUND_SHAPE) {\n                ctx.roundRect(0, 0, size[0], size[1], [10]);\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.clip();\n        }\n\n        //draw shape\n        if (node.has_errors) {\n            bgcolor = \"red\";\n        }\n        this.drawNodeShape(\n            node,\n            ctx,\n            size,\n            color,\n            bgcolor,\n            node.is_selected,\n            node.mouseOver\n        );\n        ctx.shadowColor = \"transparent\";\n\n        //draw foreground\n        if (node.onDrawForeground) {\n            node.onDrawForeground(ctx, this, this.canvas);\n        }\n\n        //connection slots\n        ctx.textAlign = horizontal ? \"center\" : \"left\";\n        ctx.font = this.inner_text_font;\n\n        var render_text = !low_quality;\n\n        var out_slot = this.connecting_output;\n        var in_slot = this.connecting_input;\n        ctx.lineWidth = 1;\n\n        var max_y = 0;\n        var slot_pos = new Float32Array(2); //to reuse\n\n        //render inputs and outputs\n        if (!node.flags.collapsed) {\n            //input connection slots\n            if (node.inputs) {\n                for (var i = 0; i < node.inputs.length; i++) {\n                    var slot = node.inputs[i];\n\n                    var slot_type = slot.type;\n                    var slot_shape = slot.shape;\n\n                    ctx.globalAlpha = editor_alpha;\n                    //change opacity of incompatible slots when dragging a connection\n                    if ( this.connecting_output && !LiteGraph.isValidConnection( slot.type , out_slot.type) ) {\n                        ctx.globalAlpha = 0.4 * editor_alpha;\n                    }\n\n                    ctx.fillStyle =\n                        slot.link != null\n                            ? slot.color_on ||\n                            this.default_connection_color_byType[slot_type] ||\n                            this.default_connection_color.input_on\n                            : slot.color_off ||\n                            this.default_connection_color_byTypeOff[slot_type] ||\n                            this.default_connection_color_byType[slot_type] ||\n                            this.default_connection_color.input_off;\n\n                    var pos = node.getConnectionPos(true, i, slot_pos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                        max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.beginPath();\n\n                    if (slot_type == \"array\"){\n                        slot_shape = LiteGraph.GRID_SHAPE; // place in addInput? addOutput instead?\n                    }\n\n                    var doStroke = true;\n\n                    if (\n                        slot.type === LiteGraph.EVENT ||\n                        slot.shape === LiteGraph.BOX_SHAPE\n                    ) {\n                        if (horizontal) {\n                            ctx.rect(\n                                pos[0] - 5 + 0.5,\n                                pos[1] - 8 + 0.5,\n                                10,\n                                14\n                            );\n                        } else {\n                            ctx.rect(\n                                pos[0] - 6 + 0.5,\n                                pos[1] - 5 + 0.5,\n                                14,\n                                10\n                            );\n                        }\n                    } else if (slot_shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else if (slot_shape === LiteGraph.GRID_SHAPE) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] + 2, 2, 2);\n                        doStroke = false;\n                    } else {\n                        if(low_quality)\n                            ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8 ); //faster\n                        else\n                            ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n                    ctx.fill();\n\n                    //render name\n                    if (render_text) {\n                        var text = slot.label != null ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir == LiteGraph.UP) {\n                                ctx.fillText(text, pos[0], pos[1] - 10);\n                            } else {\n                                ctx.fillText(text, pos[0] + 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            //output connection slots\n\n            ctx.textAlign = horizontal ? \"center\" : \"right\";\n            ctx.strokeStyle = \"black\";\n            if (node.outputs) {\n                for (var i = 0; i < node.outputs.length; i++) {\n                    var slot = node.outputs[i];\n\n                    var slot_type = slot.type;\n                    var slot_shape = slot.shape;\n\n                    //change opacity of incompatible slots when dragging a connection\n                    if (this.connecting_input && !LiteGraph.isValidConnection( slot_type , in_slot.type) ) {\n                        ctx.globalAlpha = 0.4 * editor_alpha;\n                    }\n\n                    var pos = node.getConnectionPos(false, i, slot_pos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                        max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.fillStyle =\n                        slot.links && slot.links.length\n                            ? slot.color_on ||\n                            this.default_connection_color_byType[slot_type] ||\n                            this.default_connection_color.output_on\n                            : slot.color_off ||\n                            this.default_connection_color_byTypeOff[slot_type] ||\n                            this.default_connection_color_byType[slot_type] ||\n                            this.default_connection_color.output_off;\n                    ctx.beginPath();\n                    //ctx.rect( node.size[0] - 14,i*14,10,10);\n\n                    if (slot_type == \"array\"){\n                        slot_shape = LiteGraph.GRID_SHAPE;\n                    }\n\n                    var doStroke = true;\n\n                    if (\n                        slot_type === LiteGraph.EVENT ||\n                        slot_shape === LiteGraph.BOX_SHAPE\n                    ) {\n                        if (horizontal) {\n                            ctx.rect(\n                                pos[0] - 5 + 0.5,\n                                pos[1] - 8 + 0.5,\n                                10,\n                                14\n                            );\n                        } else {\n                            ctx.rect(\n                                pos[0] - 6 + 0.5,\n                                pos[1] - 5 + 0.5,\n                                14,\n                                10\n                            );\n                        }\n                    } else if (slot_shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    }  else if (slot_shape === LiteGraph.GRID_SHAPE) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] + 2, 2, 2);\n                        doStroke = false;\n                    } else {\n                        if(low_quality)\n                            ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8 );\n                        else\n                            ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n\n                    //trigger\n                    //if(slot.node_id != null && slot.slot == -1)\n                    //\tctx.fillStyle = \"#F85\";\n\n                    //if(slot.links != null && slot.links.length)\n                    ctx.fill();\n                    if(!low_quality && doStroke)\n                        ctx.stroke();\n\n                    //render output name\n                    if (render_text) {\n                        var text = slot.label != null ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir == LiteGraph.DOWN) {\n                                ctx.fillText(text, pos[0], pos[1] - 8);\n                            } else {\n                                ctx.fillText(text, pos[0] - 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            ctx.textAlign = \"left\";\n            ctx.globalAlpha = 1;\n\n            if (node.widgets) {\n                var widgets_y = max_y;\n                if (horizontal || node.widgets_up) {\n                    widgets_y = 2;\n                }\n                if( node.widgets_start_y != null )\n                    widgets_y = node.widgets_start_y;\n                this.drawNodeWidgets(\n                    node,\n                    widgets_y,\n                    ctx,\n                    this.node_widget && this.node_widget[0] == node\n                        ? this.node_widget[1]\n                        : null\n                );\n            }\n        } else if (this.render_collapsed_slots) {\n            //if collapsed\n            var input_slot = null;\n            var output_slot = null;\n\n            //get first connected slot to render\n            if (node.inputs) {\n                for (var i = 0; i < node.inputs.length; i++) {\n                    var slot = node.inputs[i];\n                    if (slot.link == null) {\n                        continue;\n                    }\n                    input_slot = slot;\n                    break;\n                }\n            }\n            if (node.outputs) {\n                for (var i = 0; i < node.outputs.length; i++) {\n                    var slot = node.outputs[i];\n                    if (!slot.links || !slot.links.length) {\n                        continue;\n                    }\n                    output_slot = slot;\n                }\n            }\n\n            if (input_slot) {\n                var x = 0;\n                var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; //center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = -LiteGraph.NODE_TITLE_HEIGHT;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.beginPath();\n                if (\n                    slot.type === LiteGraph.EVENT ||\n                    slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(x + 8, y);\n                    ctx.lineTo(x + -4, y - 4);\n                    ctx.lineTo(x + -4, y + 4);\n                    ctx.closePath();\n                } else {\n                    ctx.arc(x, y, 4, 0, Math.PI * 2);\n                }\n                ctx.fill();\n            }\n\n            if (output_slot) {\n                var x = node._collapsed_width;\n                var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; //center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = 0;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.strokeStyle = \"black\";\n                ctx.beginPath();\n                if (\n                    slot.type === LiteGraph.EVENT ||\n                    slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(x + 6, y);\n                    ctx.lineTo(x - 6, y - 4);\n                    ctx.lineTo(x - 6, y + 4);\n                    ctx.closePath();\n                } else {\n                    ctx.arc(x, y, 4, 0, Math.PI * 2);\n                }\n                ctx.fill();\n                //ctx.stroke();\n            }\n        }\n\n        if (node.clip_area) {\n            ctx.restore();\n        }\n\n        ctx.globalAlpha = 1.0;\n    };\n\n    //used by this.over_link_center\n    LGraphCanvas.prototype.drawLinkTooltip = function( ctx, link )\n    {\n        var pos = link._pos;\n        ctx.fillStyle = \"black\";\n        ctx.beginPath();\n        ctx.arc( pos[0], pos[1], 3, 0, Math.PI * 2 );\n        ctx.fill();\n\n        if(link.data == null)\n            return;\n\n        if(this.onDrawLinkTooltip)\n            if( this.onDrawLinkTooltip(ctx,link,this) == true )\n                return;\n\n        var data = link.data;\n        var text = null;\n\n        if( data.constructor === Number )\n            text = data.toFixed(2);\n        else if( data.constructor === String )\n            text = \"\\\"\" + data + \"\\\"\";\n        else if( data.constructor === Boolean )\n            text = String(data);\n        else if (data.toToolTip)\n            text = data.toToolTip();\n        else\n            text = \"[\" + data.constructor.name + \"]\";\n\n        if(text == null)\n            return;\n        text = text.substr(0,30); //avoid weird\n\n        ctx.font = \"14px Courier New\";\n        var info = ctx.measureText(text);\n        var w = info.width + 20;\n        var h = 24;\n        ctx.shadowColor = \"black\";\n        ctx.shadowOffsetX = 2;\n        ctx.shadowOffsetY = 2;\n        ctx.shadowBlur = 3;\n        ctx.fillStyle = \"#454\";\n        ctx.beginPath();\n        ctx.roundRect( pos[0] - w*0.5, pos[1] - 15 - h, w, h, [3]);\n        ctx.moveTo( pos[0] - 10, pos[1] - 15 );\n        ctx.lineTo( pos[0] + 10, pos[1] - 15 );\n        ctx.lineTo( pos[0], pos[1] - 5 );\n        ctx.fill();\n        ctx.shadowColor = \"transparent\";\n        ctx.textAlign = \"center\";\n        ctx.fillStyle = \"#CEC\";\n        ctx.fillText(text, pos[0], pos[1] - 15 - h * 0.3);\n    }\n\n    /**\n     * draws the shape of the given node in the canvas\n     * @method drawNodeShape\n     **/\n    var tmp_area = new Float32Array(4);\n\n    LGraphCanvas.prototype.drawNodeShape = function(\n        node,\n        ctx,\n        size,\n        fgcolor,\n        bgcolor,\n        selected,\n        mouse_over\n    ) {\n        //bg rect\n        ctx.strokeStyle = fgcolor;\n        ctx.fillStyle = bgcolor;\n\n        var title_height = LiteGraph.NODE_TITLE_HEIGHT;\n        var low_quality = this.ds.scale < 0.5;\n\n        //render node area depending on shape\n        var shape =\n            node._shape || node.constructor.shape || LiteGraph.ROUND_SHAPE;\n\n        var title_mode = node.constructor.title_mode;\n\n        var render_title = true;\n        if (title_mode == LiteGraph.TRANSPARENT_TITLE || title_mode == LiteGraph.NO_TITLE) {\n            render_title = false;\n        } else if (title_mode == LiteGraph.AUTOHIDE_TITLE && mouse_over) {\n            render_title = true;\n        }\n\n        var area = tmp_area;\n        area[0] = 0; //x\n        area[1] = render_title ? -title_height : 0; //y\n        area[2] = size[0] + 1; //w\n        area[3] = render_title ? size[1] + title_height : size[1]; //h\n\n        var old_alpha = ctx.globalAlpha;\n\n        //full node shape\n        //if(node.flags.collapsed)\n        {\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                ctx.fillRect(area[0], area[1], area[2], area[3]);\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                shape == LiteGraph.CARD_SHAPE\n            ) {\n                ctx.roundRect(\n                    area[0],\n                    area[1],\n                    area[2],\n                    area[3],\n                    shape == LiteGraph.CARD_SHAPE ? [this.round_radius,this.round_radius,0,0] : [this.round_radius]\n                );\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.fill();\n\n            //separator\n            if(!node.flags.collapsed && render_title)\n            {\n                ctx.shadowColor = \"transparent\";\n                ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n                ctx.fillRect(0, -1, area[2], 2);\n            }\n        }\n        ctx.shadowColor = \"transparent\";\n\n        if (node.onDrawBackground) {\n            node.onDrawBackground(ctx, this, this.canvas, this.graph_mouse );\n        }\n\n        //title bg (remember, it is rendered ABOVE the node)\n        if (render_title || title_mode == LiteGraph.TRANSPARENT_TITLE) {\n            //title bar\n            if (node.onDrawTitleBar) {\n                node.onDrawTitleBar( ctx, title_height, size, this.ds.scale, fgcolor );\n            } else if (\n                title_mode != LiteGraph.TRANSPARENT_TITLE &&\n                (node.constructor.title_color || this.render_title_colored)\n            ) {\n                var title_color = node.constructor.title_color || fgcolor;\n\n                if (node.flags.collapsed) {\n                    ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n                }\n\n                //* gradient test\n                if (this.use_gradients) {\n                    var grad = LGraphCanvas.gradients[title_color];\n                    if (!grad) {\n                        grad = LGraphCanvas.gradients[ title_color ] = ctx.createLinearGradient(0, 0, 400, 0);\n                        grad.addColorStop(0, title_color); // TODO refactor: validate color !! prevent DOMException\n                        grad.addColorStop(1, \"#000\");\n                    }\n                    ctx.fillStyle = grad;\n                } else {\n                    ctx.fillStyle = title_color;\n                }\n\n                //ctx.globalAlpha = 0.5 * old_alpha;\n                ctx.beginPath();\n                if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                    ctx.rect(0, -title_height, size[0] + 1, title_height);\n                } else if (  shape == LiteGraph.ROUND_SHAPE || shape == LiteGraph.CARD_SHAPE ) {\n                    ctx.roundRect(\n                        0,\n                        -title_height,\n                        size[0] + 1,\n                        title_height,\n                        node.flags.collapsed ? [this.round_radius] : [this.round_radius,this.round_radius,0,0]\n                    );\n                }\n                ctx.fill();\n                ctx.shadowColor = \"transparent\";\n            }\n\n            var colState = false;\n            if (LiteGraph.node_box_coloured_by_mode){\n                if(LiteGraph.NODE_MODES_COLORS[node.mode]){\n                    colState = LiteGraph.NODE_MODES_COLORS[node.mode];\n                }\n            }\n            if (LiteGraph.node_box_coloured_when_on){\n                colState = node.action_triggered ? \"#FFF\" : (node.execute_triggered ? \"#AAA\" : colState);\n            }\n\n            //title box\n            var box_size = 10;\n            if (node.onDrawTitleBox) {\n                node.onDrawTitleBox(ctx, title_height, size, this.ds.scale);\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                shape == LiteGraph.CIRCLE_SHAPE ||\n                shape == LiteGraph.CARD_SHAPE\n            ) {\n                if (low_quality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.beginPath();\n                    ctx.arc(\n                        title_height * 0.5,\n                        title_height * -0.5,\n                        box_size * 0.5 + 1,\n                        0,\n                        Math.PI * 2\n                    );\n                    ctx.fill();\n                }\n\n                ctx.fillStyle = node.boxcolor || colState || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n                if(low_quality)\n                    ctx.fillRect( title_height * 0.5 - box_size *0.5, title_height * -0.5 - box_size *0.5, box_size , box_size  );\n                else\n                {\n                    ctx.beginPath();\n                    ctx.arc(\n                        title_height * 0.5,\n                        title_height * -0.5,\n                        box_size * 0.5,\n                        0,\n                        Math.PI * 2\n                    );\n                    ctx.fill();\n                }\n            } else {\n                if (low_quality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.fillRect(\n                        (title_height - box_size) * 0.5 - 1,\n                        (title_height + box_size) * -0.5 - 1,\n                        box_size + 2,\n                        box_size + 2\n                    );\n                }\n                ctx.fillStyle = node.boxcolor || colState || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n                ctx.fillRect(\n                    (title_height - box_size) * 0.5,\n                    (title_height + box_size) * -0.5,\n                    box_size,\n                    box_size\n                );\n            }\n            ctx.globalAlpha = old_alpha;\n\n            //title text\n            if (node.onDrawTitleText) {\n                node.onDrawTitleText(\n                    ctx,\n                    title_height,\n                    size,\n                    this.ds.scale,\n                    this.title_text_font,\n                    selected\n                );\n            }\n            if (!low_quality) {\n                ctx.font = this.title_text_font;\n                var title = String(node.getTitle());\n                if (title) {\n                    if (selected) {\n                        ctx.fillStyle = LiteGraph.NODE_SELECTED_TITLE_COLOR;\n                    } else {\n                        ctx.fillStyle =\n                            node.constructor.title_text_color ||\n                            this.node_title_color;\n                    }\n                    if (node.flags.collapsed) {\n                        ctx.textAlign = \"left\";\n                        var measure = ctx.measureText(title);\n                        ctx.fillText(\n                            title.substr(0,20), //avoid urls too long\n                            title_height,// + measure.width * 0.5,\n                            LiteGraph.NODE_TITLE_TEXT_Y - title_height\n                        );\n                        ctx.textAlign = \"left\";\n                    } else {\n                        ctx.textAlign = \"left\";\n                        ctx.fillText(\n                            title,\n                            title_height,\n                            LiteGraph.NODE_TITLE_TEXT_Y - title_height\n                        );\n                    }\n                }\n            }\n\n            //subgraph box\n            if (!node.flags.collapsed && node.subgraph && !node.skip_subgraph_button) {\n                var w = LiteGraph.NODE_TITLE_HEIGHT;\n                var x = node.size[0] - w;\n                var over = LiteGraph.isInsideRectangle( this.graph_mouse[0] - node.pos[0], this.graph_mouse[1] - node.pos[1], x+2, -w+2, w-4, w-4 );\n                ctx.fillStyle = over ? \"#888\" : \"#555\";\n                if( shape == LiteGraph.BOX_SHAPE || low_quality)\n                    ctx.fillRect(x+2, -w+2, w-4, w-4);\n                else\n                {\n                    ctx.beginPath();\n                    ctx.roundRect(x+2, -w+2, w-4, w-4,[4]);\n                    ctx.fill();\n                }\n                ctx.fillStyle = \"#333\";\n                ctx.beginPath();\n                ctx.moveTo(x + w * 0.2, -w * 0.6);\n                ctx.lineTo(x + w * 0.8, -w * 0.6);\n                ctx.lineTo(x + w * 0.5, -w * 0.3);\n                ctx.fill();\n            }\n\n            //custom title render\n            if (node.onDrawTitle) {\n                node.onDrawTitle(ctx);\n            }\n        }\n\n        //render selection marker\n        if (selected) {\n            if (node.onBounding) {\n                node.onBounding(area);\n            }\n\n            if (title_mode == LiteGraph.TRANSPARENT_TITLE) {\n                area[1] -= title_height;\n                area[3] += title_height;\n            }\n            ctx.lineWidth = 1;\n            ctx.globalAlpha = 0.8;\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE) {\n                ctx.rect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3]\n                );\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                (shape == LiteGraph.CARD_SHAPE && node.flags.collapsed)\n            ) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    [this.round_radius * 2]\n                );\n            } else if (shape == LiteGraph.CARD_SHAPE) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    [this.round_radius * 2,2,this.round_radius * 2,2]\n                );\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5 + 6,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.strokeStyle = LiteGraph.NODE_BOX_OUTLINE_COLOR;\n            ctx.stroke();\n            ctx.strokeStyle = fgcolor;\n            ctx.globalAlpha = 1;\n        }\n\n        // these counter helps in conditioning drawing based on if the node has been executed or an action occurred\n        if (node.execute_triggered>0) node.execute_triggered--;\n        if (node.action_triggered>0) node.action_triggered--;\n    };\n\n    var margin_area = new Float32Array(4);\n    var link_bounding = new Float32Array(4);\n    var tempA = new Float32Array(2);\n    var tempB = new Float32Array(2);\n\n    /**\n     * draws every connection visible in the canvas\n     * OPTIMIZE THIS: pre-catch connections position instead of recomputing them every time\n     * @method drawConnections\n     **/\n    LGraphCanvas.prototype.drawConnections = function(ctx) {\n        var now = LiteGraph.getTime();\n        var visible_area = this.visible_area;\n        margin_area[0] = visible_area[0] - 20;\n        margin_area[1] = visible_area[1] - 20;\n        margin_area[2] = visible_area[2] + 40;\n        margin_area[3] = visible_area[3] + 40;\n\n        //draw connections\n        ctx.lineWidth = this.connections_width;\n\n        ctx.fillStyle = \"#AAA\";\n        ctx.strokeStyle = \"#AAA\";\n        ctx.globalAlpha = this.editor_alpha;\n        //for every node\n        var nodes = this.graph._nodes;\n        for (var n = 0, l = nodes.length; n < l; ++n) {\n            var node = nodes[n];\n            //for every input (we render just inputs because it is easier as every slot can only have one input)\n            if (!node.inputs || !node.inputs.length) {\n                continue;\n            }\n\n            for (var i = 0; i < node.inputs.length; ++i) {\n                var input = node.inputs[i];\n                if (!input || input.link == null) {\n                    continue;\n                }\n                var link_id = input.link;\n                var link = this.graph.links[link_id];\n                if (!link) {\n                    continue;\n                }\n\n                //find link info\n                var start_node = this.graph.getNodeById(link.origin_id);\n                if (start_node == null) {\n                    continue;\n                }\n                var start_node_slot = link.origin_slot;\n                var start_node_slotpos = null;\n                if (start_node_slot == -1) {\n                    start_node_slotpos = [\n                        start_node.pos[0] + 10,\n                        start_node.pos[1] + 10\n                    ];\n                } else {\n                    start_node_slotpos = start_node.getConnectionPos(\n                        false,\n                        start_node_slot,\n                        tempA\n                    );\n                }\n                var end_node_slotpos = node.getConnectionPos(true, i, tempB);\n\n                //compute link bounding\n                link_bounding[0] = start_node_slotpos[0];\n                link_bounding[1] = start_node_slotpos[1];\n                link_bounding[2] = end_node_slotpos[0] - start_node_slotpos[0];\n                link_bounding[3] = end_node_slotpos[1] - start_node_slotpos[1];\n                if (link_bounding[2] < 0) {\n                    link_bounding[0] += link_bounding[2];\n                    link_bounding[2] = Math.abs(link_bounding[2]);\n                }\n                if (link_bounding[3] < 0) {\n                    link_bounding[1] += link_bounding[3];\n                    link_bounding[3] = Math.abs(link_bounding[3]);\n                }\n\n                //skip links outside of the visible area of the canvas\n                if (!overlapBounding(link_bounding, margin_area)) {\n                    continue;\n                }\n\n                var start_slot = start_node.outputs[start_node_slot];\n                var end_slot = node.inputs[i];\n                if (!start_slot || !end_slot) {\n                    continue;\n                }\n                var start_dir =\n                    start_slot.dir ||\n                    (start_node.horizontal ? LiteGraph.DOWN : LiteGraph.RIGHT);\n                var end_dir =\n                    end_slot.dir ||\n                    (node.horizontal ? LiteGraph.UP : LiteGraph.LEFT);\n\n                this.renderLink(\n                    ctx,\n                    start_node_slotpos,\n                    end_node_slotpos,\n                    link,\n                    false,\n                    0,\n                    null,\n                    start_dir,\n                    end_dir\n                );\n\n                //event triggered rendered on top\n                if (link && link._last_time && now - link._last_time < 1000) {\n                    var f = 2.0 - (now - link._last_time) * 0.002;\n                    var tmp = ctx.globalAlpha;\n                    ctx.globalAlpha = tmp * f;\n                    this.renderLink(\n                        ctx,\n                        start_node_slotpos,\n                        end_node_slotpos,\n                        link,\n                        true,\n                        f,\n                        \"white\",\n                        start_dir,\n                        end_dir\n                    );\n                    ctx.globalAlpha = tmp;\n                }\n            }\n        }\n        ctx.globalAlpha = 1;\n    };\n\n    /**\n     * draws a link between two points\n     * @method renderLink\n     * @param {vec2} a start pos\n     * @param {vec2} b end pos\n     * @param {Object} link the link object with all the link info\n     * @param {boolean} skip_border ignore the shadow of the link\n     * @param {boolean} flow show flow animation (for events)\n     * @param {string} color the color for the link\n     * @param {number} start_dir the direction enum\n     * @param {number} end_dir the direction enum\n     * @param {number} num_sublines number of sublines (useful to represent vec3 or rgb)\n     **/\n    LGraphCanvas.prototype.renderLink = function(\n        ctx,\n        a,\n        b,\n        link,\n        skip_border,\n        flow,\n        color,\n        start_dir,\n        end_dir,\n        num_sublines\n    ) {\n        if (link) {\n            this.visible_links.push(link);\n        }\n\n        //choose color\n        if (!color && link) {\n            color = link.color || LGraphCanvas.link_type_colors[link.type];\n        }\n        if (!color) {\n            color = this.default_link_color;\n        }\n        if (link != null && this.highlighted_links[link.id]) {\n            color = \"#FFF\";\n        }\n\n        start_dir = start_dir || LiteGraph.RIGHT;\n        end_dir = end_dir || LiteGraph.LEFT;\n\n        var dist = distance(a, b);\n\n        if (this.render_connections_border && this.ds.scale > 0.6) {\n            ctx.lineWidth = this.connections_width + 4;\n        }\n        ctx.lineJoin = \"round\";\n        num_sublines = num_sublines || 1;\n        if (num_sublines > 1) {\n            ctx.lineWidth = 0.5;\n        }\n\n        //begin line shape\n        ctx.beginPath();\n        for (var i = 0; i < num_sublines; i += 1) {\n            var offsety = (i - (num_sublines - 1) * 0.5) * 5;\n\n            if (this.links_render_mode == LiteGraph.SPLINE_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                var start_offset_x = 0;\n                var start_offset_y = 0;\n                var end_offset_x = 0;\n                var end_offset_y = 0;\n                switch (start_dir) {\n                    case LiteGraph.LEFT:\n                        start_offset_x = dist * -0.25;\n                        break;\n                    case LiteGraph.RIGHT:\n                        start_offset_x = dist * 0.25;\n                        break;\n                    case LiteGraph.UP:\n                        start_offset_y = dist * -0.25;\n                        break;\n                    case LiteGraph.DOWN:\n                        start_offset_y = dist * 0.25;\n                        break;\n                }\n                switch (end_dir) {\n                    case LiteGraph.LEFT:\n                        end_offset_x = dist * -0.25;\n                        break;\n                    case LiteGraph.RIGHT:\n                        end_offset_x = dist * 0.25;\n                        break;\n                    case LiteGraph.UP:\n                        end_offset_y = dist * -0.25;\n                        break;\n                    case LiteGraph.DOWN:\n                        end_offset_y = dist * 0.25;\n                        break;\n                }\n                ctx.bezierCurveTo(\n                    a[0] + start_offset_x,\n                    a[1] + start_offset_y + offsety,\n                    b[0] + end_offset_x,\n                    b[1] + end_offset_y + offsety,\n                    b[0],\n                    b[1] + offsety\n                );\n            } else if (this.links_render_mode == LiteGraph.LINEAR_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                var start_offset_x = 0;\n                var start_offset_y = 0;\n                var end_offset_x = 0;\n                var end_offset_y = 0;\n                switch (start_dir) {\n                    case LiteGraph.LEFT:\n                        start_offset_x = -1;\n                        break;\n                    case LiteGraph.RIGHT:\n                        start_offset_x = 1;\n                        break;\n                    case LiteGraph.UP:\n                        start_offset_y = -1;\n                        break;\n                    case LiteGraph.DOWN:\n                        start_offset_y = 1;\n                        break;\n                }\n                switch (end_dir) {\n                    case LiteGraph.LEFT:\n                        end_offset_x = -1;\n                        break;\n                    case LiteGraph.RIGHT:\n                        end_offset_x = 1;\n                        break;\n                    case LiteGraph.UP:\n                        end_offset_y = -1;\n                        break;\n                    case LiteGraph.DOWN:\n                        end_offset_y = 1;\n                        break;\n                }\n                var l = 15;\n                ctx.lineTo(\n                    a[0] + start_offset_x * l,\n                    a[1] + start_offset_y * l + offsety\n                );\n                ctx.lineTo(\n                    b[0] + end_offset_x * l,\n                    b[1] + end_offset_y * l + offsety\n                );\n                ctx.lineTo(b[0], b[1] + offsety);\n            } else if (this.links_render_mode == LiteGraph.STRAIGHT_LINK) {\n                ctx.moveTo(a[0], a[1]);\n                var start_x = a[0];\n                var start_y = a[1];\n                var end_x = b[0];\n                var end_y = b[1];\n                if (start_dir == LiteGraph.RIGHT) {\n                    start_x += 10;\n                } else {\n                    start_y += 10;\n                }\n                if (end_dir == LiteGraph.LEFT) {\n                    end_x -= 10;\n                } else {\n                    end_y -= 10;\n                }\n                ctx.lineTo(start_x, start_y);\n                ctx.lineTo((start_x + end_x) * 0.5, start_y);\n                ctx.lineTo((start_x + end_x) * 0.5, end_y);\n                ctx.lineTo(end_x, end_y);\n                ctx.lineTo(b[0], b[1]);\n            } else {\n                return;\n            } //unknown\n        }\n\n        //rendering the outline of the connection can be a little bit slow\n        if (\n            this.render_connections_border &&\n            this.ds.scale > 0.6 &&\n            !skip_border\n        ) {\n            ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n            ctx.stroke();\n        }\n\n        ctx.lineWidth = this.connections_width;\n        ctx.fillStyle = ctx.strokeStyle = color;\n        ctx.stroke();\n        //end line shape\n\n        var pos = this.computeConnectionPoint(a, b, 0.5, start_dir, end_dir);\n        if (link && link._pos) {\n            link._pos[0] = pos[0];\n            link._pos[1] = pos[1];\n        }\n\n        //render arrow in the middle\n        if (\n            this.ds.scale >= 0.6 &&\n            this.highquality_render &&\n            end_dir != LiteGraph.CENTER\n        ) {\n            //render arrow\n            if (this.render_connection_arrows) {\n                //compute two points in the connection\n                var posA = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.25,\n                    start_dir,\n                    end_dir\n                );\n                var posB = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.26,\n                    start_dir,\n                    end_dir\n                );\n                var posC = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.75,\n                    start_dir,\n                    end_dir\n                );\n                var posD = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.76,\n                    start_dir,\n                    end_dir\n                );\n\n                //compute the angle between them so the arrow points in the right direction\n                var angleA = 0;\n                var angleB = 0;\n                if (this.render_curved_connections) {\n                    angleA = -Math.atan2(posB[0] - posA[0], posB[1] - posA[1]);\n                    angleB = -Math.atan2(posD[0] - posC[0], posD[1] - posC[1]);\n                } else {\n                    angleB = angleA = b[1] > a[1] ? 0 : Math.PI;\n                }\n\n                //render arrow\n                ctx.save();\n                ctx.translate(posA[0], posA[1]);\n                ctx.rotate(angleA);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, +7);\n                ctx.lineTo(+5, -3);\n                ctx.fill();\n                ctx.restore();\n                ctx.save();\n                ctx.translate(posC[0], posC[1]);\n                ctx.rotate(angleB);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, +7);\n                ctx.lineTo(+5, -3);\n                ctx.fill();\n                ctx.restore();\n            }\n\n            //circle\n            ctx.beginPath();\n            ctx.arc(pos[0], pos[1], 5, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        //render flowing points\n        if (flow) {\n            ctx.fillStyle = color;\n            for (var i = 0; i < 5; ++i) {\n                var f = (LiteGraph.getTime() * 0.001 + i * 0.2) % 1;\n                var pos = this.computeConnectionPoint(\n                    a,\n                    b,\n                    f,\n                    start_dir,\n                    end_dir\n                );\n                ctx.beginPath();\n                ctx.arc(pos[0], pos[1], 5, 0, 2 * Math.PI);\n                ctx.fill();\n            }\n        }\n    };\n\n    //returns the link center point based on curvature\n    LGraphCanvas.prototype.computeConnectionPoint = function(\n        a,\n        b,\n        t,\n        start_dir,\n        end_dir\n    ) {\n        start_dir = start_dir || LiteGraph.RIGHT;\n        end_dir = end_dir || LiteGraph.LEFT;\n\n        var dist = distance(a, b);\n        var p0 = a;\n        var p1 = [a[0], a[1]];\n        var p2 = [b[0], b[1]];\n        var p3 = b;\n\n        switch (start_dir) {\n            case LiteGraph.LEFT:\n                p1[0] += dist * -0.25;\n                break;\n            case LiteGraph.RIGHT:\n                p1[0] += dist * 0.25;\n                break;\n            case LiteGraph.UP:\n                p1[1] += dist * -0.25;\n                break;\n            case LiteGraph.DOWN:\n                p1[1] += dist * 0.25;\n                break;\n        }\n        switch (end_dir) {\n            case LiteGraph.LEFT:\n                p2[0] += dist * -0.25;\n                break;\n            case LiteGraph.RIGHT:\n                p2[0] += dist * 0.25;\n                break;\n            case LiteGraph.UP:\n                p2[1] += dist * -0.25;\n                break;\n            case LiteGraph.DOWN:\n                p2[1] += dist * 0.25;\n                break;\n        }\n\n        var c1 = (1 - t) * (1 - t) * (1 - t);\n        var c2 = 3 * ((1 - t) * (1 - t)) * t;\n        var c3 = 3 * (1 - t) * (t * t);\n        var c4 = t * t * t;\n\n        var x = c1 * p0[0] + c2 * p1[0] + c3 * p2[0] + c4 * p3[0];\n        var y = c1 * p0[1] + c2 * p1[1] + c3 * p2[1] + c4 * p3[1];\n        return [x, y];\n    };\n\n    LGraphCanvas.prototype.drawExecutionOrder = function(ctx) {\n        ctx.shadowColor = \"transparent\";\n        ctx.globalAlpha = 0.25;\n\n        ctx.textAlign = \"center\";\n        ctx.strokeStyle = \"white\";\n        ctx.globalAlpha = 0.75;\n\n        var visible_nodes = this.visible_nodes;\n        for (var i = 0; i < visible_nodes.length; ++i) {\n            var node = visible_nodes[i];\n            ctx.fillStyle = \"black\";\n            ctx.fillRect(\n                node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT,\n                node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT,\n                LiteGraph.NODE_TITLE_HEIGHT,\n                LiteGraph.NODE_TITLE_HEIGHT\n            );\n            if (node.order == 0) {\n                ctx.strokeRect(\n                    node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                    node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                    LiteGraph.NODE_TITLE_HEIGHT,\n                    LiteGraph.NODE_TITLE_HEIGHT\n                );\n            }\n            ctx.fillStyle = \"#FFF\";\n            ctx.fillText(\n                node.order,\n                node.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * -0.5,\n                node.pos[1] - 6\n            );\n        }\n        ctx.globalAlpha = 1;\n    };\n\n    /**\n     * draws the widgets stored inside a node\n     * @method drawNodeWidgets\n     **/\n    LGraphCanvas.prototype.drawNodeWidgets = function(\n        node,\n        posY,\n        ctx,\n        active_widget\n    ) {\n        if (!node.widgets || !node.widgets.length) {\n            return 0;\n        }\n        var width = node.size[0];\n        var widgets = node.widgets;\n        posY += 2;\n        var H = LiteGraph.NODE_WIDGET_HEIGHT;\n        var show_text = this.ds.scale > 0.5;\n        ctx.save();\n        ctx.globalAlpha = this.editor_alpha;\n        var outline_color = LiteGraph.WIDGET_OUTLINE_COLOR;\n        var background_color = LiteGraph.WIDGET_BGCOLOR;\n        var text_color = LiteGraph.WIDGET_TEXT_COLOR;\n        var secondary_text_color = LiteGraph.WIDGET_SECONDARY_TEXT_COLOR;\n        var margin = 15;\n\n        for (var i = 0; i < widgets.length; ++i) {\n            var w = widgets[i];\n            var y = posY;\n            if (w.y) {\n                y = w.y;\n            }\n            w.last_y = y;\n            ctx.strokeStyle = outline_color;\n            ctx.fillStyle = \"#222\";\n            ctx.textAlign = \"left\";\n            //ctx.lineWidth = 2;\n            if(w.disabled)\n                ctx.globalAlpha *= 0.5;\n            var widget_width = w.width || width;\n\n            switch (w.type) {\n                case \"button\":\n                    ctx.fillStyle = background_color;\n                    if (w.clicked) {\n                        ctx.fillStyle = \"#AAA\";\n                        w.clicked = false;\n                        this.dirty_canvas = true;\n                    }\n                    ctx.fillRect(margin, y, widget_width - margin * 2, H);\n                    if(show_text && !w.disabled)\n                        ctx.strokeRect( margin, y, widget_width - margin * 2, H );\n                    if (show_text) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = text_color;\n                        ctx.fillText(w.label || w.name, widget_width * 0.5, y + H * 0.7);\n                    }\n                    break;\n                case \"toggle\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n                    if (show_text)\n                        ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5]);\n                    else\n                        ctx.rect(margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n                    if(show_text && !w.disabled)\n                        ctx.stroke();\n                    ctx.fillStyle = w.value ? \"#89A\" : \"#333\";\n                    ctx.beginPath();\n                    ctx.arc( widget_width - margin * 2, y + H * 0.5, H * 0.36, 0, Math.PI * 2 );\n                    ctx.fill();\n                    if (show_text) {\n                        ctx.fillStyle = secondary_text_color;\n                        const label = w.label || w.name;\n                        if (label != null) {\n                            ctx.fillText(label, margin * 2, y + H * 0.7);\n                        }\n                        ctx.fillStyle = w.value ? text_color : secondary_text_color;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(\n                            w.value\n                                ? w.options.on || \"true\"\n                                : w.options.off || \"false\",\n                            widget_width - 40,\n                            y + H * 0.7\n                        );\n                    }\n                    break;\n                case \"slider\":\n                    ctx.fillStyle = background_color;\n                    ctx.fillRect(margin, y, widget_width - margin * 2, H);\n                    var range = w.options.max - w.options.min;\n                    var nvalue = (w.value - w.options.min) / range;\n                    if(nvalue < 0.0) nvalue = 0.0;\n                    if(nvalue > 1.0) nvalue = 1.0;\n                    ctx.fillStyle = w.options.hasOwnProperty(\"slider_color\") ? w.options.slider_color : (active_widget == w ? \"#89A\" : \"#678\");\n                    ctx.fillRect(margin, y, nvalue * (widget_width - margin * 2), H);\n                    if(show_text && !w.disabled)\n                        ctx.strokeRect(margin, y, widget_width - margin * 2, H);\n                    if (w.marker) {\n                        var marker_nvalue = (w.marker - w.options.min) / range;\n                        if(marker_nvalue < 0.0) marker_nvalue = 0.0;\n                        if(marker_nvalue > 1.0) marker_nvalue = 1.0;\n                        ctx.fillStyle = w.options.hasOwnProperty(\"marker_color\") ? w.options.marker_color : \"#AA9\";\n                        ctx.fillRect( margin + marker_nvalue * (widget_width - margin * 2), y, 2, H );\n                    }\n                    if (show_text) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = text_color;\n                        ctx.fillText(\n                            w.label || w.name + \"  \" + Number(w.value).toFixed(\n                                w.options.precision != null\n                                    ? w.options.precision\n                                    : 3\n                            ),\n                            widget_width * 0.5,\n                            y + H * 0.7\n                        );\n                    }\n                    break;\n                case \"number\":\n                case \"combo\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n                    if(show_text)\n                        ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5] );\n                    else\n                        ctx.rect(margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n                    if (show_text) {\n                        if(!w.disabled)\n                            ctx.stroke();\n                        ctx.fillStyle = text_color;\n                        if(!w.disabled)\n                        {\n                            ctx.beginPath();\n                            ctx.moveTo(margin + 16, y + 5);\n                            ctx.lineTo(margin + 6, y + H * 0.5);\n                            ctx.lineTo(margin + 16, y + H - 5);\n                            ctx.fill();\n                            ctx.beginPath();\n                            ctx.moveTo(widget_width - margin - 16, y + 5);\n                            ctx.lineTo(widget_width - margin - 6, y + H * 0.5);\n                            ctx.lineTo(widget_width - margin - 16, y + H - 5);\n                            ctx.fill();\n                        }\n                        ctx.fillStyle = secondary_text_color;\n                        ctx.fillText(w.label || w.name, margin * 2 + 5, y + H * 0.7);\n                        ctx.fillStyle = text_color;\n                        ctx.textAlign = \"right\";\n                        if (w.type == \"number\") {\n                            ctx.fillText(\n                                Number(w.value).toFixed(\n                                    w.options.precision !== undefined\n                                        ? w.options.precision\n                                        : 3\n                                ),\n                                widget_width - margin * 2 - 20,\n                                y + H * 0.7\n                            );\n                        } else {\n                            var v = w.value;\n                            if( w.options.values )\n                            {\n                                var values = w.options.values;\n                                if( values.constructor === Function )\n                                    values = values();\n                                if(values && values.constructor !== Array)\n                                    v = values[ w.value ];\n                            }\n                            ctx.fillText(\n                                v,\n                                widget_width - margin * 2 - 20,\n                                y + H * 0.7\n                            );\n                        }\n                    }\n                    break;\n                case \"string\":\n                case \"text\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n                    if (show_text)\n                        ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5]);\n                    else\n                        ctx.rect( margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n                    if (show_text) {\n                        if(!w.disabled)\n                            ctx.stroke();\n                        ctx.save();\n                        ctx.beginPath();\n                        ctx.rect(margin, y, widget_width - margin * 2, H);\n                        ctx.clip();\n\n                        //ctx.stroke();\n                        ctx.fillStyle = secondary_text_color;\n                        const label = w.label || w.name;\n                        if (label != null) {\n                            ctx.fillText(label, margin * 2, y + H * 0.7);\n                        }\n                        ctx.fillStyle = text_color;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(String(w.value).substr(0,30), widget_width - margin * 2, y + H * 0.7); //30 chars max\n                        ctx.restore();\n                    }\n                    break;\n                default:\n                    if (w.draw) {\n                        w.draw(ctx, node, widget_width, y, H);\n                    }\n                    break;\n            }\n            posY += (w.computeSize ? w.computeSize(widget_width)[1] : H) + 4;\n            ctx.globalAlpha = this.editor_alpha;\n\n        }\n        ctx.restore();\n        ctx.textAlign = \"left\";\n    };\n\n    /**\n     * process an event on widgets\n     * @method processNodeWidgets\n     **/\n    LGraphCanvas.prototype.processNodeWidgets = function(\n        node,\n        pos,\n        event,\n        active_widget\n    ) {\n        if (!node.widgets || !node.widgets.length || (!this.allow_interaction && !node.flags.allow_interaction)) {\n            return null;\n        }\n\n        var x = pos[0] - node.pos[0];\n        var y = pos[1] - node.pos[1];\n        var width = node.size[0];\n        var that = this;\n        var ref_window = this.getCanvasWindow();\n\n        for (var i = 0; i < node.widgets.length; ++i) {\n            var w = node.widgets[i];\n            if(!w || w.disabled)\n                continue;\n            var widget_height = w.computeSize ? w.computeSize(width)[1] : LiteGraph.NODE_WIDGET_HEIGHT;\n            var widget_width = w.width || width;\n            //outside\n            if ( w != active_widget &&\n                (x < 6 || x > widget_width - 12 || y < w.last_y || y > w.last_y + widget_height || w.last_y === undefined) )\n                continue;\n\n            var old_value = w.value;\n\n            //if ( w == active_widget || (x > 6 && x < widget_width - 12 && y > w.last_y && y < w.last_y + widget_height) ) {\n            //inside widget\n            switch (w.type) {\n                case \"button\":\n                    if (event.type === LiteGraph.pointerevents_method+\"down\") {\n                        if (w.callback) {\n                            setTimeout(function() {\n                                w.callback(w, that, node, pos, event);\n                            }, 20);\n                        }\n                        w.clicked = true;\n                        this.dirty_canvas = true;\n                    }\n                    break;\n                case \"slider\":\n                    var old_value = w.value;\n                    var nvalue = clamp((x - 15) / (widget_width - 30), 0, 1);\n                    if(w.options.read_only) break;\n                    w.value = w.options.min + (w.options.max - w.options.min) * nvalue;\n                    if (old_value != w.value) {\n                        setTimeout(function() {\n                            inner_value_change(w, w.value);\n                        }, 20);\n                    }\n                    this.dirty_canvas = true;\n                    break;\n                case \"number\":\n                case \"combo\":\n                    var old_value = w.value;\n                    var delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n                    var allow_scroll = true;\n                    if (delta) {\n                        if (x > -3 && x < widget_width + 3) {\n                            allow_scroll = false;\n                        }\n                    }\n                    if (allow_scroll && event.type == LiteGraph.pointerevents_method+\"move\" && w.type == \"number\") {\n                        if(event.deltaX)\n                            w.value += event.deltaX * 0.1 * (w.options.step || 1);\n                        if ( w.options.min != null && w.value < w.options.min ) {\n                            w.value = w.options.min;\n                        }\n                        if ( w.options.max != null && w.value > w.options.max ) {\n                            w.value = w.options.max;\n                        }\n                    } else if (event.type == LiteGraph.pointerevents_method+\"down\") {\n                        var values = w.options.values;\n                        if (values && values.constructor === Function) {\n                            values = w.options.values(w, node);\n                        }\n                        var values_list = null;\n\n                        if( w.type != \"number\")\n                            values_list = values.constructor === Array ? values : Object.keys(values);\n\n                        var delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n                        if (w.type == \"number\") {\n                            w.value += delta * 0.1 * (w.options.step || 1);\n                            if ( w.options.min != null && w.value < w.options.min ) {\n                                w.value = w.options.min;\n                            }\n                            if ( w.options.max != null && w.value > w.options.max ) {\n                                w.value = w.options.max;\n                            }\n                        } else if (delta) { //clicked in arrow, used for combos\n                            var index = -1;\n                            this.last_mouseclick = 0; //avoids dobl click event\n                            if(values.constructor === Object)\n                                index = values_list.indexOf( String( w.value ) ) + delta;\n                            else\n                                index = values_list.indexOf( w.value ) + delta;\n                            if (index >= values_list.length) {\n                                index = values_list.length - 1;\n                            }\n                            if (index < 0) {\n                                index = 0;\n                            }\n                            if( values.constructor === Array )\n                                w.value = values[index];\n                            else\n                                w.value = index;\n                        } else { //combo clicked\n                            var text_values = values != values_list ? Object.values(values) : values;\n                            var menu = new LiteGraph.ContextMenu(text_values, {\n                                    scale: Math.max(1, this.ds.scale),\n                                    event: event,\n                                    className: \"dark\",\n                                    callback: inner_clicked.bind(w)\n                                },\n                                ref_window);\n                            function inner_clicked(v, option, event) {\n                                if(values != values_list)\n                                    v = text_values.indexOf(v);\n                                this.value = v;\n                                inner_value_change(this, v);\n                                that.dirty_canvas = true;\n                                return false;\n                            }\n                        }\n                    } //end mousedown\n                    else if(event.type == LiteGraph.pointerevents_method+\"up\" && w.type == \"number\")\n                    {\n                        var delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n                        if (event.click_time < 200 && delta == 0) {\n                            this.prompt(\"Value\",w.value,function(v) {\n                                    // check if v is a valid equation or a number\n                                    if (/^[0-9+\\-*/()\\s]+|\\d+\\.\\d+$/.test(v)) {\n                                        try {//solve the equation if possible\n                                            v = eval(v);\n                                        } catch (e) { }\n                                    }\n                                    this.value = Number(v);\n                                    inner_value_change(this, this.value);\n                                }.bind(w),\n                                event);\n                        }\n                    }\n\n                    if( old_value != w.value )\n                        setTimeout(\n                            function() {\n                                inner_value_change(this, this.value);\n                            }.bind(w),\n                            20\n                        );\n                    this.dirty_canvas = true;\n                    break;\n                case \"toggle\":\n                    if (event.type == LiteGraph.pointerevents_method+\"down\") {\n                        w.value = !w.value;\n                        setTimeout(function() {\n                            inner_value_change(w, w.value);\n                        }, 20);\n                    }\n                    break;\n                case \"string\":\n                case \"text\":\n                    if (event.type == LiteGraph.pointerevents_method+\"down\") {\n                        this.prompt(\"Value\",w.value,function(v) {\n                                inner_value_change(this, v);\n                            }.bind(w),\n                            event,w.options ? w.options.multiline : false );\n                    }\n                    break;\n                default:\n                    if (w.mouse) {\n                        this.dirty_canvas = w.mouse(event, [x, y], node);\n                    }\n                    break;\n            } //end switch\n\n            //value changed\n            if( old_value != w.value )\n            {\n                if(node.onWidgetChanged)\n                    node.onWidgetChanged( w.name,w.value,old_value,w );\n                node.graph._version++;\n            }\n\n            return w;\n        }//end for\n\n        function inner_value_change(widget, value) {\n            if(widget.type == \"number\"){\n                value = Number(value);\n            }\n            widget.value = value;\n            if ( widget.options && widget.options.property && node.properties[widget.options.property] !== undefined ) {\n                node.setProperty( widget.options.property, value );\n            }\n            if (widget.callback) {\n                widget.callback(widget.value, that, node, pos, event);\n            }\n        }\n\n        return null;\n    };\n\n    /**\n     * draws every group area in the background\n     * @method drawGroups\n     **/\n    LGraphCanvas.prototype.drawGroups = function(canvas, ctx) {\n        if (!this.graph) {\n            return;\n        }\n\n        var groups = this.graph._groups;\n\n        ctx.save();\n        ctx.globalAlpha = 0.5 * this.editor_alpha;\n\n        for (var i = 0; i < groups.length; ++i) {\n            var group = groups[i];\n\n            if (!overlapBounding(this.visible_area, group._bounding)) {\n                continue;\n            } //out of the visible area\n\n            ctx.fillStyle = group.color || \"#335\";\n            ctx.strokeStyle = group.color || \"#335\";\n            var pos = group._pos;\n            var size = group._size;\n            ctx.globalAlpha = 0.25 * this.editor_alpha;\n            ctx.beginPath();\n            ctx.rect(pos[0] + 0.5, pos[1] + 0.5, size[0], size[1]);\n            ctx.fill();\n            ctx.globalAlpha = this.editor_alpha;\n            ctx.stroke();\n\n            ctx.beginPath();\n            ctx.moveTo(pos[0] + size[0], pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0] - 10, pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0], pos[1] + size[1] - 10);\n            ctx.fill();\n\n            var font_size =\n                group.font_size || LiteGraph.DEFAULT_GROUP_FONT_SIZE;\n            ctx.font = font_size + \"px Arial\";\n            ctx.textAlign = \"left\";\n            ctx.fillText(group.title, pos[0] + 4, pos[1] + font_size);\n        }\n\n        ctx.restore();\n    };\n\n    LGraphCanvas.prototype.adjustNodesSize = function() {\n        var nodes = this.graph._nodes;\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].size = nodes[i].computeSize();\n        }\n        this.setDirty(true, true);\n    };\n\n    /**\n     * resizes the canvas to a given size, if no size is passed, then it tries to fill the parentNode\n     * @method resize\n     **/\n    LGraphCanvas.prototype.resize = function(width, height) {\n        if (!width && !height) {\n            var parent = this.canvas.parentNode;\n            width = parent.offsetWidth;\n            height = parent.offsetHeight;\n        }\n\n        if (this.canvas.width == width && this.canvas.height == height) {\n            return;\n        }\n\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.bgcanvas.width = this.canvas.width;\n        this.bgcanvas.height = this.canvas.height;\n        this.setDirty(true, true);\n    };\n\n    /**\n     * switches to live mode (node shapes are not rendered, only the content)\n     * this feature was designed when graphs where meant to create user interfaces\n     * @method switchLiveMode\n     **/\n    LGraphCanvas.prototype.switchLiveMode = function(transition) {\n        if (!transition) {\n            this.live_mode = !this.live_mode;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n            return;\n        }\n\n        var self = this;\n        var delta = this.live_mode ? 1.1 : 0.9;\n        if (this.live_mode) {\n            this.live_mode = false;\n            this.editor_alpha = 0.1;\n        }\n\n        var t = setInterval(function() {\n            self.editor_alpha *= delta;\n            self.dirty_canvas = true;\n            self.dirty_bgcanvas = true;\n\n            if (delta < 1 && self.editor_alpha < 0.01) {\n                clearInterval(t);\n                if (delta < 1) {\n                    self.live_mode = true;\n                }\n            }\n            if (delta > 1 && self.editor_alpha > 0.99) {\n                clearInterval(t);\n                self.editor_alpha = 1;\n            }\n        }, 1);\n    };\n\n    LGraphCanvas.prototype.onNodeSelectionChange = function(node) {\n        return; //disabled\n    };\n\n    /* this is an implementation for touch not in production and not ready\n     */\n    /*LGraphCanvas.prototype.touchHandler = function(event) {\n        //alert(\"foo\");\n        var touches = event.changedTouches,\n            first = touches[0],\n            type = \"\";\n\n        switch (event.type) {\n            case \"touchstart\":\n                type = \"mousedown\";\n                break;\n            case \"touchmove\":\n                type = \"mousemove\";\n                break;\n            case \"touchend\":\n                type = \"mouseup\";\n                break;\n            default:\n                return;\n        }\n\n        //initMouseEvent(type, canBubble, cancelable, view, clickCount,\n        //           screenX, screenY, clientX, clientY, ctrlKey,\n        //           altKey, shiftKey, metaKey, button, relatedTarget);\n\n        // this is eventually a Dom object, get the LGraphCanvas back\n        if(typeof this.getCanvasWindow == \"undefined\"){\n            var window = this.lgraphcanvas.getCanvasWindow();\n        }else{\n            var window = this.getCanvasWindow();\n        }\n\n        var document = window.document;\n\n        var simulatedEvent = document.createEvent(\"MouseEvent\");\n        simulatedEvent.initMouseEvent(\n            type,\n            true,\n            true,\n            window,\n            1,\n            first.screenX,\n            first.screenY,\n            first.clientX,\n            first.clientY,\n            false,\n            false,\n            false,\n            false,\n            0, //left\n            null\n        );\n        first.target.dispatchEvent(simulatedEvent);\n        event.preventDefault();\n    };*/\n\n    /* CONTEXT MENU ********************/\n\n    LGraphCanvas.onGroupAdd = function(info, entry, mouse_event) {\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var group = new LiteGraph.LGraphGroup();\n        group.pos = canvas.convertEventToCanvasOffset(mouse_event);\n        canvas.graph.add(group);\n    };\n\n    /**\n     * Determines the furthest nodes in each direction\n     * @param nodes {LGraphNode[]} the nodes to from which boundary nodes will be extracted\n     * @return {{left: LGraphNode, top: LGraphNode, right: LGraphNode, bottom: LGraphNode}}\n     */\n    LGraphCanvas.getBoundaryNodes = function(nodes) {\n        let top = null;\n        let right = null;\n        let bottom = null;\n        let left = null;\n        for (const nID in nodes) {\n            const node = nodes[nID];\n            const [x, y] = node.pos;\n            const [width, height] = node.size;\n\n            if (top === null || y < top.pos[1]) {\n                top = node;\n            }\n            if (right === null || x + width > right.pos[0] + right.size[0]) {\n                right = node;\n            }\n            if (bottom === null || y + height > bottom.pos[1] + bottom.size[1]) {\n                bottom = node;\n            }\n            if (left === null || x < left.pos[0]) {\n                left = node;\n            }\n        }\n\n        return {\n            \"top\": top,\n            \"right\": right,\n            \"bottom\": bottom,\n            \"left\": left\n        };\n    }\n    /**\n     * Determines the furthest nodes in each direction for the currently selected nodes\n     * @return {{left: LGraphNode, top: LGraphNode, right: LGraphNode, bottom: LGraphNode}}\n     */\n    LGraphCanvas.prototype.boundaryNodesForSelection = function() {\n        return LGraphCanvas.getBoundaryNodes(Object.values(this.selected_nodes));\n    }\n\n    /**\n     *\n     * @param {LGraphNode[]} nodes a list of nodes\n     * @param {\"top\"|\"bottom\"|\"left\"|\"right\"} direction Direction to align the nodes\n     * @param {LGraphNode?} align_to Node to align to (if null, align to the furthest node in the given direction)\n     */\n    LGraphCanvas.alignNodes = function (nodes, direction, align_to) {\n        if (!nodes) {\n            return;\n        }\n\n        const canvas = LGraphCanvas.active_canvas;\n        let boundaryNodes = []\n        if (align_to === undefined) {\n            boundaryNodes = LGraphCanvas.getBoundaryNodes(nodes)\n        } else {\n            boundaryNodes = {\n                \"top\": align_to,\n                \"right\": align_to,\n                \"bottom\": align_to,\n                \"left\": align_to\n            }\n        }\n\n        for (const [_, node] of Object.entries(canvas.selected_nodes)) {\n            switch (direction) {\n                case \"right\":\n                    node.pos[0] = boundaryNodes[\"right\"].pos[0] + boundaryNodes[\"right\"].size[0] - node.size[0];\n                    break;\n                case \"left\":\n                    node.pos[0] = boundaryNodes[\"left\"].pos[0];\n                    break;\n                case \"top\":\n                    node.pos[1] = boundaryNodes[\"top\"].pos[1];\n                    break;\n                case \"bottom\":\n                    node.pos[1] = boundaryNodes[\"bottom\"].pos[1] + boundaryNodes[\"bottom\"].size[1] - node.size[1];\n                    break;\n            }\n        }\n\n        canvas.dirty_canvas = true;\n        canvas.dirty_bgcanvas = true;\n    };\n\n    LGraphCanvas.onNodeAlign = function(value, options, event, prev_menu, node) {\n        new LiteGraph.ContextMenu([\"Top\", \"Bottom\", \"Left\", \"Right\"], {\n            event: event,\n            callback: inner_clicked,\n            parentMenu: prev_menu,\n        });\n\n        function inner_clicked(value) {\n            LGraphCanvas.alignNodes(LGraphCanvas.active_canvas.selected_nodes, value.toLowerCase(), node);\n        }\n    }\n\n    LGraphCanvas.onGroupAlign = function(value, options, event, prev_menu) {\n        new LiteGraph.ContextMenu([\"Top\", \"Bottom\", \"Left\", \"Right\"], {\n            event: event,\n            callback: inner_clicked,\n            parentMenu: prev_menu,\n        });\n\n        function inner_clicked(value) {\n            LGraphCanvas.alignNodes(LGraphCanvas.active_canvas.selected_nodes, value.toLowerCase());\n        }\n    }\n\n    LGraphCanvas.onMenuAdd = function (node, options, e, prev_menu, callback) {\n\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n        var graph = canvas.graph;\n        if (!graph)\n            return;\n\n        function inner_onMenuAdded(base_category ,prev_menu){\n\n            var categories  = LiteGraph.getNodeTypesCategories(canvas.filter || graph.filter).filter(function(category){return category.startsWith(base_category)});\n            var entries = [];\n\n            categories.map(function(category){\n\n                if (!category)\n                    return;\n\n                var base_category_regex = new RegExp('^(' + base_category + ')');\n                var category_name = category.replace(base_category_regex,\"\").split('/')[0];\n                var category_path = base_category  === '' ? category_name + '/' : base_category + category_name + '/';\n\n                var name = category_name;\n                if(name.indexOf(\"::\") != -1) //in case it has a namespace like \"shader::math/rand\" it hides the namespace\n                    name = name.split(\"::\")[1];\n\n                var index = entries.findIndex(function(entry){return entry.value === category_path});\n                if (index === -1) {\n                    entries.push({ value: category_path, content: name, has_submenu: true, callback : function(value, event, mouseEvent, contextMenu){\n                            inner_onMenuAdded(value.value, contextMenu)\n                        }});\n                }\n\n            });\n\n            var nodes = LiteGraph.getNodeTypesInCategory(base_category.slice(0, -1), canvas.filter || graph.filter );\n            nodes.map(function(node){\n\n                if (node.skip_list)\n                    return;\n\n                var entry = { value: node.type, content: node.title, has_submenu: false , callback : function(value, event, mouseEvent, contextMenu){\n\n                        var first_event = contextMenu.getFirstEvent();\n                        canvas.graph.beforeChange();\n                        var node = LiteGraph.createNode(value.value);\n                        if (node) {\n                            node.pos = canvas.convertEventToCanvasOffset(first_event);\n                            canvas.graph.add(node);\n                        }\n                        if(callback)\n                            callback(node);\n                        canvas.graph.afterChange();\n\n                    }\n                }\n\n                entries.push(entry);\n\n            });\n\n            new LiteGraph.ContextMenu( entries, { event: e, parentMenu: prev_menu }, ref_window );\n\n        }\n\n        inner_onMenuAdded('',prev_menu);\n        return false;\n\n    };\n\n    LGraphCanvas.onMenuCollapseAll = function() {};\n\n    LGraphCanvas.onMenuNodeEdit = function() {};\n\n    LGraphCanvas.showMenuNodeOptionalInputs = function(\n        v,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var options = node.optional_inputs;\n        if (node.onGetInputs) {\n            options = node.onGetInputs();\n        }\n\n        var entries = [];\n        if (options) {\n            for (var i=0; i < options.length; i++) {\n                var entry = options[i];\n                if (!entry) {\n                    entries.push(null);\n                    continue;\n                }\n                var label = entry[0];\n                if(!entry[2])\n                    entry[2] = {};\n\n                if (entry[2].label) {\n                    label = entry[2].label;\n                }\n\n                entry[2].removable = true;\n                var data = { content: label, value: entry };\n                if (entry[1] == LiteGraph.ACTION) {\n                    data.className = \"event\";\n                }\n                entries.push(data);\n            }\n        }\n\n        if (node.onMenuNodeInputs) {\n            var retEntries = node.onMenuNodeInputs(entries);\n            if(retEntries) entries = retEntries;\n        }\n\n        if (!entries.length) {\n            console.log(\"no input entries\");\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, e, prev) {\n            if (!node) {\n                return;\n            }\n\n            if (v.callback) {\n                v.callback.call(that, node, v, e, prev);\n            }\n\n            if (v.value) {\n                node.graph.beforeChange();\n                node.addInput(v.value[0], v.value[1], v.value[2]);\n\n                if (node.onNodeInputAdd) { // callback to the node when adding a slot\n                    node.onNodeInputAdd(v.value);\n                }\n                node.setDirtyCanvas(true, true);\n                node.graph.afterChange();\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.showMenuNodeOptionalOutputs = function(\n        v,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var options = node.optional_outputs;\n        if (node.onGetOutputs) {\n            options = node.onGetOutputs();\n        }\n\n        var entries = [];\n        if (options) {\n            for (var i=0; i < options.length; i++) {\n                var entry = options[i];\n                if (!entry) {\n                    //separator?\n                    entries.push(null);\n                    continue;\n                }\n\n                if (\n                    node.flags &&\n                    node.flags.skip_repeated_outputs &&\n                    node.findOutputSlot(entry[0]) != -1\n                ) {\n                    continue;\n                } //skip the ones already on\n                var label = entry[0];\n                if(!entry[2])\n                    entry[2] = {};\n                if (entry[2].label) {\n                    label = entry[2].label;\n                }\n                entry[2].removable = true;\n                var data = { content: label, value: entry };\n                if (entry[1] == LiteGraph.EVENT) {\n                    data.className = \"event\";\n                }\n                entries.push(data);\n            }\n        }\n\n        if (this.onMenuNodeOutputs) {\n            entries = this.onMenuNodeOutputs(entries);\n        }\n        if (LiteGraph.do_add_triggers_slots){ //canvas.allow_addOutSlot_onExecuted\n            if (node.findOutputSlot(\"onExecuted\") == -1){\n                entries.push({content: \"On Executed\", value: [\"onExecuted\", LiteGraph.EVENT, {nameLocked: true}], className: \"event\"}); //, opts: {}\n            }\n        }\n        // add callback for modifing the menu elements onMenuNodeOutputs\n        if (node.onMenuNodeOutputs) {\n            var retEntries = node.onMenuNodeOutputs(entries);\n            if(retEntries) entries = retEntries;\n        }\n\n        if (!entries.length) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, e, prev) {\n            if (!node) {\n                return;\n            }\n\n            if (v.callback) {\n                v.callback.call(that, node, v, e, prev);\n            }\n\n            if (!v.value) {\n                return;\n            }\n\n            var value = v.value[1];\n\n            if (\n                value &&\n                (value.constructor === Object || value.constructor === Array)\n            ) {\n                //submenu why?\n                var entries = [];\n                for (var i in value) {\n                    entries.push({ content: i, value: value[i] });\n                }\n                new LiteGraph.ContextMenu(entries, {\n                    event: e,\n                    callback: inner_clicked,\n                    parentMenu: prev_menu,\n                    node: node\n                });\n                return false;\n            } else {\n                node.graph.beforeChange();\n                node.addOutput(v.value[0], v.value[1], v.value[2]);\n\n                if (node.onNodeOutputAdd) { // a callback to the node when adding a slot\n                    node.onNodeOutputAdd(v.value);\n                }\n                node.setDirtyCanvas(true, true);\n                node.graph.afterChange();\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onShowMenuNodeProperties = function(\n        value,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node || !node.properties) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var entries = [];\n        for (var i in node.properties) {\n            var value = node.properties[i] !== undefined ? node.properties[i] : \" \";\n            if( typeof value == \"object\" )\n                value = JSON.stringify(value);\n            var info = node.getPropertyInfo(i);\n            if(info.type == \"enum\" || info.type == \"combo\")\n                value = LGraphCanvas.getPropertyPrintableValue( value, info.values );\n\n            //value could contain invalid html characters, clean that\n            value = LGraphCanvas.decodeHTML(value);\n            entries.push({\n                content:\n                    \"<span class='property_name'>\" +\n                    (info.label ? info.label : i) +\n                    \"</span>\" +\n                    \"<span class='property_value'>\" +\n                    value +\n                    \"</span>\",\n                value: i\n            });\n        }\n        if (!entries.length) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                allow_html: true,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, options, e, prev) {\n            if (!node) {\n                return;\n            }\n            var rect = this.getBoundingClientRect();\n            canvas.showEditPropertyValue(node, v.value, {\n                position: [rect.left, rect.top]\n            });\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.decodeHTML = function(str) {\n        var e = document.createElement(\"div\");\n        e.innerText = str;\n        return e.innerHTML;\n    };\n\n    LGraphCanvas.onMenuResizeNode = function(value, options, e, menu, node) {\n        if (!node) {\n            return;\n        }\n\n        var fApplyMultiNode = function(node){\n            node.size = node.computeSize();\n            if (node.onResize)\n                node.onResize(node.size);\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n            fApplyMultiNode(node);\n        }else{\n            for (var i in graphcanvas.selected_nodes) {\n                fApplyMultiNode(graphcanvas.selected_nodes[i]);\n            }\n        }\n\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.prototype.showLinkMenu = function(link, e) {\n        var that = this;\n        // console.log(link);\n        var node_left = that.graph.getNodeById( link.origin_id );\n        var node_right = that.graph.getNodeById( link.target_id );\n        var fromType = false;\n        if (node_left && node_left.outputs && node_left.outputs[link.origin_slot]) fromType = node_left.outputs[link.origin_slot].type;\n        var destType = false;\n        if (node_right && node_right.outputs && node_right.outputs[link.target_slot]) destType = node_right.inputs[link.target_slot].type;\n\n        var options = [\"Add Node\",null,\"Delete\",null];\n\n\n        var menu = new LiteGraph.ContextMenu(options, {\n            event: e,\n            title: link.data != null ? link.data.constructor.name : null,\n            callback: inner_clicked\n        });\n\n        function inner_clicked(v,options,e) {\n            switch (v) {\n                case \"Add Node\":\n                    LGraphCanvas.onMenuAdd(null, null, e, menu, function(node){\n                        // console.debug(\"node autoconnect\");\n                        if(!node.inputs || !node.inputs.length || !node.outputs || !node.outputs.length){\n                            return;\n                        }\n                        // leave the connection type checking inside connectByType\n                        if (node_left.connectByType( link.origin_slot, node, fromType )){\n                            node.connectByType( link.target_slot, node_right, destType );\n                            node.pos[0] -= node.size[0] * 0.5;\n                        }\n                    });\n                    break;\n\n                case \"Delete\":\n                    that.graph.removeLink(link.id);\n                    break;\n                default:\n                /*var nodeCreated = createDefaultNodeForSlot({   nodeFrom: node_left\n                                                                ,slotFrom: link.origin_slot\n                                                                ,nodeTo: node\n                                                                ,slotTo: link.target_slot\n                                                                ,e: e\n                                                                ,nodeType: \"AUTO\"\n                                                            });\n                if(nodeCreated) console.log(\"new node in beetween \"+v+\" created\");*/\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.prototype.createDefaultNodeForSlot = function(optPass) { // addNodeMenu for connection\n        var optPass = optPass || {};\n        var opts = Object.assign({   nodeFrom: null // input\n                ,slotFrom: null // input\n                ,nodeTo: null   // output\n                ,slotTo: null   // output\n                ,position: []\t// pass the event coords\n                ,nodeType: null\t// choose a nodetype to add, AUTO to set at first good\n                ,posAdd:[0,0]\t// adjust x,y\n                ,posSizeFix:[0,0] // alpha, adjust the position x,y based on the new node size w,h\n            }\n            ,optPass\n        );\n        var that = this;\n\n        var isFrom = opts.nodeFrom && opts.slotFrom!==null;\n        var isTo = !isFrom && opts.nodeTo && opts.slotTo!==null;\n\n        if (!isFrom && !isTo){\n            console.warn(\"No data passed to createDefaultNodeForSlot \"+opts.nodeFrom+\" \"+opts.slotFrom+\" \"+opts.nodeTo+\" \"+opts.slotTo);\n            return false;\n        }\n        if (!opts.nodeType){\n            console.warn(\"No type to createDefaultNodeForSlot\");\n            return false;\n        }\n\n        var nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n        var slotX = isFrom ? opts.slotFrom : opts.slotTo;\n\n        var iSlotConn = false;\n        switch (typeof slotX){\n            case \"string\":\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX,false) : nodeX.findInputSlot(slotX,false);\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n                break;\n            case \"object\":\n                // ok slotX\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n                break;\n            case \"number\":\n                iSlotConn = slotX;\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n                break;\n            case \"undefined\":\n            default:\n                // bad ?\n                //iSlotConn = 0;\n                console.warn(\"Cant get slot information \"+slotX);\n                return false;\n        }\n\n        if (slotX===false || iSlotConn===false){\n            console.warn(\"createDefaultNodeForSlot bad slotX \"+slotX+\" \"+iSlotConn);\n        }\n\n        // check for defaults nodes for this slottype\n        var fromSlotType = slotX.type==LiteGraph.EVENT?\"_event_\":slotX.type;\n        var slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n        if(slotTypesDefault && slotTypesDefault[fromSlotType]){\n            if (slotX.link !== null) {\n                // is connected\n            }else{\n                // is not not connected\n            }\n            nodeNewType = false;\n            if(typeof slotTypesDefault[fromSlotType] == \"object\" || typeof slotTypesDefault[fromSlotType] == \"array\"){\n                for(var typeX in slotTypesDefault[fromSlotType]){\n                    if (opts.nodeType == slotTypesDefault[fromSlotType][typeX] || opts.nodeType == \"AUTO\"){\n                        nodeNewType = slotTypesDefault[fromSlotType][typeX];\n                        // console.log(\"opts.nodeType == slotTypesDefault[fromSlotType][typeX] :: \"+opts.nodeType);\n                        break; // --------\n                    }\n                }\n            }else{\n                if (opts.nodeType == slotTypesDefault[fromSlotType] || opts.nodeType == \"AUTO\") nodeNewType = slotTypesDefault[fromSlotType];\n            }\n            if (nodeNewType) {\n                var nodeNewOpts = false;\n                if (typeof nodeNewType == \"object\" && nodeNewType.node){\n                    nodeNewOpts = nodeNewType;\n                    nodeNewType = nodeNewType.node;\n                }\n\n                //that.graph.beforeChange();\n\n                var newNode = LiteGraph.createNode(nodeNewType);\n                if(newNode){\n                    // if is object pass options\n                    if (nodeNewOpts){\n                        if (nodeNewOpts.properties) {\n                            for (var i in nodeNewOpts.properties) {\n                                newNode.addProperty( i, nodeNewOpts.properties[i] );\n                            }\n                        }\n                        if (nodeNewOpts.inputs) {\n                            newNode.inputs = [];\n                            for (var i in nodeNewOpts.inputs) {\n                                newNode.addOutput(\n                                    nodeNewOpts.inputs[i][0],\n                                    nodeNewOpts.inputs[i][1]\n                                );\n                            }\n                        }\n                        if (nodeNewOpts.outputs) {\n                            newNode.outputs = [];\n                            for (var i in nodeNewOpts.outputs) {\n                                newNode.addOutput(\n                                    nodeNewOpts.outputs[i][0],\n                                    nodeNewOpts.outputs[i][1]\n                                );\n                            }\n                        }\n                        if (nodeNewOpts.title) {\n                            newNode.title = nodeNewOpts.title;\n                        }\n                        if (nodeNewOpts.json) {\n                            newNode.configure(nodeNewOpts.json);\n                        }\n\n                    }\n\n                    // add the node\n                    that.graph.add(newNode);\n                    newNode.pos = [\topts.position[0]+opts.posAdd[0]+(opts.posSizeFix[0]?opts.posSizeFix[0]*newNode.size[0]:0)\n                        ,opts.position[1]+opts.posAdd[1]+(opts.posSizeFix[1]?opts.posSizeFix[1]*newNode.size[1]:0)]; //that.last_click_position; //[e.canvasX+30, e.canvasX+5];*/\n\n                    //that.graph.afterChange();\n\n                    // connect the two!\n                    if (isFrom){\n                        opts.nodeFrom.connectByType( iSlotConn, newNode, fromSlotType );\n                    }else{\n                        opts.nodeTo.connectByTypeOutput( iSlotConn, newNode, fromSlotType );\n                    }\n\n                    // if connecting in between\n                    if (isFrom && isTo){\n                        // TODO\n                    }\n\n                    return true;\n\n                }else{\n                    console.log(\"failed creating \"+nodeNewType);\n                }\n            }\n        }\n        return false;\n    }\n\n    LGraphCanvas.prototype.showConnectionMenu = function(optPass) { // addNodeMenu for connection\n        var optPass = optPass || {};\n        var opts = Object.assign({   nodeFrom: null  // input\n                ,slotFrom: null // input\n                ,nodeTo: null   // output\n                ,slotTo: null   // output\n                ,e: null\n            }\n            ,optPass\n        );\n        var that = this;\n\n        var isFrom = opts.nodeFrom && opts.slotFrom;\n        var isTo = !isFrom && opts.nodeTo && opts.slotTo;\n\n        if (!isFrom && !isTo){\n            console.warn(\"No data passed to showConnectionMenu\");\n            return false;\n        }\n\n        var nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n        var slotX = isFrom ? opts.slotFrom : opts.slotTo;\n\n        var iSlotConn = false;\n        switch (typeof slotX){\n            case \"string\":\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX,false) : nodeX.findInputSlot(slotX,false);\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n                break;\n            case \"object\":\n                // ok slotX\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n                break;\n            case \"number\":\n                iSlotConn = slotX;\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n                break;\n            default:\n                // bad ?\n                //iSlotConn = 0;\n                console.warn(\"Cant get slot information \"+slotX);\n                return false;\n        }\n\n        var options = [\"Add Node\",null];\n\n        if (that.allow_searchbox){\n            options.push(\"Search\");\n            options.push(null);\n        }\n\n        // get defaults nodes for this slottype\n        var fromSlotType = slotX.type==LiteGraph.EVENT?\"_event_\":slotX.type;\n        var slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n        if(slotTypesDefault && slotTypesDefault[fromSlotType]){\n            if(typeof slotTypesDefault[fromSlotType] == \"object\" || typeof slotTypesDefault[fromSlotType] == \"array\"){\n                for(var typeX in slotTypesDefault[fromSlotType]){\n                    options.push(slotTypesDefault[fromSlotType][typeX]);\n                }\n            }else{\n                options.push(slotTypesDefault[fromSlotType]);\n            }\n        }\n\n        // build menu\n        var menu = new LiteGraph.ContextMenu(options, {\n            event: opts.e,\n            title: (slotX && slotX.name!=\"\" ? (slotX.name + (fromSlotType?\" | \":\"\")) : \"\")+(slotX && fromSlotType ? fromSlotType : \"\"),\n            callback: inner_clicked\n        });\n\n        // callback\n        function inner_clicked(v,options,e) {\n            //console.log(\"Process showConnectionMenu selection\");\n            switch (v) {\n                case \"Add Node\":\n                    LGraphCanvas.onMenuAdd(null, null, e, menu, function(node){\n                        if (isFrom){\n                            opts.nodeFrom.connectByType( iSlotConn, node, fromSlotType );\n                        }else{\n                            opts.nodeTo.connectByTypeOutput( iSlotConn, node, fromSlotType );\n                        }\n                    });\n                    break;\n                case \"Search\":\n                    if(isFrom){\n                        that.showSearchBox(e,{node_from: opts.nodeFrom, slot_from: slotX, type_filter_in: fromSlotType});\n                    }else{\n                        that.showSearchBox(e,{node_to: opts.nodeTo, slot_from: slotX, type_filter_out: fromSlotType});\n                    }\n                    break;\n                default:\n                    // check for defaults nodes for this slottype\n                    var nodeCreated = that.createDefaultNodeForSlot(Object.assign(opts,{ position: [opts.e.canvasX, opts.e.canvasY]\n                        ,nodeType: v\n                    }));\n                    if (nodeCreated){\n                        // new node created\n                        //console.log(\"node \"+v+\" created\")\n                    }else{\n                        // failed or v is not in defaults\n                    }\n                    break;\n            }\n        }\n\n        return false;\n    };\n\n    // TODO refactor :: this is used fot title but not for properties!\n    LGraphCanvas.onShowPropertyEditor = function(item, options, e, menu, node) {\n        var input_html = \"\";\n        var property = item.property || \"title\";\n        var value = node[property];\n\n        // TODO refactor :: use createDialog ?\n\n        var dialog = document.createElement(\"div\");\n        dialog.is_modified = false;\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML =\n            \"<span class='name'></span><input autofocus type='text' class='value'/><button>OK</button>\";\n        dialog.close = function() {\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n        var title = dialog.querySelector(\".name\");\n        title.innerText = property;\n        var input = dialog.querySelector(\".value\");\n        if (input) {\n            input.value = value;\n            input.addEventListener(\"blur\", function(e) {\n                this.focus();\n            });\n            input.addEventListener(\"keydown\", function(e) {\n                dialog.is_modified = true;\n                if (e.keyCode == 27) {\n                    //ESC\n                    dialog.close();\n                } else if (e.keyCode == 13) {\n                    inner(); // save\n                } else if (e.keyCode != 13 && e.target.localName != \"textarea\") {\n                    return;\n                }\n                e.preventDefault();\n                e.stopPropagation();\n            });\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n\n        var rect = canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", inner);\n        canvas.parentNode.appendChild(dialog);\n\n        if(input) input.focus();\n\n        var dialogCloseTimer = null;\n        dialog.addEventListener(\"mouseleave\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        dialog.addEventListener(\"mouseenter\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n\n        function inner() {\n            if(input) setValue(input.value);\n        }\n\n        function setValue(value) {\n            if (item.type == \"Number\") {\n                value = Number(value);\n            } else if (item.type == \"Boolean\") {\n                value = Boolean(value);\n            }\n            node[property] = value;\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n            node.setDirtyCanvas(true, true);\n        }\n    };\n\n    // refactor: there are different dialogs, some uses createDialog some dont\n    LGraphCanvas.prototype.prompt = function(title, value, callback, event, multiline) {\n        var that = this;\n        var input_html = \"\";\n        title = title || \"\";\n\n        var dialog = document.createElement(\"div\");\n        dialog.is_modified = false;\n        dialog.className = \"graphdialog rounded\";\n        if(multiline)\n            dialog.innerHTML = \"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>\";\n        else\n            dialog.innerHTML = \"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>\";\n        dialog.close = function() {\n            that.prompt_box = null;\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n        canvas.parentNode.appendChild(dialog);\n\n        if (this.ds.scale > 1) {\n            dialog.style.transform = \"scale(\" + this.ds.scale + \")\";\n        }\n\n        var dialogCloseTimer = null;\n        var prevent_timeout = false;\n        LiteGraph.pointerListenerAdd(dialog,\"leave\", function(e) {\n            if (prevent_timeout)\n                return;\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        LiteGraph.pointerListenerAdd(dialog,\"enter\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n        var selInDia = dialog.querySelectorAll(\"select\");\n        if (selInDia){\n            // if filtering, check focus changed to comboboxes and prevent closing\n            selInDia.forEach(function(selIn) {\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                    prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            });\n        }\n\n        if (that.prompt_box) {\n            that.prompt_box.close();\n        }\n        that.prompt_box = dialog;\n\n        var first = null;\n        var timeout = null;\n        var selected = null;\n\n        var name_element = dialog.querySelector(\".name\");\n        name_element.innerText = title;\n        var value_element = dialog.querySelector(\".value\");\n        value_element.value = value;\n        value_element.select();\n\n        var input = value_element;\n        input.addEventListener(\"keydown\", function(e) {\n            dialog.is_modified = true;\n            if (e.keyCode == 27) {\n                //ESC\n                dialog.close();\n            } else if (e.keyCode == 13 && e.target.localName != \"textarea\") {\n                if (callback) {\n                    callback(this.value);\n                }\n                dialog.close();\n            } else {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", function(e) {\n            if (callback) {\n                callback(input.value);\n            }\n            that.setDirty(true);\n            dialog.close();\n        });\n\n        var rect = canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n\n        setTimeout(function() {\n            input.focus();\n        }, 10);\n\n        return dialog;\n    };\n\n    LGraphCanvas.search_limit = -1;\n    LGraphCanvas.prototype.showSearchBox = function(event, options) {\n        // proposed defaults\n        var def_options = { slot_from: null\n            ,node_from: null\n            ,node_to: null\n            ,do_type_filter: LiteGraph.search_filter_enabled // TODO check for registered_slot_[in/out]_types not empty // this will be checked for functionality enabled : filter on slot type, in and out\n            ,type_filter_in: false                          // these are default: pass to set initially set values\n            ,type_filter_out: false\n            ,show_general_if_none_on_typefilter: true\n            ,show_general_after_typefiltered: true\n            ,hide_on_mouse_leave: LiteGraph.search_hide_on_mouse_leave\n            ,show_all_if_empty: true\n            ,show_all_on_open: LiteGraph.search_show_all_on_open\n        };\n        options = Object.assign(def_options, options || {});\n\n        //console.log(options);\n\n        var that = this;\n        var input_html = \"\";\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n        var root_document = canvas.ownerDocument || document;\n\n        var dialog = document.createElement(\"div\");\n        dialog.className = \"litegraph litesearchbox graphdialog rounded\";\n        dialog.innerHTML = \"<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/>\";\n        if (options.do_type_filter){\n            dialog.innerHTML += \"<select class='slot_in_type_filter'><option value=''></option></select>\";\n            dialog.innerHTML += \"<select class='slot_out_type_filter'><option value=''></option></select>\";\n        }\n        dialog.innerHTML += \"<div class='helper'></div>\";\n\n        if( root_document.fullscreenElement )\n            root_document.fullscreenElement.appendChild(dialog);\n        else\n        {\n            root_document.body.appendChild(dialog);\n            root_document.body.style.overflow = \"hidden\";\n        }\n        // dialog element has been appended\n\n        if (options.do_type_filter){\n            var selIn = dialog.querySelector(\".slot_in_type_filter\");\n            var selOut = dialog.querySelector(\".slot_out_type_filter\");\n        }\n\n        dialog.close = function() {\n            that.search_box = null;\n            this.blur();\n            canvas.focus();\n            root_document.body.style.overflow = \"\";\n\n            setTimeout(function() {\n                that.canvas.focus();\n            }, 20); //important, if canvas loses focus keys wont be captured\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n\n        if (this.ds.scale > 1) {\n            dialog.style.transform = \"scale(\" + this.ds.scale + \")\";\n        }\n\n        // hide on mouse leave\n        if(options.hide_on_mouse_leave){\n            var prevent_timeout = false;\n            var timeout_close = null;\n            LiteGraph.pointerListenerAdd(dialog,\"enter\", function(e) {\n                if (timeout_close) {\n                    clearTimeout(timeout_close);\n                    timeout_close = null;\n                }\n            });\n            LiteGraph.pointerListenerAdd(dialog,\"leave\", function(e) {\n                if (prevent_timeout){\n                    return;\n                }\n                timeout_close = setTimeout(function() {\n                    dialog.close();\n                }, typeof options.hide_on_mouse_leave === \"number\" ? options.hide_on_mouse_leave : 500);\n            });\n            // if filtering, check focus changed to comboboxes and prevent closing\n            if (options.do_type_filter){\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                    prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n                selOut.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selOut.addEventListener(\"blur\", function(e) {\n                    prevent_timeout = 0;\n                });\n                selOut.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            }\n        }\n\n        if (that.search_box) {\n            that.search_box.close();\n        }\n        that.search_box = dialog;\n\n        var helper = dialog.querySelector(\".helper\");\n\n        var first = null;\n        var timeout = null;\n        var selected = null;\n\n        var input = dialog.querySelector(\"input\");\n        if (input) {\n            input.addEventListener(\"blur\", function(e) {\n                this.focus();\n            });\n            input.addEventListener(\"keydown\", function(e) {\n                if (e.keyCode == 38) {\n                    //UP\n                    changeSelection(false);\n                } else if (e.keyCode == 40) {\n                    //DOWN\n                    changeSelection(true);\n                } else if (e.keyCode == 27) {\n                    //ESC\n                    dialog.close();\n                } else if (e.keyCode == 13) {\n                    if (selected) {\n                        select(unescape(selected.dataset[\"type\"]));\n                    } else if (first) {\n                        select(first);\n                    } else {\n                        dialog.close();\n                    }\n                } else {\n                    if (timeout) {\n                        clearInterval(timeout);\n                    }\n                    timeout = setTimeout(refreshHelper, 10);\n                    return;\n                }\n                e.preventDefault();\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                return true;\n            });\n        }\n\n        // if should filter on type, load and fill selected and choose elements if passed\n        if (options.do_type_filter){\n            if (selIn){\n                var aSlots = LiteGraph.slot_types_in;\n                var nSlots = aSlots.length; // this for object :: Object.keys(aSlots).length;\n\n                if (options.type_filter_in == LiteGraph.EVENT || options.type_filter_in == LiteGraph.ACTION)\n                    options.type_filter_in = \"_event_\";\n                /* this will filter on * .. but better do it manually in case\n                else if(options.type_filter_in === \"\" || options.type_filter_in === 0)\n                    options.type_filter_in = \"*\";*/\n\n                for (var iK=0; iK<nSlots; iK++){\n                    var opt = document.createElement('option');\n                    opt.value = aSlots[iK];\n                    opt.innerHTML = aSlots[iK];\n                    selIn.appendChild(opt);\n                    if(options.type_filter_in !==false && (options.type_filter_in+\"\").toLowerCase() == (aSlots[iK]+\"\").toLowerCase()){\n                        //selIn.selectedIndex ..\n                        opt.selected = true;\n                        //console.log(\"comparing IN \"+options.type_filter_in+\" :: \"+aSlots[iK]);\n                    }else{\n                        //console.log(\"comparing OUT \"+options.type_filter_in+\" :: \"+aSlots[iK]);\n                    }\n                }\n                selIn.addEventListener(\"change\",function(){\n                    refreshHelper();\n                });\n            }\n            if (selOut){\n                var aSlots = LiteGraph.slot_types_out;\n                var nSlots = aSlots.length; // this for object :: Object.keys(aSlots).length;\n\n                if (options.type_filter_out == LiteGraph.EVENT || options.type_filter_out == LiteGraph.ACTION)\n                    options.type_filter_out = \"_event_\";\n                /* this will filter on * .. but better do it manually in case\n                else if(options.type_filter_out === \"\" || options.type_filter_out === 0)\n                    options.type_filter_out = \"*\";*/\n\n                for (var iK=0; iK<nSlots; iK++){\n                    var opt = document.createElement('option');\n                    opt.value = aSlots[iK];\n                    opt.innerHTML = aSlots[iK];\n                    selOut.appendChild(opt);\n                    if(options.type_filter_out !==false && (options.type_filter_out+\"\").toLowerCase() == (aSlots[iK]+\"\").toLowerCase()){\n                        //selOut.selectedIndex ..\n                        opt.selected = true;\n                    }\n                }\n                selOut.addEventListener(\"change\",function(){\n                    refreshHelper();\n                });\n            }\n        }\n\n        //compute best position\n        var rect = canvas.getBoundingClientRect();\n\n        var left = ( event ? event.clientX : (rect.left + rect.width * 0.5) ) - 80;\n        var top = ( event ? event.clientY : (rect.top + rect.height * 0.5) ) - 20;\n        dialog.style.left = left + \"px\";\n        dialog.style.top = top + \"px\";\n\n        //To avoid out of screen problems\n        if(event.layerY > (rect.height - 200))\n            helper.style.maxHeight = (rect.height - event.layerY - 20) + \"px\";\n\n        /*\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n        canvas.parentNode.appendChild(dialog);\n        */\n\n        input.focus();\n        if (options.show_all_on_open) refreshHelper();\n\n        function select(name) {\n            if (name) {\n                if (that.onSearchBoxSelection) {\n                    that.onSearchBoxSelection(name, event, graphcanvas);\n                } else {\n                    var extra = LiteGraph.searchbox_extras[name.toLowerCase()];\n                    if (extra) {\n                        name = extra.type;\n                    }\n\n                    graphcanvas.graph.beforeChange();\n                    var node = LiteGraph.createNode(name);\n                    if (node) {\n                        node.pos = graphcanvas.convertEventToCanvasOffset(\n                            event\n                        );\n                        graphcanvas.graph.add(node, false);\n                    }\n\n                    if (extra && extra.data) {\n                        if (extra.data.properties) {\n                            for (var i in extra.data.properties) {\n                                node.addProperty( i, extra.data.properties[i] );\n                            }\n                        }\n                        if (extra.data.inputs) {\n                            node.inputs = [];\n                            for (var i in extra.data.inputs) {\n                                node.addOutput(\n                                    extra.data.inputs[i][0],\n                                    extra.data.inputs[i][1]\n                                );\n                            }\n                        }\n                        if (extra.data.outputs) {\n                            node.outputs = [];\n                            for (var i in extra.data.outputs) {\n                                node.addOutput(\n                                    extra.data.outputs[i][0],\n                                    extra.data.outputs[i][1]\n                                );\n                            }\n                        }\n                        if (extra.data.title) {\n                            node.title = extra.data.title;\n                        }\n                        if (extra.data.json) {\n                            node.configure(extra.data.json);\n                        }\n\n                    }\n\n                    // join node after inserting\n                    if (options.node_from){\n                        var iS = false;\n                        switch (typeof options.slot_from){\n                            case \"string\":\n                                iS = options.node_from.findOutputSlot(options.slot_from);\n                                break;\n                            case \"object\":\n                                if (options.slot_from.name){\n                                    iS = options.node_from.findOutputSlot(options.slot_from.name);\n                                }else{\n                                    iS = -1;\n                                }\n                                if (iS==-1 && typeof options.slot_from.slot_index !== \"undefined\") iS = options.slot_from.slot_index;\n                                break;\n                            case \"number\":\n                                iS = options.slot_from;\n                                break;\n                            default:\n                                iS = 0; // try with first if no name set\n                        }\n                        if (typeof options.node_from.outputs[iS] !== \"undefined\"){\n                            if (iS!==false && iS>-1){\n                                options.node_from.connectByType( iS, node, options.node_from.outputs[iS].type );\n                            }\n                        }else{\n                            // console.warn(\"cant find slot \" + options.slot_from);\n                        }\n                    }\n                    if (options.node_to){\n                        var iS = false;\n                        switch (typeof options.slot_from){\n                            case \"string\":\n                                iS = options.node_to.findInputSlot(options.slot_from);\n                                break;\n                            case \"object\":\n                                if (options.slot_from.name){\n                                    iS = options.node_to.findInputSlot(options.slot_from.name);\n                                }else{\n                                    iS = -1;\n                                }\n                                if (iS==-1 && typeof options.slot_from.slot_index !== \"undefined\") iS = options.slot_from.slot_index;\n                                break;\n                            case \"number\":\n                                iS = options.slot_from;\n                                break;\n                            default:\n                                iS = 0; // try with first if no name set\n                        }\n                        if (typeof options.node_to.inputs[iS] !== \"undefined\"){\n                            if (iS!==false && iS>-1){\n                                // try connection\n                                options.node_to.connectByTypeOutput(iS,node,options.node_to.inputs[iS].type);\n                            }\n                        }else{\n                            // console.warn(\"cant find slot_nodeTO \" + options.slot_from);\n                        }\n                    }\n\n                    graphcanvas.graph.afterChange();\n                }\n            }\n\n            dialog.close();\n        }\n\n        function changeSelection(forward) {\n            var prev = selected;\n            if (selected) {\n                selected.classList.remove(\"selected\");\n            }\n            if (!selected) {\n                selected = forward\n                    ? helper.childNodes[0]\n                    : helper.childNodes[helper.childNodes.length];\n            } else {\n                selected = forward\n                    ? selected.nextSibling\n                    : selected.previousSibling;\n                if (!selected) {\n                    selected = prev;\n                }\n            }\n            if (!selected) {\n                return;\n            }\n            selected.classList.add(\"selected\");\n            selected.scrollIntoView({block: \"end\", behavior: \"smooth\"});\n        }\n\n        function refreshHelper() {\n            timeout = null;\n            var str = input.value;\n            first = null;\n            helper.innerHTML = \"\";\n            if (!str && !options.show_all_if_empty) {\n                return;\n            }\n\n            if (that.onSearchBox) {\n                var list = that.onSearchBox(helper, str, graphcanvas);\n                if (list) {\n                    for (var i = 0; i < list.length; ++i) {\n                        addResult(list[i]);\n                    }\n                }\n            } else {\n                var c = 0;\n                str = str.toLowerCase();\n                var filter = graphcanvas.filter || graphcanvas.graph.filter;\n\n                // filter by type preprocess\n                if(options.do_type_filter && that.search_box){\n                    var sIn = that.search_box.querySelector(\".slot_in_type_filter\");\n                    var sOut = that.search_box.querySelector(\".slot_out_type_filter\");\n                }else{\n                    var sIn = false;\n                    var sOut = false;\n                }\n\n                //extras\n                for (var i in LiteGraph.searchbox_extras) {\n                    var extra = LiteGraph.searchbox_extras[i];\n                    if ((!options.show_all_if_empty || str) && extra.desc.toLowerCase().indexOf(str) === -1) {\n                        continue;\n                    }\n                    var ctor = LiteGraph.registered_node_types[ extra.type ];\n                    if( ctor && ctor.filter != filter )\n                        continue;\n                    if( ! inner_test_filter(extra.type) )\n                        continue;\n                    addResult( extra.desc, \"searchbox_extra\" );\n                    if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                        break;\n                    }\n                }\n\n                var filtered = null;\n                if (Array.prototype.filter) { //filter supported\n                    var keys = Object.keys( LiteGraph.registered_node_types ); //types\n                    var filtered = keys.filter( inner_test_filter );\n                } else {\n                    filtered = [];\n                    for (var i in LiteGraph.registered_node_types) {\n                        if( inner_test_filter(i) )\n                            filtered.push(i);\n                    }\n                }\n\n                for (var i = 0; i < filtered.length; i++) {\n                    addResult(filtered[i]);\n                    if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                        break;\n                    }\n                }\n\n                // add general type if filtering\n                if (options.show_general_after_typefiltered\n                    && (sIn.value || sOut.value)\n                ){\n                    filtered_extra = [];\n                    for (var i in LiteGraph.registered_node_types) {\n                        if( inner_test_filter(i, {inTypeOverride: sIn&&sIn.value?\"*\":false, outTypeOverride: sOut&&sOut.value?\"*\":false}) )\n                            filtered_extra.push(i);\n                    }\n                    for (var i = 0; i < filtered_extra.length; i++) {\n                        addResult(filtered_extra[i], \"generic_type\");\n                        if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                            break;\n                        }\n                    }\n                }\n\n                // check il filtering gave no results\n                if ((sIn.value || sOut.value) &&\n                    ( (helper.childNodes.length == 0 && options.show_general_if_none_on_typefilter) )\n                ){\n                    filtered_extra = [];\n                    for (var i in LiteGraph.registered_node_types) {\n                        if( inner_test_filter(i, {skipFilter: true}) )\n                            filtered_extra.push(i);\n                    }\n                    for (var i = 0; i < filtered_extra.length; i++) {\n                        addResult(filtered_extra[i], \"not_in_filter\");\n                        if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                            break;\n                        }\n                    }\n                }\n\n                function inner_test_filter( type, optsIn )\n                {\n                    var optsIn = optsIn || {};\n                    var optsDef = { skipFilter: false\n                        ,inTypeOverride: false\n                        ,outTypeOverride: false\n                    };\n                    var opts = Object.assign(optsDef,optsIn);\n                    var ctor = LiteGraph.registered_node_types[ type ];\n                    if(filter && ctor.filter != filter )\n                        return false;\n                    if ((!options.show_all_if_empty || str) && type.toLowerCase().indexOf(str) === -1 && (!ctor.title || ctor.title.toLowerCase().indexOf(str) === -1))\n                        return false;\n\n                    // filter by slot IN, OUT types\n                    if(options.do_type_filter && !opts.skipFilter){\n                        var sType = type;\n\n                        var sV = sIn.value;\n                        if (opts.inTypeOverride!==false) sV = opts.inTypeOverride;\n                        //if (sV.toLowerCase() == \"_event_\") sV = LiteGraph.EVENT; // -1\n\n                        if(sIn && sV){\n                            //console.log(\"will check filter against \"+sV);\n                            if (LiteGraph.registered_slot_in_types[sV] && LiteGraph.registered_slot_in_types[sV].nodes){ // type is stored\n                                //console.debug(\"check \"+sType+\" in \"+LiteGraph.registered_slot_in_types[sV].nodes);\n                                var doesInc = LiteGraph.registered_slot_in_types[sV].nodes.includes(sType);\n                                if (doesInc!==false){\n                                    //console.log(sType+\" HAS \"+sV);\n                                }else{\n                                    /*console.debug(LiteGraph.registered_slot_in_types[sV]);\n                                    console.log(+\" DONT includes \"+type);*/\n                                    return false;\n                                }\n                            }\n                        }\n\n                        var sV = sOut.value;\n                        if (opts.outTypeOverride!==false) sV = opts.outTypeOverride;\n                        //if (sV.toLowerCase() == \"_event_\") sV = LiteGraph.EVENT; // -1\n\n                        if(sOut && sV){\n                            //console.log(\"search will check filter against \"+sV);\n                            if (LiteGraph.registered_slot_out_types[sV] && LiteGraph.registered_slot_out_types[sV].nodes){ // type is stored\n                                //console.debug(\"check \"+sType+\" in \"+LiteGraph.registered_slot_out_types[sV].nodes);\n                                var doesInc = LiteGraph.registered_slot_out_types[sV].nodes.includes(sType);\n                                if (doesInc!==false){\n                                    //console.log(sType+\" HAS \"+sV);\n                                }else{\n                                    /*console.debug(LiteGraph.registered_slot_out_types[sV]);\n                                    console.log(+\" DONT includes \"+type);*/\n                                    return false;\n                                }\n                            }\n                        }\n                    }\n                    return true;\n                }\n            }\n\n            function addResult(type, className) {\n                var help = document.createElement(\"div\");\n                if (!first) {\n                    first = type;\n                }\n\n                const nodeType = LiteGraph.registered_node_types[type];\n                if (nodeType?.title) {\n                    help.innerText = nodeType?.title;\n                    const typeEl = document.createElement(\"span\");\n                    typeEl.className = \"litegraph lite-search-item-type\";\n                    typeEl.textContent = type;\n                    help.append(typeEl);\n                } else {\n                    help.innerText = type;\n                }\n\n                help.dataset[\"type\"] = escape(type);\n                help.className = \"litegraph lite-search-item\";\n                if (className) {\n                    help.className += \" \" + className;\n                }\n                help.addEventListener(\"click\", function(e) {\n                    select(unescape(this.dataset[\"type\"]));\n                });\n                helper.appendChild(help);\n            }\n        }\n\n        return dialog;\n    };\n\n    LGraphCanvas.prototype.showEditPropertyValue = function( node, property, options ) {\n        if (!node || node.properties[property] === undefined) {\n            return;\n        }\n\n        options = options || {};\n        var that = this;\n\n        var info = node.getPropertyInfo(property);\n        var type = info.type;\n\n        var input_html = \"\";\n\n        if (type == \"string\" || type == \"number\" || type == \"array\" || type == \"object\") {\n            input_html = \"<input autofocus type='text' class='value'/>\";\n        } else if ( (type == \"enum\" || type == \"combo\") && info.values) {\n            input_html = \"<select autofocus type='text' class='value'>\";\n            for (var i in info.values) {\n                var v = i;\n                if( info.values.constructor === Array )\n                    v = info.values[i];\n\n                input_html +=\n                    \"<option value='\" +\n                    v +\n                    \"' \" +\n                    (v == node.properties[property] ? \"selected\" : \"\") +\n                    \">\" +\n                    info.values[i] +\n                    \"</option>\";\n            }\n            input_html += \"</select>\";\n        } else if (type == \"boolean\" || type == \"toggle\") {\n            input_html =\n                \"<input autofocus type='checkbox' class='value' \" +\n                (node.properties[property] ? \"checked\" : \"\") +\n                \"/>\";\n        } else {\n            console.warn(\"unknown type: \" + type);\n            return;\n        }\n\n        var dialog = this.createDialog(\n            \"<span class='name'>\" +\n            (info.label ? info.label : property) +\n            \"</span>\" +\n            input_html +\n            \"<button>OK</button>\",\n            options\n        );\n\n        var input = false;\n        if ((type == \"enum\" || type == \"combo\") && info.values) {\n            input = dialog.querySelector(\"select\");\n            input.addEventListener(\"change\", function(e) {\n                dialog.modified();\n                setValue(e.target.value);\n                //var index = e.target.value;\n                //setValue( e.options[e.selectedIndex].value );\n            });\n        } else if (type == \"boolean\" || type == \"toggle\") {\n            input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"click\", function(e) {\n                    dialog.modified();\n                    setValue(!!input.checked);\n                });\n            }\n        } else {\n            input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"blur\", function(e) {\n                    this.focus();\n                });\n\n                var v = node.properties[property] !== undefined ? node.properties[property] : \"\";\n                if (type !== 'string') {\n                    v = JSON.stringify(v);\n                }\n\n                input.value = v;\n                input.addEventListener(\"keydown\", function(e) {\n                    if (e.keyCode == 27) {\n                        //ESC\n                        dialog.close();\n                    } else if (e.keyCode == 13) {\n                        // ENTER\n                        inner(); // save\n                    } else if (e.keyCode != 13) {\n                        dialog.modified();\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n        if (input) input.focus();\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", inner);\n\n        function inner() {\n            setValue(input.value);\n        }\n\n        function setValue(value) {\n\n            if(info && info.values && info.values.constructor === Object && info.values[value] != undefined )\n                value = info.values[value];\n\n            if (typeof node.properties[property] == \"number\") {\n                value = Number(value);\n            }\n            if (type == \"array\" || type == \"object\") {\n                value = JSON.parse(value);\n            }\n            node.properties[property] = value;\n            if (node.graph) {\n                node.graph._version++;\n            }\n            if (node.onPropertyChanged) {\n                node.onPropertyChanged(property, value);\n            }\n            if(options.onclose)\n                options.onclose();\n            dialog.close();\n            node.setDirtyCanvas(true, true);\n        }\n\n        return dialog;\n    };\n\n    // TODO refactor, theer are different dialog, some uses createDialog, some dont\n    LGraphCanvas.prototype.createDialog = function(html, options) {\n        var def_options = { checkForInput: false, closeOnLeave: true, closeOnLeave_checkModified: true };\n        options = Object.assign(def_options, options || {});\n\n        var dialog = document.createElement(\"div\");\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML = html;\n        dialog.is_modified = false;\n\n        var rect = this.canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (options.position) {\n            offsetx += options.position[0];\n            offsety += options.position[1];\n        } else if (options.event) {\n            offsetx += options.event.clientX;\n            offsety += options.event.clientY;\n        } //centered\n        else {\n            offsetx += this.canvas.width * 0.5;\n            offsety += this.canvas.height * 0.5;\n        }\n\n        dialog.style.left = offsetx + \"px\";\n        dialog.style.top = offsety + \"px\";\n\n        this.canvas.parentNode.appendChild(dialog);\n\n        // acheck for input and use default behaviour: save on enter, close on esc\n        if (options.checkForInput){\n            var aI = [];\n            var focused = false;\n            if (aI = dialog.querySelectorAll(\"input\")){\n                aI.forEach(function(iX) {\n                    iX.addEventListener(\"keydown\",function(e){\n                        dialog.modified();\n                        if (e.keyCode == 27) {\n                            dialog.close();\n                        } else if (e.keyCode != 13) {\n                            return;\n                        }\n                        // set value ?\n                        e.preventDefault();\n                        e.stopPropagation();\n                    });\n                    if (!focused) iX.focus();\n                });\n            }\n        }\n\n        dialog.modified = function(){\n            dialog.is_modified = true;\n        }\n        dialog.close = function() {\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n\n        var dialogCloseTimer = null;\n        var prevent_timeout = false;\n        dialog.addEventListener(\"mouseleave\", function(e) {\n            if (prevent_timeout)\n                return;\n            if(options.closeOnLeave || LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        dialog.addEventListener(\"mouseenter\", function(e) {\n            if(options.closeOnLeave || LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n        var selInDia = dialog.querySelectorAll(\"select\");\n        if (selInDia){\n            // if filtering, check focus changed to comboboxes and prevent closing\n            selInDia.forEach(function(selIn) {\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                    prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            });\n        }\n\n        return dialog;\n    };\n\n    LGraphCanvas.prototype.createPanel = function(title, options) {\n        options = options || {};\n\n        var ref_window = options.window || window;\n        var root = document.createElement(\"div\");\n        root.className = \"litegraph dialog\";\n        root.innerHTML = \"<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div style='display:none;' class='dialog-alt-content'></div><div class='dialog-footer'></div>\";\n        root.header = root.querySelector(\".dialog-header\");\n\n        if(options.width)\n            root.style.width = options.width + (options.width.constructor === Number ? \"px\" : \"\");\n        if(options.height)\n            root.style.height = options.height + (options.height.constructor === Number ? \"px\" : \"\");\n        if(options.closable)\n        {\n            var close = document.createElement(\"span\");\n            close.innerHTML = \"&#10005;\";\n            close.classList.add(\"close\");\n            close.addEventListener(\"click\",function(){\n                root.close();\n            });\n            root.header.appendChild(close);\n        }\n        root.title_element = root.querySelector(\".dialog-title\");\n        root.title_element.innerText = title;\n        root.content = root.querySelector(\".dialog-content\");\n        root.alt_content = root.querySelector(\".dialog-alt-content\");\n        root.footer = root.querySelector(\".dialog-footer\");\n\n        root.close = function()\n        {\n            if (root.onClose && typeof root.onClose == \"function\"){\n                root.onClose();\n            }\n            if(root.parentNode)\n                root.parentNode.removeChild(root);\n            /* XXX CHECK THIS */\n            if(this.parentNode){\n                this.parentNode.removeChild(this);\n            }\n            /* XXX this was not working, was fixed with an IF, check this */\n        }\n\n        // function to swap panel content\n        root.toggleAltContent = function(force){\n            if (typeof force != \"undefined\"){\n                var vTo = force ? \"block\" : \"none\";\n                var vAlt = force ? \"none\" : \"block\";\n            }else{\n                var vTo = root.alt_content.style.display != \"block\" ? \"block\" : \"none\";\n                var vAlt = root.alt_content.style.display != \"block\" ? \"none\" : \"block\";\n            }\n            root.alt_content.style.display = vTo;\n            root.content.style.display = vAlt;\n        }\n\n        root.toggleFooterVisibility = function(force){\n            if (typeof force != \"undefined\"){\n                var vTo = force ? \"block\" : \"none\";\n            }else{\n                var vTo = root.footer.style.display != \"block\" ? \"block\" : \"none\";\n            }\n            root.footer.style.display = vTo;\n        }\n\n        root.clear = function()\n        {\n            this.content.innerHTML = \"\";\n        }\n\n        root.addHTML = function(code, classname, on_footer)\n        {\n            var elem = document.createElement(\"div\");\n            if(classname)\n                elem.className = classname;\n            elem.innerHTML = code;\n            if(on_footer)\n                root.footer.appendChild(elem);\n            else\n                root.content.appendChild(elem);\n            return elem;\n        }\n\n        root.addButton = function( name, callback, options )\n        {\n            var elem = document.createElement(\"button\");\n            elem.innerText = name;\n            elem.options = options;\n            elem.classList.add(\"btn\");\n            elem.addEventListener(\"click\",callback);\n            root.footer.appendChild(elem);\n            return elem;\n        }\n\n        root.addSeparator = function()\n        {\n            var elem = document.createElement(\"div\");\n            elem.className = \"separator\";\n            root.content.appendChild(elem);\n        }\n\n        root.addWidget = function( type, name, value, options, callback )\n        {\n            options = options || {};\n            var str_value = String(value);\n            type = type.toLowerCase();\n            if(type == \"number\")\n                str_value = value.toFixed(3);\n\n            var elem = document.createElement(\"div\");\n            elem.className = \"property\";\n            elem.innerHTML = \"<span class='property_name'></span><span class='property_value'></span>\";\n            elem.querySelector(\".property_name\").innerText = options.label || name;\n            var value_element = elem.querySelector(\".property_value\");\n            value_element.innerText = str_value;\n            elem.dataset[\"property\"] = name;\n            elem.dataset[\"type\"] = options.type || type;\n            elem.options = options;\n            elem.value = value;\n\n            if( type == \"code\" )\n                elem.addEventListener(\"click\", function(e){ root.inner_showCodePad( this.dataset[\"property\"] ); });\n            else if (type == \"boolean\")\n            {\n                elem.classList.add(\"boolean\");\n                if(value)\n                    elem.classList.add(\"bool-on\");\n                elem.addEventListener(\"click\", function(){\n                    //var v = node.properties[this.dataset[\"property\"]];\n                    //node.setProperty(this.dataset[\"property\"],!v); this.innerText = v ? \"true\" : \"false\";\n                    var propname = this.dataset[\"property\"];\n                    this.value = !this.value;\n                    this.classList.toggle(\"bool-on\");\n                    this.querySelector(\".property_value\").innerText = this.value ? \"true\" : \"false\";\n                    innerChange(propname, this.value );\n                });\n            }\n            else if (type == \"string\" || type == \"number\")\n            {\n                value_element.setAttribute(\"contenteditable\",true);\n                value_element.addEventListener(\"keydown\", function(e){\n                    if(e.code == \"Enter\" && (type != \"string\" || !e.shiftKey)) // allow for multiline\n                    {\n                        e.preventDefault();\n                        this.blur();\n                    }\n                });\n                value_element.addEventListener(\"blur\", function(){\n                    var v = this.innerText;\n                    var propname = this.parentNode.dataset[\"property\"];\n                    var proptype = this.parentNode.dataset[\"type\"];\n                    if( proptype == \"number\")\n                        v = Number(v);\n                    innerChange(propname, v);\n                });\n            }\n            else if (type == \"enum\" || type == \"combo\") {\n                var str_value = LGraphCanvas.getPropertyPrintableValue( value, options.values );\n                value_element.innerText = str_value;\n\n                value_element.addEventListener(\"click\", function(event){\n                    var values = options.values || [];\n                    var propname = this.parentNode.dataset[\"property\"];\n                    var elem_that = this;\n                    var menu = new LiteGraph.ContextMenu(values,{\n                            event: event,\n                            className: \"dark\",\n                            callback: inner_clicked\n                        },\n                        ref_window);\n                    function inner_clicked(v, option, event) {\n                        //node.setProperty(propname,v);\n                        //graphcanvas.dirty_canvas = true;\n                        elem_that.innerText = v;\n                        innerChange(propname,v);\n                        return false;\n                    }\n                });\n            }\n\n            root.content.appendChild(elem);\n\n            function innerChange(name, value)\n            {\n                //console.log(\"change\",name,value);\n                //that.dirty_canvas = true;\n                if(options.callback)\n                    options.callback(name,value,options);\n                if(callback)\n                    callback(name,value,options);\n            }\n\n            return elem;\n        }\n\n        if (root.onOpen && typeof root.onOpen == \"function\") root.onOpen();\n\n        return root;\n    };\n\n    LGraphCanvas.getPropertyPrintableValue = function(value, values)\n    {\n        if(!values)\n            return String(value);\n\n        if(values.constructor === Array)\n        {\n            return String(value);\n        }\n\n        if(values.constructor === Object)\n        {\n            var desc_value = \"\";\n            for(var k in values)\n            {\n                if(values[k] != value)\n                    continue;\n                desc_value = k;\n                break;\n            }\n            return String(value) + \" (\"+desc_value+\")\";\n        }\n    }\n\n    LGraphCanvas.prototype.closePanels = function(){\n        var panel = document.querySelector(\"#node-panel\");\n        if(panel)\n            panel.close();\n        var panel = document.querySelector(\"#option-panel\");\n        if(panel)\n            panel.close();\n    }\n\n    LGraphCanvas.prototype.showShowGraphOptionsPanel = function(refOpts, obEv, refMenu, refMenu2){\n        if(this.constructor && this.constructor.name == \"HTMLDivElement\"){\n            // assume coming from the menu event click\n            if (!obEv || !obEv.event || !obEv.event.target || !obEv.event.target.lgraphcanvas){\n                console.warn(\"Canvas not found\"); // need a ref to canvas obj\n                /*console.debug(event);\n                console.debug(event.target);*/\n                return;\n            }\n            var graphcanvas = obEv.event.target.lgraphcanvas;\n        }else{\n            // assume called internally\n            var graphcanvas = this;\n        }\n        graphcanvas.closePanels();\n        var ref_window = graphcanvas.getCanvasWindow();\n        panel = graphcanvas.createPanel(\"Options\",{\n            closable: true\n            ,window: ref_window\n            ,onOpen: function(){\n                graphcanvas.OPTIONPANEL_IS_OPEN = true;\n            }\n            ,onClose: function(){\n                graphcanvas.OPTIONPANEL_IS_OPEN = false;\n                graphcanvas.options_panel = null;\n            }\n        });\n        graphcanvas.options_panel = panel;\n        panel.id = \"option-panel\";\n        panel.classList.add(\"settings\");\n\n        function inner_refresh(){\n\n            panel.content.innerHTML = \"\"; //clear\n\n            var fUpdate = function(name, value, options){\n                switch(name){\n                    /*case \"Render mode\":\n                        // Case \"\"..\n                        if (options.values && options.key){\n                            var kV = Object.values(options.values).indexOf(value);\n                            if (kV>=0 && options.values[kV]){\n                                console.debug(\"update graph options: \"+options.key+\": \"+kV);\n                                graphcanvas[options.key] = kV;\n                                //console.debug(graphcanvas);\n                                break;\n                            }\n                        }\n                        console.warn(\"unexpected options\");\n                        console.debug(options);\n                        break;*/\n                    default:\n                        //console.debug(\"want to update graph options: \"+name+\": \"+value);\n                        if (options && options.key){\n                            name = options.key;\n                        }\n                        if (options.values){\n                            value = Object.values(options.values).indexOf(value);\n                        }\n                        //console.debug(\"update graph option: \"+name+\": \"+value);\n                        graphcanvas[name] = value;\n                        break;\n                }\n            };\n\n            // panel.addWidget( \"string\", \"Graph name\", \"\", {}, fUpdate); // implement\n\n            var aProps = LiteGraph.availableCanvasOptions;\n            aProps.sort();\n            for(var pI in aProps){\n                var pX = aProps[pI];\n                panel.addWidget( \"boolean\", pX, graphcanvas[pX], {key: pX, on: \"True\", off: \"False\"}, fUpdate);\n            }\n\n            var aLinks = [ graphcanvas.links_render_mode ];\n            panel.addWidget( \"combo\", \"Render mode\", LiteGraph.LINK_RENDER_MODES[graphcanvas.links_render_mode], {key: \"links_render_mode\", values: LiteGraph.LINK_RENDER_MODES}, fUpdate);\n\n            panel.addSeparator();\n\n            panel.footer.innerHTML = \"\"; // clear\n\n        }\n        inner_refresh();\n\n        graphcanvas.canvas.parentNode.appendChild( panel );\n    }\n\n    LGraphCanvas.prototype.showShowNodePanel = function( node )\n    {\n        this.SELECTED_NODE = node;\n        this.closePanels();\n        var ref_window = this.getCanvasWindow();\n        var that = this;\n        var graphcanvas = this;\n        var panel = this.createPanel(node.title || \"\",{\n            closable: true\n            ,window: ref_window\n            ,onOpen: function(){\n                graphcanvas.NODEPANEL_IS_OPEN = true;\n            }\n            ,onClose: function(){\n                graphcanvas.NODEPANEL_IS_OPEN = false;\n                graphcanvas.node_panel = null;\n            }\n        });\n        graphcanvas.node_panel = panel;\n        panel.id = \"node-panel\";\n        panel.node = node;\n        panel.classList.add(\"settings\");\n\n        function inner_refresh()\n        {\n            panel.content.innerHTML = \"\"; //clear\n            panel.addHTML(\"<span class='node_type'>\"+node.type+\"</span><span class='node_desc'>\"+(node.constructor.desc || \"\")+\"</span><span class='separator'></span>\");\n\n            panel.addHTML(\"<h3>Properties</h3>\");\n\n            var fUpdate = function(name,value){\n                graphcanvas.graph.beforeChange(node);\n                switch(name){\n                    case \"Title\":\n                        node.title = value;\n                        break;\n                    case \"Mode\":\n                        var kV = Object.values(LiteGraph.NODE_MODES).indexOf(value);\n                        if (kV>=0 && LiteGraph.NODE_MODES[kV]){\n                            node.changeMode(kV);\n                        }else{\n                            console.warn(\"unexpected mode: \"+value);\n                        }\n                        break;\n                    case \"Color\":\n                        if (LGraphCanvas.node_colors[value]){\n                            node.color = LGraphCanvas.node_colors[value].color;\n                            node.bgcolor = LGraphCanvas.node_colors[value].bgcolor;\n                        }else{\n                            console.warn(\"unexpected color: \"+value);\n                        }\n                        break;\n                    default:\n                        node.setProperty(name,value);\n                        break;\n                }\n                graphcanvas.graph.afterChange();\n                graphcanvas.dirty_canvas = true;\n            };\n\n            panel.addWidget( \"string\", \"Title\", node.title, {}, fUpdate);\n\n            panel.addWidget( \"combo\", \"Mode\", LiteGraph.NODE_MODES[node.mode], {values: LiteGraph.NODE_MODES}, fUpdate);\n\n            var nodeCol = \"\";\n            if (node.color !== undefined){\n                nodeCol = Object.keys(LGraphCanvas.node_colors).filter(function(nK){ return LGraphCanvas.node_colors[nK].color == node.color; });\n            }\n\n            panel.addWidget( \"combo\", \"Color\", nodeCol, {values: Object.keys(LGraphCanvas.node_colors)}, fUpdate);\n\n            for(var pName in node.properties)\n            {\n                var value = node.properties[pName];\n                var info = node.getPropertyInfo(pName);\n                var type = info.type || \"string\";\n\n                //in case the user wants control over the side panel widget\n                if( node.onAddPropertyToPanel && node.onAddPropertyToPanel(pName,panel) )\n                    continue;\n\n                panel.addWidget( info.widget || info.type, pName, value, info, fUpdate);\n            }\n\n            panel.addSeparator();\n\n            if(node.onShowCustomPanelInfo)\n                node.onShowCustomPanelInfo(panel);\n\n            panel.footer.innerHTML = \"\"; // clear\n            panel.addButton(\"Delete\",function(){\n                if(node.block_delete)\n                    return;\n                node.graph.remove(node);\n                panel.close();\n            }).classList.add(\"delete\");\n        }\n\n        panel.inner_showCodePad = function( propname )\n        {\n            panel.classList.remove(\"settings\");\n            panel.classList.add(\"centered\");\n\n\n            /*if(window.CodeFlask) //disabled for now\n            {\n                panel.content.innerHTML = \"<div class='code'></div>\";\n                var flask = new CodeFlask( \"div.code\", { language: 'js' });\n                flask.updateCode(node.properties[propname]);\n                flask.onUpdate( function(code) {\n                    node.setProperty(propname, code);\n                });\n            }\n            else\n            {*/\n            panel.alt_content.innerHTML = \"<textarea class='code'></textarea>\";\n            var textarea = panel.alt_content.querySelector(\"textarea\");\n            var fDoneWith = function(){\n                panel.toggleAltContent(false); //if(node_prop_div) node_prop_div.style.display = \"block\"; // panel.close();\n                panel.toggleFooterVisibility(true);\n                textarea.parentNode.removeChild(textarea);\n                panel.classList.add(\"settings\");\n                panel.classList.remove(\"centered\");\n                inner_refresh();\n            }\n            textarea.value = node.properties[propname];\n            textarea.addEventListener(\"keydown\", function(e){\n                if(e.code == \"Enter\" && e.ctrlKey )\n                {\n                    node.setProperty(propname, textarea.value);\n                    fDoneWith();\n                }\n            });\n            panel.toggleAltContent(true);\n            panel.toggleFooterVisibility(false);\n            textarea.style.height = \"calc(100% - 40px)\";\n            /*}*/\n            var assign = panel.addButton( \"Assign\", function(){\n                node.setProperty(propname, textarea.value);\n                fDoneWith();\n            });\n            panel.alt_content.appendChild(assign); //panel.content.appendChild(assign);\n            var button = panel.addButton( \"Close\", fDoneWith);\n            button.style.float = \"right\";\n            panel.alt_content.appendChild(button); // panel.content.appendChild(button);\n        }\n\n        inner_refresh();\n\n        this.canvas.parentNode.appendChild( panel );\n    }\n\n    LGraphCanvas.prototype.showSubgraphPropertiesDialog = function(node)\n    {\n        console.log(\"showing subgraph properties dialog\");\n\n        var old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n        if(old_panel)\n            old_panel.close();\n\n        var panel = this.createPanel(\"Subgraph Inputs\",{closable:true, width: 500});\n        panel.node = node;\n        panel.classList.add(\"subgraph_dialog\");\n\n        function inner_refresh()\n        {\n            panel.clear();\n\n            //show currents\n            if(node.inputs)\n                for(var i = 0; i < node.inputs.length; ++i)\n                {\n                    var input = node.inputs[i];\n                    if(input.not_subgraph_input)\n                        continue;\n                    var html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n                    var elem = panel.addHTML(html,\"subgraph_property\");\n                    elem.dataset[\"name\"] = input.name;\n                    elem.dataset[\"slot\"] = i;\n                    elem.querySelector(\".name\").innerText = input.name;\n                    elem.querySelector(\".type\").innerText = input.type;\n                    elem.querySelector(\"button\").addEventListener(\"click\",function(e){\n                        node.removeInput( Number( this.parentNode.dataset[\"slot\"] ) );\n                        inner_refresh();\n                    });\n                }\n        }\n\n        //add extra\n        var html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>\";\n        var elem = panel.addHTML(html,\"subgraph_property extra\", true);\n        elem.querySelector(\"button\").addEventListener(\"click\", function(e){\n            var elem = this.parentNode;\n            var name = elem.querySelector(\".name\").value;\n            var type = elem.querySelector(\".type\").value;\n            if(!name || node.findInputSlot(name) != -1)\n                return;\n            node.addInput(name,type);\n            elem.querySelector(\".name\").value = \"\";\n            elem.querySelector(\".type\").value = \"\";\n            inner_refresh();\n        });\n\n        inner_refresh();\n        this.canvas.parentNode.appendChild(panel);\n        return panel;\n    }\n    LGraphCanvas.prototype.showSubgraphPropertiesDialogRight = function (node) {\n\n        // console.log(\"showing subgraph properties dialog\");\n        var that = this;\n        // old_panel if old_panel is exist close it\n        var old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n        if (old_panel)\n            old_panel.close();\n        // new panel\n        var panel = this.createPanel(\"Subgraph Outputs\", { closable: true, width: 500 });\n        panel.node = node;\n        panel.classList.add(\"subgraph_dialog\");\n\n        function inner_refresh() {\n            panel.clear();\n            //show currents\n            if (node.outputs)\n                for (var i = 0; i < node.outputs.length; ++i) {\n                    var input = node.outputs[i];\n                    if (input.not_subgraph_output)\n                        continue;\n                    var html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n                    var elem = panel.addHTML(html, \"subgraph_property\");\n                    elem.dataset[\"name\"] = input.name;\n                    elem.dataset[\"slot\"] = i;\n                    elem.querySelector(\".name\").innerText = input.name;\n                    elem.querySelector(\".type\").innerText = input.type;\n                    elem.querySelector(\"button\").addEventListener(\"click\", function (e) {\n                        node.removeOutput(Number(this.parentNode.dataset[\"slot\"]));\n                        inner_refresh();\n                    });\n                }\n        }\n\n        //add extra\n        var html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>\";\n        var elem = panel.addHTML(html, \"subgraph_property extra\", true);\n        elem.querySelector(\".name\").addEventListener(\"keydown\", function (e) {\n            if (e.keyCode == 13) {\n                addOutput.apply(this)\n            }\n        })\n        elem.querySelector(\"button\").addEventListener(\"click\", function (e) {\n            addOutput.apply(this)\n        });\n        function addOutput() {\n            var elem = this.parentNode;\n            var name = elem.querySelector(\".name\").value;\n            var type = elem.querySelector(\".type\").value;\n            if (!name || node.findOutputSlot(name) != -1)\n                return;\n            node.addOutput(name, type);\n            elem.querySelector(\".name\").value = \"\";\n            elem.querySelector(\".type\").value = \"\";\n            inner_refresh();\n        }\n\n        inner_refresh();\n        this.canvas.parentNode.appendChild(panel);\n        return panel;\n    }\n    LGraphCanvas.prototype.checkPanels = function()\n    {\n        if(!this.canvas)\n            return;\n        var panels = this.canvas.parentNode.querySelectorAll(\".litegraph.dialog\");\n        for(var i = 0; i < panels.length; ++i)\n        {\n            var panel = panels[i];\n            if( !panel.node )\n                continue;\n            if( !panel.node.graph || panel.graph != this.graph )\n                panel.close();\n        }\n    }\n\n    LGraphCanvas.onMenuNodeCollapse = function(value, options, e, menu, node) {\n        node.graph.beforeChange(/*?*/);\n\n        var fApplyMultiNode = function(node){\n            node.collapse();\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n            fApplyMultiNode(node);\n        }else{\n            for (var i in graphcanvas.selected_nodes) {\n                fApplyMultiNode(graphcanvas.selected_nodes[i]);\n            }\n        }\n\n        node.graph.afterChange(/*?*/);\n    };\n\n    LGraphCanvas.onMenuNodePin = function(value, options, e, menu, node) {\n        node.pin();\n    };\n\n    LGraphCanvas.onMenuNodeMode = function(value, options, e, menu, node) {\n        new LiteGraph.ContextMenu(\n            LiteGraph.NODE_MODES,\n            { event: e, callback: inner_clicked, parentMenu: menu, node: node }\n        );\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n            var kV = Object.values(LiteGraph.NODE_MODES).indexOf(v);\n            var fApplyMultiNode = function(node){\n                if (kV>=0 && LiteGraph.NODE_MODES[kV])\n                    node.changeMode(kV);\n                else{\n                    console.warn(\"unexpected mode: \"+v);\n                    node.changeMode(LiteGraph.ALWAYS);\n                }\n            }\n\n            var graphcanvas = LGraphCanvas.active_canvas;\n            if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n                fApplyMultiNode(node);\n            }else{\n                for (var i in graphcanvas.selected_nodes) {\n                    fApplyMultiNode(graphcanvas.selected_nodes[i]);\n                }\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeColors = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node for color\";\n        }\n\n        var values = [];\n        values.push({\n            value: null,\n            content:\n                \"<span style='display: block; padding-left: 4px;'>No color</span>\"\n        });\n\n        for (var i in LGraphCanvas.node_colors) {\n            var color = LGraphCanvas.node_colors[i];\n            var value = {\n                value: i,\n                content:\n                    \"<span style='display: block; color: #999; padding-left: 4px; border-left: 8px solid \" +\n                    color.color +\n                    \"; background-color:\" +\n                    color.bgcolor +\n                    \"'>\" +\n                    i +\n                    \"</span>\"\n            };\n            values.push(value);\n        }\n        new LiteGraph.ContextMenu(values, {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: menu,\n            node: node\n        });\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n\n            var color = v.value ? LGraphCanvas.node_colors[v.value] : null;\n\n            var fApplyColor = function(node){\n                if (color) {\n                    if (node.constructor === LiteGraph.LGraphGroup) {\n                        node.color = color.groupcolor;\n                    } else {\n                        node.color = color.color;\n                        node.bgcolor = color.bgcolor;\n                    }\n                } else {\n                    delete node.color;\n                    delete node.bgcolor;\n                }\n            }\n\n            var graphcanvas = LGraphCanvas.active_canvas;\n            if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n                fApplyColor(node);\n            }else{\n                for (var i in graphcanvas.selected_nodes) {\n                    fApplyColor(graphcanvas.selected_nodes[i]);\n                }\n            }\n            node.setDirtyCanvas(true, true);\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeShapes = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node passed\";\n        }\n\n        new LiteGraph.ContextMenu(LiteGraph.VALID_SHAPES, {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: menu,\n            node: node\n        });\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n            node.graph.beforeChange(/*?*/); //node\n\n            var fApplyMultiNode = function(node){\n                node.shape = v;\n            }\n\n            var graphcanvas = LGraphCanvas.active_canvas;\n            if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n                fApplyMultiNode(node);\n            }else{\n                for (var i in graphcanvas.selected_nodes) {\n                    fApplyMultiNode(graphcanvas.selected_nodes[i]);\n                }\n            }\n\n            node.graph.afterChange(/*?*/); //node\n            node.setDirtyCanvas(true);\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeRemove = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node passed\";\n        }\n\n        var graph = node.graph;\n        graph.beforeChange();\n\n\n        var fApplyMultiNode = function(node){\n            if (node.removable === false) {\n                return;\n            }\n            graph.remove(node);\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n            fApplyMultiNode(node);\n        }else{\n            for (var i in graphcanvas.selected_nodes) {\n                fApplyMultiNode(graphcanvas.selected_nodes[i]);\n            }\n        }\n\n        graph.afterChange();\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.onMenuNodeToSubgraph = function(value, options, e, menu, node) {\n        var graph = node.graph;\n        var graphcanvas = LGraphCanvas.active_canvas;\n        if(!graphcanvas) //??\n            return;\n\n        var nodes_list = Object.values( graphcanvas.selected_nodes || {} );\n        if( !nodes_list.length )\n            nodes_list = [ node ];\n\n        var subgraph_node = LiteGraph.createNode(\"graph/subgraph\");\n        subgraph_node.pos = node.pos.concat();\n        graph.add(subgraph_node);\n\n        subgraph_node.buildFromNodes( nodes_list );\n\n        graphcanvas.deselectAllNodes();\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.onMenuNodeClone = function(value, options, e, menu, node) {\n\n        node.graph.beforeChange();\n\n        var newSelected = {};\n\n        var fApplyMultiNode = function(node){\n            if (node.clonable === false) {\n                return;\n            }\n            var newnode = node.clone();\n            if (!newnode) {\n                return;\n            }\n            newnode.pos = [node.pos[0] + 5, node.pos[1] + 5];\n            node.graph.add(newnode);\n            newSelected[newnode.id] = newnode;\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n            fApplyMultiNode(node);\n        }else{\n            for (var i in graphcanvas.selected_nodes) {\n                fApplyMultiNode(graphcanvas.selected_nodes[i]);\n            }\n        }\n\n        if(Object.keys(newSelected).length){\n            graphcanvas.selectNodes(newSelected);\n        }\n\n        node.graph.afterChange();\n\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.node_colors = {\n        red: { color: \"#322\", bgcolor: \"#533\", groupcolor: \"#A88\" },\n        brown: { color: \"#332922\", bgcolor: \"#593930\", groupcolor: \"#b06634\" },\n        green: { color: \"#232\", bgcolor: \"#353\", groupcolor: \"#8A8\" },\n        blue: { color: \"#223\", bgcolor: \"#335\", groupcolor: \"#88A\" },\n        pale_blue: {\n            color: \"#2a363b\",\n            bgcolor: \"#3f5159\",\n            groupcolor: \"#3f789e\"\n        },\n        cyan: { color: \"#233\", bgcolor: \"#355\", groupcolor: \"#8AA\" },\n        purple: { color: \"#323\", bgcolor: \"#535\", groupcolor: \"#a1309b\" },\n        yellow: { color: \"#432\", bgcolor: \"#653\", groupcolor: \"#b58b2a\" },\n        black: { color: \"#222\", bgcolor: \"#000\", groupcolor: \"#444\" }\n    };\n\n    LGraphCanvas.prototype.getCanvasMenuOptions = function() {\n        var options = null;\n        var that = this;\n        if (this.getMenuOptions) {\n            options = this.getMenuOptions();\n        } else {\n            options = [\n                {\n                    content: \"Add Node\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuAdd\n                },\n                { content: \"Add Group\", callback: LGraphCanvas.onGroupAdd },\n                //{ content: \"Arrange\", callback: that.graph.arrange },\n                //{content:\"Collapse All\", callback: LGraphCanvas.onMenuCollapseAll }\n            ];\n            /*if (LiteGraph.showCanvasOptions){\n                options.push({ content: \"Options\", callback: that.showShowGraphOptionsPanel });\n            }*/\n\n            if (Object.keys(this.selected_nodes).length > 1) {\n                options.push({\n                    content: \"Align\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onGroupAlign,\n                })\n            }\n\n            if (this._graph_stack && this._graph_stack.length > 0) {\n                options.push(null, {\n                    content: \"Close subgraph\",\n                    callback: this.closeSubgraph.bind(this)\n                });\n            }\n        }\n\n        if (this.getExtraMenuOptions) {\n            var extra = this.getExtraMenuOptions(this, options);\n            if (extra) {\n                options = options.concat(extra);\n            }\n        }\n\n        return options;\n    };\n\n    //called by processContextMenu to extract the menu list\n    LGraphCanvas.prototype.getNodeMenuOptions = function(node) {\n        var options = null;\n\n        if (node.getMenuOptions) {\n            options = node.getMenuOptions(this);\n        } else {\n            options = [\n                {\n                    content: \"Inputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalInputs\n                },\n                {\n                    content: \"Outputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalOutputs\n                },\n                null,\n                {\n                    content: \"Properties\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onShowMenuNodeProperties\n                },\n                {\n                    content: \"Properties Panel\",\n                    callback: function(item, options, e, menu, node) { LGraphCanvas.active_canvas.showShowNodePanel(node) }\n                },\n                null,\n                {\n                    content: \"Title\",\n                    callback: LGraphCanvas.onShowPropertyEditor\n                },\n                {\n                    content: \"Mode\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeMode\n                }];\n            if(node.resizable !== false){\n                options.push({\n                    content: \"Resize\", callback: LGraphCanvas.onMenuResizeNode\n                });\n            }\n            options.push(\n                {\n                    content: \"Collapse\",\n                    callback: LGraphCanvas.onMenuNodeCollapse\n                },\n                { content: \"Pin\", callback: LGraphCanvas.onMenuNodePin },\n                {\n                    content: \"Colors\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeColors\n                },\n                {\n                    content: \"Shapes\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeShapes\n                },\n                null\n            );\n        }\n\n        if (node.onGetInputs) {\n            var inputs = node.onGetInputs();\n            if (inputs && inputs.length) {\n                options[0].disabled = false;\n            }\n        }\n\n        if (node.onGetOutputs) {\n            var outputs = node.onGetOutputs();\n            if (outputs && outputs.length) {\n                options[1].disabled = false;\n            }\n        }\n\n        if (node.getExtraMenuOptions) {\n            var extra = node.getExtraMenuOptions(this, options);\n            if (extra) {\n                extra.push(null);\n                options = extra.concat(options);\n            }\n        }\n\n        if (node.clonable !== false) {\n            options.push({\n                content: \"Clone\",\n                callback: LGraphCanvas.onMenuNodeClone\n            });\n        }\n\n        if(0) //TODO\n            options.push({\n                content: \"To Subgraph\",\n                callback: LGraphCanvas.onMenuNodeToSubgraph\n            });\n\n        if (Object.keys(this.selected_nodes).length > 1) {\n            options.push({\n                content: \"Align Selected To\",\n                has_submenu: true,\n                callback: LGraphCanvas.onNodeAlign,\n            })\n        }\n\n        options.push(null, {\n            content: \"Remove\",\n            disabled: !(node.removable !== false && !node.block_delete ),\n            callback: LGraphCanvas.onMenuNodeRemove\n        });\n\n        if (node.graph && node.graph.onGetNodeMenuOptions) {\n            node.graph.onGetNodeMenuOptions(options, node);\n        }\n\n        return options;\n    };\n\n    LGraphCanvas.prototype.getGroupMenuOptions = function(node) {\n        var o = [\n            { content: \"Title\", callback: LGraphCanvas.onShowPropertyEditor },\n            {\n                content: \"Color\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeColors\n            },\n            {\n                content: \"Font size\",\n                property: \"font_size\",\n                type: \"Number\",\n                callback: LGraphCanvas.onShowPropertyEditor\n            },\n            null,\n            { content: \"Remove\", callback: LGraphCanvas.onMenuNodeRemove }\n        ];\n\n        return o;\n    };\n\n    LGraphCanvas.prototype.processContextMenu = function(node, event) {\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var menu_info = null;\n        var options = {\n            event: event,\n            callback: inner_option_clicked,\n            extra: node\n        };\n\n        if(node)\n            options.title = node.type;\n\n        //check if mouse is in input\n        var slot = null;\n        if (node) {\n            slot = node.getSlotInPosition(event.canvasX, event.canvasY);\n            LGraphCanvas.active_node = node;\n        }\n\n        if (slot) {\n            //on slot\n            menu_info = [];\n            if (node.getSlotMenuOptions) {\n                menu_info = node.getSlotMenuOptions(slot);\n            } else {\n                if (\n                    slot &&\n                    slot.output &&\n                    slot.output.links &&\n                    slot.output.links.length\n                ) {\n                    menu_info.push({ content: \"Disconnect Links\", slot: slot });\n                }\n                var _slot = slot.input || slot.output;\n                if (_slot.removable){\n                    menu_info.push(\n                        _slot.locked\n                            ? \"Cannot remove\"\n                            : { content: \"Remove Slot\", slot: slot }\n                    );\n                }\n                if (!_slot.nameLocked){\n                    menu_info.push({ content: \"Rename Slot\", slot: slot });\n                }\n\n            }\n            options.title =\n                (slot.input ? slot.input.type : slot.output.type) || \"*\";\n            if (slot.input && slot.input.type == LiteGraph.ACTION) {\n                options.title = \"Action\";\n            }\n            if (slot.output && slot.output.type == LiteGraph.EVENT) {\n                options.title = \"Event\";\n            }\n        } else {\n            if (node) {\n                //on node\n                menu_info = this.getNodeMenuOptions(node);\n            } else {\n                menu_info = this.getCanvasMenuOptions();\n                var group = this.graph.getGroupOnPos(\n                    event.canvasX,\n                    event.canvasY\n                );\n                if (group) {\n                    //on group\n                    menu_info.push(null, {\n                        content: \"Edit Group\",\n                        has_submenu: true,\n                        submenu: {\n                            title: \"Group\",\n                            extra: group,\n                            options: this.getGroupMenuOptions(group)\n                        }\n                    });\n                }\n            }\n        }\n\n        //show menu\n        if (!menu_info) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(menu_info, options, ref_window);\n\n        function inner_option_clicked(v, options, e) {\n            if (!v) {\n                return;\n            }\n\n            if (v.content == \"Remove Slot\") {\n                var info = v.slot;\n                node.graph.beforeChange();\n                if (info.input) {\n                    node.removeInput(info.slot);\n                } else if (info.output) {\n                    node.removeOutput(info.slot);\n                }\n                node.graph.afterChange();\n                return;\n            } else if (v.content == \"Disconnect Links\") {\n                var info = v.slot;\n                node.graph.beforeChange();\n                if (info.output) {\n                    node.disconnectOutput(info.slot);\n                } else if (info.input) {\n                    node.disconnectInput(info.slot);\n                }\n                node.graph.afterChange();\n                return;\n            } else if (v.content == \"Rename Slot\") {\n                var info = v.slot;\n                var slot_info = info.input\n                    ? node.getInputInfo(info.slot)\n                    : node.getOutputInfo(info.slot);\n                var dialog = that.createDialog(\n                    \"<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>\",\n                    options\n                );\n                var input = dialog.querySelector(\"input\");\n                if (input && slot_info) {\n                    input.value = slot_info.label || \"\";\n                }\n                var inner = function(){\n                    node.graph.beforeChange();\n                    if (input.value) {\n                        if (slot_info) {\n                            slot_info.label = input.value;\n                        }\n                        that.setDirty(true);\n                    }\n                    dialog.close();\n                    node.graph.afterChange();\n                }\n                dialog.querySelector(\"button\").addEventListener(\"click\", inner);\n                input.addEventListener(\"keydown\", function(e) {\n                    dialog.is_modified = true;\n                    if (e.keyCode == 27) {\n                        //ESC\n                        dialog.close();\n                    } else if (e.keyCode == 13) {\n                        inner(); // save\n                    } else if (e.keyCode != 13 && e.target.localName != \"textarea\") {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n                input.focus();\n            }\n\n            //if(v.callback)\n            //\treturn v.callback.call(that, node, options, e, menu, that, event );\n        }\n    };\n\n    //API *************************************************\n    //like rect but rounded corners\n    if (typeof(window) != \"undefined\" && window.CanvasRenderingContext2D && !window.CanvasRenderingContext2D.prototype.roundRect) {\n        window.CanvasRenderingContext2D.prototype.roundRect = function(\n            x,\n            y,\n            w,\n            h,\n            radius,\n            radius_low\n        ) {\n            var top_left_radius = 0;\n            var top_right_radius = 0;\n            var bottom_left_radius = 0;\n            var bottom_right_radius = 0;\n\n            if ( radius === 0 )\n            {\n                this.rect(x,y,w,h);\n                return;\n            }\n\n            if(radius_low === undefined)\n                radius_low = radius;\n\n            //make it compatible with official one\n            if(radius != null && radius.constructor === Array)\n            {\n                if(radius.length == 1)\n                    top_left_radius = top_right_radius = bottom_left_radius = bottom_right_radius = radius[0];\n                else if(radius.length == 2)\n                {\n                    top_left_radius = bottom_right_radius = radius[0];\n                    top_right_radius = bottom_left_radius = radius[1];\n                }\n                else if(radius.length == 4)\n                {\n                    top_left_radius = radius[0];\n                    top_right_radius = radius[1];\n                    bottom_left_radius = radius[2];\n                    bottom_right_radius = radius[3];\n                }\n                else\n                    return;\n            }\n            else //old using numbers\n            {\n                top_left_radius = radius || 0;\n                top_right_radius = radius || 0;\n                bottom_left_radius = radius_low || 0;\n                bottom_right_radius = radius_low || 0;\n            }\n\n            //top right\n            this.moveTo(x + top_left_radius, y);\n            this.lineTo(x + w - top_right_radius, y);\n            this.quadraticCurveTo(x + w, y, x + w, y + top_right_radius);\n\n            //bottom right\n            this.lineTo(x + w, y + h - bottom_right_radius);\n            this.quadraticCurveTo(\n                x + w,\n                y + h,\n                x + w - bottom_right_radius,\n                y + h\n            );\n\n            //bottom left\n            this.lineTo(x + bottom_right_radius, y + h);\n            this.quadraticCurveTo(x, y + h, x, y + h - bottom_left_radius);\n\n            //top left\n            this.lineTo(x, y + bottom_left_radius);\n            this.quadraticCurveTo(x, y, x + top_left_radius, y);\n        };\n    }//if\n\n    function compareObjects(a, b) {\n        for (var i in a) {\n            if (a[i] != b[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    LiteGraph.compareObjects = compareObjects;\n\n    function distance(a, b) {\n        return Math.sqrt(\n            (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1])\n        );\n    }\n    LiteGraph.distance = distance;\n\n    function colorToString(c) {\n        return (\n            \"rgba(\" +\n            Math.round(c[0] * 255).toFixed() +\n            \",\" +\n            Math.round(c[1] * 255).toFixed() +\n            \",\" +\n            Math.round(c[2] * 255).toFixed() +\n            \",\" +\n            (c.length == 4 ? c[3].toFixed(2) : \"1.0\") +\n            \")\"\n        );\n    }\n    LiteGraph.colorToString = colorToString;\n\n    function isInsideRectangle(x, y, left, top, width, height) {\n        if (left < x && left + width > x && top < y && top + height > y) {\n            return true;\n        }\n        return false;\n    }\n    LiteGraph.isInsideRectangle = isInsideRectangle;\n\n    //[minx,miny,maxx,maxy]\n    function growBounding(bounding, x, y) {\n        if (x < bounding[0]) {\n            bounding[0] = x;\n        } else if (x > bounding[2]) {\n            bounding[2] = x;\n        }\n\n        if (y < bounding[1]) {\n            bounding[1] = y;\n        } else if (y > bounding[3]) {\n            bounding[3] = y;\n        }\n    }\n    LiteGraph.growBounding = growBounding;\n\n    //point inside bounding box\n    function isInsideBounding(p, bb) {\n        if (\n            p[0] < bb[0][0] ||\n            p[1] < bb[0][1] ||\n            p[0] > bb[1][0] ||\n            p[1] > bb[1][1]\n        ) {\n            return false;\n        }\n        return true;\n    }\n    LiteGraph.isInsideBounding = isInsideBounding;\n\n    //bounding overlap, format: [ startx, starty, width, height ]\n    function overlapBounding(a, b) {\n        var A_end_x = a[0] + a[2];\n        var A_end_y = a[1] + a[3];\n        var B_end_x = b[0] + b[2];\n        var B_end_y = b[1] + b[3];\n\n        if (\n            a[0] > B_end_x ||\n            a[1] > B_end_y ||\n            A_end_x < b[0] ||\n            A_end_y < b[1]\n        ) {\n            return false;\n        }\n        return true;\n    }\n    LiteGraph.overlapBounding = overlapBounding;\n\n    //Convert a hex value to its decimal value - the inputted hex must be in the\n    //\tformat of a hex triplet - the kind we use for HTML colours. The function\n    //\twill return an array with three values.\n    function hex2num(hex) {\n        if (hex.charAt(0) == \"#\") {\n            hex = hex.slice(1);\n        } //Remove the '#' char - if there is one.\n        hex = hex.toUpperCase();\n        var hex_alphabets = \"0123456789ABCDEF\";\n        var value = new Array(3);\n        var k = 0;\n        var int1, int2;\n        for (var i = 0; i < 6; i += 2) {\n            int1 = hex_alphabets.indexOf(hex.charAt(i));\n            int2 = hex_alphabets.indexOf(hex.charAt(i + 1));\n            value[k] = int1 * 16 + int2;\n            k++;\n        }\n        return value;\n    }\n\n    LiteGraph.hex2num = hex2num;\n\n    //Give a array with three values as the argument and the function will return\n    //\tthe corresponding hex triplet.\n    function num2hex(triplet) {\n        var hex_alphabets = \"0123456789ABCDEF\";\n        var hex = \"#\";\n        var int1, int2;\n        for (var i = 0; i < 3; i++) {\n            int1 = triplet[i] / 16;\n            int2 = triplet[i] % 16;\n\n            hex += hex_alphabets.charAt(int1) + hex_alphabets.charAt(int2);\n        }\n        return hex;\n    }\n\n    LiteGraph.num2hex = num2hex;\n\n    /* LiteGraph GUI elements used for canvas editing *************************************/\n\n    /**\n     * ContextMenu from LiteGUI\n     *\n     * @class ContextMenu\n     * @constructor\n     * @param {Array} values (allows object { title: \"Nice text\", callback: function ... })\n     * @param {Object} options [optional] Some options:\\\n     * - title: title to show on top of the menu\n     * - callback: function to call when an option is clicked, it receives the item information\n     * - ignore_item_callbacks: ignores the callback inside the item, it just calls the options.callback\n     * - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\n     */\n    function ContextMenu(values, options) {\n        options = options || {};\n        this.options = options;\n        var that = this;\n\n        //to link a menu with its parent\n        if (options.parentMenu) {\n            if (options.parentMenu.constructor !== this.constructor) {\n                console.error(\n                    \"parentMenu must be of class ContextMenu, ignoring it\"\n                );\n                options.parentMenu = null;\n            } else {\n                this.parentMenu = options.parentMenu;\n                this.parentMenu.lock = true;\n                this.parentMenu.current_submenu = this;\n            }\n        }\n\n        var eventClass = null;\n        if(options.event) //use strings because comparing classes between windows doesnt work\n            eventClass = options.event.constructor.name;\n        if ( eventClass !== \"MouseEvent\" &&\n            eventClass !== \"CustomEvent\" &&\n            eventClass !== \"PointerEvent\"\n        ) {\n            console.error(\n                \"Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it. (\"+eventClass+\")\"\n            );\n            options.event = null;\n        }\n\n        var root = document.createElement(\"div\");\n        root.className = \"litegraph litecontextmenu litemenubar-panel\";\n        if (options.className) {\n            root.className += \" \" + options.className;\n        }\n        root.style.minWidth = 100;\n        root.style.minHeight = 100;\n        root.style.pointerEvents = \"none\";\n        setTimeout(function() {\n            root.style.pointerEvents = \"auto\";\n        }, 100); //delay so the mouse up event is not caught by this element\n\n        //this prevents the default context browser menu to open in case this menu was created when pressing right button\n        LiteGraph.pointerListenerAdd(root,\"up\",\n            function(e) {\n                //console.log(\"pointerevents: ContextMenu up root prevent\");\n                e.preventDefault();\n                return true;\n            },\n            true\n        );\n        root.addEventListener(\n            \"contextmenu\",\n            function(e) {\n                if (e.button != 2) {\n                    //right button\n                    return false;\n                }\n                e.preventDefault();\n                return false;\n            },\n            true\n        );\n\n        LiteGraph.pointerListenerAdd(root,\"down\",\n            function(e) {\n                //console.log(\"pointerevents: ContextMenu down\");\n                if (e.button == 2) {\n                    that.close();\n                    e.preventDefault();\n                    return true;\n                }\n            },\n            true\n        );\n\n        function on_mouse_wheel(e) {\n            var pos = parseInt(root.style.top);\n            root.style.top =\n                (pos + e.deltaY * options.scroll_speed).toFixed() + \"px\";\n            e.preventDefault();\n            return true;\n        }\n\n        if (!options.scroll_speed) {\n            options.scroll_speed = 0.1;\n        }\n\n        root.addEventListener(\"wheel\", on_mouse_wheel, true);\n        root.addEventListener(\"mousewheel\", on_mouse_wheel, true);\n\n        this.root = root;\n\n        //title\n        if (options.title) {\n            var element = document.createElement(\"div\");\n            element.className = \"litemenu-title\";\n            element.innerHTML = options.title;\n            root.appendChild(element);\n        }\n\n        //entries\n        var num = 0;\n        for (var i=0; i < values.length; i++) {\n            var name = values.constructor == Array ? values[i] : i;\n            if (name != null && name.constructor !== String) {\n                name = name.content === undefined ? String(name) : name.content;\n            }\n            var value = values[i];\n            this.addItem(name, value, options);\n            num++;\n        }\n\n        //close on leave? touch enabled devices won't work TODO use a global device detector and condition on that\n        /*LiteGraph.pointerListenerAdd(root,\"leave\", function(e) {\n\t\t  \tconsole.log(\"pointerevents: ContextMenu leave\");\n            if (that.lock) {\n                return;\n            }\n            if (root.closing_timer) {\n                clearTimeout(root.closing_timer);\n            }\n            root.closing_timer = setTimeout(that.close.bind(that, e), 500);\n            //that.close(e);\n        });*/\n\n        LiteGraph.pointerListenerAdd(root,\"enter\", function(e) {\n            //console.log(\"pointerevents: ContextMenu enter\");\n            if (root.closing_timer) {\n                clearTimeout(root.closing_timer);\n            }\n        });\n\n        //insert before checking position\n        var root_document = document;\n        if (options.event) {\n            root_document = options.event.target.ownerDocument;\n        }\n\n        if (!root_document) {\n            root_document = document;\n        }\n\n        if( root_document.fullscreenElement )\n            root_document.fullscreenElement.appendChild(root);\n        else\n            root_document.body.appendChild(root);\n\n        //compute best position\n        var left = options.left || 0;\n        var top = options.top || 0;\n        if (options.event) {\n            left = options.event.clientX - 10;\n            top = options.event.clientY - 10;\n            if (options.title) {\n                top -= 20;\n            }\n\n            if (options.parentMenu) {\n                var rect = options.parentMenu.root.getBoundingClientRect();\n                left = rect.left + rect.width;\n            }\n\n            var body_rect = document.body.getBoundingClientRect();\n            var root_rect = root.getBoundingClientRect();\n            if(body_rect.height == 0)\n                console.error(\"document.body height is 0. That is dangerous, set html,body { height: 100%; }\");\n\n            if (body_rect.width && left > body_rect.width - root_rect.width - 10) {\n                left = body_rect.width - root_rect.width - 10;\n            }\n            if (body_rect.height && top > body_rect.height - root_rect.height - 10) {\n                top = body_rect.height - root_rect.height - 10;\n            }\n        }\n\n        root.style.left = left + \"px\";\n        root.style.top = top + \"px\";\n\n        if (options.scale) {\n            root.style.transform = \"scale(\" + options.scale + \")\";\n        }\n    }\n\n    ContextMenu.prototype.addItem = function(name, value, options) {\n        var that = this;\n        options = options || {};\n\n        var element = document.createElement(\"div\");\n        element.className = \"litemenu-entry submenu\";\n\n        var disabled = false;\n\n        if (value === null) {\n            element.classList.add(\"separator\");\n            //element.innerHTML = \"<hr/>\"\n            //continue;\n        } else {\n            element.innerHTML = value && value.title ? value.title : name;\n            element.value = value;\n\n            if (value) {\n                if (value.disabled) {\n                    disabled = true;\n                    element.classList.add(\"disabled\");\n                }\n                if (value.submenu || value.has_submenu) {\n                    element.classList.add(\"has_submenu\");\n                }\n            }\n\n            if (typeof value == \"function\") {\n                element.dataset[\"value\"] = name;\n                element.onclick_callback = value;\n            } else {\n                element.dataset[\"value\"] = value;\n            }\n\n            if (value.className) {\n                element.className += \" \" + value.className;\n            }\n        }\n\n        this.root.appendChild(element);\n        if (!disabled) {\n            element.addEventListener(\"click\", inner_onclick);\n        }\n        if (!disabled && options.autoopen) {\n            LiteGraph.pointerListenerAdd(element,\"enter\",inner_over);\n        }\n\n        function inner_over(e) {\n            var value = this.value;\n            if (!value || !value.has_submenu) {\n                return;\n            }\n            //if it is a submenu, autoopen like the item was clicked\n            inner_onclick.call(this, e);\n        }\n\n        //menu option clicked\n        function inner_onclick(e) {\n            var value = this.value;\n            var close_parent = true;\n\n            if (that.current_submenu) {\n                that.current_submenu.close(e);\n            }\n\n            //global callback\n            if (options.callback) {\n                var r = options.callback.call(\n                    this,\n                    value,\n                    options,\n                    e,\n                    that,\n                    options.node\n                );\n                if (r === true) {\n                    close_parent = false;\n                }\n            }\n\n            //special cases\n            if (value) {\n                if (\n                    value.callback &&\n                    !options.ignore_item_callbacks &&\n                    value.disabled !== true\n                ) {\n                    //item callback\n                    var r = value.callback.call(\n                        this,\n                        value,\n                        options,\n                        e,\n                        that,\n                        options.extra\n                    );\n                    if (r === true) {\n                        close_parent = false;\n                    }\n                }\n                if (value.submenu) {\n                    if (!value.submenu.options) {\n                        throw \"ContextMenu submenu needs options\";\n                    }\n                    var submenu = new that.constructor(value.submenu.options, {\n                        callback: value.submenu.callback,\n                        event: e,\n                        parentMenu: that,\n                        ignore_item_callbacks:\n                        value.submenu.ignore_item_callbacks,\n                        title: value.submenu.title,\n                        extra: value.submenu.extra,\n                        autoopen: options.autoopen\n                    });\n                    close_parent = false;\n                }\n            }\n\n            if (close_parent && !that.lock) {\n                that.close();\n            }\n        }\n\n        return element;\n    };\n\n    ContextMenu.prototype.close = function(e, ignore_parent_menu) {\n        if (this.root.parentNode) {\n            this.root.parentNode.removeChild(this.root);\n        }\n        if (this.parentMenu && !ignore_parent_menu) {\n            this.parentMenu.lock = false;\n            this.parentMenu.current_submenu = null;\n            if (e === undefined) {\n                this.parentMenu.close();\n            } else if (\n                e &&\n                !ContextMenu.isCursorOverElement(e, this.parentMenu.root)\n            ) {\n                ContextMenu.trigger(this.parentMenu.root, LiteGraph.pointerevents_method+\"leave\", e);\n            }\n        }\n        if (this.current_submenu) {\n            this.current_submenu.close(e, true);\n        }\n\n        if (this.root.closing_timer) {\n            clearTimeout(this.root.closing_timer);\n        }\n\n        // TODO implement : LiteGraph.contextMenuClosed(); :: keep track of opened / closed / current ContextMenu\n        // on key press, allow filtering/selecting the context menu elements\n    };\n\n    //this code is used to trigger events easily (used in the context menu mouseleave\n    ContextMenu.trigger = function(element, event_name, params, origin) {\n        var evt = document.createEvent(\"CustomEvent\");\n        evt.initCustomEvent(event_name, true, true, params); //canBubble, cancelable, detail\n        evt.srcElement = origin;\n        if (element.dispatchEvent) {\n            element.dispatchEvent(evt);\n        } else if (element.__events) {\n            element.__events.dispatchEvent(evt);\n        }\n        //else nothing seems binded here so nothing to do\n        return evt;\n    };\n\n    //returns the top most menu\n    ContextMenu.prototype.getTopMenu = function() {\n        if (this.options.parentMenu) {\n            return this.options.parentMenu.getTopMenu();\n        }\n        return this;\n    };\n\n    ContextMenu.prototype.getFirstEvent = function() {\n        if (this.options.parentMenu) {\n            return this.options.parentMenu.getFirstEvent();\n        }\n        return this.options.event;\n    };\n\n    ContextMenu.isCursorOverElement = function(event, element) {\n        var left = event.clientX;\n        var top = event.clientY;\n        var rect = element.getBoundingClientRect();\n        if (!rect) {\n            return false;\n        }\n        if (\n            top > rect.top &&\n            top < rect.top + rect.height &&\n            left > rect.left &&\n            left < rect.left + rect.width\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    LiteGraph.ContextMenu = ContextMenu;\n\n    LiteGraph.closeAllContextMenus = function(ref_window) {\n        ref_window = ref_window || window;\n\n        var elements = ref_window.document.querySelectorAll(\".litecontextmenu\");\n        if (!elements.length) {\n            return;\n        }\n\n        var result = [];\n        for (var i = 0; i < elements.length; i++) {\n            result.push(elements[i]);\n        }\n\n        for (var i=0; i < result.length; i++) {\n            if (result[i].close) {\n                result[i].close();\n            } else if (result[i].parentNode) {\n                result[i].parentNode.removeChild(result[i]);\n            }\n        }\n    };\n\n    LiteGraph.extendClass = function(target, origin) {\n        for (var i in origin) {\n            //copy class properties\n            if (target.hasOwnProperty(i)) {\n                continue;\n            }\n            target[i] = origin[i];\n        }\n\n        if (origin.prototype) {\n            //copy prototype properties\n            for (var i in origin.prototype) {\n                //only enumerable\n                if (!origin.prototype.hasOwnProperty(i)) {\n                    continue;\n                }\n\n                if (target.prototype.hasOwnProperty(i)) {\n                    //avoid overwriting existing ones\n                    continue;\n                }\n\n                //copy getters\n                if (origin.prototype.__lookupGetter__(i)) {\n                    target.prototype.__defineGetter__(\n                        i,\n                        origin.prototype.__lookupGetter__(i)\n                    );\n                } else {\n                    target.prototype[i] = origin.prototype[i];\n                }\n\n                //and setters\n                if (origin.prototype.__lookupSetter__(i)) {\n                    target.prototype.__defineSetter__(\n                        i,\n                        origin.prototype.__lookupSetter__(i)\n                    );\n                }\n            }\n        }\n    };\n\n    //used by some widgets to render a curve editor\n    function CurveEditor( points )\n    {\n        this.points = points;\n        this.selected = -1;\n        this.nearest = -1;\n        this.size = null; //stores last size used\n        this.must_update = true;\n        this.margin = 5;\n    }\n\n    CurveEditor.sampleCurve = function(f,points)\n    {\n        if(!points)\n            return;\n        for(var i = 0; i < points.length - 1; ++i)\n        {\n            var p = points[i];\n            var pn = points[i+1];\n            if(pn[0] < f)\n                continue;\n            var r = (pn[0] - p[0]);\n            if( Math.abs(r) < 0.00001 )\n                return p[1];\n            var local_f = (f - p[0]) / r;\n            return p[1] * (1.0 - local_f) + pn[1] * local_f;\n        }\n        return 0;\n    }\n\n    CurveEditor.prototype.draw = function( ctx, size, graphcanvas, background_color, line_color, inactive )\n    {\n        var points = this.points;\n        if(!points)\n            return;\n        this.size = size;\n        var w = size[0] - this.margin * 2;\n        var h = size[1] - this.margin * 2;\n\n        line_color = line_color || \"#666\";\n\n        ctx.save();\n        ctx.translate(this.margin,this.margin);\n\n        if(background_color)\n        {\n            ctx.fillStyle = \"#111\";\n            ctx.fillRect(0,0,w,h);\n            ctx.fillStyle = \"#222\";\n            ctx.fillRect(w*0.5,0,1,h);\n            ctx.strokeStyle = \"#333\";\n            ctx.strokeRect(0,0,w,h);\n        }\n        ctx.strokeStyle = line_color;\n        if(inactive)\n            ctx.globalAlpha = 0.5;\n        ctx.beginPath();\n        for(var i = 0; i < points.length; ++i)\n        {\n            var p = points[i];\n            ctx.lineTo( p[0] * w, (1.0 - p[1]) * h );\n        }\n        ctx.stroke();\n        ctx.globalAlpha = 1;\n        if(!inactive)\n            for(var i = 0; i < points.length; ++i)\n            {\n                var p = points[i];\n                ctx.fillStyle = this.selected == i ? \"#FFF\" : (this.nearest == i ? \"#DDD\" : \"#AAA\");\n                ctx.beginPath();\n                ctx.arc( p[0] * w, (1.0 - p[1]) * h, 2, 0, Math.PI * 2 );\n                ctx.fill();\n            }\n        ctx.restore();\n    }\n\n    //localpos is mouse in curve editor space\n    CurveEditor.prototype.onMouseDown = function( localpos, graphcanvas )\n    {\n        var points = this.points;\n        if(!points)\n            return;\n        if( localpos[1] < 0 )\n            return;\n\n        //this.captureInput(true);\n        var w = this.size[0] - this.margin * 2;\n        var h = this.size[1] - this.margin * 2;\n        var x = localpos[0] - this.margin;\n        var y = localpos[1] - this.margin;\n        var pos = [x,y];\n        var max_dist = 30 / graphcanvas.ds.scale;\n        //search closer one\n        this.selected = this.getCloserPoint(pos, max_dist);\n        //create one\n        if(this.selected == -1)\n        {\n            var point = [x / w, 1 - y / h];\n            points.push(point);\n            points.sort(function(a,b){ return a[0] - b[0]; });\n            this.selected = points.indexOf(point);\n            this.must_update = true;\n        }\n        if(this.selected != -1)\n            return true;\n    }\n\n    CurveEditor.prototype.onMouseMove = function( localpos, graphcanvas )\n    {\n        var points = this.points;\n        if(!points)\n            return;\n        var s = this.selected;\n        if(s < 0)\n            return;\n        var x = (localpos[0] - this.margin) / (this.size[0] - this.margin * 2 );\n        var y = (localpos[1] - this.margin) / (this.size[1] - this.margin * 2 );\n        var curvepos = [(localpos[0] - this.margin),(localpos[1] - this.margin)];\n        var max_dist = 30 / graphcanvas.ds.scale;\n        this._nearest = this.getCloserPoint(curvepos, max_dist);\n        var point = points[s];\n        if(point)\n        {\n            var is_edge_point = s == 0 || s == points.length - 1;\n            if( !is_edge_point && (localpos[0] < -10 || localpos[0] > this.size[0] + 10 || localpos[1] < -10 || localpos[1] > this.size[1] + 10) )\n            {\n                points.splice(s,1);\n                this.selected = -1;\n                return;\n            }\n            if( !is_edge_point ) //not edges\n                point[0] = clamp(x, 0, 1);\n            else\n                point[0] = s == 0 ? 0 : 1;\n            point[1] = 1.0 - clamp(y, 0, 1);\n            points.sort(function(a,b){ return a[0] - b[0]; });\n            this.selected = points.indexOf(point);\n            this.must_update = true;\n        }\n    }\n\n    CurveEditor.prototype.onMouseUp = function( localpos, graphcanvas )\n    {\n        this.selected = -1;\n        return false;\n    }\n\n    CurveEditor.prototype.getCloserPoint = function(pos, max_dist)\n    {\n        var points = this.points;\n        if(!points)\n            return -1;\n        max_dist = max_dist || 30;\n        var w = (this.size[0] - this.margin * 2);\n        var h = (this.size[1] - this.margin * 2);\n        var num = points.length;\n        var p2 = [0,0];\n        var min_dist = 1000000;\n        var closest = -1;\n        var last_valid = -1;\n        for(var i = 0; i < num; ++i)\n        {\n            var p = points[i];\n            p2[0] = p[0] * w;\n            p2[1] = (1.0 - p[1]) * h;\n            if(p2[0] < pos[0])\n                last_valid = i;\n            var dist = vec2.distance(pos,p2);\n            if(dist > min_dist || dist > max_dist)\n                continue;\n            closest = i;\n            min_dist = dist;\n        }\n        return closest;\n    }\n\n    LiteGraph.CurveEditor = CurveEditor;\n\n    //used to create nodes from wrapping functions\n    LiteGraph.getParameterNames = function(func) {\n        return (func + \"\")\n            .replace(/[/][/].*$/gm, \"\") // strip single-line comments\n            .replace(/\\s+/g, \"\") // strip white space\n            .replace(/[/][*][^/*]*[*][/]/g, \"\") // strip multi-line comments  /**/\n            .split(\"){\", 1)[0]\n            .replace(/^[^(]*[(]/, \"\") // extract the parameters\n            .replace(/=[^,]+/g, \"\") // strip any ES6 defaults\n            .split(\",\")\n            .filter(Boolean); // split & filter [\"\"]\n    };\n\n    /* helper for interaction: pointer, touch, mouse Listeners\n    used by LGraphCanvas DragAndScale ContextMenu*/\n    LiteGraph.pointerListenerAdd = function(oDOM, sEvIn, fCall, capture=false) {\n        if (!oDOM || !oDOM.addEventListener || !sEvIn || typeof fCall!==\"function\"){\n            //console.log(\"cant pointerListenerAdd \"+oDOM+\", \"+sEvent+\", \"+fCall);\n            return; // -- break --\n        }\n\n        var sMethod = LiteGraph.pointerevents_method;\n        var sEvent = sEvIn;\n\n        // UNDER CONSTRUCTION\n        // convert pointerevents to touch event when not available\n        if (sMethod==\"pointer\" && !window.PointerEvent){\n            console.warn(\"sMethod=='pointer' && !window.PointerEvent\");\n            console.log(\"Converting pointer[\"+sEvent+\"] : down move up cancel enter TO touchstart touchmove touchend, etc ..\");\n            switch(sEvent){\n                case \"down\":{\n                    sMethod = \"touch\";\n                    sEvent = \"start\";\n                    break;\n                }\n                case \"move\":{\n                    sMethod = \"touch\";\n                    //sEvent = \"move\";\n                    break;\n                }\n                case \"up\":{\n                    sMethod = \"touch\";\n                    sEvent = \"end\";\n                    break;\n                }\n                case \"cancel\":{\n                    sMethod = \"touch\";\n                    //sEvent = \"cancel\";\n                    break;\n                }\n                case \"enter\":{\n                    console.log(\"debug: Should I send a move event?\"); // ???\n                    break;\n                }\n                // case \"over\": case \"out\": not used at now\n                default:{\n                    console.warn(\"PointerEvent not available in this browser ? The event \"+sEvent+\" would not be called\");\n                }\n            }\n        }\n\n        switch(sEvent){\n            //both pointer and move events\n            case \"down\": case \"up\": case \"move\": case \"over\": case \"out\": case \"enter\":\n            {\n                oDOM.addEventListener(sMethod+sEvent, fCall, capture);\n            }\n            // only pointerevents\n            case \"leave\": case \"cancel\": case \"gotpointercapture\": case \"lostpointercapture\":\n            {\n                if (sMethod!=\"mouse\"){\n                    return oDOM.addEventListener(sMethod+sEvent, fCall, capture);\n                }\n            }\n            // not \"pointer\" || \"mouse\"\n            default:\n                return oDOM.addEventListener(sEvent, fCall, capture);\n        }\n    }\n    LiteGraph.pointerListenerRemove = function(oDOM, sEvent, fCall, capture=false) {\n        if (!oDOM || !oDOM.removeEventListener || !sEvent || typeof fCall!==\"function\"){\n            //console.log(\"cant pointerListenerRemove \"+oDOM+\", \"+sEvent+\", \"+fCall);\n            return; // -- break --\n        }\n        switch(sEvent){\n            //both pointer and move events\n            case \"down\": case \"up\": case \"move\": case \"over\": case \"out\": case \"enter\":\n            {\n                if (LiteGraph.pointerevents_method==\"pointer\" || LiteGraph.pointerevents_method==\"mouse\"){\n                    oDOM.removeEventListener(LiteGraph.pointerevents_method+sEvent, fCall, capture);\n                }\n            }\n            // only pointerevents\n            case \"leave\": case \"cancel\": case \"gotpointercapture\": case \"lostpointercapture\":\n            {\n                if (LiteGraph.pointerevents_method==\"pointer\"){\n                    return oDOM.removeEventListener(LiteGraph.pointerevents_method+sEvent, fCall, capture);\n                }\n            }\n            // not \"pointer\" || \"mouse\"\n            default:\n                return oDOM.removeEventListener(sEvent, fCall, capture);\n        }\n    }\n\n    function clamp(v, a, b) {\n        return a > v ? a : b < v ? b : v;\n    };\n    global.clamp = clamp;\n\n    if (typeof window != \"undefined\" && !window[\"requestAnimationFrame\"]) {\n        window.requestAnimationFrame =\n            window.webkitRequestAnimationFrame ||\n            window.mozRequestAnimationFrame ||\n            function(callback) {\n                window.setTimeout(callback, 1000 / 60);\n            };\n    }\n})(window);\n\nif (typeof exports != \"undefined\") {\n    exports.LiteGraph = this.LiteGraph;\n    exports.LGraph = this.LGraph;\n    exports.LLink = this.LLink;\n    exports.LGraphNode = this.LGraphNode;\n    exports.LGraphGroup = this.LGraphGroup;\n    exports.DragAndScale = this.DragAndScale;\n    exports.LGraphCanvas = this.LGraphCanvas;\n    exports.ContextMenu = this.ContextMenu;\n}\n\n\n","import {ComfyUIPreparser} from '../Preparser/ComfyUIPreparser';\nimport {convertToApiJson} from \"../workflowjsonconverter/converter\";\nimport {transferWorkflowStore} from \"./TasksStore\";\nimport confirmDialog from \"./confirmDialog\";\n\n\nexport default class Comfy {\n\n    static getInstance(SDConfig) {\n        if (!this.instance) {\n            this.instance = new Comfy(SDConfig);\n        }\n        return this.instance;\n    }\n\n\n    async getLayerImage(layerName,layerID){\n        return new Promise((resolve) => {\n            let func = async (event) => {\n                let data = event.data;\n                if (data.key === \"sendLayerImage\"){\n                    if(data.error) this.stoperror = true;\n                    let randomname = (Math.random() + 1).toString(36).substring(7);\n                    await this.uploadImage(data.base64,randomname);\n                    //console.log(\"getImagelayer uploaded\",layerName);\n                    window.removeEventListener(\"message\",func);\n                    resolve(randomname);\n                }\n            }\n            window.addEventListener(\"message\",func)\n\n            window.postMessage({\n                key: \"getLayerImage\",\n                layerName,\n                layerID\n            })\n        });\n    }\n\n    async getSingleImage(propertyName, arrayName=\"\",index) {\n        return new Promise((resolve) => {\n            let func = async (event) => {\n                let data = event.data;\n                if (data.key === \"sendWorkflowImage\") {\n                    let cmfy = Comfy.getInstance();\n                    let randomname = (Math.random() + 1).toString(36).substring(7);\n                    await cmfy.uploadImage(data.base64, randomname);\n                    //console.log(\"getImage uploaded\",propertyName);\n                    window.removeEventListener(\"message\", func);\n                    resolve(randomname);\n                }\n            }\n            window.addEventListener(\"message\", func);\n\n            window.postMessage({\n                key: \"getWorkflowImage\",\n                propertyName,\n                arrayName,\n                index\n            });\n        });\n    }\n\n    async getWorkflowList() {\n        let res;\n        try {\n            res = await fetch(`${this.serverAddress}/gyre/readworkflowdir`);\n        } catch (e) {\n            e.message = \"Error getting workflowlist. \";\n            e.message += e.stack;\n            window.postMessage({\n                key: \"generateError\",\n                errorObject: e,\n            });\n            return false;\n        }\n        let wflistresult = await res.json();\n\n        if ('error' in wflistresult) {\n            throw new Error(JSON.stringify(wflistresult));\n        }\n        let deactivatedlist = wflistresult.find((el) => el.name == 'deactivatedworkflows');\n        if (deactivatedlist) {\n            deactivatedlist = JSON.parse(deactivatedlist.json)\n        }\n        wflistresult = wflistresult.filter((el) => el.name != 'deactivatedworkflows');\n\n\n        wflistresult = wflistresult.filter((rel) => {\n            let el = JSON.parse(rel.json);\n            let wfid = el?.extra?.gyre?.workflowid;\n            if (deactivatedlist.includes(wfid)) {\n                return false;\n            }\n            return true;\n\n        });\n        return wflistresult\n\n    }\n\n\n    constructor(SDConfig) {\n        this.clientId = this.uuidv4();\n        //this.serverAddress = 'tkkqxa51rwbtj9-8188.proxy.runpod.net';\n        //this.serverAddress = 'f5ti02ww28ot31-8188.proxy.runpod.net';\n        console.log(\"SDConfig\", SDConfig);\n        this.serverAddress = SDConfig.url;\n\n        if(!this.serverAddress &&  SDConfig.configList){\n            this.serverAddress = SDConfig.configList[SDConfig.currentConfigNum].generalConfig.url;\n        }\n\n        let serverAddressNoPrefix = this.serverAddress.replace(/(^\\w+:|^)\\/\\//, '');\n        let wsprefix = `ws://`;\n        if (this.serverAddress.indexOf(\"https://\") == 0) {\n            wsprefix = `wss://`;\n        }\n        this.wsurl = `${wsprefix}${serverAddressNoPrefix}/ws?clientId=${this.clientId}`;\n        this.connect();\n    }\n\n\n    async connect() {\n        if (this.ws) {\n            await this.disconnect();\n        }\n        this.ws = new WebSocket(this.wsurl);\n\n        this.ws.onopen = function () {\n            console.log(\"socket onopen\");\n        };\n        this.ws.onmessage = function (e) {\n        };\n        this.ws.onclose = function () {\n            console.log(\"onclose\");\n        };\n        this.ws.onerror = function () {\n            console.log(\"onerror\");\n        };\n\n    }\n\n    async disconnect() {\n        if (this.ws) {\n            this.ws.close();\n            this.ws = undefined;\n        }\n    }\n\n    async getEmbeddings() {\n        const res = await fetch(`${this.serverAddress}/embeddings`);\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            throw new Error(JSON.stringify(json));\n        }\n        return json;\n    }\n\n    async getExtensions() {\n        const res = await fetch(`${this.serverAddress}/extensions`);\n        const json = await res.json();\n\n        if ('error' in json) {\n            throw new Error(JSON.stringify(json));\n        }\n        return json;\n    }\n\n\n    async getImages(prompt) {\n        if (!this.ws) {\n            throw new Error(\n                'WebSocket client is not connected. Please call connect() before interacting.',\n            );\n        }\n\n        const queue = await this.queuePrompt(prompt);\n        const promptId = queue.prompt_id;\n\n        return new Promise((resolve, reject) => {\n            const outputImages = [];\n\n            const onMessage = this.onwsmessage =  async (evt, isBinary) => {\n                // Previews are binary data\n\n                if (isBinary) {\n                    return;\n                }\n                window.postMessage({\n                    key: \"wsmessage\",\n                    data:evt.data,\n                    totalNodes:this.totalNodes,\n                    nodesNames:this.nodesNames\n                });\n\n                try {\n\n                    if (typeof evt.data==='string') {\n                        const message = JSON.parse(evt.data.toString());\n                        console.log(\"message type:\", message.type);\n                        if (message.type === 'executing') {\n                            const messageData = message.data;\n                            if (!messageData.node) {\n                                const donePromptId = messageData.prompt_id;\n\n                                console.log(`Done executing prompt (ID: ${donePromptId})`);\n\n                                // Execution is done\n                                if (messageData.prompt_id === promptId) {\n                                    // Get history\n                                    const historyRes = await this.getHistory(promptId);\n                                    const history = historyRes[promptId];\n                                    // Populate output images\n                                    for (const nodeId of Object.keys(history.outputs)) {\n                                        if (this.currworkflow.extra.gyre && this.currworkflow.extra.gyre.mappings && this.currworkflow.extra.gyre.mappings[nodeId]) {\n                                            const nodeOutput = history.outputs[nodeId];\n\n                                            const elementsOutput = [];\n                                            for (const [key, value] of Object.entries(nodeOutput)) {\n                                                for (const element of value) {\n                                                    const blob = await this.getImage(\n                                                        element.filename,\n                                                        element.subfolder,\n                                                        element.type,\n                                                    );\n                                                    elementsOutput.push({\n                                                        nodeId,\n                                                        blob,\n                                                        element,\n                                                        key\n                                                    });\n                                                }\n                                            }\n                                            if (elementsOutput.length>0) outputImages.push(elementsOutput);\n\n\n                                        }\n                                    }\n                                    // Remove listener\n                                    this.ws.onmessage = null;\n                                    return resolve(outputImages);\n                                }\n                            }\n                        }\n                    }\n                } catch (err) {\n                    return reject(err);\n                }\n            };\n\n            // Add listener\n            this.ws.onmessage = onMessage\n            //this.ws?.on('message', onMessage);\n        });\n    }\n\n    async getImage(\n        filename,\n        subfolder,\n        type,\n    ) {\n        const res = await fetch(\n            `${this.serverAddress}/view?` +\n            new URLSearchParams({\n                filename,\n                subfolder,\n                type,\n            }),\n        );\n\n        const blob = await res.blob();\n        return blob;\n    }\n\n    async queuePrompt(prompt) {\n        const res = await fetch(`${this.serverAddress}/prompt`, {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                prompt,\n                client_id: this.clientId,\n            }),\n        });\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            await this.cancelRequestMethod();\n            throw new Error(JSON.stringify(json));\n        }\n\n        return json;\n    }\n\n\n    async interrupt() {\n        const res = await fetch(`${this.serverAddress}/interrupt`, {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n        });\n\n        /*\n        const json = await res.json();\n        console.log(\"json interrupt: \",json)\n        if ('error' in json) {\n            //throw new Error(JSON.stringify(json));\n        }\n        */\n    }\n\n    async editHistory(params) {\n        const res = await fetch(`${this.serverAddress}/history`, {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(params),\n        });\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            throw new Error(JSON.stringify(json));\n        }\n    }\n\n    async getComfySystemStats() {\n        const res = await fetch(`${this.serverAddress}/system_stats`, {\n            method: 'GET',\n        });\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            throw new Error(JSON.stringify(json));\n        }\n        return json;\n    }\n\n\n\n    async uploadLog(file_path, jsonData,debugdir) {\n        try {\n            const response = await fetch(`${this.serverAddress}/gyre/upload_log_json_file`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify({\n                    file_path: file_path,\n                    json_str: jsonData,\n                    debugdir\n                }),\n            });\n            const result = await response.text();\n            return result;\n        } catch (error) {\n            alert(\"Error saving workflow .json file: \" + error);\n            console.error(\"Error saving workspace:\", error);\n        }\n    }\n\n    async getHistory(promptId) {\n        const res = await fetch(\n            `${this.serverAddress}/history` + (promptId ? `/${promptId}` : ''),\n        );\n\n        const json = await res.json();\n\n        if (json[promptId].status?.status_str == 'error') {\n            await this.cancelRequestMethod();\n            throw new Error(JSON.stringify(json[promptId].status.messages));\n\n        }\n\n        if ('error' in json) {\n            await this.cancelRequestMethod();\n            throw new Error(JSON.stringify(json));\n        }\n\n        return json;\n    }\n\n    async uploadFile(image,filename){\n          if(!image){\n              const e = new Error('Upload file error empty file!');\n              window.postMessage({\n                  key: \"generateError\",\n                  errorObject: e,\n              });\n              return null;\n          }\n          return this.uploadImage(image,filename,true);\n    }\n\n\n    async uploadImage(\n        image,\n        filename,\n        textfile,\n        overwrite,\n    ) {\n\n        let blob;\n            if (textfile){\n                blob = new Blob([image])\n            }\n            else if (typeof image === 'string' || image instanceof String) {\n                let res = await fetch(image)\n                blob = await res.blob();\n            } else {\n                blob = new Blob([image])\n            }\n\n\n\n        const formData = new FormData();\n        formData.append('image', blob, filename);\n\n        if (overwrite !== undefined) {\n            formData.append('overwrite', overwrite.toString());\n        }\n\n        const res = await fetch(`${this.serverAddress}/upload/image`, {\n            method: 'POST',\n            body: formData,\n        });\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            //throw new Error(JSON.stringify(json));\n            throw new Error(JSON.stringify(json));\n        }\n        return json;\n    }\n\n    async uploadMask(\n        image,\n        filename,\n        originalRef,\n        overwrite,\n    ) {\n        const formData = new FormData();\n        //image = 'https://8bs45wcdyoxjaq-8188.proxy.runpod.net/view?filename=clipspace-mask-887219.6000000238.png&subfolder=clipspace&type=input&rand=0.5320911630540031';\n        let blob;\n        if (typeof image === 'string' || image instanceof String) {\n            let res = await fetch(image)\n            blob = await res.blob();\n        } else {\n            blob = new Blob([image])\n        }\n        //originalRef =  {\"filename\":\"clipspace-mask-887219.6000000238.png\",\"subfolder\":\"clipspace\",\"type\":\"input\"}\n        formData.append('image', blob, filename);\n        formData.append('original_ref', JSON.stringify(originalRef));\n        formData.append('type', 'input');\n        formData.append('subfolder', '');\n\n        if (overwrite !== undefined) {\n            formData.append('overwrite', overwrite.toString());\n        }\n\n        const res = await fetch(`${this.serverAddress}/upload/mask`, {\n            method: 'POST',\n            body: formData,\n        });\n\n        const json = await res.json();\n\n        if ('error' in json) {\n            throw new Error(JSON.stringify(json));\n        }\n\n        return json;\n    }\n\n\n    getStatus() {\n        return this.status\n    }\n\n\n    getFormValues() {\n        let retobj = {}\n        this.currentWorkflowListValues.forms.default.elements.forEach((el) => {\n            retobj[el.name] = typeof el.elementvalue !== 'undefined' ? el.elementvalue : el.default;\n            if (el.type == 'number') retobj[el.name] = parseFloat(retobj[el.name]);\n            if (el.name == 'seed') {\n                if (!retobj[el.name] || retobj[el.name] === 0 || retobj[el.name] === '0') retobj[el.name] = this.generateSeed();\n                retobj[el.name] = parseInt(retobj[el.name]);\n            }\n        })\n        return retobj;\n    }\n\n    generateSeed() {\n        return Math.floor(Math.random() * (4294967294 - 2)) + 1;\n    }\n\n\n    getControlNetData(p) {\n        if (!p.specialLayersImageInfo) return null;\n        if (!p.specialLayersImageInfo.length) return null;\n\n        return p.specialLayersImageInfo.map((el) => {\n            return {...el,type: el.type, \"image\": \"empty\"}\n        })\n    }\n\n    createDataForParser(p) {\n        let data = {};\n        data.prompt = p.prompt\n        data.negativePrompt = p.negativePrompt\n        data.hasMask = false\n        data.hasInitImage = false\n        data.document_width=p.width || p.config.width;\n        data.document_height=p.height|| p.config.height;\n        if (typeof p.image64 !== 'undefined') {\n            data.mergedImage = \"empty\"\n        }\n        if (typeof p.maskImage64 !== 'undefined') {\n            data.mask = \"empty\"\n        }\n        if (p.maskImage64 || p.maskURLRef || p.mode == \"inpainting\") { // mask provided\n            data.hasMask = true\n        }\n        if ( p.mode === \"inpainting\" ||  p.mode === \"img2img\") {        // image data provided\n            data.hasInitImage = true\n        }        \n        data = {...data, ...this.getFormValues()}\n        let cntrdata = this.getControlNetData(p)\n        if (cntrdata) {\n            data.controlnet = cntrdata\n        } else {\n            data.controlnet=[]\n        }\n        console.log(\"data for parser:::::\", data)\n        return data;\n    }\n\n\n    async runSD(SDConfig, p) {\n        let workflowapijson;\n        console.log(SDConfig.currentworkflowelementid);\n        if(!this.workflowList){ this.workflowList =  await this.getWorkflowList()}\n\n        this.currworkflow = JSON.parse(this.workflowList.find((el) => el.name == SDConfig.currentworkflowelementname).json)\n        this.currentWorkflowListValues = SDConfig.workflowListValues.find((el) => el.name == SDConfig.currentworkflowelementname);\n\n        if(SDConfig.currentworkflowelementid){\n            this.currworkflow = JSON.parse(this.workflowList.find((el) => el.id == SDConfig.currentworkflowelementid).json)\n            this.currentWorkflowListValues = SDConfig.workflowListValues.find((el) => el.workflowid== SDConfig.currentworkflowelementid);\n        }\n\n\n        let parser = new ComfyUIPreparser(this.currworkflow);\n        let formdata = this.createDataForParser(p);\n        let numberimages = formdata.number_images || 1;\n\n\n        let seedlist = [];\n        if (formdata.seed) seedlist.push(formdata.seed);\n\n        try {\n            await parser.execute(formdata);\n        } catch (e) {\n            e.message = e.stack;\n            console.error('error',e);\n            let layergeneration = p.layergeneration;\n            window.postMessage({\n                key: \"generateBack\",\n                taskid: p.taskid,\n                imagelist: e,\n                generateasync: !window.generatesync,\n                layergeneration\n            });\n            return;\n        }\n\n\n        if(this.stoperror){\n            this.stoperror = false;\n            return;\n        }\n        if(SDConfig.debugNextGenerate){\n            //parser.workflow\n            var d = new Date();\n            d = new Date(d.getTime());\n            let date_format_str = d.getFullYear().toString() + \"-\" + ((d.getMonth() + 1).toString().length == 2 ? (d.getMonth() + 1).toString() : \"0\" + (d.getMonth() + 1).toString()) + \"-\" + (d.getDate().toString().length == 2 ? d.getDate().toString() : \"0\" + d.getDate().toString()) + \" \" + (d.getHours().toString().length == 2 ? d.getHours().toString() : \"0\" + d.getHours().toString()) + \":\" + ((parseInt(d.getMinutes() / 5) * 5).toString().length == 2 ? (parseInt(d.getMinutes() / 5) * 5).toString() : \"0\" + (parseInt(d.getMinutes() / 5) * 5).toString()) + \":00\";\n            let logfilename = `debug_api_${date_format_str}.json`\n            logfilename = logfilename.replace(/\\s/g, '_');\n            logfilename = logfilename.replaceAll('-', '_');\n            logfilename = logfilename.replaceAll(':', '_');\n            await this.uploadLog(logfilename, JSON.stringify(parser.workflow),'debug');\n            await this.uploadLog(\"formdata_\"+logfilename, JSON.stringify(formdata),'formdata');\n        }\n        this.totalNodes  = parser.workflow.nodes.length;\n\n        this.nodesNames = parser.workflow.nodes.map((el)=>{ return {id:el.id,type:el.type} });\n\n\n        workflowapijson = await convertToApiJson(parser.workflow,this.systemstats?.system?.os);\n        let res = null;\n        this.morerequests = [];\n\n        for (let i = 0; i < numberimages; i++) {\n            let stringwf = JSON.stringify(workflowapijson);\n            if(seedlist.length){\n                let newseed = this.generateSeed();\n                stringwf = stringwf.replaceAll(seedlist[0],newseed);\n                seedlist.push(newseed);\n            }\n            let cloned = JSON.parse(stringwf);\n            this.morerequests.push(cloned);\n        }\n        await this.generateAllImages(p,seedlist);\n        return res;\n    }\n\n    async cancelRequestMethod() {\n        this.cancelrequest = true;\n        await this.interrupt();\n    }\n\n    async generateAllImages(p,seedlist) {\n\n        let complete = false;\n        let idx = 0;\n        while (!complete) {\n            if(this.cancelrequest){\n                this.cancelrequest = false;\n                break;\n            }\n            console.log('generate more image befor sleep');\n            await new Promise(r => setTimeout(r, 500));\n            let wapijson = this.morerequests.shift();\n            let elseed = this.generateSeed();\n            if(seedlist.length && seedlist[idx]){ elseed = seedlist[idx];}\n            let res = await this.executeRequest(wapijson,elseed);\n            console.log('generate more image res', res);\n            let layergeneration = p.layergeneration;\n            window.postMessage({\n                key: \"generateBack\",\n                taskid: p.taskid,\n                imagelist: res,\n                generateasync: !window.generatesync,\n                resultinnewlayer: true,\n                idx,\n                layergeneration\n            });\n            console.log('generate more image after post messafe');\n            //transferWorkflowStore.set({taskid:p.taskid,res});\n            idx++;\n            if (!this.morerequests.length) complete = true;\n\n        }\n        console.log('generate more image after post complete');\n    }\n\n\n    async executeRequest(workflowapijson, seed) {\n        let blobToBase64 = (blob) => {\n            return new Promise((resolve, _) => {\n                const reader = new FileReader();\n                reader.onloadend = () => resolve(reader.result);\n                reader.readAsDataURL(blob);\n            });\n        }\n\n        // execute ready json here and return to gyre\n\n        let images;\n        try {\n            images = await this.getImages(workflowapijson);\n        } catch (e) {\n            var d = new Date();\n            d = new Date(d.getTime());\n            let date_format_str = d.getFullYear().toString() + \"-\" + ((d.getMonth() + 1).toString().length == 2 ? (d.getMonth() + 1).toString() : \"0\" + (d.getMonth() + 1).toString()) + \"-\" + (d.getDate().toString().length == 2 ? d.getDate().toString() : \"0\" + d.getDate().toString()) + \" \" + (d.getHours().toString().length == 2 ? d.getHours().toString() : \"0\" + d.getHours().toString()) + \":\" + ((parseInt(d.getMinutes() / 5) * 5).toString().length == 2 ? (parseInt(d.getMinutes() / 5) * 5).toString() : \"0\" + (parseInt(d.getMinutes() / 5) * 5).toString()) + \":00\";\n            let logfilename = `error_api_${date_format_str}.json`\n            logfilename = logfilename.replace(/\\s/g, '_');\n            logfilename = logfilename.replaceAll('-', '_');\n            logfilename = logfilename.replaceAll(':', '_');\n\n            await this.uploadLog(logfilename, JSON.stringify(workflowapijson));\n            return e;\n        }\n\n        let retobj = [];\n        for (let idx = 0; idx < images.length; idx++) {\n            let base64 = await blobToBase64(images[idx][0].blob);\n            let mime = base64.split(',')[0];\n            base64 = base64.split(',')[1];\n            let tmpobj = {mime, base64, seed: seed, blob: images[idx][0].blob}\n            retobj.push(tmpobj);\n        }\n        return retobj;\n    }\n\n\n    async getServerFeatures(SDConfig) {\n        try {\n            let features = {}\n            this.systemstats = await this.getComfySystemStats();\n            this.workflowList =  await this.getWorkflowList()\n\n            features.workflow_image_request = true\n            features.inpainting_original = true\n            features.invert_controlnet_sketch=true    \n            features.features = [\n                \"canny\",\n                \"T2I_ControlNet_canny_switch\",\n                \"depth\",\n                \"skribble\",\n                \"text\",\n                \"posenet\",\n                \"hed\",\n                \"control_mode\"\n            ]\n            // get list of all installed models\n            let res = await fetch(`${this.serverAddress}/gyre/get_all_models`)\n            let  json = await res.json()\n            if (json && json.models) {\n                features.availableModels=json.models\n            } else {\n                features.availableModels=[]\n            }\n            return features\n        } catch (e) {\n            e.message = \"Error getting server features. \";\n            e.message += e.stack;\n            window.postMessage({\n                key: \"generateError\",\n                errorObject: e,\n            });\n            return false;\n        }\n\n    }\n\n\n    uuidv4() {\n        return \"10000000-1000-4000-8000-100000000000\".replace(/[018]/g, c =>\n            (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n        );\n    }\n\n}\n\n\n\n","import confirmDialog from \"./confirmDialog\"\nimport Comfy from \"./Comfy\"\nimport Gyre from \"./Gyre\"\n\nexport default class SDWebservice {\n    constructor() {\n    }\n\n    strip(str, remove) {\n        while (str.length > 0 && remove.indexOf(str.charAt(0)) != -1) {\n            str = str.substr(1)\n        }\n        while (str.length > 0 && remove.indexOf(str.charAt(str.length - 1)) != -1) {\n            str = str.substr(0, str.length - 1)\n        }\n        return str\n    }\n\n\n    createSDGrpc(SDConfig){\n                if(SDConfig.type===\"COMFY\"){\n                    return Comfy.getInstance(SDConfig);\n                } else {\n                    return new Gyre();\n                }\n    }\n\n    async getWorkflowList(SDConfig) {\n        let gs=this.createSDGrpc(SDConfig);\n        let res=await gs.getWorkflowList(SDConfig);\n        return res;\n    }\n\n\n\n    async getServerFeatures(SDConfig) {\n        let samplers=[]\n        let width=parseInt(SDConfig.width)\n        let height=parseInt(SDConfig.height)\n\n                let gs=this.createSDGrpc(SDConfig);\n                let features=await gs.getServerFeatures(SDConfig)\n\n                samplers=[{name:\"LMS\"},{name:'Euler a'},{name:'Euler'},{name:'Heun'},{name:'DPM2'},{name:'DPM2 a'},{name:'DDIM'},{name:'PLMS'},{name:'DPMSolver++ 1 Order'},{name:'DPMSolver++ 2 Order'}\n                ,{name:'DPMSolver++ 3 Order'},{name:'DPMSolver++ 2S a'},{name:'DPMSolver++ SDE'},{name:'DPMSolver++ 2M'},{name:'DPMSolver++ 2M (Fast)'}]\n\n\n                let defaultProps={tiling:true, strength:true, steps:true,seed:true,samplers:samplers,hr:true,clip:true,image_number_max:9}\n                if (features && features.artifacts && features.artifacts.includes(\"ARTIFACT_DEPTH\")) defaultProps.depth=true\n                if (features && features.models) defaultProps.models=features.models\n                if (features && features.upscalers) defaultProps.upscalers=features.upscalers.engine\n                if (features && features.model) defaultProps.model=features.model\n                if (width<=512 && height <=512) defaultProps.hr=false\n                defaultProps.removeBackground=true\n                defaultProps.autoMatte=true\n                defaultProps.features=features.features\n                if(features.inpainting_original){defaultProps.inpainting_original = features.inpainting_original;}\n                if(features.workflow_image_request){defaultProps.workflow_image_request = features.workflow_image_request;}\n                if(features.invert_controlnet_sketch){defaultProps.invert_controlnet_sketch = features.invert_controlnet_sketch;}\n                if(features.availableModels){defaultProps.availableModels = features.availableModels;}\n\n                return defaultProps\n\n\n    }\n\n\n\n\n\n    async getServerData(p,reqData, SDConfig) {\n        let endpoint = SDConfig.url\n        endpoint = this.strip(endpoint, \"/\")\n        if (p.mode===\"txt2img\")       endpoint += \"/sdapi/v1/txt2img\"\n        else  endpoint += \"/sdapi/v1/img2img\"\n        try {\n            let res= await fetch(endpoint, {\n                headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"              \n                }, \n                method: 'post',\n                body: reqData\n            })\n            let result=await res.json()\n\n            if ( !result[\"images\"]) {\n                await new confirmDialog().alert(\"Error\",JSON.stringify(result))\n                return\n            }\n            if (result[\"error\"]) {\n                await new confirmDialog().alert(\"Error\",result[\"text\"])\n                return\n            }\n            return result\n        } catch(error) {\n            await new confirmDialog().alert(\"Server error\",error.toString()+\"\\n\"+endpoint)\n        }\n    }\n    estimateTime(SDConfig,p) {\n        if (!SDConfig.timeCalculation) return 80*p.num*p.steps\n        //if (!SDConfig.timeCalculation) return 5000\n        return SDConfig.timeCalculation*p.num*p.steps\n    }\n    getStatus() {\n        if (this.gs) return this.gs.getStatus()\n        if (this.d2) return this.d2.getStatus()\n        return this.status\n    }\n\n\n    async estimateTimeQueue(SDConfig) {\n        // This is not implemented now!\n        return {};\n        if (SDConfig.type!==\"SDGRPC\") return {};\n        // get queue here\n            let infres= [];\n            return {'infoqueue':infres,'currentQueueSize':0,estimatedGenerationTime:0}\n        return {};\n    }\n\n    async cancelRequest(SDConfig,taskid) {\n        if (SDConfig.type===\"SDGRPC\") {  // using GRPC\n            this.gs=this.createSDGrpc(SDConfig);\n            try {\n                await this.gs.cancelRequest(SDConfig,taskid);\n            } catch (e) {}\n        }\n        if (SDConfig.type===\"COMFY\") {\n            this.gs = Comfy.getInstance(SDConfig);\n            try {\n                await this.gs.cancelRequest(SDConfig,taskid);\n            } catch (e) {}\n        }\n    }\n\n    async runSD(SDConfig, p) {\n\n        p.config=SDConfig\n        if (SDConfig.type===\"COMFY\") {\n            let startTime = performance.now()\n            this.gs = Comfy.getInstance(SDConfig);\n            let imgs\n            try {\n                imgs= await this.gs.runSD(SDConfig, p)\n            } catch (e) {}\n\n            let endTime = performance.now()\n\n            let duration=endTime-startTime\n            SDConfig.timeCalculation=duration/p.num/p.steps\n            return imgs\n        }\n\n         if (SDConfig.type===\"SDGRPC\") {  // using GRPC\n            let startTime = performance.now()\n\n            this.gs=this.createSDGrpc(SDConfig);\n            let imgs\n            try {\n                imgs= await this.gs.runSD(SDConfig, p)\n            } catch (e) {}\n\n            let endTime = performance.now()\n\n            let duration=endTime-startTime\n            SDConfig.timeCalculation=duration/p.num/p.steps\n            return imgs            \n        }        \n        this.status=\"waiting\"\n        let seed\n        if (!p.seed) { seed = -1 } else { seed = parseInt(p.seed) }\n\n        let inpainting_fill_options = ['fill', 'original', 'latent noise', 'latent nothing',\"g-diffusion\"]\n        let inpainting_fill = inpainting_fill_options.indexOf(SDConfig.inpaint_mask_content)\n        let res=await this.switchModel(SDConfig,p)\n        if (!res) {\n            this.status=\"error\"\n            return\n        }\n        let j = {\n            \"enable_hr\": p.enable_hr,\n            \"denoising_strength\": 0,\n            \"firstphase_width\": 0,\n            \"firstphase_height\": 0,\n            \"prompt\": p.prompt,\n            \"seed\": seed,\n            \"subseed\": -1,\n            \"subseed_strength\": 0,\n            \"seed_resize_from_h\": -1,\n            \"seed_resize_from_w\": -1,\n            \"batch_size\": 1,\n            \"n_iter\": parseInt(p.num),\n            \"steps\": parseInt(p.steps),\n            \"cfg_scale\": parseFloat(p.cfg_value),\n            \"width\":  parseInt(SDConfig.width),\n            \"height\":  parseInt(SDConfig.height),\n            \"restore_faces\":  p.restore_faces,\n            \"tiling\":  p.tiling,\n            \"negative_prompt\": p.negative_prompt,\n            \"eta\": 0,\n            \"s_churn\": 0,\n            \"s_tmax\": 0,\n            \"s_tmin\": 0,\n            \"s_noise\": 1,\n            \"override_settings\": {},\n            \"sampler_index\": p.sampling_method\n          }\n          if (p.enable_hr) j.denoising_strength=0.7\n          if (p.mode===\"img2img\" || p.mode===\"inpainting\"  || p.mode===\"inpainting_original\") {\n            j.init_images=[\"data:image/png;base64,\"+p.image64]\n            j.denoising_strength=p.strength\n            j.resize_mode=0\n            j.inpaint_full_res= false\n            if (p.maskImage64) {\n                j.mask=\"data:image/png;base64,\"+p.maskImage64\n              //  j.mask_blur=parseInt(SDConfig.inpaint_mask_blur)\n                console.log(\"fill\", inpainting_fill)\n            //    j.inpainting_fill= inpainting_fill\n                j.denoising_strength=1.0\n                j.inpainting_fill=2\n                j.mask_blur=0\n        }\n\n          }\n\n\n\n\n\n        let data = JSON.stringify(j)\n        let startTime = performance.now()\n        this.status=\"processing\"\n        let response = await this.getServerData(p,data, SDConfig)\n\n        if (!response) {\n            this.status=\"error\"\n            return\n        }\n        this.status=\"ready\"\n        let endTime = performance.now()\n        let duration=endTime-startTime\n        SDConfig.timeCalculation=duration/p.num/p.steps\n        let images = []\n        p.seedList = [] \n        let s = response[\"info\"]\n        let info = JSON.parse(s)\n\n        let b64Data\n        let allSeeds=info[\"all_seeds\"]\n            for(let i=0;i<p.num;i++) {\n                b64Data = response[\"images\"][i ] // image in list\n                p.seedList[i] = allSeeds[i]+\"\"\n                let img={base64: b64Data}\n                img.seed=p.seedList[i]\n                images.push(img)\n            }\n        return images    \n    }\n    \n    async getModels(SDConfig) {\n\n        let endpoint = SDConfig.url\n        endpoint = this.strip(endpoint, \"/\")\n        endpoint += \"/sdapi/v1/sd-models\"\n        let engineList=[]\n        let result\n        try {\n            let res= await fetch(endpoint, {\n                headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n                },\n                method: 'get'\n            })\n            result=await res.json()\n            if (result[\"error\"]) {\n                await new confirmDialog().alert(\"Error\",result[\"text\"])\n                return\n            }\n        } catch(error) {\n            await new confirmDialog().alert(\"Server error\",error.toString()+\"\\n\"+endpoint)\n        }\n//        console.log(result)\n        for(let i=0;i<result.length;i++) {\n            let m=result[i]\n            engineList.push({id:m.model_name,hash:m.hash})\n        }\n\n        return engineList\n    }\n    async switchModel(SDConfig,p) {\n        let list=await this.getModels(SDConfig)\n        if (!list) return false\n        let model=\"\"\n        model=SDConfig.model\n        if (p.mode===\"inpainting\") {\n            model=SDConfig.inpainting_model\n            if (!model) model=\"sd-v1-5-inpainting\"\n        }\n        if (!model) {\n            await new confirmDialog().alert(\"No model selected in config\")\n            return false\n        }\n        let title=\"\"\n        for (let i=0;i<list.length;i++) {\n            let m=list[i]\n            if (m.id===model) title=model+\".ckpt [\"+m.hash+\"]\"\n        }\n\n        if (!title) {\n            await new confirmDialog().alert(\"Model not found: \"+title)\n            return false\n        }\n        let request={\n            \"sd_model_checkpoint\":title\n        }\n        let reqData = JSON.stringify(request)\n        let endpoint = SDConfig.url\n        endpoint = this.strip(endpoint, \"/\")\n        endpoint += \"/sdapi/v1/options\"\n        try {\n            let res= await fetch(endpoint, {\n                headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n                },\n                method: 'post',\n                body: reqData\n            })\n            let result=await res.json()\n            return true\n        } catch(error) {\n            await new confirmDialog().alert(\"Server error\",error.toString()+\"\\n\"+endpoint)\n            return false\n        }\n    }\n}\n\n","import confirmDialog from \"./confirmDialog\"\n\n\nexport default class prompt {\n\n    taskid\n\n    constructor(taskid) {  // Constructor\n        this.taskid = taskid;\n    }\n\n    async getFullPrompt(dlg) {\n        let modifiers = \"\"\n        let str=dlg.modifiers\n        let list = str.split(/\\n|\\r/)\n        let prefix=\"\"\n        let prompt=\"\"\n        try {\n\n            for (let i = 0; i < list.length; i++) {\n                let m = list[i]\n                m=m.trim()\n                if (m.endsWith(\"...\") ) {\n                    prefix+=m.replace(\"...\",\" \")\n                }else {\n                    if (m && m[0] != \"#\" && m[0] != \"-\" && !m.startsWith(\"lora:\")) {\n                        if (m.search(\":\") != -1)  m=\"(\"+m+\")\"\n                        modifiers += \", \" + m\n                    }\n                }\n            }\n            prompt = dlg.prompt\n        } catch(e) {\n            console.log(e)\n        }\n        if (!prompt) prompt=\"\"\n\n/*        if (!prompt) {\n            await new confirmDialog().alert(\"Empty prompt\",\"Type some text in prompt input box about what you want to see.\")\n            return \"\"\n        }*/\n\n        prompt=prefix+prompt\n        prompt += modifiers\n        return prompt\n    }\n    getLoraList(dlg) {\n        let str=dlg.modifiers\n        let list = str.split(/\\n|\\r/)\n        let loraList=[]\n        for (let i = 0; i < list.length; i++) {\n            let m = list[i]\n            if (m.startsWith(\"lora:\")) {\n                let url=m.replace(\"lora:\",\"\")\n                let weight=1.0\n                url=url.replace(\"://\", \"__MAGIC__\")\n                if (url.search(\":\") != -1)  {\n                    let arr=url.split(\":\")\n                    url=arr[0]\n                    weight=parseFloat(arr[1])\n                }\n                url=url.replace(\"__MAGIC__\", \"://\")\n                loraList.push({url,weight})\n            }\n        }\n        return loraList\n\n    }\n    async getNegativePrompt(dlg) {\n        let negativePrompt = \"\"\n        let str=dlg.modifiers\n        let list = str.split(/\\n|\\r/)\n        for (let i = 0; i < list.length; i++) {\n            let m = list[i]\n            if (m[0] === \"-\") negativePrompt += \", \" + m.replace(\"-\",\"\")\n        }\n        return negativePrompt\n    }\n    async getPromptObject(dlgData,SDMode,ImageInfo,AlphaImgInfo,DepthImageInfo,specialLayersImageInfo,ImageInfoSelection) {\n        let data=dlgData\n        let p={}\n        p.prompt=await this.getFullPrompt(data)\n        p.negativePrompt=await this.getNegativePrompt(data)\n        p.loraList=await this.getLoraList(data)\n\n        if (!p.prompt) return\n        p.mode=SDMode        \n        if (p.mode===\"variations\") p.prompt=\"variations\"\n        p.steps=data[\"steps\"]\n        p.seed=data[\"seed\"]\n        p.num=data[\"num\"]\n        p.inpainting_original=data[\"inpainting_original\"]\n        p.sampling_method=data[\"sampling_method\"]\n        p.cfg_value=data[\"cfg_value\"]\n        if (data[\"clip\"]) p.clip=true\n        p.tiling=dlgData.tiling\n        p.enable_hr=dlgData.enable_hr\n        p.enable_depth=dlgData.enable_depth\n        p.restore_faces=dlgData.restore_faces\n        p.strength=0.75\n        if (SDMode===\"img2img\") {\n            p.strength=data[\"strength\"]\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n            if (DepthImageInfo) p.depthImage64=DepthImageInfo.base64\n        }\n        if (SDMode===\"variations\") {\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n        }\n        if (SDMode===\"removeBackground\") {\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n        }\n        if (SDMode===\"autoMatte\") {\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n            p.pointList=dlgData.pointList               // location of interest (loi) x,y, label (0/1)\n            p.rectangleList=dlgData.rectangleList       // usually one entry with rectangle, top,left, bottom, right\n            p.erode=dlgData.erode\n        }\n\n        if (SDMode===\"upscale\") {\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n            p.upscaleEngine=dlgData.upscaleEngine\n        }        \n        if (SDMode===\"inpainting\" || SDMode===\"inpainting_original\") {\n            p.strength=data[\"strength\"]\n            p.image64=ImageInfo.base64\n            p.imageURLRef=ImageInfo.urlRef\n            if (AlphaImgInfo) {\n                p.maskImage64=AlphaImgInfo.base64\n                p.maskURLRef=AlphaImgInfo.urlRef\n                if(ImageInfoSelection) p.imageInfoSelectionURLRef =ImageInfoSelection.urlRef;\n            }\n        }\n        p.specialLayersImageInfo=specialLayersImageInfo\n        if(this.taskid) p.taskid = this.taskid;\n        p.targetWidth=dlgData.targetWidth\n        p.targetHeight=dlgData.targetHeight\n\n        return p\n    }\n\n}","import Comfy from \"./Comfy\";\nimport {ComfyUIPreparser} from '../Preparser/ComfyUIPreparser';\nimport {convertToApiJson} from \"../workflowjsonconverter/converter\";\n\nexport default class ComfyStandAlone extends Comfy{\n\n    static getInstance(SDConfig) {\n        if (!this.instancestandalone) {\n            this.instancestandalone = new ComfyStandAlone(SDConfig);\n        }\n        return this.instancestandalone;\n    }\n\n    constructor(SDConfig) {\n        super(SDConfig);\n        this.activateErrorListener();\n    }\n\n\n    activateErrorListener(){\n        window.addEventListener(\"message\", (data)=>{\n                console.log(\"data error message\",data);\n                if (this.callback_error && data.key === 'generateError') {\n                    this.callback_error(data);\n                }\n        });\n    }\n\n\n\n    async getLayerImage(layerName,layerID){\n        let res = await this.callBack_files('getLayerImage',layerName,layerID);\n        if(!res) this.stoperror = true;\n        let randomname = (Math.random() + 1).toString(36).substring(7);\n        await this.uploadImage(res,randomname);\n        return randomname;\n    }\n\n    async getSingleImage(propertyName, arrayName=\"\",index) {\n        let res = await this.callBack_files('getSingleImage',propertyName, arrayName,index);\n        if(!res) this.stoperror = true;\n        let randomname = (Math.random() + 1).toString(36).substring(7);\n        await this.uploadImage(res,randomname);\n        return randomname;\n    }\n    async getFile(propertyName, arrayName=\"\",index) {   // currently only available for plugins\n        let res = await this.callBack_files('getFile',propertyName, arrayName,index);\n        if(!res) this.stoperror = true\n        let randomname = (Math.random() + 1).toString(36).substring(7)\n        await this.uploadFile(res,randomname);\n        return randomname;\n    }\n\n    async runSDById(workflowId,callback_finished,formdata,callBack_files,callback_error) {\n       let res =  await this.runSD(workflowId,callback_finished,formdata,callBack_files,callback_error,'byId');\n        return res;\n    }\n\n    async runSD(workflowName,callback_finished,formdata,callBack_files,callback_error,byId=false) {\n        let workflowapijson;\n        this.callBack_files = callBack_files;\n        this.callback_finished = callback_finished;\n        this.callback_error = callback_error;\n        if(!this.workflowList)\n            this.workflowList = await this.getWorkflowList();\n        let wf;\n\n        if(byId){\n            wf=this.workflowList.find((el) => el.id == workflowName)\n        } else{\n            wf=this.workflowList.find((el) => el.name == workflowName)\n        }\n\n        if (!wf) {\n            throw(\"Could not find workflow \"+workflowName)\n        }\n        this.currworkflow = JSON.parse(wf.json)\n        let parser = new ComfyUIPreparser(this.currworkflow);\n        let numberimages = formdata.number_images || 1;\n\n        let seedlist = [];\n        if (formdata.seed) seedlist.push(formdata.seed);\n        try {\n            await parser.execute(formdata);\n        } catch (e) {\n            e.message = e.stack;\n            console.error('error',e);\n            window.postMessage({\n                key: \"generateBack\",\n //               taskid: p.taskid,\n                imagelist: e,\n                generateasync: !window.generatesync,\n   //             layergeneration\n            });\n            return;\n        }\n\n\n        if(this.stoperror){\n            this.stoperror = false;\n            return;\n        }\n\n        this.totalNodes  = parser.workflow.nodes.length;\n\n        this.nodesNames = parser.workflow.nodes.map((el)=>{ return {id:el.id,type:el.type} });\n\n\n        workflowapijson = await convertToApiJson(parser.workflow,this.systemstats?.system?.os);\n        let res = null;\n        this.morerequests = [];\n\n        for (let i = 0; i < numberimages; i++) {\n            let stringwf = JSON.stringify(workflowapijson);\n            if(seedlist.length){\n                let newseed = this.generateSeed();\n                stringwf = stringwf.replaceAll(seedlist[0],newseed);\n                seedlist.push(newseed);\n            }\n            let cloned = JSON.parse(stringwf);\n            this.morerequests.push(cloned);\n        }\n        await this.generateAllImages(seedlist);\n        return res;\n    }\n\n    async generateAllImages(seedlist) {\n\n        let complete = false;\n        let idx = 0;\n        while (!complete) {\n            if(this.cancelrequest){\n                this.cancelrequest = false;\n                break;\n            }\n            console.log('generate more image befor sleep');\n            await new Promise(r => setTimeout(r, 500));\n            let wapijson = this.morerequests.shift();\n            let elseed = this.generateSeed();\n            if(seedlist.length && seedlist[idx]){ elseed = seedlist[idx];}\n            let res = await this.executeRequest(wapijson,elseed);\n\n            this.callback_finished(res);\n\n            console.log('generate more image after post messafe');\n            //transferWorkflowStore.set({taskid:p.taskid,res});\n            idx++;\n            if (!this.morerequests.length) complete = true;\n\n        }\n        console.log('generate more image after post complete');\n    }\n\n\n\n\n}\n\n\n\n","import config from \"./ConfigClass\";\nimport sdws from \"./SDWebservice.js\"\nimport {transferStore} from './TasksStore';\nimport promptClass from \"./prompt.js\"\nimport {serverurl} from \"./FirstConfig.svelte\";\nimport Comfy from \"./Comfy\";\nimport ComfyStandAlone from \"./ComfyStandAlone\";\n\n\nclass PostMessageAdapter {\n    unsubscribe;\n    openProfile = true;\n    firstconfigelement;\n    server_features;\n\n    constructor() {}\n\n    async postMessage(data) { \n        let result;\n\n        if (data.key === \"init\") {\n            try{\n            // get server\n            let initwidth = 512;\n            let initheight = 512;\n            let initurl = \"\";\n            let initbearer = \"\"\n            let Config = new config()\n            await Config.load()\n            await Config.get();\n            //window.comfyuimode = true;\n            /*\n            if(window.comfyuimode){\n                Config.generalConfig = JSON.parse(JSON.stringify(Config.generalConfig));\n                Config.generalConfig.type='COMFY';\n                Config.generalConfig.name='COMFY';\n                Config.generalConfig.inpainting_original = false;\n            } else {\n                Config.generalConfig.type='SDGRPC';\n                Config.generalConfig.name='Gyre';\n                Config.generalConfig.inpainting_original = true;\n            }\n            */\n\n            if (!Config.configList.length) {\n                await Config.add('SDGRPC');\n            }\n\n            let hasComfy = Config.configList.find((el) => {\n                return el.generalConfig.name == 'COMFY'\n            })\n            if (!hasComfy) {\n                await Config.add('COMFY');\n                Config.currentConfigNum = 0;\n            }\n\n            console.log(\"config\");\n            this.firstconfigelement = document.createElement('fds-first-config');\n            this.firstconfigelement.classList.add(\"colorScheme\")\n            this.firstconfigelement.serverurl = Config.generalConfig.url || window.location.href;\n            this.firstconfigelement.bearer = Config.generalConfig.token;\n            this.firstconfigelement.SDConfig = Config\n            this.firstconfigelement.servertype = Config.generalConfig.name;\n            document.body.appendChild(this.firstconfigelement);\n            if (!Config.configList.length) {\n                this.firstconfigelement.finishedInit = true;\n            }\n            this.firstconfigelement.finishedInit = true\n\n            if (!this.firstconfigelement.serverurl || (this.firstconfigelement.serverurl === \"https://cloud.gyre.ai\" && !this.firstconfigelement.bearer)) {\n                this.firstconfigelement.openProfile = true\n            }\n            while (this.firstconfigelement.finishedInit) {\n                await new Promise(r => setTimeout(r, 100));\n            }\n\n\n            console.log(\"Finished Init\")\n            initurl = this.firstconfigelement.serverurl || initurl;\n            initurl = initurl.endsWith('/') ? initurl.slice(0, -1) : initurl;\n            initwidth = this.firstconfigelement.initwidth || initwidth;\n            initheight = this.firstconfigelement.initheight || initheight;\n            initbearer = this.firstconfigelement.bearer\n\n            let currentConfigNum = 0;\n\n            Config.configList.forEach((el, idx) => {\n                if (el.generalConfig.name == this.firstconfigelement.servertype) {\n                    currentConfigNum = idx;\n                }\n            })\n\n\n            console.log(\"current config number: \", Config.currentConfigNum);\n            if (Config.currentConfigNum != currentConfigNum) {\n                Config.currentConfigNum = currentConfigNum;\n                await Config.get()\n            }\n            console.log(\"current config number after: \", Config.currentConfigNum);\n\n\n            Config.generalConfig.url = initurl;\n            Config.generalConfig.token = initbearer;\n            await Config.set();\n            //}\n\n            var canvas = document.createElement(\"canvas\");\n            // set desired size of transparent image\n            canvas.width = initwidth;\n            canvas.height = initheight;\n            let imageType = \"png\"\n            let base64\n            if (!this.firstconfigelement.file_blob && !this.firstconfigelement.file_uncompressed && !this.firstconfigelement.file_base64) {\n                base64 = canvas.toDataURL()  // empty background layer\n            }\n\n            let blob\n            let uncompressed\n            // plain image as base64\n            if (this.firstconfigelement.file_base64 && this.firstconfigelement.file_type === \"image\") {\n                base64 = this.firstconfigelement.file_base64\n                imageType = base64.substring(\"data:image/\".length, base64.indexOf(\";base64\"))\n            }\n            // gyre document as base64\n            if (this.firstconfigelement.file_base64 && this.firstconfigelement.file_type === \"gyre\") {\n                base64 = this.firstconfigelement.file_base64\n                imageType = \"gyre\"\n            }\n            // gyre document as binary \n            if (this.firstconfigelement.file_blob && this.firstconfigelement.file_type === \"gyre\") {\n                blob = this.firstconfigelement.file_blob\n                imageType = \"gyre\"\n            }\n            // gyre document as internal data/JSON structure\n            if (this.firstconfigelement.file_uncompressed && this.firstconfigelement.file_type === \"gyre\") {\n                uncompressed = this.firstconfigelement.file_uncompressed\n                imageType = \"gyre\"\n            }\n            let WS = new sdws()\n            this.server_features = await WS.getServerFeatures(Config.generalConfig)\n            let workflowList = await WS.getWorkflowList(Config.generalConfig)\n            console.log(\"server_features\", this.server_features);\n\n            result = {\n                data:\n                    {\n                        base64,\n                        blob,\n                        imageType,\n                        uncompressed,\n                        key: \"init\",\n                        documentInfo: {width: initwidth, height: initheight},\n                        Config,\n                        num: Config.currentConfigNum,\n                        serverFeatures: this.server_features,\n                        workflowList\n                    }\n            }\n            } catch (e) {\n                e.message = e.stack;\n                window.postMessage({\n                    key: \"generateError\",\n                    errorObject: e,\n                });\n                return false;\n            }\n        }\n        if (data.key === \"changeModel\") {\n            result = await this.changeConfigElement({objkey: 'model', value: data.model});\n        }\n\n        if (data.key === \"changeInpaintingModel\") {\n            result = await this.changeConfigElement({objkey: 'inpainting_model', value: data.model});\n        }\n\n        if (data.key === \"changeGeneralConfig\") {\n            result = await this.changeConfigElement({objkey: data.type, value: data.value});\n            if(data.skiprefresh) result=null;\n        }\n\n\n        if (data.key === \"changeGlobalData\") {\n            let Config = new config()\n            Config.updateGlobalData(data.globalData)\n        }\n\n\n\n        if (data.key === \"changeSize\") {\n            let objkey;\n            if (data.type === \"width\") {\n                objkey = \"width\"\n\n            }\n            if (data.type === \"height\") {\n                objkey = \"height\"\n            }\n            result = await this.changeConfigElement({objkey, value: data.value});\n        }\n\n        if (data.key === \"numberImages\") {\n\n            let Config = new config()\n            await Config.load()\n            await Config.get()\n            Config.generalConfig.dlgData.num = parseInt(data.num)\n            Config.set()\n        }\n\n        if (data.key === \"modifierSave\") {\n            let Config = new config()\n            await Config.load()\n            await Config.get();\n            Config.ModifierData = JSON.parse(data.modifier.modifierdata);\n            await Config.save();\n        }\n\n\n        if (data.key === \"changeSampler\") {\n            let Config = new config()\n            await Config.load()\n            await Config.get()\n            Config.generalConfig.dlgData.sampling_method = data.sampling_method\n            Config.set()\n        }\n\n\n        if (data.key === \"cancelRequest\") {\n            let WS = new sdws()\n            await WS.cancelRequest(data.Config.generalConfig, data.taskid);\n        }\n\n        if (data.key === \"getWorkflowsList\") {\n            let WS = new sdws()\n            let workflowlist = await WS.getWorkflowList(data.Config.generalConfig)\n            result = {\n                data:\n                    {\n                        key: \"workflowsListBack\",\n                        workflowlist\n                    }\n            };\n        }\n\n\n        if (data.key === \"generate\") {\n\n            let layer = data.layer\n            let p = new promptClass(layer.taskid)\n            // @ts-ignore\n            let prompt = await p.getPromptObject(layer.generate, layer.generate.mode, layer.ImageInfo, layer.AlphaImageInfo, layer.DepthImageInfo, layer.specialLayersImageInfo)\n            let WS = new sdws();\n            this.standalone = false;\n            let layergeneration = layer.generate.layergeneration;\n            prompt.layergeneration = layergeneration;\n            let images = await WS.runSD(data.Config.generalConfig, prompt);\n\n\n            if (!this.unsubscribe) {\n                this.unsubscribe = transferStore.subscribe(async (taskel) => {\n                    if (!taskel) return;\n                    if (!taskel.taskid) return;\n                    let res = taskel.answers.answer.map((el) => {\n                        let im = el.artifacts[0];\n                        //let base64 = \"data:image/png;base64,\"+im.binary;\n                        let base64 = im.binary;\n                        let seed = im.seed;\n                        let complete = taskel.answers.complete;\n                        let retobj = {base64, seed};\n                        if (complete) retobj.complete = true;\n                        return retobj;\n                    })\n\n                    window.postMessage({\n                        key: \"generateBack\",\n                        taskid: taskel.taskid,\n                        imagelist: res,\n                        generateasync: !window.generatesync\n                    });\n\n                    transferStore.set();\n                });\n            }\n\n\n            if(images!=null) {\n                result = {\n                    data:\n                        {\n                            key: \"generateBack\",\n                            taskid: layer.taskid,\n                            generateasync: !window.generatesync,\n                            imagelist: images,\n                            layergeneration\n                        }\n                };\n            }\n        }\n\n\n        if (result) window.postMessage(result.data);\n    }\n\n    async generate(config, layer) {\n        let WS = new sdws()\n        if (typeof layer === 'string' || layer instanceof String){\n            const response = await fetch(layer);\n            layer = await response.json();\n        }\n\n        let p = new promptClass(layer.taskid)\n        // @ts-ignore\n        let prompt = await p.getPromptObject(layer.generate, layer.generate.mode, layer.ImageInfo, layer.AlphaImageInfo, layer.DepthImageInfo, layer.specialLayersImageInfo,layer.ImageInfoSelection)\n\n        let images = await WS.runSD(config, prompt);\n\n        let result = {\n                data:\n                    {\n                        key: \"generateBack\",\n                        /*taskid: layer.taskid,*/\n                        generateasync: !window.generatesync,\n                        imagelist: images\n                    }\n        };\n\n        if (result){\n            return result.data;\n        }\n            //window.postMessage(result.data);\n    }\n\n\n    async init(servername) {\n        this.StandAloneSDConfig =  {'url': servername};\n        let comfysa = this.getWorkflowImageRequestServerInstance('standalone');\n        if (globalThis.gyre) {\n            let workflowList=await comfysa.getWorkflowList();\n            globalThis.gyre.ComfyUI.workflowList=workflowList\n        }\n\n    }\n\n    async executeWorkflow(workflowName,callback_finished,callBack_files,formData,callback_error){\n\n        let comfysa = this.getWorkflowImageRequestServerInstance('standalone');\n        comfysa.runSD(workflowName,callback_finished,formData,callBack_files,callback_error);\n\n    }\n    async executeWorkflowById(workflowId,callback_finished,callBack_files,formData,callback_error){\n\n        let comfysa = this.getWorkflowImageRequestServerInstance('standalone');\n        comfysa.runSDById(workflowId,callback_finished,formData,callBack_files,callback_error);\n\n    }\n\n    async changeConfigElement(element) {\n        let Config = new config()\n        await Config.load()\n        await Config.get()\n        if(element.objkey==\"\"){\n            Config.generalConfig = element.value;\n        } else {\n            Config.generalConfig[element.objkey] = element.value;\n        }\n\n        await Config.set()\n\n        let WS = new sdws()\n\n        if(!this.server_features) this.server_features = await WS.getServerFeatures(Config.generalConfig)\n        console.log(\"server_features\", this.server_features);\n\n        let response = {\n            data:\n                {\n                    key: \"switchConfig\",\n                    num: Config.currentConfigNum,\n                    serverFeatures: this.server_features\n                }\n        }\n        return response;\n    }\n\n    getWorkflowImageRequestServerInstance(standalone) {\n        let sdConfig = this.firstconfigelement?.SDConfig || null;\n        if(standalone || this.standalone){\n            this.standalone = true;\n            if(this.StandAloneSDConfig)  sdConfig = this.StandAloneSDConfig  ;\n            if(!sdConfig && this.firstconfigelement?.SDConfig) sdConfig = this.firstconfigelement?.SDConfig;\n            return ComfyStandAlone.getInstance(sdConfig);\n        }\n        return Comfy.getInstance(sdConfig);\n    }\n\n\n\n}\n\nlet inst = new PostMessageAdapter();\nwindow.postMessageAdapter = inst;\nexport default inst;\n","<svelte:options tag=\"fds-ai-image-editor\"></svelte:options>\n<script>\n    import { onMount } from 'svelte'\n    import {get_current_component} from \"svelte/internal\"\n    let host = get_current_component()\n    import fdsHelper from \"@fds-components/fds-helper\"\n    let path = fdsHelper.get_href()\n    // eslint-disable-next-line no-unused-vars\n    import FirstConfig from \"./postmessageadapter/FirstConfig.svelte\";\n    // eslint-disable-next-line no-unused-vars\n    import  WizardSteps  from './postmessageadapter/WizardSteps.svelte';    \n    // eslint-disable-next-line no-unused-vars\n    import  LayerStack3D  from './postmessageadapter/LayerStack3D.svelte';       \n    import { version as componentversion,name } from '../package.json';\n    // eslint-disable-next-line no-unused-vars\n    import PostMessageAdapter  from \"./postmessageadapter/postMessageAdapter\"\n\n    /**\n     * example parameter\n     * @type {string}\n     */\n\n    /**\n     * Get information about component\n     * @param  {(\"api\" | \"examples\" | \"css\")} type the info type\n     */\n    export async function getInfo(type) {\n        if (type===\"version\"){\n            return new Promise(resolve => {\n                resolve(componentversion);\n            });\n        }\n        let res = await fdsHelper.getInfo(type,name);\n        return res;    \n    }\n\n    /**\n     * version of component\n     * @type {string}\n     */\n    export const version = componentversion;\n    let postMessageAdapter;\n\n    onMount(()=> {\n\n    })\n    $: {}\n\n</script>"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","current_component","src_url_equal","element_src","url","document","createElement","href","is_empty","obj","keys","length","subscribe","store","callbacks","unsub","unsubscribe","get_store_value","value","_","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","i","d","element","name","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","set_custom_element_data","prop","children","Array","from","childNodes","set_data","set_input_value","input","set_style","key","important","style","removeProperty","setProperty","toggle_class","toggle","classList","attribute_to_object","attributes","result","set_current_component","component","get_current_component","Error","onMount","$$","on_mount","push","afterUpdate","after_update","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","schedule_update","then","flush","add_render_callback","seen_callbacks","Set","flushidx","saved_component","update","e","pop","callback","has","add","clear","fragment","before_update","dirty","p","ctx","flush_render_callbacks","filtered","targets","c","indexOf","outroing","transition_in","block","local","delete","mount_component","customElement","m","new_on_destroy","map","filter","on_destroy","destroy_component","make_dirty","fill","init","instance","create_fragment","not_equal","props","append_styles","parent_component","bound","on_disconnect","context","Map","skip_bound","root","ready","ret","rest","hydrate","nodes","l","intro","SvelteElement","HTMLElement","constructor","super","this","attachShadow","mode","connectedCallback","slotted","attributeChangedCallback","_oldValue","newValue","disconnectedCallback","$destroy","$on","type","index","splice","$set","$$props","$$set","path","currentScript","src","URL","baseURI","fdsHelper","getInfo","componentname","fetchurl","alternativefetchurl","notfound","replace","get_href","res","fetch","response","ok","json","components","get_local","pathname","tutorialsData","id","title","entries","image","imageHover","play","square","file","quickStartData","wizard","newDocumentData","icon","selected","width","height","module","t","o","n","exports","r","call","defineProperty","configurable","enumerable","get","__esModule","default","prototype","hasOwnProperty","s","CLASS_NAMES","MODAL","OVERLAY","SHOW_MODAL","MODAL_TITLE","MODAL_TEXT","ICON","ICON_CUSTOM","CONTENT","FOOTER","BUTTON_CONTAINER","BUTTON","CONFIRM_BUTTON","CANCEL_BUTTON","DANGER_BUTTON","BUTTON_LOADING","BUTTON_LOADER","getNode","querySelector","stringToNode","innerHTML","trim","firstChild","insertAfter","nextSibling","removeNode","parentElement","throwErr","isPlainObject","toString","getPrototypeOf","ordinalSuffixOf","overlayMarkup","iconMarkup","titleMarkup","textMarkup","footerMarkup","CONFIRM_KEY","CANCEL_KEY","visible","className","closeModal","assign","defaultButtonList","cancel","confirm","charAt","toUpperCase","slice","u","getButtonListOpts","isArray","f","injectElIntoModal","textContent","initModalContent","initTitle","initText","content","buttons","dangerMode","modalMarkup","isOpen","promise","actions","timer","resetState","setActionValue","setActionOptionsFor","openModal","remove","onAction","getState","stopLoading","querySelectorAll","Function","eval","window","sweetAlert","swal","insertAt","locals","btoa","concat","sources","sourceRoot","join","unescape","encodeURIComponent","JSON","stringify","refs","parts","base","css","media","sourceMap","v","insertInto","w","attrs","rel","transform","singleton","h","g","bind","createObjectURL","revokeObjectURL","Blob","styleSheet","cssText","x","convertToAbsoluteUrls","y","apply","arguments","all","atob","DEBUG","Boolean","location","protocol","host","test","String","includes","TypeError","Math","max","abs","isNaN","Element","CharacterData","DocumentType","writable","_state","_handled","_value","_deferreds","_immediateFn","onFulfilled","onRejected","_unhandledRejectionFn","setTimeout","catch","reject","race","console","_setImmediateFn","_setUnhandledRejectionFn","setImmediate","_id","_clearFn","clearTimeout","setInterval","clearInterval","close","unref","ref","enroll","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","clearImmediate","args","process","nextTick","postMessage","importScripts","onmessage","random","source","attachEvent","MessageChannel","port1","port2","documentElement","onreadystatechange","self","fun","array","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","umask","polyfill","getOwnPropertyDescriptor","getOpts","setDefaults","body","errorIconMarkup","warningIconMarkup","successIconMarkup","contentMarkup","buttonMarkup","error","warning","success","navigator","userAgent","display","offsetHeight","createDocumentFragment","split","focus","preventDefault","shiftKey","tabIndex","k","O","closeOnEsc","closeOnClickOutside","button","getContentOpts","DEPRECATED_OPTS","logDeprecation","placeholder","onlyRename","replacement","subOption","link","imageUrl","customClass","imageSize","showCancelButton","showConfirmButton","confirmButtonText","confirmButtonColor","cancelButtonText","closeOnConfirm","closeOnCancel","showLoaderOnConfirm","animation","inputType","inputValue","inputPlaceholder","html","allowEscapeKey","allowClickOutside","confirmDialog","alert","heading","message","subscriber_queue","start","stop","subscribers","set","new_value","run_queue","subscriber","invalidate","size","transferStore","tasksStore","readyToLoadStore","Gyre","getWeightsArray","prompt","promptArray","splitPrompt","item","search","weight","bracketCount","arr","parseFloat","strip","str","substr","onlyonegrpclocal","getStatus","status","runSD","SDConfig","origin","endsWith","newServer","checkNewServer","requestlocalgrpcprocessing","images","seedList","model","modelList","getModels","found","requestTemplate","engineId","requestId","floor","allprompts","parameters","negativePrompt","uuid","newprompt","specialLayersImageInfo","specialLayer","image64","artifact","binary","adjustments","background_removal","maskPrompts","erode","rectangleList","loi","rectangles","pointList","points","mask_predict","behaviour","upscaleEngine","maskImage64","promptMask","levels","inputLow","inputHigh","outputLow","outputHigh","blur","sigma","direction","channels","invert","mime","hint_image_type","method","preprocessorType","canny_edge","low_threshold","high_threshold","depth","edge_detection","engine_id","shuffle","normal","background_threshold","preblur","postblur","smoothing","segmentation","openpose","preprocessor","base64","control_mode","hint_priority","loraList","lora","parseInt","imageobj","targetWidth","targetHeight","seed","steps","samples","num","hires","enable","tiling","diffusion","DDIM","PLMS","Euler","Heun","DPM2","LMS","sampling_method","answers","asyncHandleobj","scaledStep","sampler","cfgScale","cfg_value","sigmaMin","karrasRho","schedule","strength","inpainting_original","clip","guidance","guidancePreset","instances","guidanceStrength","postRest","asyncHandleobjList","taskid","hasanyresult","find","el","canceled","complete","answer","postMessageAdapter","aistudio","getAllOtherImagesStudio","getAllOtherImages","artifacts","innerSeed","img","that","canceledfound","canceledrequest","retobj","cancelRequest","asyncHandle","tasksarray","foundindex","eltoupdate","idx","im","imagelist","getSpecialFeatures","upscalers","list","features","acceptedHintTypes","hType","toFind","getServerFeatures","models","task_group","modelFound","acceptedPromptArtifacts","command","ignoreError","apiKey","token","answertext","postRequest","endpoint","headers","Accept","parse","SyntaxError","messsage","errortext","statusText","getRequest","engine","getWorkflowList","gyreDocument","modifiers","presetName","layers","setPrompt","setModifiers","setDefaultModifier","layerImageEmpty","layerImage","layer","layerText","font_size","string","font","letter_spacing","background_type","getScene","layer3D","layerPose","show_character","setToolsLayers","toolsLayers","dragRestriction","resizeRestriction","extendImage","orgWidth","orgHeight","setMode","make","promptInfo","doc","reverse","fromWizard","collectedData","background","subType","modifierInfo","scene3d","pose","outpainting","wizards","description","promptTitle","txt2img","if_block0","create_if_block_18","if_block1","create_if_block_17","create_if_block_8","create_if_block_2","create_if_block_1","div1","div3","div4","div6","div7","fadeOut","div11","div9","div0","div8","span","div2","div5","label","div10","fds_image_editor_dialog","fds_posenet_select","fds_search_models_3d0","fds_search_models_3d1","if_block3","t0_value","create_if_block_32","create_if_block_31","create_if_block_30","create_if_block_29","create_if_block_28","create_if_block_27","create_if_block_25","create_if_block_23","create_if_block_20","create_if_block_19","fds_wizard_steps","fds_wizard_steps_steps_value","stackTop","stackTopFadeOut","fds_image_editor_button0","fds_layer_stack_3d","fds_image_editor_button1","fds_image_editor_text","fds_3d_scene","fds_pose_editor","t0","fds_image_editor_button","textarea","textarea_value_value","div","t2_value","t4_value","t6_value","t8_value","t2","t4","t6","t8","input_value_value","create_if_block_26","t_value","create_if_block_24","img_src_value","create_if_block_21","create_if_block_22","label0","input0","label1","input1","hr","t3_value","create_if_block_15","create_if_block_14","div0_href_value","t3","if_block","create_if_block_12","t1_value","img_alt_value","t1","raw_value","fds_image_editor_button_icon_value","fds_image_editor_button_title_value","create_if_block_13","create_if_block_11","if_block2","create_if_block_10","create_if_block_9","create_if_block_16","each_value_2","create_if_block_3","create_if_block_7","each_value","create_if_block_5","create_if_block_4","select","option","option_selected_value","undefined","create_if_block_6","fds_presets_dialog","create_if_block","openLink","open","async","convertToPNG","base64Image","Image","onload","canvas","getContext","drawImage","pngDataUrl","toDataURL","serverstatusurl","contentelement","openProfile","finishedInit","initwidth","initheight","serverurl","bearer","servertype","file_base64","file_blob","file_type","file_name","file_uncompressed","onclosed","serverIsAvailable","posenetselectoropen","search3dopen","scene3DGetPrimitive","selectModifier","reopendialogevent","layerStack","toY","quickStart","shadow","shadowRoot","links","openmodifiers","stack","contains","rect","getBoundingClientRect","$$invalidate","fromX","innerWidth","right","fromY","top","wizardCurrentStep","wizardData","startWizard","wizard_glb","wizard_image","wizard_pose","wizard_text","wizard_prompt","wizard_modifier","wizard_outpainting","wizard_background","gotoWizardStep","wizardCurrentstepData","next","setfinishedInitIfServerIsAvailable","substring","generalConfig","setOutpaintingDirection","poseComponent","scene3dComponent","textComponent","selectFont","autoSize","renderForAI","thumb","handleClick","entry","binaryData","arrayBuffer","onPremise","detail","setScene","searchstring","sceneparams","meshes","BABYLON","camera","position","Vector3","rotation","files","startsWith","reader","FileReader","decode","readAsDataURL","upperText","$$value","configList","li","ol","current","liWidth","state","Config","imageDialog","regenerate","inpaint_mask_blur","inpaint_mask_content","tokenid","m1fix","allVisible","dlgData","steps_update","previewMode","globalData","appRegisteredhash","dateRegistered","fingerprint","ModifierData","tags","currentConfigNum","getDefault","saveToken","localStorage","setItem","loadToken","getItem","updateGlobalData","load","save","saveObj","allconfStr","allconf","configType","conf","mappingsHelper","getDefaultFields","notInRuleEditor","getMappingFields","metadata","fields","forms","elements","defaultFields","outputFields","field","split_value_num","split_value_type","newField","originalName","num_layers","rulesExecution","getField","fieldName","fieldList","checkArray","getArrayName","convertValue","isFloat","step","getValue","arrayIdx","arrayName","propertyName","setValue","execute","rules","hiddenFields","showFields","leftValue","rule","rightValue","targetFieldName","targetField","condition","actionType","actionValue","hideIt","showIt","fromFieldName","_force_render","targetParameter","loopPreparser","workflow","nodeMapping","getGroup","groups","group","gx","gy","gWidth","gHeight","bounding","nx","ny","pos","getNodeById","nodeId","getGroupByName","groupName","isNodeInGroup","updateNodeLinks","inputs","outputs","output","linkID","fromNodeID","fromSlot","toNodeID","toSlot","fromNode","toNode","removeGyreNodesAndLinkDirectly","outgoingLink","incomingLink","newLink","last_link_id","splitLinkWithGyreStartNode","linkIndex","findIndex","originalLink","newGyreStartNodeID","last_node_id","newLink1ID","newLink2ID","gyreStartNode","newLink1","newLink2","adjustLinksForSpecialNodes","gyreLoopEndNodes","linksToRemove","removedLinks","newLinks","removedLink","removedLinkID","linkFromGyreLoopStart","linkFromNodeID","__","linkToNodeID","slot","linkType","clonedToNodeID","newLinkID","duplicateGroupWithNodesAndLinks","groupNameClone","originalGroup","maxNodeId","maxLinkId","newGroup","newNode","cloneMappings","mappings","extra","gyre","nodeMappings","newNodeID","deactivateGroup","generateLoop","arraySize","valuePreparser","loopParser","getWidgetIndex","nodeWidgets","nId","widgets","getLinkById","linkId","linkArr","getImage","getWorkflowImageRequestServerInstance","getSingleImage","getLayerImage","layerName","layerID","getFile","setNodesValue","mappingList","nodeIdInt","targetIndex","targetNode","widget","targetNodeId","mapping","fromField","widgets_values","toIndex","setNodesValueGroup","removeVirtualNodes","isVirtualNode","virtualNodes","setValues","propName","fieldNameIndex","splitCustomValues","splitField","ComfyUIPreparser","generateLoops","loop","executeAllRules","vp","getTestData","hasMask","controlnet","global","LiteGraph","VERSION","CANVAS_GRID_SIZE","NODE_TITLE_HEIGHT","NODE_TITLE_TEXT_Y","NODE_SLOT_HEIGHT","NODE_WIDGET_HEIGHT","NODE_WIDTH","NODE_MIN_WIDTH","NODE_COLLAPSED_RADIUS","NODE_COLLAPSED_WIDTH","NODE_TITLE_COLOR","NODE_SELECTED_TITLE_COLOR","NODE_TEXT_SIZE","NODE_TEXT_COLOR","NODE_SUBTEXT_SIZE","NODE_DEFAULT_COLOR","NODE_DEFAULT_BGCOLOR","NODE_DEFAULT_BOXCOLOR","NODE_DEFAULT_SHAPE","NODE_BOX_OUTLINE_COLOR","DEFAULT_SHADOW_COLOR","DEFAULT_GROUP_FONT","WIDGET_BGCOLOR","WIDGET_OUTLINE_COLOR","WIDGET_TEXT_COLOR","WIDGET_SECONDARY_TEXT_COLOR","LINK_COLOR","EVENT_LINK_COLOR","CONNECTING_LINK_COLOR","MAX_NUMBER_OF_NODES","DEFAULT_POSITION","VALID_SHAPES","BOX_SHAPE","ROUND_SHAPE","CIRCLE_SHAPE","CARD_SHAPE","ARROW_SHAPE","GRID_SHAPE","INPUT","OUTPUT","EVENT","ACTION","NODE_MODES","NODE_MODES_COLORS","ALWAYS","ON_EVENT","NEVER","ON_TRIGGER","UP","DOWN","LEFT","RIGHT","CENTER","LINK_RENDER_MODES","STRAIGHT_LINK","LINEAR_LINK","SPLINE_LINK","NORMAL_TITLE","NO_TITLE","TRANSPARENT_TITLE","AUTOHIDE_TITLE","VERTICAL_LAYOUT","proxy","node_images_path","debug","catch_exceptions","throw_errors","allow_scripts","registered_node_types","node_types_by_file_extension","Nodes","Globals","searchbox_extras","auto_sort_node_types","node_box_coloured_when_on","node_box_coloured_by_mode","dialog_close_on_mouse_leave","dialog_close_on_mouse_leave_delay","shift_click_do_break_link_from","click_do_break_link_to","search_hide_on_mouse_leave","search_filter_enabled","search_show_all_on_open","auto_load_slot_types","registered_slot_in_types","registered_slot_out_types","slot_types_in","slot_types_out","slot_types_default_in","slot_types_default_out","alt_drag_do_clone_nodes","do_add_triggers_slots","allow_multi_output_for_events","middle_click_slot_add_default_node","release_link_on_empty_shows_menu","pointerevents_method","ctrl_shift_v_paste_connect_unselected_outputs","use_uuids","registerNodeType","base_class","classname","lastIndexOf","category","LGraphNode","prev","_shape","supported_extensions","ext","toLowerCase","onNodeTypeRegistered","onNodeTypeReplaced","onPropertyChange","unregisterNodeType","registerNodeAndSlotType","slot_type","out","class_type","allTypes","slotType","registerTo","sort","wrapFunctionAsNode","func","param_types","return_type","properties","params","code","names","getParameterNames","classobj","desc","onExecute","getInputData","setOutputData","clearRegisteredTypes","addNodeMethod","createNode","err","properties_info","flags","computeSize","onNodeCreated","getNodeType","getNodeTypesInCategory","localeCompare","getNodeTypesCategories","categories","skip_list","reloadNodes","folder_wildcard","tmp","getElementsByTagName","script_files","docHeadObj","dynamicScript","cloneObject","uuidv4","isValidConnection","type_a","type_b","supported_types_a","supported_types_b","j","registerSearchboxExtra","node_type","fetchFile","on_complete","on_error","blob","File","readAsArrayBuffer","readAsText","readAsBinaryString","LGraph","list_of_graphcanvas","configure","LLink","origin_id","origin_slot","target_id","target_slot","_data","_pos","Float32Array","_ctor","LGraphGroup","DragAndScale","skip_events","offset","scale","max_scale","min_scale","onredraw","enabled","last_mouse","visible_area","bindEvents","LGraphCanvas","graph","background_image","DEFAULT_BACKGROUND_IMAGE","ds","zoom_modify_alpha","title_text_font","inner_text_font","node_title_color","default_link_color","default_connection_color","input_off","input_on","output_off","output_on","default_connection_color_byType","default_connection_color_byTypeOff","highquality_render","use_gradients","editor_alpha","pause_rendering","clear_background","clear_background_color","read_only","render_only_selected","live_mode","show_info","allow_dragcanvas","allow_dragnodes","allow_interaction","multi_select","allow_searchbox","allow_reconnect_links","align_to_grid","drag_mode","dragging_rectangle","set_canvas_dirty_on_mouse_event","always_render_background","render_shadows","render_canvas_border","render_connections_shadows","render_connections_border","render_curved_connections","render_connection_arrows","render_collapsed_slots","render_execution_order","render_title_colored","render_link_tooltip","links_render_mode","mouse","graph_mouse","canvas_mouse","onSearchBox","onSearchBoxSelection","onMouse","onDrawBackground","onDrawForeground","onDrawOverlay","onDrawLinkTooltip","onNodeMoved","onSelectionChange","onConnectingChange","onBeforeChange","onAfterChange","connections_width","round_radius","current_node","node_widget","over_link_center","last_mouse_position","visible_links","viewport","attachCanvas","setCanvas","skip_render","startRendering","autoresize","performance","getTime","now","Date","hrtime","supported_types","getSupportedTypes","STATUS_STOPPED","STATUS_RUNNING","_version","_nodes","onRemoved","_nodes_by_id","_nodes_in_order","_nodes_executable","_groups","iteration","config","vars","globaltime","runningtime","fixedtime","fixedtime_lapse","elapsed_time","last_update_time","starttime","catch_errors","nodes_executing","nodes_actioning","nodes_executedAction","change","sendActionToCanvas","graphcanvas","detachCanvas","interval","onPlayEvent","sendEventToAllNodes","requestAnimationFrame","on_frame","execution_timer_id","onBeforeStep","runStep","onAfterStep","onStopEvent","do_not_catch_errors","limit","doExecute","onExecuteStep","onAfterExecute","errors_in_execution","elapsed","execution_time","updateExecutionOrder","computeExecutionOrder","only_onExecute","set_level","L","S","M","visited_links","remaining_links","l2","_level","shift","link_id","target_node","order","A","B","Ap","priority","Bp","getAncestors","ancestors","pending","visited","getInputNode","arrange","margin","layout","columns","col","column","max_size","max_size_index","node_size_index","setDirtyCanvas","getFixedTime","getElapsedTime","eventname","Subgraph","action","skip_compute_order","onAdded","alignToGrid","onNodeAdded","ignore_remove","beforeChange","disconnectInput","disconnectOutput","selected_nodes","node_dragged","onNodeRemoved","afterChange","findNodesByClass","classObject","findNodesByType","findNodeByTitle","findNodesByTitle","getNodeOnPos","nodes_list","skip_title","title_mode","isPointInside","getGroupOnPos","checkNodeTypes","ctor","newnode","serialize","param","_input_nodes","GraphInput","actionDo","trigger","onTrigger","addInput","onInputAdded","onInputsOutputsChange","setInputData","renameInput","old_name","onInputRenamed","changeInputType","onInputTypeChanged","removeInput","onInputRemoved","addOutput","onOutputAdded","getOutputData","renameOutput","onOutputRenamed","changeOutputType","onOutputTypeChanged","removeOutput","onOutputRemoved","triggerInput","setCallback","setTrigger","info","connectionChange","link_info","onConnectionChange","isLive","clearTriggeredSlots","_last_time","on_change","fg","bg","removeLink","nodes_info","link2","groups_info","onSerialize","keep_old","link_data","n_info","last_serialization","has_errors","onConfigure","req","XMLHttpRequest","send","oEvent","onerror","onNodeTrace","msg","color","connections","onPropertyChanged","onConnectionsChange","property","serialize_widgets","bgcolor","boxcolor","shape","clone","getTitle","prev_value","output_info","setOutputDataType","force_update","updateOutputData","getInputDataType","getInputDataByName","slot_name","findInputSlot","isInputConnected","getInputInfo","getInputLink","slot_info","getInputOrProperty","input_info","getOutputInfo","isOutputConnected","isAnyOutputConnected","getOutputNodes","addOnTriggerInput","trigS","optional","nameLocked","addOnExecutedOutput","findOutputSlot","onAfterExecuteNode","triggerSlot","changeMode","modeTo","ON_REQUEST","action_call","exec_version","execute_triggered","action_triggered","_last_trigger_time","target_connection","clearTriggeredSlot","setSize","onResize","addProperty","default_value","extra_info","addOutputs","addInputs","addConnection","rows","title_width","compute_text_size","input_width","output_width","text_width","slot_start_y","widgets_height","widgets_up","widgets_start_y","min_height","inResizeCorner","canvasX","canvasY","outputs_offset","isInsideRectangle","getPropertyInfo","widgets_info","onGetPropertyInfo","addWidget","values","addCustomWidget","custom_widget","getBounding","compute_outer","nodePos","isCollapsed","collapsed","nodeSize","left_offset","right_offset","top_offset","bottom_offset","_collapsed_width","onBounding","margin_top","getSlotInPosition","link_pos","getConnectionPos","returnObj","findInputSlotFree","optsIn","opts","typesNotAccepted","findOutputSlotFree","findInputSlotByType","preferFreeSlot","doNotUseOccupied","findSlotByType","findOutputSlotByType","aSlots","aSource","aDest","sI","dI","connectByType","target_slotType","createEventInCase","firstFreeIfOutputGeneralInCase","generalTypeInCase","Number","connect","connectByTypeOutput","source_node","source_slotType","firstFreeIfInputGeneralInCase","source_slot","changed","onBeforeConnectInput","onConnectInput","onConnectOutput","doProcessChange","onNodeConnectionChange","is_input","slot_number","num_slots","horizontal","round","trace","MAX_CONSOLE","dirty_foreground","dirty_background","loadImage","captureInput","node_capturing_input","collapse","force","collapsable","pin","pinned","localToScreen","node_colors","pale_blue","groupcolor","_bounding","subarray","_size","move","deltax","deltay","ignore_nodes","recomputeInsideNodes","node_bounding","overlapBounding","_binded_mouse_callback","pointerListenerAdd","computeVisibleArea","startx","starty","endx","endy","clientX","left","clientY","canvasx","canvasy","dragging","is_inside","ignore","onmouse","pointerListenerRemove","mouseDrag","eventType","wheel","deltaY","wheelDeltaY","delta","wheelDelta","changeDeltaScale","stopPropagation","toCanvasContext","translate","convertOffsetToCanvas","convertCanvasToOffset","changeScale","zooming_center","center","new_center","delta_offset","reset","link_type_colors","number","gradients","frame","last_draw_time","render_time","fps","selected_group","visible_nodes","node_over","connecting_node","highlighted_links","dragging_canvas","dirty_canvas","dirty_bgcanvas","dirty_area","node_in_panel","last_mouseclick","pointer_is_down","pointer_is_double","onClear","setGraph","skip_clear","_graph_stack","setDirty","getTopGraph","openSubgraph","checkPanels","closeSubgraph","subgraph_node","_subgraph_node","centerOnNode","selectNodes","getCurrentGraph","getElementById","unbindEvents","tabindex","bgcanvas","localName","webgl_enabled","enableWebGL","_doNothing","_doReturnTrue","_events_binded","getCanvasWindow","_mousedown_callback","processMouseDown","_mousewheel_callback","processMouseWheel","_mousemove_callback","processMouseMove","_mouseup_callback","processMouseUp","_key_callback","processKey","_ondrop_callback","processDrop","getFileExtension","question","point","GL","enableWebGLCanvas","gl","webgl","bgctx","fgcanvas","ownerDocument","defaultView","parentWindow","is_rendering","renderFrame","draw","stopRendering","blockClick","block_click","adjustMouseEvent","ref_window","active_canvas","skip_action","is_primary","isPrimary","is_double_click","last_click_position","closeAllContextMenus","which","mClikSlot","mClikSlot_index","mClikSlot_isOut","alphaPosY","posRef","createDefaultNodeForSlot","nodeFrom","slotFrom","nodeTo","slotTo","nodeType","posAdd","posSizeFix","ctrlKey","metaKey","processContextMenu","altKey","cloned","doCalcSize","block_drag_node","processNodeSelected","clicking_canvas_bg","showLinkMenu","selected_group_resizing","distance","showSearchBox","bringToFront","resizable","resizing_node","cursor","connecting_output","slot_index","connecting_pos","connecting_slot","onOutputDblClick","onOutputClick","onInputDblClick","onInputClick","connecting_input","processNodeWidgets","onDblClick","processNodeDblClicked","onMouseDown","subgraph","skip_subgraph_button","is_selected","last_mouse_dragging","activeElement","nodeName","resize","mouseOver","onMouseLeave","redraw_on_mouse","onMouseEnter","onMouseMove","_highlight_input","isOverNodeBox","isOverNodeInput","_highlight_input_slot","_highlight_output","isOverNodeOutput","over_link","desired_size","min_size","click_time","diffx","diffy","to_select","nodeX","connType","node_from","slot_from","type_filter_in","node_to","type_filter_out","showConnectionMenu","deselectAllNodes","onMouseUp","title_height","slot_pos","block_default","keyCode","node_panel","options_panel","copyToClipboard","pasteFromClipboard","deleteSelectedNodes","onKeyDown","onKeyUp","stopImmediatePropagation","clipboard_info","selected_nodes_array","clonable","_relative_id","isConnectUnselected","posMin","posMinIndexes","node_data","origin_node","origin_node_relative_id","origin_node_id","onDropItem","checkDropItem","onDropFile","onDropData","dataTransfer","filename","nodetype","onShowNodePanel","onNodeDblClicked","selectNode","onNodeSelected","add_to_current_selection","deselectNode","onSelected","onDeselected","onNodeDeselected","block_delete","input_link","output_link","input_node","output_node","clientX_rel","clientY_rel","deltaX","setZoom","convertEventToCanvasOffset","sendToBack","unshift","temp","computeVisibleNodes","force_canvas","force_bgcanvas","drawBackCanvas","drawFrontCanvas","start2D","restore","setTransform","area","beginPath","clearRect","onRender","renderInfo","drawNode","drawExecutionOrder","links_ontop","drawConnections","lineWidth","link_color","connInOrOut","connDir","dir","connShape","renderLink","moveTo","lineTo","closePath","arc","PI","fillStyle","strokeStyle","strokeRect","drawLinkTooltip","visible_rect","drawSubgraphPanel","finish2D","subnode","drawSubgraphPanelLeft","drawSubgraphPanelRight","globalAlpha","roundRect","textAlign","fillText","drawButton","not_subgraph_input","input_node_type","showSubgraphPropertiesDialog","canvas_w","title_text","tw","measureText","output_node_type","showSubgraphPropertiesDialogRight","hovercolor","textcolor","hover","clicked","was_clicked","isAreaClicked","hold_click","toFixed","bg_already_painted","onRenderBackground","fillRect","imageSmoothingEnabled","_bg_img","pattern","_pattern","createPattern","_pattern_img","drawGroups","onBackgroundRender","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","finish","temp_vec2","low_quality","onDrawCollapsed","min","clip_area","drawNodeShape","render_text","out_slot","in_slot","max_y","input_slot","output_slot","slot_shape","color_on","color_off","doStroke","stroke","widgets_y","drawNodeWidgets","toToolTip","tmp_area","fgcolor","mouse_over","render_title","old_alpha","onDrawTitleBar","title_color","grad","createLinearGradient","addColorStop","colState","box_size","onDrawTitleBox","onDrawTitleText","title_text_color","over","onDrawTitle","margin_area","link_bounding","tempA","tempB","compareObjects","sqrt","colorToString","growBounding","isInsideBounding","bb","A_end_x","A_end_y","B_end_x","B_end_y","hex2num","hex","int1","int2","hex_alphabets","num2hex","triplet","ContextMenu","parentMenu","lock","current_submenu","eventClass","on_mouse_wheel","scroll_speed","minWidth","minHeight","pointerEvents","addItem","closing_timer","root_document","fullscreenElement","body_rect","root_rect","CurveEditor","nearest","must_update","clamp","start_node","start_node_slot","start_node_slotpos","end_node_slotpos","start_slot","end_slot","start_dir","end_dir","skip_border","flow","num_sublines","dist","lineJoin","offsety","start_offset_x","start_offset_y","end_offset_x","end_offset_y","bezierCurveTo","start_x","start_y","end_x","end_y","computeConnectionPoint","posA","posB","posC","posD","angleA","angleB","atan2","rotate","p0","p1","p2","p3","c1","c2","c3","c4","posY","active_widget","H","show_text","outline_color","background_color","text_color","secondary_text_color","last_y","disabled","widget_width","range","nvalue","slider_color","marker","marker_nvalue","marker_color","precision","widget_height","old_value","inner_value_change","allow_scroll","values_list","text_values","inner_clicked","multiline","onWidgetChanged","DEFAULT_GROUP_FONT_SIZE","adjustNodesSize","parent","offsetWidth","switchLiveMode","transition","onNodeSelectionChange","onGroupAdd","mouse_event","getBoundaryNodes","bottom","nID","boundaryNodesForSelection","alignNodes","align_to","boundaryNodes","onNodeAlign","prev_menu","onGroupAlign","onMenuAdd","inner_onMenuAdded","base_category","base_category_regex","RegExp","category_name","category_path","has_submenu","mouseEvent","contextMenu","first_event","getFirstEvent","onMenuCollapseAll","onMenuNodeEdit","showMenuNodeOptionalInputs","optional_inputs","onGetInputs","removable","onMenuNodeInputs","retEntries","onNodeInputAdd","showMenuNodeOptionalOutputs","optional_outputs","onGetOutputs","skip_repeated_outputs","onMenuNodeOutputs","onNodeOutputAdd","onShowMenuNodeProperties","getPropertyPrintableValue","decodeHTML","showEditPropertyValue","allow_html","innerText","onMenuResizeNode","menu","fApplyMultiNode","node_left","node_right","fromType","destType","optPass","isFrom","isTo","slotX","iSlotConn","fromSlotType","slotTypesDefault","nodeNewType","typeX","nodeNewOpts","onShowPropertyEditor","dialog","is_modified","inner","offsetx","dialogCloseTimer","prompt_box","prevent_timeout","selInDia","selIn","value_element","search_limit","def_options","do_type_filter","show_general_if_none_on_typefilter","show_general_after_typefiltered","hide_on_mouse_leave","show_all_if_empty","show_all_on_open","overflow","selOut","search_box","timeout_close","helper","first","timeout","changeSelection","refreshHelper","dataset","nSlots","iK","opt","iS","forward","previousSibling","scrollIntoView","behavior","addResult","sIn","sOut","inner_test_filter","filtered_extra","inTypeOverride","outTypeOverride","skipFilter","sType","sV","help","typeEl","escape","layerY","maxHeight","input_html","createDialog","modified","checked","onclose","checkForInput","closeOnLeave","closeOnLeave_checkModified","aI","iX","createPanel","header","closable","title_element","alt_content","footer","onClose","toggleAltContent","vTo","vAlt","toggleFooterVisibility","addHTML","on_footer","elem","addButton","addSeparator","str_value","inner_showCodePad","propname","innerChange","elem_that","onOpen","desc_value","closePanels","panel","showShowGraphOptionsPanel","refOpts","obEv","refMenu","refMenu2","lgraphcanvas","OPTIONPANEL_IS_OPEN","fUpdate","aProps","availableCanvasOptions","pI","pX","inner_refresh","showShowNodePanel","SELECTED_NODE","NODEPANEL_IS_OPEN","kV","nodeCol","pName","nK","onAddPropertyToPanel","onShowCustomPanelInfo","fDoneWith","float","old_panel","not_subgraph_output","panels","onMenuNodeCollapse","onMenuNodePin","onMenuNodeMode","onMenuNodeColors","fApplyColor","onMenuNodeShapes","onMenuNodeRemove","onMenuNodeToSubgraph","buildFromNodes","onMenuNodeClone","newSelected","red","brown","green","blue","cyan","purple","yellow","black","getCanvasMenuOptions","getMenuOptions","getExtraMenuOptions","getNodeMenuOptions","onGetNodeMenuOptions","getGroupMenuOptions","menu_info","active_node","getSlotMenuOptions","_slot","locked","submenu","CanvasRenderingContext2D","radius","radius_low","top_left_radius","top_right_radius","bottom_left_radius","bottom_right_radius","quadraticCurveTo","inner_onclick","close_parent","ignore_item_callbacks","autoopen","onclick_callback","ignore_parent_menu","isCursorOverElement","event_name","evt","createEvent","initCustomEvent","srcElement","dispatchEvent","__events","getTopMenu","extendClass","__lookupGetter__","__defineGetter__","__lookupSetter__","__defineSetter__","sampleCurve","pn","local_f","line_color","inactive","localpos","max_dist","getCloserPoint","curvepos","_nearest","is_edge_point","min_dist","closest","vec2","oDOM","sEvIn","fCall","capture","sMethod","sEvent","PointerEvent","webkitRequestAnimationFrame","mozRequestAnimationFrame","convertToApiJson","datajson","systemstats","fixJsonPathsForOs","fixDataJson","createApiJson","iswindows","idx1","el1","isValidUrl","replaceAll","checkIsVirtualNode","prepareGraph","outer","beforeQueued","getInnerNodes","applyToGraph","apiJsonOutput","outerNode","innerNodes","nodeInputs","nodewidgets","wdgt","serializeValue","parentnode","nodelink","nodefound","allInp","inpParent","updateLink","ntitle","_meta","inputName","Comfy","getInstance","stoperror","randomname","uploadImage","cmfy","serverAddress","errorObject","wflistresult","deactivatedlist","wfid","workflowid","clientId","serverAddressNoPrefix","wsprefix","wsurl","ws","disconnect","WebSocket","onopen","getEmbeddings","getExtensions","getImages","promptId","queuePrompt","prompt_id","outputImages","onMessage","onwsmessage","isBinary","totalNodes","nodesNames","messageData","history","getHistory","currworkflow","nodeOutput","elementsOutput","subfolder","URLSearchParams","client_id","cancelRequestMethod","interrupt","editHistory","getComfySystemStats","uploadLog","file_path","jsonData","debugdir","json_str","status_str","messages","uploadFile","textfile","overwrite","formData","FormData","uploadMask","originalRef","getFormValues","currentWorkflowListValues","elementvalue","generateSeed","getControlNetData","createDataForParser","hasInitImage","document_width","document_height","mergedImage","mask","maskURLRef","cntrdata","workflowapijson","workflowList","currentworkflowelementname","workflowListValues","currentworkflowelementid","parser","formdata","numberimages","number_images","seedlist","layergeneration","generateasync","generatesync","debugNextGenerate","logfilename","getFullYear","getMonth","getDate","getHours","getMinutes","system","os","morerequests","stringwf","newseed","generateAllImages","cancelrequest","wapijson","elseed","executeRequest","resultinnewlayer","blobToBase64","onloadend","tmpobj","workflow_image_request","invert_controlnet_sketch","availableModels","crypto","getRandomValues","Uint8Array","SDWebservice","createSDGrpc","gs","samplers","defaultProps","image_number_max","removeBackground","autoMatte","getServerData","reqData","estimateTime","timeCalculation","d2","estimateTimeQueue","imgs","startTime","duration","switchModel","enable_hr","denoising_strength","firstphase_width","firstphase_height","subseed","subseed_strength","seed_resize_from_h","seed_resize_from_w","batch_size","n_iter","cfg_scale","restore_faces","negative_prompt","eta","s_churn","s_tmax","s_tmin","s_noise","override_settings","sampler_index","init_images","resize_mode","inpaint_full_res","inpainting_fill","mask_blur","b64Data","allSeeds","engineList","model_name","hash","inpainting_model","request","sd_model_checkpoint","getFullPrompt","dlg","prefix","getLoraList","getNegativePrompt","getPromptObject","SDMode","ImageInfo","AlphaImgInfo","DepthImageInfo","ImageInfoSelection","enable_depth","imageURLRef","urlRef","depthImage64","imageInfoSelectionURLRef","ComfyStandAlone","instancestandalone","activateErrorListener","callback_error","callBack_files","runSDById","workflowId","callback_finished","workflowName","byId","wf","PostMessageAdapter","firstconfigelement","server_features","initurl","initbearer","uncompressed","imageType","WS","sdws","documentInfo","serverFeatures","changeConfigElement","objkey","skiprefresh","modifier","modifierdata","workflowlist","promptClass","generate","AlphaImageInfo","standalone","taskel","servername","StandAloneSDConfig","comfysa","globalThis","ComfyUI","executeWorkflow","executeWorkflowById","sdConfig","inst","componentversion"],"mappings":"gCAAA,SAASA,OAAU,CAkBnB,SAASC,IAAIC,GACT,OAAOA,GACX,CACA,SAASC,eACL,OAAOC,OAAOC,OAAO,KACzB,CACA,SAASC,QAAQC,GACbA,EAAIC,QAAQP,IAChB,CACA,SAASQ,YAAYC,GACjB,MAAwB,mBAAVA,CAClB,CACA,SAASC,eAAeC,EAAGC,GACvB,OAAOD,GAAKA,EAAIC,GAAKA,EAAID,IAAMC,GAAOD,GAAkB,iBAANA,GAAgC,mBAANA,CAChF,CACA,IAAIE,qBA4jCAC,kBA3jCJ,SAASC,cAAcC,EAAaC,GAKhC,OAJKJ,uBACDA,qBAAuBK,SAASC,cAAc,MAElDN,qBAAqBO,KAAOH,EACrBD,IAAgBH,qBAAqBO,IAChD,CAIA,SAASC,SAASC,GACd,OAAmC,IAA5BnB,OAAOoB,KAAKD,GAAKE,MAC5B,CAMA,SAASC,UAAUC,KAAUC,GACzB,GAAa,MAATD,EACA,OAAO3B,KAEX,MAAM6B,EAAQF,EAAMD,aAAaE,GACjC,OAAOC,EAAMC,YAAc,IAAMD,EAAMC,cAAgBD,CAC3D,CACA,SAASE,gBAAgBJ,GACrB,IAAIK,EAEJ,OADAN,UAAUC,GAAOM,GAAKD,EAAQC,GAA9BP,GACOM,CACX,CAiSA,SAASE,OAAOC,EAAQC,GACpBD,EAAOE,YAAYD,EACvB,CAoDA,SAASE,OAAOH,EAAQC,EAAMG,GAC1BJ,EAAOK,aAAaJ,EAAMG,GAAU,KACxC,CASA,SAASE,OAAOL,GACRA,EAAKM,YACLN,EAAKM,WAAWC,YAAYP,EAEpC,CACA,SAASQ,aAAaC,EAAYC,GAC9B,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAWpB,OAAQsB,GAAK,EACpCF,EAAWE,IACXF,EAAWE,GAAGC,EAAEF,EAE5B,CACA,SAASG,QAAQC,GACb,OAAO/B,SAASC,cAAc8B,EAClC,CAmBA,SAASC,KAAKC,GACV,OAAOjC,SAASkC,eAAeD,EACnC,CACA,SAASE,QACL,OAAOH,KAAK,IAChB,CACA,SAASI,QACL,OAAOJ,KAAK,GAChB,CAIA,SAASK,OAAOpB,EAAMqB,EAAOC,EAASC,GAElC,OADAvB,EAAKwB,iBAAiBH,EAAOC,EAASC,GAC/B,IAAMvB,EAAKyB,oBAAoBJ,EAAOC,EAASC,EAC1D,CAoCA,SAASG,KAAK1B,EAAM2B,EAAW/B,GACd,MAATA,EACAI,EAAK4B,gBAAgBD,GAChB3B,EAAK6B,aAAaF,KAAe/B,GACtCI,EAAK8B,aAAaH,EAAW/B,EACrC,CAwCA,SAASmC,wBAAwB/B,EAAMgC,EAAMpC,GACrCoC,KAAQhC,EACRA,EAAKgC,GAA8B,kBAAfhC,EAAKgC,IAAiC,KAAVpC,GAAsBA,EAGtE8B,KAAK1B,EAAMgC,EAAMpC,EAEzB,CAwEA,SAASqC,SAASpB,GACd,OAAOqB,MAAMC,KAAKtB,EAAQuB,WAC9B,CA6HA,SAASC,SAAStB,EAAMC,GACpBA,EAAO,GAAKA,EACRD,EAAKC,OAASA,IAElBD,EAAKC,KAAOA,EAChB,CAeA,SAASsB,gBAAgBC,EAAO3C,GAC5B2C,EAAM3C,MAAiB,MAATA,EAAgB,GAAKA,CACvC,CASA,SAAS4C,UAAUxC,EAAMyC,EAAK7C,EAAO8C,GACpB,MAAT9C,EACAI,EAAK2C,MAAMC,eAAeH,GAG1BzC,EAAK2C,MAAME,YAAYJ,EAAK7C,EAAO8C,EAAY,YAAc,GAErE,CAqFA,SAASI,aAAajC,EAASC,EAAMiC,GACjClC,EAAQmC,UAAUD,EAAS,MAAQ,UAAUjC,EACjD,CAyFA,SAASmC,oBAAoBC,GACzB,MAAMC,EAAS,CAAA,EACf,IAAK,MAAMxB,KAAauB,EACpBC,EAAOxB,EAAUb,MAAQa,EAAU/B,MAEvC,OAAOuD,CACX,CAmJA,SAASC,sBAAsBC,GAC3B1E,kBAAoB0E,CACxB,CACA,SAASC,wBACL,IAAK3E,kBACD,MAAM,IAAI4E,MAAM,oDACpB,OAAO5E,iBACX,CAoBA,SAAS6E,QAAQ1F,GACbwF,wBAAwBG,GAAGC,SAASC,KAAK7F,EAC7C,CAMA,SAAS8F,YAAY9F,GACjBwF,wBAAwBG,GAAGI,aAAaF,KAAK7F,EACjD,CA4FA,MAAMgG,iBAAmB,GAEnBC,kBAAoB,GAC1B,IAAIC,iBAAmB,GACvB,MAAMC,gBAAkB,GAClBC,iBAAmCC,QAAQC,UACjD,IAAIC,kBAAmB,EACvB,SAASC,kBACAD,mBACDA,kBAAmB,EACnBH,iBAAiBK,KAAKC,OAE9B,CAKA,SAASC,oBAAoB3G,GACzBkG,iBAAiBL,KAAK7F,EAC1B,CAsBA,MAAM4G,eAAiB,IAAIC,IAC3B,IAAIC,SAAW,EACf,SAASJ,QAIL,GAAiB,IAAbI,SACA,OAEJ,MAAMC,EAAkBlG,kBACxB,EAAG,CAGC,IACI,KAAOiG,SAAWd,iBAAiBzE,QAAQ,CACvC,MAAMgE,EAAYS,iBAAiBc,UACnCA,WACAxB,sBAAsBC,GACtByB,OAAOzB,EAAUI,GACpB,CACJ,CACD,MAAOsB,GAIH,MAFAjB,iBAAiBzE,OAAS,EAC1BuF,SAAW,EACLG,CACT,CAID,IAHA3B,sBAAsB,MACtBU,iBAAiBzE,OAAS,EAC1BuF,SAAW,EACJb,kBAAkB1E,QACrB0E,kBAAkBiB,KAAlBjB,GAIJ,IAAK,IAAIpD,EAAI,EAAGA,EAAIqD,iBAAiB3E,OAAQsB,GAAK,EAAG,CACjD,MAAMsE,EAAWjB,iBAAiBrD,GAC7B+D,eAAeQ,IAAID,KAEpBP,eAAeS,IAAIF,GACnBA,IAEP,CACDjB,iBAAiB3E,OAAS,CAClC,OAAayE,iBAAiBzE,QAC1B,KAAO4E,gBAAgB5E,QACnB4E,gBAAgBe,KAAhBf,GAEJI,kBAAmB,EACnBK,eAAeU,QACfhC,sBAAsByB,EAC1B,CACA,SAASC,OAAOrB,GACZ,GAAoB,OAAhBA,EAAG4B,SAAmB,CACtB5B,EAAGqB,SACH5G,QAAQuF,EAAG6B,eACX,MAAMC,EAAQ9B,EAAG8B,MACjB9B,EAAG8B,MAAQ,EAAE,GACb9B,EAAG4B,UAAY5B,EAAG4B,SAASG,EAAE/B,EAAGgC,IAAKF,GACrC9B,EAAGI,aAAazF,QAAQqG,oBAC3B,CACL,CAIA,SAASiB,uBAAuBvH,GAC5B,MAAMwH,EAAW,GACXC,EAAU,GAChB5B,iBAAiB5F,SAASyH,IAA0B,IAApB1H,EAAI2H,QAAQD,GAAYF,EAAShC,KAAKkC,GAAKD,EAAQjC,KAAKkC,KACxFD,EAAQxH,SAASyH,GAAMA,MACvB7B,iBAAmB2B,CACvB,CAeA,MAAMI,SAAW,IAAIpB,IAerB,SAASqB,cAAcC,EAAOC,GACtBD,GAASA,EAAMtF,IACfoF,SAASI,OAAOF,GAChBA,EAAMtF,EAAEuF,GAEhB,CA4rBA,SAASE,gBAAgB/C,EAAWtD,EAAQI,EAAQkG,GAChD,MAAMhB,SAAEA,EAAQxB,aAAEA,GAAiBR,EAAUI,GAC7C4B,GAAYA,EAASiB,EAAEvG,EAAQI,GAC1BkG,GAED5B,qBAAoB,KAChB,MAAM8B,EAAiBlD,EAAUI,GAAGC,SAAS8C,IAAI3I,KAAK4I,OAAOpI,aAIzDgF,EAAUI,GAAGiD,WACbrD,EAAUI,GAAGiD,WAAW/C,QAAQ4C,GAKhCrI,QAAQqI,GAEZlD,EAAUI,GAAGC,SAAW,EAAE,IAGlCG,EAAazF,QAAQqG,oBACzB,CACA,SAASkC,kBAAkBtD,EAAW3C,GAClC,MAAM+C,EAAKJ,EAAUI,GACD,OAAhBA,EAAG4B,WACHK,uBAAuBjC,EAAGI,cAC1B3F,QAAQuF,EAAGiD,YACXjD,EAAG4B,UAAY5B,EAAG4B,SAASzE,EAAEF,GAG7B+C,EAAGiD,WAAajD,EAAG4B,SAAW,KAC9B5B,EAAGgC,IAAM,GAEjB,CACA,SAASmB,WAAWvD,EAAW1C,IACI,IAA3B0C,EAAUI,GAAG8B,MAAM,KACnBzB,iBAAiBH,KAAKN,GACtBiB,kBACAjB,EAAUI,GAAG8B,MAAMsB,KAAK,IAE5BxD,EAAUI,GAAG8B,MAAO5E,EAAI,GAAM,IAAO,GAAMA,EAAI,EACnD,CACA,SAASmG,KAAKzD,EAAW9B,EAASwF,EAAUC,EAAiBC,EAAWC,EAAOC,EAAe5B,EAAQ,EAAE,IACpG,MAAM6B,EAAmBzI,kBACzByE,sBAAsBC,GACtB,MAAMI,EAAKJ,EAAUI,GAAK,CACtB4B,SAAU,KACVI,IAAK,GAELyB,QACApC,OAAQlH,KACRqJ,YACAI,MAAOtJ,eAEP2F,SAAU,GACVgD,WAAY,GACZY,cAAe,GACfhC,cAAe,GACfzB,aAAc,GACd0D,QAAS,IAAIC,IAAIjG,EAAQgG,UAAYH,EAAmBA,EAAiB3D,GAAG8D,QAAU,KAEtF/H,UAAWzB,eACXwH,QACAkC,YAAY,EACZC,KAAMnG,EAAQxB,QAAUqH,EAAiB3D,GAAGiE,MAEhDP,GAAiBA,EAAc1D,EAAGiE,MAClC,IAAIC,GAAQ,EAkBZ,GAjBAlE,EAAGgC,IAAMsB,EACHA,EAAS1D,EAAW9B,EAAQ2F,OAAS,CAAE,GAAE,CAACvG,EAAGiH,KAAQC,KACnD,MAAMjI,EAAQiI,EAAKxI,OAASwI,EAAK,GAAKD,EAOtC,OANInE,EAAGgC,KAAOwB,EAAUxD,EAAGgC,IAAI9E,GAAI8C,EAAGgC,IAAI9E,GAAKf,MACtC6D,EAAGgE,YAAchE,EAAG4D,MAAM1G,IAC3B8C,EAAG4D,MAAM1G,GAAGf,GACZ+H,GACAf,WAAWvD,EAAW1C,IAEvBiH,CAAG,IAEZ,GACNnE,EAAGqB,SACH6C,GAAQ,EACRzJ,QAAQuF,EAAG6B,eAEX7B,EAAG4B,WAAW2B,GAAkBA,EAAgBvD,EAAGgC,KAC/ClE,EAAQxB,OAAQ,CAChB,GAAIwB,EAAQuG,QAAS,CAEjB,MAAMC,EAAQ9F,SAASV,EAAQxB,QAE/B0D,EAAG4B,UAAY5B,EAAG4B,SAAS2C,EAAED,GAC7BA,EAAM3J,QAAQiC,OACjB,MAGGoD,EAAG4B,UAAY5B,EAAG4B,SAASQ,IAE3BtE,EAAQ0G,OACRjC,cAAc3C,EAAUI,GAAG4B,UAC/Be,gBAAgB/C,EAAW9B,EAAQxB,OAAQwB,EAAQpB,OAAQoB,EAAQ8E,eAEnE7B,OACH,CACDpB,sBAAsBgE,EAC1B,CACA,IAAIc,cACuB,mBAAhBC,cACPD,cAAgB,cAAcC,YAC1B,WAAAC,GACIC,QACAC,KAAKC,aAAa,CAAEC,KAAM,QAC7B,CACD,iBAAAC,GACI,MAAM/E,SAAEA,GAAa4E,KAAK7E,GAC1B6E,KAAK7E,GAAG6D,cAAgB5D,EAAS8C,IAAI3I,KAAK4I,OAAOpI,aAEjD,IAAK,MAAMoE,KAAO6F,KAAK7E,GAAGiF,QAEtBJ,KAAKrI,YAAYqI,KAAK7E,GAAGiF,QAAQjG,GAExC,CACD,wBAAAkG,CAAyBjH,EAAMkH,EAAWC,GACtCP,KAAK5G,GAAQmH,CAChB,CACD,oBAAAC,GACI5K,QAAQoK,KAAK7E,GAAG6D,cACnB,CACD,QAAAyB,GACIpC,kBAAkB2B,KAAM,GACxBA,KAAKS,SAAWnL,IACnB,CACD,GAAAoL,CAAIC,EAAMhE,GAEN,IAAK5G,YAAY4G,GACb,OAAOrH,KAEX,MAAM4B,EAAa8I,KAAK7E,GAAGjE,UAAUyJ,KAAUX,KAAK7E,GAAGjE,UAAUyJ,GAAQ,IAEzE,OADAzJ,EAAUmE,KAAKsB,GACR,KACH,MAAMiE,EAAQ1J,EAAUsG,QAAQb,IACjB,IAAXiE,GACA1J,EAAU2J,OAAOD,EAAO,EAAE,CAErC,CACD,IAAAE,CAAKC,GACGf,KAAKgB,QAAUpK,SAASmK,KACxBf,KAAK7E,GAAGgE,YAAa,EACrBa,KAAKgB,MAAMD,GACXf,KAAK7E,GAAGgE,YAAa,EAE5B,ICrsET,IAAI8B,KAAsBxK,SAAAyK,eAAAzK,SAAAyK,cAAAC,KAAA,IAAAC,IAAA,yBAAA3K,SAAA4K,SAAA1K,KACX,MAAM2K,UAEjB,oBAAaC,CAAQZ,EAAKa,GACtB,IAAIC,EAAW,GACXC,EAAsB,GACtBC,GAAW,EACZH,IACCA,EAAgBA,EAAcI,QAAQ,mBAAmB,IACzDH,EAAYH,UAAUO,WAAWlB,EAAK,IAAIa,EAAc,QACxDE,EAAuB,mBAAmBF,UAAsBb,KAAQa,UAG5E,IAAIM,QAAYC,MAAMN,GACjBxF,MAAK+F,IACGA,EAASC,KACVN,GAAW,GAERK,EAASE,UAEnBjG,MAAKvD,GACS,QAAPiI,EAAqBjI,EACpBA,EACAA,EAAKyJ,WACHzJ,EAAKyJ,WAAW,GADMzJ,OAD7B,IAmBR,OAfOiJ,IACCG,QAAYC,MAAML,GACbzF,MAAK+F,IACGA,EAASC,KACVN,GAAW,GAERK,EAASE,UAEnBjG,MAAKvD,GACW,QAATiI,EAAuBjI,EACtBA,EACAA,EAAKyJ,WACHzJ,EAAKyJ,WAAW,GADMzJ,OAD7B,KAKToJ,CACV,CAGD,eAAOD,GACH,OAAO,IAAIT,IAAI,KAAMH,MAAMtK,IAC9B,CAED,gBAAOyL,GACH,OAAO,IAAIhB,IAAI,KAAMH,MAAMoB,QAC9B,ECnDE,IAAIC,cAAc,CACrB,CACIC,GAAM,YACNC,MAAS,YACT7C,MAAS,gCACT8C,QAAW,CACP,CACIjM,IAAO,+BACPkM,MAAS,mEACTC,WAAc,mEACdH,MAAS,4BACTI,MAAQ,EACRC,QAAU,GAEd,CACIrM,IAAO,+BACPkM,MAAS,4DACTC,WAAc,4DACdH,MAAS,6BACTI,MAAQ,EACRC,QAAU,GAEd,CACIrM,IAAO,+BACPkM,MAAS,gEACTC,WAAc,gEACdH,MAAS,8BACTI,MAAQ,EACRC,QAAU,GAEd,CACIrM,IAAO,+BACPkM,MAAS,sEACTC,WAAc,sEACdH,MAAS,2CACTI,MAAQ,EACRC,QAAU,GAEd,CACIrM,IAAO,+BACPkM,MAAS,mEACTC,WAAc,mEACdH,MAAS,mBACTI,MAAQ,EACRC,QAAU,GAEd,CACIrM,IAAO,+BACPkM,MAAS,mEACTC,WAAc,mEACdH,MAAS,mBACTI,MAAQ,EACRC,QAAU,KAKtB,CACIN,GAAM,YACNC,MAAS,WACT7C,MAAS,WACT8C,QAAW,CACP,CACIC,MAAS,gEACT/B,KAAQ,OACRmC,KAAQ,0DACRjJ,KAAQ,WACR2I,MAAS,aASjB,CACIE,MAAS,iEACT/B,KAAQ,OACRmC,KAAQ,0DACRjJ,KAAQ,WACR2I,MAAS,aAEb,CACQE,MAAS,iEACT/B,KAAQ,OACRmC,KAAQ,2DACRjJ,KAAQ,WACR2I,MAAS,0BCxFdO,eAAe,CACtB,CACIR,GAAM,aACNC,MAAS,cACT7C,MAAS,8EACT8C,QAAW,CACP,CACIC,MAAS,oEACTC,WAAc,oEACdH,MAAS,gBACTQ,OAAU,WAEtB,CACIN,MAAS,iEACTC,WAAc,iEACdH,MAAS,oBACTQ,OAAU,QAElB,CACIN,MAAS,wEACTC,WAAc,wEACdH,MAAS,cACTQ,OAAU,eAIF,CACIN,MAAS,+DACTC,WAAc,+DACdH,MAAS,sBACTQ,OAAU,MAElB,CACIN,MAAS,oEACTC,WAAc,oEACdH,MAAS,2BACTQ,OAAU,QAElB,CACIN,MAAS,uEACTC,WAAc,uEACdH,MAAS,yBACTQ,OAAU,iBC1CPC,gBAAgB,CACvB,CACIV,GAAM,MACNC,MAAS,GACT7C,MAAS,gBACT8C,QAAW,CACP,CACIS,KAAQ,SACRV,MAAS,cACTW,UAAW,EACXC,MAAS,KACTC,OAAU,MAEd,CACIH,KAAQ,SACRV,MAAS,aACTW,UAAW,EACXC,MAAS,KACTC,OAAU,KAEd,CACIH,KAAQ,SACRV,MAAS,YACTW,UAAW,EACXC,MAAS,IACTC,OAAU,KAEd,CACIH,KAAQ,SACRV,MAAS,cACTW,UAAW,EACXC,MAAS,KACTC,OAAU,QAItB,CACId,GAAM,aACNC,MAAS,GACT7C,MAAS,eACT8C,QAAW,CACP,CACIS,KAAQ,YACRV,MAAS,iCACTW,UAAW,EACXC,MAAS,KACTC,OAAU,MAEd,CACIH,KAAQ,YACRV,MAAS,kCACTW,UAAW,EACXC,MAAS,KACTC,OAAU,MAEd,CACIH,KAAQ,WACRV,MAAS,8BACTW,UAAW,EACXC,MAAS,IACTC,OAAU,KAEd,CACIH,KAAQ,UACRV,MAAS,kCACTW,UAAW,EACXC,MAAS,KACTC,OAAU,KAEd,CACIH,KAAQ,IACRV,MAAS,wBACTW,UAAW,EACXC,MAAS,KACTC,OAAU,KAEd,CACIH,KAAQ,SACRV,MAAS,yBACTW,UAAW,EACXC,MAAS,KACTC,OAAU,gbCjFuCC,UAAmJ,SAASC,GAAG,SAAS9G,EAAE+G,GAAG,GAAGC,EAAED,GAAG,OAAOC,EAAED,GAAGE,QAAQ,IAAIC,EAAEF,EAAED,GAAG,CAACnL,EAAEmL,EAAE9D,GAAE,EAAGgE,QAAQ,CAAE,GAAE,OAAOH,EAAEC,GAAGI,KAAKD,EAAED,QAAQC,EAAEA,EAAED,QAAQjH,GAAGkH,EAAEjE,GAAE,EAAGiE,EAAED,OAAO,CAAC,IAAID,EAAE,GAAG,OAAOhH,EAAEuB,EAAEuF,EAAE9G,EAAEc,EAAEkG,EAAEhH,EAAEnE,EAAE,SAASiL,EAAEE,EAAED,GAAG/G,EAAE+G,EAAED,EAAEE,IAAI/N,OAAOmO,eAAeN,EAAEE,EAAE,CAACK,cAAa,EAAGC,YAAW,EAAGC,IAAIR,GAAG,EAAE/G,EAAEgH,EAAE,SAASF,GAAG,IAAIE,EAAEF,GAAGA,EAAEU,WAAW,WAAW,OAAOV,EAAEW,OAAO,EAAE,WAAW,OAAOX,CAAC,EAAE,OAAO9G,EAAEnE,EAAEmL,EAAE,IAAIA,GAAGA,CAAC,EAAEhH,EAAE+G,EAAE,SAASD,EAAE9G,GAAG,OAAO/G,OAAOyO,UAAUC,eAAeR,KAAKL,EAAE9G,EAAE,EAAEA,EAAES,EAAE,GAAGT,EAAEA,EAAE4H,EAAE,EAAE,CAAhd,CAAkd,CAAC,SAASd,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAE,cAAc/G,EAAE6H,YAAY,CAACC,MAAM,aAAaC,QAAQ,eAAeC,WAAW,2BAA2BC,YAAY,aAAaC,WAAW,YAAYC,KAAK,YAAYC,YAAY,oBAAoBC,QAAQ,eAAeC,OAAO,cAAcC,iBAAiB,wBAAwBC,OAAOzB,EAAE0B,eAAe1B,EAAE,YAAY2B,cAAc3B,EAAE,WAAW4B,cAAc5B,EAAE,WAAW6B,eAAe7B,EAAE,YAAY8B,cAAc9B,EAAE,YAAY/G,EAAEyH,QAAQzH,EAAE6H,WAAW,EAAE,SAASf,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAKmF,EAAE8I,QAAQ,SAAShC,GAAG,IAAI9G,EAAE,IAAI8G,EAAE,OAAO9M,SAAS+O,cAAc/I,EAAE,EAAEA,EAAEgJ,aAAa,SAASlC,GAAG,IAAI9G,EAAEhG,SAASC,cAAc,OAAO,OAAO+F,EAAEiJ,UAAUnC,EAAEoC,OAAOlJ,EAAEmJ,UAAU,EAAEnJ,EAAEoJ,YAAY,SAAStC,EAAE9G,GAAG,IAAIgH,EAAEhH,EAAEqJ,YAAYrJ,EAAEzE,WAAWF,aAAayL,EAAEE,EAAE,EAAEhH,EAAEsJ,WAAW,SAASxC,GAAGA,EAAEyC,cAAc/N,YAAYsL,EAAE,EAAE9G,EAAEwJ,SAAS,SAAS1C,GAAG,KAAiC,gBAA3BA,EAAEA,EAAE3B,QAAQ,WAAW,KAAwB+D,MAAO,EAAElJ,EAAEyJ,cAAc,SAAS3C,GAAG,GAAG,oBAAoB7N,OAAOyO,UAAUgC,SAASvC,KAAKL,GAAG,OAAM,EAAG,IAAI9G,EAAE/G,OAAO0Q,eAAe7C,GAAG,OAAO,OAAO9G,GAAGA,IAAI/G,OAAOyO,SAAS,EAAE1H,EAAE4J,gBAAgB,SAAS9C,GAAG,IAAI9G,EAAE8G,EAAE,GAAGE,EAAEF,EAAE,IAAI,OAAO,IAAI9G,GAAG,KAAKgH,EAAEF,EAAE,KAAK,IAAI9G,GAAG,KAAKgH,EAAEF,EAAE,KAAK,IAAI9G,GAAG,KAAKgH,EAAEF,EAAE,KAAKA,EAAE,IAAI,CAAC,EAAE,SAASA,EAAE9G,EAAEgH,GAAgB,SAASD,EAAED,GAAG,IAAI,IAAIE,KAAKF,EAAE9G,EAAE2H,eAAeX,KAAKhH,EAAEgH,GAAGF,EAAEE,GAAG,CAAC/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAKkM,EAAEC,EAAE,KAAK,IAAIE,EAAEF,EAAE,IAAIhH,EAAE6J,cAAc3C,EAAEO,QAAQV,EAAEC,EAAE,KAAKD,EAAEC,EAAE,KAAKD,EAAEC,EAAE,KAAK,IAAIpL,EAAEoL,EAAE,GAAGvN,EAAEmC,EAAE6L,QAAQQ,YAAYL,EAAEhM,EAAE6L,QAAQS,WAAWpH,EAAElF,EAAE6L,QAAQU,KAAKlF,EAAErH,EAAE6L,QAAQa,OAAOtI,EAAE8J,WAAW,mBAAmBhJ,EAAE,WAAWd,EAAE+J,YAAY,mBAAmBtQ,EAAE,aAAauG,EAAEgK,WAAW,mBAAmBpC,EAAE,WAAW5H,EAAEiK,aAAa,mBAAmBhH,EAAE,YAAY,EAAE,SAAS6D,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGhH,EAAEkK,YAAY,UAAUlK,EAAEmK,WAAW,SAAS,IAAIjD,EAAE,CAACkD,SAAQ,EAAGpO,KAAK,KAAKnB,MAAM,KAAKwP,UAAU,GAAGC,YAAW,GAAI1O,EAAE3C,OAAOsR,OAAO,CAAA,EAAGrD,EAAE,CAACkD,SAAQ,EAAGpO,KAAK,SAASnB,MAAM,OAAOpB,EAAER,OAAOsR,OAAO,CAAE,EAACrD,EAAE,CAAClL,KAAK,KAAKnB,OAAM,IAAKmF,EAAEwK,kBAAkB,CAACC,OAAO7O,EAAE8O,QAAQjR,GAAG,IAAImO,EAAE,SAASd,GAAG,OAAOA,GAAG,KAAK9G,EAAEkK,YAAY,OAAOzQ,EAAE,KAAKuG,EAAEmK,WAAW,OAAOvO,EAAE,QAAQ,IAAIoL,EAAEF,EAAE6D,OAAO,GAAGC,cAAc9D,EAAE+D,MAAM,GAAG,OAAO5R,OAAOsR,OAAO,CAAE,EAACrD,EAAE,CAAClL,KAAKgL,EAAEnM,MAAMiM,IAAI,EAAEhG,EAAE,SAASgG,EAAE9G,GAAG,IAAIgH,EAAEY,EAAEd,GAAG,OAAM,IAAK9G,EAAE/G,OAAOsR,OAAO,CAAE,EAACvD,EAAE,CAACoD,SAAQ,IAAK,iBAAiBpK,EAAE/G,OAAOsR,OAAO,CAAA,EAAGvD,EAAE,CAACoD,SAAQ,EAAGpO,KAAKgE,IAAI+G,EAAE0C,cAAczJ,GAAG/G,OAAOsR,OAAO,CAACH,SAAQ,GAAIpD,EAAEhH,GAAG/G,OAAOsR,OAAO,GAAGvD,EAAE,CAACoD,SAAQ,GAAI,EAAEnH,EAAE,SAAS6D,GAAG,IAAI,IAAI9G,EAAE,CAAE,EAACgH,EAAE,EAAED,EAAE9N,OAAOoB,KAAKyM,GAAGE,EAAED,EAAEzM,OAAO0M,IAAI,CAAC,IAAIE,EAAEH,EAAEC,GAAGvN,EAAEqN,EAAEI,GAAGU,EAAE9G,EAAEoG,EAAEzN,GAAGuG,EAAEkH,GAAGU,CAAC,CAAC,OAAO5H,EAAEyK,SAASzK,EAAEyK,OAAO7O,GAAGoE,CAAC,EAAE8K,EAAE,SAAShE,GAAG,IAAIE,EAAE,CAAA,EAAG,OAAOF,EAAExM,QAAQ,KAAK,EAAE0M,EAAEhH,EAAEmK,YAAYlR,OAAOsR,OAAO,CAAA,EAAG3O,EAAE,CAACwO,SAAQ,IAAK,MAAM,KAAK,EAAEpD,EAAEhH,EAAEmK,YAAYrJ,EAAEd,EAAEmK,WAAWrD,EAAE,IAAIE,EAAEhH,EAAEkK,aAAapJ,EAAEd,EAAEkK,YAAYpD,EAAE,IAAI,MAAM,QAAQC,EAAEyC,SAAS,yCAAyC1C,EAAExM,OAAO,yEAAyE,OAAO0M,CAAC,EAAEhH,EAAE+K,kBAAkB,SAASjE,GAAG,IAAIE,EAAEhH,EAAEwK,kBAAkB,MAAM,iBAAiB1D,EAAEE,EAAEhH,EAAEkK,aAAapJ,EAAEd,EAAEkK,YAAYpD,GAAG3J,MAAM6N,QAAQlE,GAAGE,EAAE8D,EAAEhE,GAAGC,EAAE0C,cAAc3C,GAAGE,EAAE/D,EAAE6D,IAAG,IAAKA,EAAEE,EAAE8D,EAAE,EAAC,GAAG,KAAK,IAAKhE,EAAEE,EAAE8D,EAAE,EAAC,GAAG,SAAK,IAAShE,IAAIE,EAAEhH,EAAEwK,mBAAmBxD,CAAC,CAAC,EAAE,SAASF,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEmC,EAAE6L,QAAQK,MAAMF,EAAEhM,EAAE6L,QAAQM,QAAQjH,EAAEkG,EAAE,IAAI/D,EAAE+D,EAAE,IAAI8D,EAAE9D,EAAE,IAAIiE,EAAEjE,EAAE,IAAIhH,EAAEkL,kBAAkB,SAASpE,GAAG,IAAI9G,EAAE+G,EAAE+B,QAAQrP,GAAGuN,EAAED,EAAEiC,aAAalC,GAAG,OAAO9G,EAAE9E,YAAY8L,GAAGA,CAAC,EAAE,IAAInL,EAAE,SAASiL,GAAGA,EAAEuD,UAAU5Q,EAAEqN,EAAEqE,YAAY,EAAE,EAAE1K,EAAE,SAASqG,EAAE9G,GAAGnE,EAAEiL,GAAG,IAAIE,EAAEhH,EAAEqK,UAAUrD,GAAGF,EAAE7I,UAAUmC,IAAI4G,EAAE,EAAEhH,EAAEoL,iBAAiB,SAAStE,GAAG,IAAI9G,EAAE+G,EAAE+B,QAAQrP,GAAGgH,EAAET,EAAE8G,GAAGhG,EAAE2G,QAAQX,EAAEL,MAAMxD,EAAEoI,UAAUvE,EAAEf,OAAO9C,EAAEqI,SAASxE,EAAE9K,MAAMiP,EAAExD,QAAQX,EAAEyE,SAAST,EAAErD,QAAQX,EAAE0E,QAAQ1E,EAAE2E,WAAW,EAAE,IAAIlK,EAAE,WAAW,IAAIuF,EAAEC,EAAE+B,QAAQlB,GAAG5H,EAAE+G,EAAEiC,aAAa9B,EAAEwE,aAAa5E,EAAE5L,YAAY8E,EAAE,EAAEA,EAAEyH,QAAQlG,CAAC,EAAE,SAASuF,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAE,CAACyE,QAAO,EAAGC,QAAQ,KAAKC,QAAQ,CAAE,EAACC,MAAM,MAAMlQ,EAAE3C,OAAOsR,OAAO,GAAGrD,GAAGlH,EAAE+L,WAAW,WAAWnQ,EAAE3C,OAAOsR,OAAO,CAAA,EAAGrD,EAAE,EAAElH,EAAEgM,eAAe,SAASlF,GAAG,GAAG,iBAAiBA,EAAE,OAAOrN,EAAEsN,EAAEmD,YAAYpD,GAAG,IAAI,IAAI9G,KAAK8G,EAAErN,EAAEuG,EAAE8G,EAAE9G,GAAG,EAAE,IAAIvG,EAAE,SAASqN,EAAE9G,GAAGpE,EAAEiQ,QAAQ/E,KAAKlL,EAAEiQ,QAAQ/E,GAAG,CAAA,GAAI7N,OAAOsR,OAAO3O,EAAEiQ,QAAQ/E,GAAG,CAACjM,MAAMmF,GAAG,EAAEA,EAAEiM,oBAAoB,SAASnF,EAAE9G,GAAG,IAAIgH,QAAG,IAAShH,EAAE,CAAE,EAACA,GAAGsK,WAAWvD,OAAE,IAASC,GAAGA,EAAE/N,OAAOsR,OAAO3O,EAAEiQ,QAAQ/E,GAAG,CAACwD,WAAWvD,GAAG,EAAE/G,EAAEyH,QAAQ7L,CAAC,EAAE,SAASkL,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEmC,EAAE6L,QAAQM,QAAQH,EAAEhM,EAAE6L,QAAQO,WAAWlH,EAAElF,EAAE6L,QAAQe,OAAOvF,EAAErH,EAAE6L,QAAQmB,eAAekC,EAAE9D,EAAE,GAAGhH,EAAEkM,UAAU,WAAWnF,EAAE+B,QAAQrP,GAAGwE,UAAUmC,IAAIwH,GAAGkD,EAAErD,QAAQkE,QAAO,CAAE,EAAE,IAAIV,EAAE,WAAWlE,EAAE+B,QAAQrP,GAAGwE,UAAUkO,OAAOvE,GAAGkD,EAAErD,QAAQkE,QAAO,CAAE,EAAE3L,EAAEoM,SAAS,SAAStF,QAAG,IAASA,IAAIA,EAAEI,EAAEiD,YAAY,IAAInK,EAAE8K,EAAErD,QAAQoE,QAAQ/E,GAAGE,EAAEhH,EAAEnF,MAAM,IAAG,IAAKmF,EAAEsK,WAAW,CAAC,IAAI1O,EAAEkF,EAAE,KAAKgG,EAAEC,EAAE+B,QAAQlN,GAAGqC,UAAUmC,IAAI6C,EAAE,MAAMgI,IAAIH,EAAErD,QAAQmE,QAAQvM,QAAQ2H,EAAE,EAAEhH,EAAEqM,SAAS,WAAW,IAAIvF,EAAE7N,OAAOsR,OAAO,CAAA,EAAGO,EAAErD,SAAS,cAAcX,EAAE8E,eAAe9E,EAAEgF,MAAMhF,CAAC,EAAE9G,EAAEsM,YAAY,WAAW,IAAI,IAAIxF,EAAE9M,SAASuS,iBAAiB,IAAIzL,GAAGd,EAAE,EAAEA,EAAE8G,EAAExM,OAAO0F,IAAK8G,EAAE9G,GAAG/B,UAAUkO,OAAOlJ,EAAG,CAAC,EAAE,SAAS6D,EAAE9G,GAAG,IAAIgH,EAAEA,EAAE,WAAW,OAAOzD,IAAI,CAAtB,GAA0B,IAAIyD,EAAEA,GAAGwF,SAAS,cAATA,KAA2B,EAAGC,MAAM,OAAO,CAAC,MAAM3F,GAAG,iBAAiB4F,SAAS1F,EAAE0F,OAAO,CAAC5F,EAAEG,QAAQD,CAAC,EAAE,SAASF,EAAE9G,EAAEgH,IAAG,SAAUhH,GAAG8G,EAAEG,QAAQjH,EAAE2M,WAAW3F,EAAE,EAAG,GAAEG,KAAKnH,EAAEgH,EAAE,GAAG,EAAE,SAASF,EAAE9G,EAAEgH,IAAG,SAAUhH,GAAG8G,EAAEG,QAAQjH,EAAE4M,KAAK5F,EAAE,GAAI,GAAEG,KAAKnH,EAAEgH,EAAE,GAAG,EAAE,SAASF,EAAE9G,EAAEgH,GAAG,oBAAoB0F,QAAQ1F,EAAE,IAAIA,EAAE,IAAI,IAAID,EAAEC,EAAE,IAAIS,QAAQX,EAAEG,QAAQF,CAAC,EAAE,SAASD,EAAE9G,EAAEgH,GAAG,IAAID,EAAEC,EAAE,IAAI,iBAAiBD,IAAIA,EAAE,CAAC,CAACD,EAAElL,EAAEmL,EAAE,MAAM,IAAIG,EAAE,CAAC2F,SAAS,MAAO3F,eAAY,GAAOF,EAAE,GAAFA,CAAMD,EAAEG,GAAGH,EAAE+F,SAAShG,EAAEG,QAAQF,EAAE+F,OAAO,EAAE,SAAShG,EAAE9G,EAAEgH,IAAKF,EAAEG,QAAQD,EAAE,GAAFA,MAAM,IAAUpI,KAAK,CAACkI,EAAElL,EAAE,+5UAA+5U,IAAI,EAAE,SAASkL,EAAE9G,GAAG,SAASgH,EAAEF,EAAE9G,GAAG,IAAIgH,EAAEF,EAAE,IAAI,GAAGI,EAAEJ,EAAE,GAAG,IAAII,EAAE,OAAOF,EAAE,GAAGhH,GAAG,mBAAmB+M,KAAK,CAAC,IAAInR,EAAEmL,EAAEG,GAAG,MAAM,CAACF,GAAGgG,OAAO9F,EAAE+F,QAAQxL,KAAI,SAASqF,GAAG,MAAM,iBAAiBI,EAAEgG,WAAWpG,EAAE,KAAK,KAAIkG,OAAO,CAACpR,IAAIuR,KAAK,KAAK,CAAC,MAAM,CAACnG,GAAGmG,KAAK,KAAK,CAAC,SAASpG,EAAED,GAAG,MAAM,mEAAmEiG,KAAKK,SAASC,mBAAmBC,KAAKC,UAAUzG,MAAM,KAAK,CAACA,EAAEG,QAAQ,SAASH,GAAG,IAAI9G,EAAE,GAAG,OAAOA,EAAE0J,SAAS,WAAW,OAAOnG,KAAK9B,KAAI,SAASzB,GAAG,IAAI+G,EAAEC,EAAEhH,EAAE8G,GAAG,OAAO9G,EAAE,GAAG,UAAUA,EAAE,GAAG,IAAI+G,EAAE,IAAIA,CAAC,IAAGoG,KAAK,GAAG,EAAEnN,EAAEpE,EAAE,SAASkL,EAAEE,GAAG,iBAAiBF,IAAIA,EAAE,CAAC,CAAC,KAAKA,EAAE,MAAM,IAAI,IAAIC,EAAE,GAAGG,EAAE,EAAEA,EAAE3D,KAAKjJ,OAAO4M,IAAI,CAAC,IAAItL,EAAE2H,KAAK2D,GAAG,GAAG,iBAAiBtL,IAAImL,EAAEnL,IAAG,EAAG,CAAC,IAAIsL,EAAE,EAAEA,EAAEJ,EAAExM,OAAO4M,IAAI,CAAC,IAAIzN,EAAEqN,EAAEI,GAAG,iBAAiBzN,EAAE,IAAIsN,EAAEtN,EAAE,MAAMuN,IAAIvN,EAAE,GAAGA,EAAE,GAAGuN,EAAEA,IAAIvN,EAAE,GAAG,IAAIA,EAAE,GAAG,UAAUuN,EAAE,KAAKhH,EAAEpB,KAAKnF,GAAG,CAAC,EAAEuG,CAAC,CAAC,EAAE,SAAS8G,EAAE9G,EAAEgH,GAAG,SAASD,EAAED,EAAE9G,GAAG,IAAI,IAAIgH,EAAE,EAAEA,EAAEF,EAAExM,OAAO0M,IAAI,CAAC,IAAID,EAAED,EAAEE,GAAGE,EAAE3F,EAAEwF,EAAEjB,IAAI,GAAGoB,EAAE,CAACA,EAAEsG,OAAO,IAAI,IAAI5R,EAAE,EAAEA,EAAEsL,EAAEuG,MAAMnT,OAAOsB,IAAIsL,EAAEuG,MAAM7R,GAAGmL,EAAE0G,MAAM7R,IAAI,KAAKA,EAAEmL,EAAE0G,MAAMnT,OAAOsB,IAAIsL,EAAEuG,MAAM7O,KAAKkM,EAAE/D,EAAE0G,MAAM7R,GAAGoE,GAAG,KAAK,CAAK,IAAIvG,EAAE,GAAV,IAAamC,EAAE,EAAEA,EAAEmL,EAAE0G,MAAMnT,OAAOsB,IAAInC,EAAEmF,KAAKkM,EAAE/D,EAAE0G,MAAM7R,GAAGoE,IAAIuB,EAAEwF,EAAEjB,IAAI,CAACA,GAAGiB,EAAEjB,GAAG0H,KAAK,EAAEC,MAAMhU,EAAE,CAAC,CAAC,CAAC,SAASyN,EAAEJ,EAAE9G,GAAG,IAAI,IAAIgH,EAAE,GAAGD,EAAE,CAAA,EAAGG,EAAE,EAAEA,EAAEJ,EAAExM,OAAO4M,IAAI,CAAC,IAAItL,EAAEkL,EAAEI,GAAGzN,EAAEuG,EAAE0N,KAAK9R,EAAE,GAAGoE,EAAE0N,KAAK9R,EAAE,GAAwBkP,EAAE,CAAC6C,IAAtB/R,EAAE,GAA0BgS,MAArBhS,EAAE,GAA2BiS,UAAtBjS,EAAE,IAAiCmL,EAAEtN,GAAGsN,EAAEtN,GAAGgU,MAAM7O,KAAKkM,GAAG9D,EAAEpI,KAAKmI,EAAEtN,GAAG,CAACqM,GAAGrM,EAAEgU,MAAM,CAAC3C,IAAI,CAAC,OAAO9D,CAAC,CAAC,SAASpL,EAAEkL,EAAE9G,GAAG,IAAIgH,EAAE8G,EAAEhH,EAAEiH,YAAY,IAAI/G,EAAE,MAAM,IAAIxI,MAAM,+GAA+G,IAAIuI,EAAEiH,EAAEA,EAAE1T,OAAO,GAAG,GAAG,QAAQwM,EAAE+F,SAAS9F,EAAEA,EAAEsC,YAAYrC,EAAE3L,aAAa2E,EAAE+G,EAAEsC,aAAarC,EAAE9L,YAAY8E,GAAGgH,EAAE3L,aAAa2E,EAAEgH,EAAEmC,YAAY6E,EAAEpP,KAAKoB,OAAO,CAAC,GAAG,WAAW8G,EAAE+F,SAAS,MAAM,IAAIrO,MAAM,sEAAsEwI,EAAE9L,YAAY8E,EAAE,CAAC,CAAC,SAASvG,EAAEqN,GAAG,GAAG,OAAOA,EAAEvL,WAAW,OAAM,EAAGuL,EAAEvL,WAAWC,YAAYsL,GAAG,IAAI9G,EAAEgO,EAAEjN,QAAQ+F,GAAG9G,GAAG,GAAGgO,EAAE5J,OAAOpE,EAAE,EAAE,CAAC,SAAS4H,EAAEd,GAAG,IAAI9G,EAAEhG,SAASC,cAAc,SAAS,OAAO6M,EAAEmH,MAAM/J,KAAK,WAAWjB,EAAEjD,EAAE8G,EAAEmH,OAAOrS,EAAEkL,EAAE9G,GAAGA,CAAC,CAAC,SAASc,EAAEgG,GAAG,IAAI9G,EAAEhG,SAASC,cAAc,QAAQ,OAAO6M,EAAEmH,MAAM/J,KAAK,WAAW4C,EAAEmH,MAAMC,IAAI,aAAajL,EAAEjD,EAAE8G,EAAEmH,OAAOrS,EAAEkL,EAAE9G,GAAGA,CAAC,CAAC,SAASiD,EAAE6D,EAAE9G,GAAG/G,OAAOoB,KAAK2F,GAAG3G,SAAQ,SAAS2N,GAAGF,EAAE/J,aAAaiK,EAAEhH,EAAEgH,GAAG,GAAE,CAAC,SAAS8D,EAAEhE,EAAE9G,GAAG,IAAIgH,EAAED,EAAEG,EAAEtL,EAAE,GAAGoE,EAAEmO,WAAWrH,EAAE6G,IAAI,CAAC,KAAK/R,EAAEoE,EAAEmO,UAAUrH,EAAE6G,MAAM,OAAO,WAAU,EAAG7G,EAAE6G,IAAI/R,CAAC,CAAC,GAAGoE,EAAEoO,UAAU,CAAC,IAAInL,EAAEoL,IAAIrH,EAAEsH,IAAIA,EAAE1G,EAAE5H,IAAI+G,EAAEkE,EAAEsD,KAAK,KAAKvH,EAAE/D,GAAE,GAAIiE,EAAE+D,EAAEsD,KAAK,KAAKvH,EAAE/D,GAAE,EAAG,MAAM6D,EAAE+G,WAAW,mBAAmBlJ,KAAK,mBAAmBA,IAAI6J,iBAAiB,mBAAmB7J,IAAI8J,iBAAiB,mBAAmBC,MAAM,mBAAmB3B,MAAM/F,EAAElG,EAAEd,GAAG+G,EAAEtG,EAAE8N,KAAK,KAAKvH,EAAEhH,GAAGkH,EAAE,WAAWzN,EAAEuN,GAAGA,EAAE9M,MAAMyK,IAAI8J,gBAAgBzH,EAAE9M,KAAK,IAAI8M,EAAEY,EAAE5H,GAAG+G,EAAElL,EAAE0S,KAAK,KAAKvH,GAAGE,EAAE,WAAWzN,EAAEuN,EAAE,GAAG,OAAOD,EAAED,GAAG,SAAS9G,GAAG,GAAGA,EAAE,CAAC,GAAGA,EAAE2N,MAAM7G,EAAE6G,KAAK3N,EAAE4N,QAAQ9G,EAAE8G,OAAO5N,EAAE6N,YAAY/G,EAAE+G,UAAU,OAAO9G,EAAED,EAAE9G,EAAE,MAAMkH,GAAG,CAAC,CAAC,SAAS+D,EAAEnE,EAAE9G,EAAEgH,EAAED,GAAG,IAAIG,EAAEF,EAAE,GAAGD,EAAE4G,IAAI,GAAG7G,EAAE6H,WAAW7H,EAAE6H,WAAWC,QAAQC,EAAE7O,EAAEkH,OAAO,CAAC,IAAItL,EAAE5B,SAASkC,eAAegL,GAAGzN,EAAEqN,EAAEzJ,WAAW5D,EAAEuG,IAAI8G,EAAEtL,YAAY/B,EAAEuG,IAAIvG,EAAEa,OAAOwM,EAAEzL,aAAaO,EAAEnC,EAAEuG,IAAI8G,EAAE5L,YAAYU,EAAE,CAAC,CAAC,SAASC,EAAEiL,EAAE9G,GAAG,IAAIgH,EAAEhH,EAAE2N,IAAI5G,EAAE/G,EAAE4N,MAAM,GAAG7G,GAAGD,EAAE/J,aAAa,QAAQgK,GAAGD,EAAE6H,WAAW7H,EAAE6H,WAAWC,QAAQ5H,MAAM,CAAC,KAAKF,EAAEqC,YAAYrC,EAAEtL,YAAYsL,EAAEqC,YAAYrC,EAAE5L,YAAYlB,SAASkC,eAAe8K,GAAG,CAAC,CAAC,SAASvG,EAAEqG,EAAE9G,EAAEgH,GAAG,IAAID,EAAEC,EAAE2G,IAAIzG,EAAEF,EAAE6G,UAAUjS,OAAE,IAASoE,EAAE8O,uBAAuB5H,GAAGlH,EAAE8O,uBAAuBlT,KAAKmL,EAAEgI,EAAEhI,IAAIG,IAAIH,GAAG,uDAAuDgG,KAAKK,SAASC,mBAAmBC,KAAKC,UAAUrG,MAAM,OAAO,IAAIzN,EAAE,IAAIiV,KAAK,CAAC3H,GAAG,CAAC7C,KAAK,aAAa0D,EAAEd,EAAE5M,KAAK4M,EAAE5M,KAAKyK,IAAI6J,gBAAgB/U,GAAGmO,GAAGjD,IAAI8J,gBAAgB7G,EAAE,CAAC,IAAIrG,EAAE,GAAG7H,EAAE,SAASoN,GAAG,IAAI9G,EAAE,OAAO,WAAW,YAAO,IAASA,IAAIA,EAAE8G,EAAEkI,MAAMzL,KAAK0L,YAAYjP,CAAC,CAAC,CAArF,EAAuF,WAAW,OAAO0M,QAAQ1S,UAAUA,SAASkV,MAAMxC,OAAOyC,IAAI,IAAGrB,EAAE,SAAShH,GAAG,IAAI9G,EAAE,GAAG,OAAO,SAASgH,GAAG,YAAO,IAAShH,EAAEgH,KAAKhH,EAAEgH,GAAGF,EAAEK,KAAK5D,KAAKyD,IAAIhH,EAAEgH,EAAE,CAAC,CAAzF,EAA2F,SAASF,GAAG,OAAO9M,SAAS+O,cAAcjC,EAAE,IAAGwH,EAAE,KAAKD,EAAE,EAAEL,EAAE,GAAGe,EAAE/H,EAAE,IAAIF,EAAEG,QAAQ,SAASH,EAAE9G,GAAG,GAAG,oBAAoBoP,OAAOA,OAAO,iBAAiBpV,SAAS,MAAM,IAAIwE,MAAM,iEAAgEwB,EAAEA,GAAG,CAAE,GAAGiO,MAAM,iBAAiBjO,EAAEiO,MAAMjO,EAAEiO,MAAM,CAAE,EAACjO,EAAEoO,YAAYpO,EAAEoO,UAAU1U,KAAKsG,EAAE+N,aAAa/N,EAAE+N,WAAW,QAAQ/N,EAAE6M,WAAW7M,EAAE6M,SAAS,UAAU,IAAI7F,EAAEE,EAAEJ,EAAE9G,GAAG,OAAO+G,EAAEC,EAAEhH,GAAG,SAAS8G,GAAG,IAAI,IAAIlL,EAAE,GAAGnC,EAAE,EAAEA,EAAEuN,EAAE1M,OAAOb,IAAI,CAAC,IAAImO,EAAEZ,EAAEvN,IAAGqH,EAAES,EAAEqG,EAAE9B,KAAM0H,OAAO5R,EAAEgD,KAAKkC,EAAE,CAAmB,IAAfgG,GAAGC,EAAEG,EAAEJ,EAAE9G,GAAGA,GAAWvG,EAAE,EAAEA,EAAEmC,EAAEtB,OAAOb,IAAI,CAAC,IAAIqH,EAAO,GAAG,KAAVA,EAAElF,EAAEnC,IAAY+T,KAAK,CAAC,IAAI,IAAIvK,EAAE,EAAEA,EAAEnC,EAAE2M,MAAMnT,OAAO2I,IAAInC,EAAE2M,MAAMxK,YAAY1B,EAAET,EAAEgF,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI+I,EAAE,WAAW,IAAI/H,EAAE,GAAG,OAAO,SAAS9G,EAAEgH,GAAG,OAAOF,EAAE9G,GAAGgH,EAAEF,EAAEpF,OAAO2N,SAASlC,KAAK,KAAK,CAAC,CAApF,EAAuF,EAAE,SAASrG,EAAE9G,GAAG8G,EAAEG,QAAQ,SAASH,GAAG,IAAI9G,EAAE,oBAAoB0M,QAAQA,OAAO4C,SAAS,IAAItP,EAAE,MAAM,IAAIxB,MAAM,oCAAoC,IAAIsI,GAAG,iBAAiBA,EAAE,OAAOA,EAAE,IAAIE,EAAEhH,EAAEuP,SAAS,KAAKvP,EAAEwP,KAAKzI,EAAEC,EAAEhH,EAAE4F,SAAST,QAAQ,YAAY,KAAK,OAAO2B,EAAE3B,QAAQ,uDAAsD,SAAS2B,EAAE9G,GAAG,IAA8KpE,EAA1KsL,EAAElH,EAAEkJ,OAAO/D,QAAQ,YAAW,SAAS2B,EAAE9G,GAAG,OAAOA,CAAC,IAAGmF,QAAQ,YAAW,SAAS2B,EAAE9G,GAAG,OAAOA,CAAC,IAAG,MAAG,+CAA+CyP,KAAKvI,GAAUJ,GAAelL,EAAE,IAAIsL,EAAEnG,QAAQ,MAAMmG,EAAE,IAAIA,EAAEnG,QAAQ,KAAKiG,EAAEE,EAAEH,EAAEG,EAAE/B,QAAQ,QAAQ,IAAI,OAAOmI,KAAKC,UAAU3R,GAAG,IAAG,GAAE,CAAC,EAAE,SAASkL,EAAE9G,EAAEgH,GAAG,IAAID,EAAEC,EAAE,IAAI,oBAAoB0F,QAAQA,OAAOtN,UAAUsN,OAAOtN,QAAQ2H,GAAGC,EAAE,IAAI0I,OAAOhI,UAAUiI,WAAWD,OAAOhI,UAAUiI,SAAS,SAAS7I,EAAE9G,GAAgB,MAAM,iBAAiBA,IAAIA,EAAE,KAAKA,EAAE8G,EAAExM,OAAOiJ,KAAKjJ,UAAU,IAAIiJ,KAAKxC,QAAQ+F,EAAE9G,EAAE,GAAG7C,MAAMuK,UAAUiI,UAAU1W,OAAOmO,eAAejK,MAAMuK,UAAU,WAAW,CAAC7M,MAAM,SAASiM,EAAE9G,GAAG,GAAG,MAAMuD,KAAK,MAAM,IAAIqM,UAAU,iCAAiC,IAAI5I,EAAE/N,OAAOsK,MAAMwD,EAAEC,EAAE1M,SAAS,EAAE,GAAG,IAAIyM,EAAE,OAAM,EAAG,IAAI,IAAIG,EAAE,EAAElH,EAAEpE,EAAEiU,KAAKC,IAAI5I,GAAG,EAAEA,EAAEH,EAAE8I,KAAKE,IAAI7I,GAAG,GAAGtL,EAAEmL,GAAG,CAAC,GAAG,SAASD,EAAE9G,GAAG,OAAO8G,IAAI9G,GAAG,iBAAiB8G,GAAG,iBAAiB9G,GAAGgQ,MAAMlJ,IAAIkJ,MAAMhQ,EAAE,CAAtF,CAAwFgH,EAAEpL,GAAGkL,GAAG,OAAM,EAAGlL,GAAG,CAAC,OAAM,CAAE,IAAI,oBAAoB8Q,QAA2M,CAACuD,QAAQvI,UAAUwI,cAAcxI,UAAUyI,aAAazI,WAA7OrO,SAAQ,SAASyN,GAAGA,EAAEa,eAAe,WAAW1O,OAAOmO,eAAeN,EAAE,SAAS,CAACO,cAAa,EAAGC,YAAW,EAAG8I,UAAS,EAAGvV,MAAM,WAAW0I,KAAKhI,WAAWC,YAAY+H,KAAK,GAAG,GAAuE,EAAE,SAASuD,EAAE9G,EAAEgH,IAAG,SAAUhH,IAAI,SAASgH,GAAG,SAASD,IAAK,CAAA,SAASG,EAAEJ,EAAE9G,GAAG,OAAO,WAAW8G,EAAEkI,MAAMhP,EAAEiP,UAAU,CAAC,CAAC,SAASrT,EAAEkL,GAAG,GAAG,iBAAiBvD,KAAK,MAAM,IAAIqM,UAAU,wCAAwC,GAAG,mBAAmB9I,EAAE,MAAM,IAAI8I,UAAU,kBAAkBrM,KAAK8M,OAAO,EAAE9M,KAAK+M,UAAS,EAAG/M,KAAKgN,YAAO,EAAOhN,KAAKiN,WAAW,GAAGvF,EAAEnE,EAAEvD,KAAK,CAAC,SAAS9J,EAAEqN,EAAE9G,GAAG,KAAK,IAAI8G,EAAEuJ,QAAQvJ,EAAEA,EAAEyJ,OAAU,IAAIzJ,EAAEuJ,QAAwCvJ,EAAEwJ,UAAS,EAAG1U,EAAE6U,cAAa,WAAW,IAAIzJ,EAAE,IAAIF,EAAEuJ,OAAOrQ,EAAE0Q,YAAY1Q,EAAE2Q,WAAW,GAAG,OAAO3J,EAAV,CAA8D,IAAID,EAAE,IAAIA,EAAEC,EAAEF,EAAEyJ,OAAO,CAAC,MAAMzJ,GAAG,YAAYhG,EAAEd,EAAE4L,QAAQ9E,EAAE,CAACc,EAAE5H,EAAE4L,QAAQ7E,EAAzE,MAArC,IAAID,EAAEuJ,OAAOzI,EAAE9G,GAAGd,EAAE4L,QAAQ9E,EAAEyJ,OAAkF,KAAnPzJ,EAAE0J,WAAW5R,KAAKoB,EAAmO,CAAC,SAAS4H,EAAEd,EAAE9G,GAAG,IAAI,GAAGA,IAAI8G,EAAE,MAAM,IAAI8I,UAAU,6CAA6C,GAAG5P,IAAI,iBAAiBA,GAAG,mBAAmBA,GAAG,CAAC,IAAIgH,EAAEhH,EAAER,KAAK,GAAGQ,aAAapE,EAAE,OAAOkL,EAAEuJ,OAAO,EAAEvJ,EAAEyJ,OAAOvQ,OAAOiD,EAAE6D,GAAG,GAAG,mBAAmBE,EAAE,YAAYiE,EAAE/D,EAAEF,EAAEhH,GAAG8G,EAAE,CAACA,EAAEuJ,OAAO,EAAEvJ,EAAEyJ,OAAOvQ,EAAEiD,EAAE6D,EAAE,CAAC,MAAM9G,GAAGc,EAAEgG,EAAE9G,EAAE,CAAC,CAAC,SAASc,EAAEgG,EAAE9G,GAAG8G,EAAEuJ,OAAO,EAAEvJ,EAAEyJ,OAAOvQ,EAAEiD,EAAE6D,EAAE,CAAC,SAAS7D,EAAE6D,GAAG,IAAIA,EAAEuJ,QAAQ,IAAIvJ,EAAE0J,WAAWlW,QAAQsB,EAAE6U,cAAa,WAAW3J,EAAEwJ,UAAU1U,EAAEgV,sBAAsB9J,EAAEyJ,OAAO,IAAG,IAAI,IAAIvQ,EAAE,EAAEgH,EAAEF,EAAE0J,WAAWlW,OAAO0F,EAAEgH,EAAEhH,IAAIvG,EAAEqN,EAAEA,EAAE0J,WAAWxQ,IAAI8G,EAAE0J,WAAW,IAAI,CAAC,SAAS1F,EAAEhE,EAAE9G,EAAEgH,GAAGzD,KAAKmN,YAAY,mBAAmB5J,EAAEA,EAAE,KAAKvD,KAAKoN,WAAW,mBAAmB3Q,EAAEA,EAAE,KAAKuD,KAAKqI,QAAQ5E,CAAC,CAAC,SAASiE,EAAEnE,EAAE9G,GAAG,IAAIgH,GAAE,EAAG,IAAIF,GAAE,SAASA,GAAGE,IAAIA,GAAE,EAAGY,EAAE5H,EAAE8G,GAAG,IAAE,SAASA,GAAGE,IAAIA,GAAE,EAAGlG,EAAEd,EAAE8G,GAAG,GAAE,CAAC,MAAMA,GAAG,GAAGE,EAAE,OAAOA,GAAE,EAAGlG,EAAEd,EAAE8G,EAAE,CAAC,CAAC,IAAIjL,EAAEgV,WAAWjV,EAAE8L,UAAUoJ,MAAM,SAAShK,GAAG,OAAOvD,KAAK/D,KAAK,KAAKsH,EAAE,EAAElL,EAAE8L,UAAUlI,KAAK,SAASsH,EAAE9G,GAAG,IAAIgH,EAAE,IAAIzD,KAAKF,YAAY0D,GAAG,OAAOtN,EAAE8J,KAAK,IAAIuH,EAAEhE,EAAE9G,EAAEgH,IAAIA,CAAC,EAAEpL,EAAEsT,IAAI,SAASpI,GAAG,IAAI9G,EAAE7C,MAAMuK,UAAUmD,MAAM1D,KAAKL,GAAG,OAAO,IAAIlL,GAAE,SAASkL,EAAEE,GAAG,SAASD,EAAEnL,EAAEnC,GAAG,IAAI,GAAGA,IAAI,iBAAiBA,GAAG,mBAAmBA,GAAG,CAAC,IAAImO,EAAEnO,EAAE+F,KAAK,GAAG,mBAAmBoI,EAAE,YAAYA,EAAET,KAAK1N,GAAE,SAASqN,GAAGC,EAAEnL,EAAEkL,EAAE,GAAEE,EAAE,CAAChH,EAAEpE,GAAGnC,EAAE,KAAKyN,GAAGJ,EAAE9G,EAAE,CAAC,MAAM8G,GAAGE,EAAEF,EAAE,CAAC,CAAC,GAAG,IAAI9G,EAAE1F,OAAO,OAAOwM,EAAE,IAAI,IAAI,IAAII,EAAElH,EAAE1F,OAAOsB,EAAE,EAAEA,EAAEoE,EAAE1F,OAAOsB,IAAImL,EAAEnL,EAAEoE,EAAEpE,GAAG,GAAE,EAAEA,EAAEyD,QAAQ,SAASyH,GAAG,OAAOA,GAAG,iBAAiBA,GAAGA,EAAEzD,cAAczH,EAAEkL,EAAE,IAAIlL,GAAE,SAASoE,GAAGA,EAAE8G,EAAE,GAAE,EAAElL,EAAEmV,OAAO,SAASjK,GAAG,OAAO,IAAIlL,GAAE,SAASoE,EAAEgH,GAAGA,EAAEF,EAAE,GAAE,EAAElL,EAAEoV,KAAK,SAASlK,GAAG,OAAO,IAAIlL,GAAE,SAASoE,EAAEgH,GAAG,IAAI,IAAID,EAAE,EAAEG,EAAEJ,EAAExM,OAAOyM,EAAEG,EAAEH,IAAID,EAAEC,GAAGvH,KAAKQ,EAAEgH,EAAE,GAAE,EAAEpL,EAAE6U,aAAa,mBAAmBzQ,GAAG,SAAS8G,GAAG9G,EAAE8G,EAAE,GAAG,SAASA,GAAGjL,EAAEiL,EAAE,EAAE,EAAElL,EAAEgV,sBAAsB,SAAS9J,GAAG,oBAAoBmK,SAASA,OAAgE,EAAErV,EAAEsV,gBAAgB,SAASpK,GAAGlL,EAAE6U,aAAa3J,CAAC,EAAElL,EAAEuV,yBAAyB,SAASrK,GAAGlL,EAAEgV,sBAAsB9J,CAAC,OAAE,IAASA,GAAGA,EAAEG,QAAQH,EAAEG,QAAQrL,EAAEoL,EAAE5H,UAAU4H,EAAE5H,QAAQxD,EAAE,CAA3hF,CAA6hF2H,KAAM,GAAE4D,KAAKnH,EAAEgH,EAAE,IAAIoK,aAAa,EAAE,SAAStK,EAAE9G,EAAEgH,GAAG,SAASD,EAAED,EAAE9G,GAAGuD,KAAK8N,IAAIvK,EAAEvD,KAAK+N,SAAStR,CAAC,CAAC,IAAIkH,EAAEsF,SAAS9E,UAAUsH,MAAMhP,EAAE6Q,WAAW,WAAW,OAAO,IAAI9J,EAAEG,EAAEC,KAAK0J,WAAWnE,OAAOuC,WAAWsC,aAAa,EAAEvR,EAAEwR,YAAY,WAAW,OAAO,IAAIzK,EAAEG,EAAEC,KAAKqK,YAAY9E,OAAOuC,WAAWwC,cAAc,EAAEzR,EAAEuR,aAAavR,EAAEyR,cAAc,SAAS3K,GAAGA,GAAGA,EAAE4K,OAAO,EAAE3K,EAAEW,UAAUiK,MAAM5K,EAAEW,UAAUkK,IAAI,WAAU,EAAG7K,EAAEW,UAAUgK,MAAM,WAAWnO,KAAK+N,SAASnK,KAAKuF,OAAOnJ,KAAK8N,IAAI,EAAErR,EAAE6R,OAAO,SAAS/K,EAAE9G,GAAGuR,aAAazK,EAAEgL,gBAAgBhL,EAAEiL,aAAa/R,CAAC,EAAEA,EAAEgS,SAAS,SAASlL,GAAGyK,aAAazK,EAAEgL,gBAAgBhL,EAAEiL,cAAc,CAAC,EAAE/R,EAAEiS,aAAajS,EAAEkS,OAAO,SAASpL,GAAGyK,aAAazK,EAAEgL,gBAAgB,IAAI9R,EAAE8G,EAAEiL,aAAa/R,GAAG,IAAI8G,EAAEgL,eAAejB,YAAW,WAAW/J,EAAEqL,YAAYrL,EAAEqL,YAAY,GAAEnS,GAAG,EAAEgH,EAAE,IAAIhH,EAAEoR,aAAaA,aAAapR,EAAEoS,eAAeA,cAAc,EAAE,SAAStL,EAAE9G,EAAEgH,IAAG,SAAUF,EAAE9G,IAAI,SAAS8G,EAAEE,GAAgB,SAASD,EAAED,GAAG,mBAAmBA,IAAIA,EAAE,IAAI0F,SAAS,GAAG1F,IAAI,IAAI,IAAI9G,EAAE,IAAI7C,MAAM8R,UAAU3U,OAAO,GAAG0M,EAAE,EAAEA,EAAEhH,EAAE1F,OAAO0M,IAAIhH,EAAEgH,GAAGiI,UAAUjI,EAAE,GAAG,IAAID,EAAE,CAAC7G,SAAS4G,EAAEuL,KAAKrS,GAAG,OAAOiD,EAAEnC,GAAGiG,EAAEa,EAAE9G,GAAGA,GAAG,CAAC,SAASoG,EAAEJ,UAAU7D,EAAE6D,EAAE,CAAC,SAASlL,EAAEkL,GAAG,IAAI9G,EAAE8G,EAAE5G,SAAS6G,EAAED,EAAEuL,KAAK,OAAOtL,EAAEzM,QAAQ,KAAK,EAAE0F,IAAI,MAAM,KAAK,EAAEA,EAAE+G,EAAE,IAAI,MAAM,KAAK,EAAE/G,EAAE+G,EAAE,GAAGA,EAAE,IAAI,MAAM,KAAK,EAAE/G,EAAE+G,EAAE,GAAGA,EAAE,GAAGA,EAAE,IAAI,MAAM,QAAQ/G,EAAEgP,MAAMhI,EAAED,GAAG,CAAC,SAAStN,EAAEqN,GAAG,GAAGgE,EAAE+F,WAAWpX,EAAE,EAAEqN,OAAO,CAAC,IAAI9G,EAAEiD,EAAE6D,GAAG,GAAG9G,EAAE,CAAC8K,GAAE,EAAG,IAAIlP,EAAEoE,EAAE,CAAC,QAAQkH,EAAEJ,GAAGgE,GAAE,CAAE,CAAC,CAAC,CAAC,CAAC,IAAIhE,EAAEsK,aAAa,CAAC,IAAIxJ,EAAE9G,EAAE,EAAEmC,EAAE,CAAE,EAAC6H,GAAE,EAAGG,EAAEnE,EAAE9M,SAAS6B,EAAE5C,OAAO0Q,gBAAgB1Q,OAAO0Q,eAAe7C,GAAGjL,EAAEA,GAAGA,EAAEgV,WAAWhV,EAAEiL,EAAE,qBAAqB,CAAA,EAAG4C,SAASvC,KAAKL,EAAEwL,SAAoB1K,EAAE,SAASd,GAAG9G,EAAEuS,UAAS,WAAW9Y,EAAEqN,EAAE,GAAE,EAAK,WAAW,GAAGA,EAAE0L,cAAc1L,EAAE2L,cAAc,CAAC,IAAIzS,GAAE,EAAGgH,EAAEF,EAAE4L,UAAU,OAAO5L,EAAE4L,UAAU,WAAW1S,GAAE,CAAE,EAAE8G,EAAE0L,YAAY,GAAG,KAAK1L,EAAE4L,UAAU1L,EAAEhH,CAAC,CAAC,CAAhJ,GAAoJ,WAAW,IAAIA,EAAE,gBAAgB6P,KAAK8C,SAAS,IAAI3L,EAAE,SAASA,GAAGA,EAAE4L,SAAS9L,GAAG,iBAAiBE,EAAE/K,MAAM,IAAI+K,EAAE/K,KAAK8E,QAAQf,IAAIvG,GAAGuN,EAAE/K,KAAK4O,MAAM7K,EAAE1F,QAAQ,EAAEwM,EAAErK,iBAAiBqK,EAAErK,iBAAiB,UAAUuK,GAAE,GAAIF,EAAE+L,YAAY,YAAY7L,GAAGY,EAAE,SAASZ,GAAGF,EAAE0L,YAAYxS,EAAEgH,EAAE,IAAI,CAAC,CAAnR,GAAuRF,EAAEgM,eAAe,WAAW,IAAIhM,EAAE,IAAIgM,eAAehM,EAAEiM,MAAML,UAAU,SAAS5L,GAAGrN,EAAEqN,EAAE7K,KAAK,EAAE2L,EAAE,SAAS5H,GAAG8G,EAAEkM,MAAMR,YAAYxS,EAAE,CAAC,CAAlH,GAAsHiL,GAAG,uBAAuBA,EAAEhR,cAAc,UAAU,WAAW,IAAI6M,EAAEmE,EAAEgI,gBAAgBrL,EAAE,SAAS5H,GAAG,IAAIgH,EAAEiE,EAAEhR,cAAc,UAAU+M,EAAEkM,mBAAmB,WAAWzZ,EAAEuG,GAAGgH,EAAEkM,mBAAmB,KAAKpM,EAAEtL,YAAYwL,GAAGA,EAAE,IAAI,EAAEF,EAAE5L,YAAY8L,EAAE,CAAC,CAA1L,GAAyMY,EAAE,SAASd,GAAG+J,WAAWpX,EAAE,EAAEqN,EAAE,EAAKjL,EAAEuV,aAAarK,EAAElL,EAAEuW,eAAelL,CAAC,CAAC,CAA3lD,CAA6lD,oBAAoBiM,UAAK,IAASrM,EAAEvD,KAAKuD,EAAEqM,KAAM,GAAEhM,KAAKnH,EAAEgH,EAAE,GAAGA,EAAE,IAAI,EAAE,SAASF,EAAE9G,GAAG,SAASgH,IAAI,MAAM,IAAIxI,MAAM,kCAAkC,CAAC,SAASuI,IAAI,MAAM,IAAIvI,MAAM,oCAAoC,CAAC,SAAS0I,EAAEJ,GAAG,GAAGgE,IAAI+F,WAAW,OAAOA,WAAW/J,EAAE,GAAG,IAAIgE,IAAI9D,IAAI8D,IAAI+F,WAAW,OAAO/F,EAAE+F,WAAWA,WAAW/J,EAAE,GAAG,IAAI,OAAOgE,EAAEhE,EAAE,EAAE,CAAC,MAAM9G,GAAG,IAAI,OAAO8K,EAAE3D,KAAK,KAAKL,EAAE,EAAE,CAAC,MAAM9G,GAAG,OAAO8K,EAAE3D,KAAK5D,KAAKuD,EAAE,EAAE,CAAC,CAAC,CAAC,SAASlL,EAAEkL,GAAG,GAAGmE,IAAIsG,aAAa,OAAOA,aAAazK,GAAG,IAAImE,IAAIlE,IAAIkE,IAAIsG,aAAa,OAAOtG,EAAEsG,aAAaA,aAAazK,GAAG,IAAI,OAAOmE,EAAEnE,EAAE,CAAC,MAAM9G,GAAG,IAAI,OAAOiL,EAAE9D,KAAK,KAAKL,EAAE,CAAC,MAAM9G,GAAG,OAAOiL,EAAE9D,KAAK5D,KAAKuD,EAAE,CAAC,CAAC,CAAC,SAASrN,IAAIC,GAAG+G,IAAI/G,GAAE,EAAG+G,EAAEnG,OAAOiH,EAAEd,EAAEuM,OAAOzL,GAAGuM,GAAG,EAAEvM,EAAEjH,QAAQsN,IAAI,CAAC,SAASA,IAAI,IAAIlO,EAAE,CAAC,IAAIoN,EAAEI,EAAEzN,GAAGC,GAAE,EAAG,IAAI,IAAIsG,EAAEuB,EAAEjH,OAAO0F,GAAG,CAAC,IAAIS,EAAEc,EAAEA,EAAE,KAAKuM,EAAE9N,GAAGS,GAAGA,EAAEqN,GAAGhV,MAAMgV,GAAG,EAAE9N,EAAEuB,EAAEjH,MAAM,CAACmG,EAAE,KAAK/G,GAAE,EAAGkC,EAAEkL,EAAE,CAAC,CAAC,SAAShG,EAAEgG,EAAE9G,GAAGuD,KAAK6P,IAAItM,EAAEvD,KAAK8P,MAAMrT,CAAC,CAAC,SAASiD,IAAK,CAAA,IAAI6H,EAAEG,EAAEpP,EAAEiL,EAAEG,QAAQ,CAAA,GAAI,WAAW,IAAI6D,EAAE,mBAAmB+F,WAAWA,WAAW7J,CAAC,CAAC,MAAMF,GAAGgE,EAAE9D,CAAC,CAAC,IAAIiE,EAAE,mBAAmBsG,aAAaA,aAAaxK,CAAC,CAAC,MAAMD,GAAGmE,EAAElE,CAAC,CAAC,CAA3I,GAA+I,IAAItG,EAAEc,EAAE,GAAG7H,GAAE,EAAGoU,GAAG,EAAEjS,EAAE0W,SAAS,SAASzL,GAAG,IAAI9G,EAAE,IAAI7C,MAAM8R,UAAU3U,OAAO,GAAG,GAAG2U,UAAU3U,OAAO,EAAE,IAAI,IAAI0M,EAAE,EAAEA,EAAEiI,UAAU3U,OAAO0M,IAAIhH,EAAEgH,EAAE,GAAGiI,UAAUjI,GAAGzF,EAAE3C,KAAK,IAAIkC,EAAEgG,EAAE9G,IAAI,IAAIuB,EAAEjH,QAAQZ,GAAGwN,EAAEU,EAAE,EAAE9G,EAAE4G,UAAU5O,IAAI,WAAWyK,KAAK6P,IAAIpE,MAAM,KAAKzL,KAAK8P,MAAM,EAAExX,EAAEkK,MAAM,UAAUlK,EAAEyX,SAAQ,EAAGzX,EAAE0X,IAAI,GAAG1X,EAAE2X,KAAK,GAAG3X,EAAE4X,QAAQ,GAAG5X,EAAE6X,SAAS,CAAA,EAAG7X,EAAE8X,GAAG1Q,EAAEpH,EAAE+X,YAAY3Q,EAAEpH,EAAEgY,KAAK5Q,EAAEpH,EAAEiY,IAAI7Q,EAAEpH,EAAEkY,eAAe9Q,EAAEpH,EAAEmY,mBAAmB/Q,EAAEpH,EAAEoY,KAAKhR,EAAEpH,EAAEqY,gBAAgBjR,EAAEpH,EAAEsY,oBAAoBlR,EAAEpH,EAAEuY,UAAU,SAAStN,GAAG,MAAM,EAAE,EAAEjL,EAAEwY,QAAQ,SAASvN,GAAG,MAAM,IAAItI,MAAM,mCAAmC,EAAE3C,EAAEyY,IAAI,WAAW,MAAM,GAAG,EAAEzY,EAAE0Y,MAAM,SAASzN,GAAG,MAAM,IAAItI,MAAM,iCAAiC,EAAE3C,EAAE2Y,MAAM,WAAW,OAAO,CAAC,CAAC,EAAE,SAAS1N,EAAE9G,EAAEgH,GAAgBA,EAAE,IAAIyN,UAAU,EAAE,SAAS3N,EAAE9G,EAAEgH,GAAgB,SAASD,EAAED,EAAE9G,GAAG,GAAG,MAAS8G,EAAY,MAAM,IAAI8I,UAAU,2CAA2C,IAAI,IAAI5I,EAAE/N,OAAO6N,GAAGC,EAAE,EAAEA,EAAEkI,UAAU3U,OAAOyM,IAAI,CAAC,IAAIG,EAAE+H,UAAUlI,GAAG,GAAG,MAASG,EAAY,IAAI,IAAItL,EAAE3C,OAAOoB,KAAKpB,OAAOiO,IAAIzN,EAAE,EAAEmO,EAAEhM,EAAEtB,OAAOb,EAAEmO,EAAEnO,IAAI,CAAC,IAAIqH,EAAElF,EAAEnC,GAAGwJ,EAAEhK,OAAOyb,yBAAyBxN,EAAEpG,QAAG,IAASmC,GAAGA,EAAEqE,aAAaN,EAAElG,GAAGoG,EAAEpG,GAAG,CAAC,CAAC,OAAOkG,CAAC,CAAC,SAASE,IAAIjO,OAAOsR,QAAQtR,OAAOmO,eAAenO,OAAO,SAAS,CAACqO,YAAW,EAAGD,cAAa,EAAG+I,UAAS,EAAGvV,MAAMkM,GAAG,CAACD,EAAEG,QAAQ,CAACsD,OAAOxD,EAAE0N,SAASvN,EAAE,EAAE,SAASJ,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,IAAIE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEuN,EAAE,IAAIY,EAAE,WAAW,IAAI,IAAId,EAAE,GAAG9G,EAAE,EAAEA,EAAEiP,UAAU3U,OAAO0F,IAAI8G,EAAE9G,GAAGiP,UAAUjP,GAAG,GAAG,oBAAoB0M,OAAO,CAAC,IAAI1F,EAAEvN,EAAEkb,QAAQ3F,WAAM,EAAOlI,GAAG,OAAO,IAAI1H,SAAQ,SAAS0H,EAAE9G,GAAGpE,EAAE6L,QAAQmE,QAAQ,CAACvM,QAAQyH,EAAEiK,OAAO/Q,GAAG+G,EAAEU,QAAQT,GAAG6J,YAAW,WAAW3J,EAAEgF,WAAW,GAAE,GAAE,CAAC,EAAEtE,EAAE8J,MAAMxK,EAAEkF,SAASxE,EAAEyE,SAASnF,EAAEmF,SAASzE,EAAEoE,eAAepQ,EAAEoQ,eAAepE,EAAE0E,YAAYpF,EAAEoF,YAAY1E,EAAEgN,YAAYnb,EAAEmb,YAAY5U,EAAEyH,QAAQG,CAAC,EAAE,SAASd,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAUpL,EAALoL,EAAE,GAAOS,QAAQK,MAAMrO,EAAEuN,EAAE,GAAGY,EAAEZ,EAAE,IAAIlG,EAAEkG,EAAE,IAAI/D,EAAE+D,EAAE,GAAGhH,EAAE+B,KAAK,SAAS+E,GAAGC,EAAE+B,QAAQlN,KAAK5B,SAAS6a,MAAM5R,EAAEuG,SAAS,yDAAyD5B,EAAEH,UAAUhO,EAAEgO,WAAWhO,EAAE2R,iBAAiBtE,GAAGhG,EAAE2G,QAAQX,EAAE,EAAE9G,EAAEyH,QAAQzH,EAAE+B,IAAI,EAAE,SAAS+E,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAWqM,EAALF,EAAE,GAAOS,QAAQK,MAAM9H,EAAE0L,YAAY,mBAAmBxE,EAAE,2CAA2ClH,EAAEyH,QAAQzH,EAAE0L,WAAW,EAAE,SAAS5E,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAA+Be,EAAE,qBAA3BoL,EAAE,GAAOS,QAAQM,QAAiC,kCAAkC/H,EAAEyH,QAAQ7L,CAAC,EAAE,SAASkL,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAWqM,EAALF,EAAE,GAAOS,QAAQU,KAAKnI,EAAE8U,gBAAgB,WAAW,IAAIhO,EAAEI,EAAE,UAAUlH,EAAE8G,EAAE,SAAS,MAAM,qBAAqBA,EAAE,kCAAkC9G,EAAE,IAAIA,EAAE,uCAAuCA,EAAE,IAAIA,EAAE,kCAAkC,EAAEA,EAAE+U,kBAAkB,WAAW,IAAIjO,EAAEI,EAAE,YAAY,MAAM,sBAAsBJ,EAAE,gCAAgCA,EAAE,iCAAiC,EAAE9G,EAAEgV,kBAAkB,WAAW,IAAIlO,EAAEI,EAAE,YAAY,MAAM,sBAAsBJ,EAAE,UAAUA,EAAE,2CAA2CA,EAAE,UAAUA,EAAE,2CAA2CA,EAAE,mCAAmCA,EAAE,4BAA4B,CAAC,EAAE,SAASA,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAWqM,EAALF,EAAE,GAAOS,QAAQY,QAAQrI,EAAEiV,cAAc,mBAAmB/N,EAAE,kBAAkB,EAAE,SAASJ,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEH,EAAEU,QAAQc,iBAAiB3M,EAAEmL,EAAEU,QAAQe,OAAO/O,EAAEsN,EAAEU,QAAQoB,cAAc7I,EAAEkV,aAAa,mBAAmBhO,EAAE,mCAAmCtL,EAAE,wCAAwCnC,EAAE,uFAAuF,EAAE,SAASqN,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEmC,EAAE6L,QAAQU,KAAKP,EAAEhM,EAAE6L,QAAQW,YAAYtH,EAAE,CAAC,QAAQ,UAAU,UAAU,QAAQmC,EAAE,CAACkS,MAAMjO,EAAE4N,kBAAkBM,QAAQlO,EAAE6N,oBAAoBM,QAAQnO,EAAE8N,qBAAqBlK,EAAE,SAAShE,EAAE9G,GAAG,IAAIgH,EAAEvN,EAAE,KAAKqN,EAAE9G,EAAE/B,UAAUmC,IAAI4G,GAAG,IAAID,EAAE9D,EAAE6D,GAAGC,IAAI/G,EAAEiJ,UAAUlC,EAAE,EAAEkE,EAAE,SAASnE,EAAE9G,GAAGA,EAAE/B,UAAUmC,IAAIwH,GAAG,IAAIZ,EAAEhN,SAASC,cAAc,OAAO+M,EAAEtC,IAAIoC,EAAE9G,EAAE9E,YAAY8L,EAAE,EAAEnL,EAAE,SAASiL,GAAG,GAAGA,EAAE,CAAC,IAAI9G,EAAE+G,EAAEmE,kBAAkBhE,EAAE4C,YAAYhJ,EAAE6O,SAAS7I,GAAGgE,EAAEhE,EAAE9G,GAAGiL,EAAEnE,EAAE9G,EAAE,CAAC,EAAEA,EAAEyH,QAAQ5L,CAAC,EAAE,SAASiL,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAE,SAASkL,GAAGwO,UAAUC,UAAU5F,SAAS,iBAAiB7I,EAAElJ,MAAM4X,QAAQ,OAAO1O,EAAE2O,aAAa3O,EAAElJ,MAAM4X,QAAQ,GAAG,EAAExV,EAAEqL,UAAU,SAASvE,GAAG,GAAGA,EAAE,CAAC,IAAI9G,EAAEkH,EAAEgE,kBAAkBnE,EAAEgD,aAAa/J,EAAEmL,YAAYrE,EAAElL,EAAEoE,EAAE,CAAC,EAAEA,EAAEsL,SAAS,SAASxE,GAAG,GAAGA,EAAE,CAAC,IAAI9G,EAAEhG,SAAS0b,yBAAyB5O,EAAE6O,MAAM,MAAMtc,SAAQ,SAASyN,EAAEE,EAAED,GAAG/G,EAAE9E,YAAYlB,SAASkC,eAAe4K,IAAIE,EAAED,EAAEzM,OAAO,GAAG0F,EAAE9E,YAAYlB,SAASC,cAAc,MAAM,IAAG,IAAI+M,EAAEE,EAAEgE,kBAAkBnE,EAAEiD,YAAYhD,EAAE9L,YAAY8E,GAAGpE,EAAEoL,EAAE,CAAC,CAAC,EAAE,SAASF,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEmC,EAAE6L,QAAQe,OAAOZ,EAAEhM,EAAE6L,QAAQkB,cAAc7H,EAAEkG,EAAE,GAAG/D,EAAE+D,EAAE,GAAG8D,EAAE9D,EAAE,GAAGiE,EAAEjE,EAAE,GAAGnL,EAAE,SAASiL,EAAE9G,EAAEgH,GAAG,IAAIE,EAAElH,EAAEhE,KAAKJ,EAAEoE,EAAEnF,MAAMgB,EAAEmE,EAAEqK,UAAU5J,EAAET,EAAEsK,WAAW/I,EAAEwF,EAAEiC,aAAa/F,EAAEiS,cAAcxb,EAAE6H,EAAEwH,cAAc,IAAItP,GAAGqU,EAAErU,EAAE,KAAKqN,EAAKpN,EAAEuE,UAAUmC,IAAI0N,GAAGjS,IAAIsB,MAAM6N,QAAQnP,GAAGA,EAAEA,EAAE8Z,MAAM,MAAMjU,QAAO,SAASoF,GAAG,OAAOA,EAAExM,OAAO,CAAC,IAAGjB,SAAQ,SAASyN,GAAGpN,EAAEuE,UAAUmC,IAAI0G,EAAE,IAAGE,GAAGF,IAAIhG,EAAEoJ,aAAaxQ,EAAEuE,UAAUmC,IAAIwH,GAAGlO,EAAEyR,YAAYjE,EAAE,IAAIoH,EAAE,GAAG,OAAOA,EAAExH,GAAGlL,EAAEqP,EAAEe,eAAesC,GAAGrD,EAAEgB,oBAAoBnF,EAAE,CAACwD,WAAW7J,IAAI/G,EAAE+C,iBAAiB,SAAQ,WAAW,OAAOqO,EAAEsB,SAAStF,EAAE,IAAGvF,CAAC,EAAEd,EAAE,SAASqG,EAAE9G,GAAG,IAAIgH,EAAEE,EAAEgE,kBAAkBjI,EAAEgH,cAAc,IAAI,IAAIlD,KAAKD,EAAE,CAAC,IAAIlL,EAAEkL,EAAEC,GAAGtN,EAAEoC,EAAEkL,EAAEnL,EAAEoE,GAAGpE,EAAEwO,SAASpD,EAAE9L,YAAYzB,EAAE,CAAC,IAAIuN,EAAE9J,SAAS5C,QAAQ0M,EAAEmF,QAAQ,EAAEnM,EAAEyH,QAAQhH,CAAC,EAAE,SAASqG,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEuN,EAAE,GAAGY,EAAEZ,EAAE,GAAU/D,EAAL+D,EAAE,GAAOS,QAAQY,QAAQyC,EAAE,SAAShE,GAAGA,EAAErK,iBAAiB,SAAQ,SAASqK,GAAG,IAAeE,EAATF,EAAE9L,OAAWH,MAAMpB,EAAEuS,eAAehF,EAAE,IAAGF,EAAErK,iBAAiB,SAAQ,SAASqK,GAAG,GAAG,UAAUA,EAAEpJ,IAAI,OAAOkK,EAAEwE,SAASrF,EAAEmD,YAAY,IAAG2G,YAAW,WAAW/J,EAAE8O,QAAQnc,EAAEuS,eAAe,GAAG,GAAE,EAAE,EAAEf,EAAE,SAASnE,EAAE9G,EAAEgH,GAAG,IAAID,EAAE/M,SAASC,cAAc+F,GAAGkH,EAAEjE,EAAE,KAAKjD,EAAqB,IAAI,IAAIpE,KAA3BmL,EAAE9I,UAAUmC,IAAI8G,GAAgBF,EAAE,CAAC,IAAIvN,EAAEuN,EAAEpL,GAAGmL,EAAEnL,GAAGnC,CAAC,CAAC,UAAUuG,GAAG8K,EAAE/D,GAAGD,EAAE5L,YAAY6L,EAAE,EAAElL,EAAE,SAASiL,GAAG,GAAGA,EAAE,CAAC,IAAI9G,EAAEkH,EAAEgE,kBAAkBtP,EAAEqZ,eAAejO,EAAEF,EAAEhL,QAAQiL,EAAED,EAAE3I,WAAW,iBAAiB6I,EAAEiE,EAAEjL,EAAEgH,EAAED,GAAG/G,EAAE9E,YAAY8L,EAAE,CAAC,EAAEhH,EAAEyH,QAAQ5L,CAAC,EAAE,SAASiL,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAE,WAAW,IAAIkL,EAAEC,EAAEiC,aAAa9B,EAAE2C,eAAe7P,SAAS6a,KAAK3Z,YAAY4L,EAAE,EAAE9G,EAAEyH,QAAQ7L,CAAC,EAAE,SAASkL,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,GAAGvN,EAAEuN,EAAE,GAAGY,EAAEZ,EAAE,GAAGlG,EAAE8G,EAAEH,QAAQK,MAAM7E,EAAE2E,EAAEH,QAAQe,OAAOsC,EAAElD,EAAEH,QAAQM,QAAQkD,EAAE,SAASnE,GAAGA,EAAE+O,iBAAiB/H,GAAG,EAAEjS,EAAE,SAASiL,GAAGA,EAAE+O,iBAAiBvH,GAAG,EAAE7N,EAAE,SAASqG,GAAG,GAAGC,EAAEU,QAAQkE,QAAyB,WAAX7E,EAAEpJ,IAAkB,OAAOwJ,EAAEkF,SAAS3S,EAAE0Q,WAAY,EAAE5I,EAAE,SAASuF,GAAG,GAAGC,EAAEU,QAAQkE,QAAyB,QAAX7E,EAAEpJ,IAAe,OAAOuN,EAAEnE,EAAG,EAAEpN,EAAE,SAASoN,GAAG,GAAGC,EAAEU,QAAQkE,OAAO,MAAM,QAAQ7E,EAAEpJ,KAAKoJ,EAAEgP,SAASja,EAAEiL,QAAG,CAAM,EAAEgH,EAAE,WAAW,IAAIhH,EAAElL,EAAEkN,QAAQ7F,GAAG6D,IAAIA,EAAEiP,SAAS,EAAEjP,EAAE8O,QAAQ,EAAEtH,EAAE,WAAW,IAAmBtO,EAAbpE,EAAEkN,QAAQhI,GAAOyL,iBAAiB,IAAItJ,GAAgB8D,EAAE/G,EAAbA,EAAE1F,OAAO,GAASyM,GAAGA,EAAE6O,OAAO,EAAEvH,EAAE,SAASvH,GAAGA,EAAEA,EAAExM,OAAO,GAAGmC,iBAAiB,UAAU8E,EAAE,EAAEyM,EAAE,SAASlH,GAAGA,EAAE,GAAGrK,iBAAiB,UAAU/C,EAAE,EAAEqV,EAAE,WAAW,IAAmB/O,EAAbpE,EAAEkN,QAAQhI,GAAOyL,iBAAiB,IAAItJ,GAAGjD,EAAE1F,SAAS+T,EAAErO,GAAGgO,EAAEhO,GAAG,EAAE6O,EAAE,SAAS/H,GAAG,GAAGlL,EAAEkN,QAAQgC,KAAKhE,EAAE9L,OAAO,OAAOkM,EAAEkF,SAAS3S,EAAE0Q,WAAW,EAAErP,EAAE,SAASgM,GAAG,IAAI9G,EAAEpE,EAAEkN,QAAQgC,GAAG9K,EAAEtD,oBAAoB,QAAQmS,GAAG/H,GAAG9G,EAAEvD,iBAAiB,QAAQoS,EAAE,EAAEmH,EAAE,SAASlP,GAAGC,EAAEU,QAAQqE,OAAOyF,aAAaxK,EAAEU,QAAQqE,OAAOhF,IAAIC,EAAEU,QAAQqE,MAAMY,OAAOmE,YAAW,WAAW,OAAO3J,EAAEkF,SAAS3S,EAAE0Q,WAAW,GAAErD,GAAG,EAAEmP,EAAE,SAASnP,GAAGA,EAAEoP,WAAWlc,SAASyC,iBAAiB,QAAQgE,GAAGzG,SAAS0C,oBAAoB,QAAQ+D,GAAGqG,EAAE2E,WAAWqC,IAAIQ,IAAIS,IAAIjU,EAAEgM,EAAEqP,qBAAqBH,EAAElP,EAAEgF,MAAM,EAAE9L,EAAEyH,QAAQwO,CAAC,EAAE,SAASnP,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAEF,EAAE,GAAGpL,EAAEoL,EAAE,IAAIvN,EAAEuN,EAAE,IAAIY,EAAE,CAAC7B,MAAM,KAAK/J,KAAK,KAAKyK,KAAK,KAAK+E,QAAQtE,EAAEsD,kBAAkBe,QAAQ,KAAKlB,UAAU,KAAK8L,qBAAoB,EAAGD,YAAW,EAAGzK,YAAW,EAAGK,MAAM,MAAMhL,EAAE7H,OAAOsR,OAAO,CAAE,EAAC3C,GAAG5H,EAAE4U,YAAY,SAAS9N,GAAGhG,EAAE7H,OAAOsR,OAAO,CAAE,EAAC3C,EAAEd,EAAE,EAAE,IAAI7D,EAAE,SAAS6D,GAAG,IAAI9G,EAAE8G,GAAGA,EAAEsP,OAAOpP,EAAEF,GAAGA,EAAE0E,QAAQ,YAAO,IAASxL,QAAG,IAASgH,GAAGD,EAAEyC,SAAS,wDAAmD,IAASxJ,EAAE,CAAC0K,QAAQ1K,GAAGgH,CAAC,EAAE8D,EAAE,SAAShE,GAAG,OAAOC,EAAE6C,gBAAgB9C,EAAE,EAAE,EAAEmE,EAAE,SAASnE,EAAE9G,GAAG+G,EAAEyC,SAASsB,EAAE9K,GAAG,eAAe8G,EAAE,gBAAgB,EAAEjL,EAAE,SAASiL,EAAE9G,GAAG,IAAIgH,EAAEF,EAAE,EAAEI,EAAElH,EAAEgH,GAAGD,EAAE0C,cAAcvC,SAAI,IAASA,GAAGH,EAAEyC,SAAS,YAAYsB,EAAE9D,GAAG,eAAeE,EAAE,0BAA0B,EAAEzG,EAAE,SAASqG,EAAE9G,GAAG,IAAIgH,EAAEF,EAAE,EAAEI,EAAElH,EAAEgH,QAAG,IAASE,GAAGH,EAAEyC,SAAS,cAAcsB,EAAE9D,GAAG,cAAcE,EAAE,IAAI,EAAE3F,EAAE,SAASuF,EAAE9G,EAAEgH,EAAEE,GAAG,IAA8BU,EAAE5H,aAAaiQ,QAAQ,GAApC,iBAAJjQ,EAA6C,CAAC,GAAG,IAAIgH,EAAE,MAAM,CAAChL,KAAKgE,GAAG,GAAG,IAAIgH,EAAE,MAAM,CAAChL,KAAKgE,EAAE+F,MAAMmB,EAAE,IAAI,GAAG,IAAIF,EAAE,OAAOnL,EAAEmL,EAAEE,GAAG,CAACT,KAAKzG,GAAGiL,EAAEjL,EAAEgH,EAAE,KAAK,CAAC,GAAGY,GAAG,IAAIZ,EAAE,OAAOnL,EAAEmL,EAAEE,GAAG,CAACqE,QAAQvL,GAAG,GAAG+G,EAAE0C,cAAczJ,GAAG,OAAOS,EAAEuG,EAAEE,GAAGlH,EAAEiL,EAAEjL,EAAEgH,EAAE,CAAC,EAAEhH,EAAE2U,QAAQ,WAAW,IAAI,IAAI7N,EAAE,GAAG9G,EAAE,EAAEA,EAAEiP,UAAU3U,OAAO0F,IAAI8G,EAAE9G,GAAGiP,UAAUjP,GAAG,IAAIgH,EAAE,GAAGF,EAAEzN,SAAQ,SAAS2G,EAAE+G,GAAG,IAAIG,EAAE3F,EAAE,EAAEvB,EAAE+G,EAAED,GAAG7N,OAAOsR,OAAOvD,EAAEE,EAAE,IAAG,IAAIH,EAAE9D,EAAE+D,GAAGA,EAAEwE,QAAQtE,EAAE6D,kBAAkBhE,UAAUC,EAAEoP,OAAOpP,EAAEuE,QAAQ3P,EAAEya,eAAerP,EAAEuE,SAAS,IAAIT,EAAE7R,OAAOsR,OAAO,GAAG3C,EAAE9G,EAAEkG,GAAG,OAAO/N,OAAOoB,KAAKyQ,GAAGzR,SAAQ,SAASyN,GAAGrN,EAAE6c,gBAAgBxP,IAAIrN,EAAE8c,eAAezP,EAAE,IAAGgE,CAAC,CAAC,EAAE,SAAShE,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAK,IAAIkM,EAAEC,EAAE,GAAGE,EAAE,CAACpL,QAAQ,QAAQqC,WAAW,CAACqY,YAAY,KAAKxW,EAAEqW,eAAe,SAASvP,GAAG,IAAI9G,EAAE,GAAG,OAAO+G,EAAE0C,cAAc3C,GAAG7N,OAAOsR,OAAOvK,EAAE8G,GAAGA,aAAamJ,QAAQ,CAACnU,QAAQgL,GAAG,UAAUA,EAAEI,EAAE,IAAI,CAAC,EAAE,SAASJ,EAAE9G,EAAEgH,GAAgB/N,OAAOmO,eAAepH,EAAE,aAAa,CAACnF,OAAM,IAAKmF,EAAEuW,eAAe,SAASzP,GAAG,IAAIE,EAAEhH,EAAEsW,gBAAgBxP,GAAKE,EAAEyP,WAAazP,EAAE0P,YAAc1P,EAAE2P,UAAY3P,EAAE4P,IAAqR,EAAE5W,EAAEsW,gBAAgB,CAACpS,KAAK,CAACwS,YAAY,OAAOE,KAAK,eAAeC,SAAS,CAACH,YAAY,OAAOE,KAAK,eAAeE,YAAY,CAACJ,YAAY,YAAYD,YAAW,EAAGG,KAAK,oBAAoBG,UAAU,GAAGC,iBAAiB,CAACN,YAAY,UAAUE,KAAK,kBAAkBK,kBAAkB,CAACP,YAAY,SAASE,KAAK,iBAAiBM,kBAAkB,CAACR,YAAY,SAASE,KAAK,iBAAiBO,mBAAmB,CAAE,EAACC,iBAAiB,CAACV,YAAY,UAAUE,KAAK,kBAAkBS,eAAe,CAACX,YAAY,SAASC,UAAU,aAAaC,KAAK,iBAAiBU,cAAc,CAACZ,YAAY,UAAUC,UAAU,aAAaC,KAAK,kBAAkBW,oBAAoB,CAACb,YAAY,WAAWc,UAAU,CAAE,EAACC,UAAU,CAACf,YAAY,UAAUE,KAAK,kBAAkBc,WAAW,CAAChB,YAAY,UAAUE,KAAK,kBAAkBe,iBAAiB,CAACjB,YAAY,UAAUE,KAAK,kBAAkBgB,KAAK,CAAClB,YAAY,UAAUE,KAAK,kBAAkBiB,eAAe,CAACnB,YAAY,aAAaD,YAAW,EAAGG,KAAK,qBAAqBkB,kBAAkB,CAACpB,YAAY,sBAAsBD,YAAW,EAAGG,KAAK,8BAA8B,oDCEn1vC,MAAMmB,cAEjB,WAAMC,CAAMC,EAASpD,GAEjB,IAAIqD,EAAUD,EACXpD,IAAMqD,EAAUA,EAAS,KAAOrD,SAC7BjI,KAAK,eAAgBsL,EAC9B,ECNL,MAAMC,iBAAmB,GAgBzB,SAAS/H,SAASvV,EAAOud,EAAQvf,MAC7B,IAAIwf,EACJ,MAAMC,EAAc,IAAI1Y,IACxB,SAAS2Y,EAAIC,GACT,GAAIhf,eAAeqB,EAAO2d,KACtB3d,EAAQ2d,EACJH,GAAM,CACN,MAAMI,GAAaN,iBAAiB7d,OACpC,IAAK,MAAMoe,KAAcJ,EACrBI,EAAW,KACXP,iBAAiBvZ,KAAK8Z,EAAY7d,GAEtC,GAAI4d,EAAW,CACX,IAAK,IAAI7c,EAAI,EAAGA,EAAIuc,iBAAiB7d,OAAQsB,GAAK,EAC9Cuc,iBAAiBvc,GAAG,GAAGuc,iBAAiBvc,EAAI,IAEhDuc,iBAAiB7d,OAAS,CAC7B,CACJ,CAER,CAmBD,MAAO,CAAEie,MAAKxY,OAlBd,SAAgBhH,GACZwf,EAAIxf,EAAG8B,GACV,EAgBqBN,UAftB,SAAmBzB,EAAK6f,EAAa9f,MACjC,MAAM6f,EAAa,CAAC5f,EAAK6f,GAMzB,OALAL,EAAYlY,IAAIsY,GACS,IAArBJ,EAAYM,OACZP,EAAOD,EAAMG,IAAQ1f,MAEzBC,EAAI+B,GACG,KACHyd,EAAYlX,OAAOsX,GACM,IAArBJ,EAAYM,MAAcP,IAC1BA,IACAA,EAAO,KACV,CAER,EAEL,CC1DO,IAAIQ,cAAiBzI,WACrB,MAAM0I,WAAa1I,SAAS,IAC5B,IAAI2I,iBAAmB3I,WCGf,MAAM4I,KAIjB,eAAAC,CAAgBC,GACZ,IAAIC,EAAc,GAEdC,EAAcF,EAAOvD,MAAM,eAC/B,IAAI,IAAI/Z,EAAE,EAAEA,EAAEwd,EAAY9e,OAAOsB,IAAK,CAClC,IAAI6E,EAAE2Y,EAAYxd,GAAGsN,OACrB,GAAIzI,EAAG,CACH,IAAIrG,EAAI,CAAC8e,OAAOzY,GAChB0Y,EAAYva,KAAKxE,EACpB,CACJ,CACD,IAAI,IAAIwB,EAAE,EAAEA,EAAEud,EAAY7e,OAAOsB,IAAK,CAClC,IAAIxB,EAAI+e,EAAYvd,GAChByd,EAAKjf,EAAI8e,OAEb,GADeG,EAAKC,OAAO,aAevBD,EAAKA,EAAKlU,QAAQ,MAAM,IACxB/K,EAAI8e,OAAOG,EACXjf,EAAImf,OAAO,MAhBA,CACX,IAAIA,EACAC,EAAaH,EAAK1D,MAAM,KAAKrb,OAC7Bkf,EAAa,IACbD,GAAQC,EAAa,GAAG,IAE5BH,EAAKA,EAAKlU,QAAQ,MAAM,IACxBkU,EAAKA,EAAKlU,QAAQ,MAAM,IACxB,IAAIsU,EAAIJ,EAAK1D,MAAM,KACd4D,IAAQA,EAAOE,EAAI,IACnBF,IAAQA,EAAO,GACpBnf,EAAImf,OAAOG,WAAWH,GACtBnf,EAAI8e,OAAOO,EAAI,EAC/B,CAKS,CAED,OAAON,CACV,CAGD,KAAAQ,CAAMC,EAAKzN,GACP,KAAOyN,EAAItf,OAAS,IAAuC,GAAlC6R,EAAOpL,QAAQ6Y,EAAIjP,OAAO,KAC/CiP,EAAMA,EAAIC,OAAO,GAErB,KAAOD,EAAItf,OAAS,IAAoD,GAA/C6R,EAAOpL,QAAQ6Y,EAAIjP,OAAOiP,EAAItf,OAAS,KAC5Dsf,EAAMA,EAAIC,OAAO,EAAGD,EAAItf,OAAS,GAErC,OAAOsf,CACV,CAED,WAAAvW,GACIqJ,OAAOoN,kBAAmB,CAE7B,CACD,SAAAC,GACI,OAAOxW,KAAKyW,MACf,CACD,WAAMC,CAAMC,EAAUzZ,GAClByZ,EAASngB,IAAI,IAAI4K,IAAIuV,EAASngB,KAAKogB,OACnCD,EAASngB,IAAIqgB,SAAS,KAAOF,EAASngB,IAAI8Q,MAAM,GAAI,GAAKqP,EAASngB,IAElEwJ,KAAKyW,OAAO,UAEZ,IAAIK,QAAgB9W,KAAK+W,eAAeJ,GAIxC,GAFMxN,OAAOoN,kBADRO,EAGF3N,OAAOoN,kBAAoBpN,OAAO6N,4BAAmE,GAArC7N,OAAO6N,2BAAoC,OAuB9G,IAAIC,EAAS,GACb/Z,EAAEga,SAAW,GACb,IAAI7e,EAAI,EASHse,EAASQ,QAAOR,EAASQ,MAAM,yBACf,mCAAjBR,EAASQ,QAA0CR,EAASQ,MAAM,yBACtE,IAAIC,QAAgBpX,KAAKqX,UAAUV,GACnC,IAAKS,EAED,YADApX,KAAKyW,OAAO,SAIhB,IAAIa,GAAM,EACV,IAAI,IAAIjf,EAAE,EAAEA,EAAE+e,EAAUrgB,OAAOsB,IAAK,CAC1B+e,EAAU/e,GACVkK,KAAKoU,EAASQ,QAAOG,GAAM,EACpC,CACD,IAAKA,GAAkB,qBAATpa,EAAEgD,KAGZ,aAFM,IAAIsU,eAAgBC,MAAM,SAASkC,EAASQ,MAAM,0DACxDnX,KAAKyW,OAAO,SAIhBzW,KAAKuX,gBAAgBC,SAAWb,EAASQ,MAEzCnX,KAAKuX,gBAAgBE,UAAYnL,KAAKoL,MAAoB,KAAdpL,KAAK8C,UAAwB,GAGzE,IAAIuI,EAAa,GAEb/B,EAAY5V,KAAK0V,gBAAgBxY,EAAEyY,QACvC,IAAI,IAAItd,EAAE,EAAEA,EAAEud,EAAY7e,OAAOsB,IAAK,CAClC,IAAIxB,EAAI+e,EAAYvd,GAChBxB,EAAI8e,QACJgC,EAAWtc,KAAK,CAAC5C,KAAK5B,EAAI8e,OAAOiC,WAAW,CAAC5B,OAAOnf,EAAImf,SAE/D,CAGG9Y,EAAE2a,gBACFF,EAAWtc,KAAK,CAAC5C,KAAKyE,EAAE2a,eAAeD,WAAW,CAAC5B,QAAQ,KAG/D,IAAI8B,EAAKxL,KAAK8C,SAASjJ,WACnB4R,EAAU,CAAE,EAIhB,GAAI7a,EAAE8a,uBACF,IAAK,IAAIC,KAAgB/a,EAAE8a,uBACpBC,EAAatX,KAuBxB,GAfIzD,EAAEgb,UAEFH,EAAY,CAACH,WAAa,CAACpZ,MAAQ,IACnCuZ,EAAUI,SAAS,CAACL,KAAKA,EAAKnX,KAAK,iBAAiByX,OAAOlb,EAAEgb,SAChD,YAAThb,EAAEgD,MAA6B,eAAThD,EAAEgD,MAAiC,YAAThD,EAAEgD,MAClDyX,EAAWtc,KAAK0c,IAIX,qBAAT7a,EAAEgD,OACFF,KAAKuX,gBAAgBC,SAAS,OAC9BO,EAAUI,SAASE,YAAY,CAAC,CAACC,mBAAqB,CAAG,IACzDX,EAAW,CAACI,IAGH,cAAT7a,EAAEgD,KAAoB,CACtBF,KAAKuX,gBAAgBC,SAAS,OAC9B,IAAIe,EAAY,GACZC,EAAM,EACNtb,EAAEsb,QAAOA,EAAMtb,EAAEsb,OACjBtb,EAAEub,eACFF,EAAYld,KAAK,CAACqd,IAAI,CAACC,WAAWzb,EAAEub,iBAEpCvb,EAAE0b,WACFL,EAAYld,KAAK,CAACqd,IAAK,CAACG,OAAO3b,EAAE0b,aAGrCb,EAAUI,SAASE,YAAY,CAC3B,CAACS,aACG,CACIC,UAAU,EACV7Y,KAAM,EACNyV,OAAQ4C,EACRC,MAAOA,KAInBb,EAAW,CAACI,EAEf,CAKD,GAJa,YAAT7a,EAAEgD,OACFF,KAAKuX,gBAAgBC,SAASta,EAAE8b,cACjB,YAAX9b,EAAEyY,SAAoBgC,EAAW,CAACI,KAE9B,cAAR7a,EAAEgD,MAA8B,uBAARhD,EAAEgD,KAC1B,GAAIhD,EAAE+b,YAAa,CACf,IAAIC,EAAa,CAACf,SAAS,CAACxX,KAAK,kBACjCuY,EAAWf,SAASE,YAAe,CAAC,CAACc,OAAO,CAACC,SAAS,EAAEC,UAAU,IAAKC,UAAU,EAAEC,WAAW,KAE9FL,EAAWf,SAASE,YAAYhd,KAAK,CAACme,KAAK,CAACC,MAAM,GAAGC,UAAU,kBAE/DR,EAAWf,SAASC,OAASlb,EAAE+b,YAE/BtB,EAAWtc,KAAK6d,EAChC,KAAmB,CACH,IAAIA,EAAa,CAACf,SAAS,CAACxX,KAAK,kBAEjCuY,EAAWf,SAASE,YAAe,CAC/B,CAACsB,SAAW,CACJhW,EAAK,YACLzN,EAAK,iBAIjBgjB,EAAWf,SAASE,YAAYhd,KAC5B,CAACue,OAAU,CAAA,IAEfV,EAAWf,SAASE,YAAYhd,KAC5B,CACIme,KAAQ,CACJC,MAAS,GACTC,UAAa,kBAGzBR,EAAWf,SAASC,OAASlb,EAAEgb,QAE/BP,EAAWtc,KAAK6d,EACnB,CAGL,GAAIhc,EAAE8a,uBACF,IAAK,IAAIC,KAAgB/a,EAAE8a,uBAAwB,CAC/C,IAAIG,EAAW,CAACxX,KAAK,sBAAsBkZ,KAAO,aAE1B,aAApB5B,EAAatX,OAAmBwX,EAAS2B,gBAAgB,UACzD7B,EAAaL,YAAcK,EAAaL,WAAWmC,QAA2C,gBAAjC9B,EAAaL,WAAWmC,SACrF5B,EAAS2B,gBAAgB,oBAEL,iBAApB7B,EAAatX,OAAuBwX,EAAS2B,gBAAgB,uBACzC,YAApB7B,EAAatX,OAAkBwX,EAAS2B,gBAAgB,YACpC,UAApB7B,EAAatX,OAAgBwX,EAAS2B,gBAAgB,SAClC,YAApB7B,EAAatX,OAAkBwX,EAAS2B,gBAAgB,WAGpC,UAApB7B,EAAatX,MAAkD,eAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,mBACrB7B,EAAaL,YAAcK,EAAaL,WAAWmC,QAA2C,gBAAjC9B,EAAaL,WAAWmC,SACrF5B,EAAS2B,gBAAgB,mBAE7B3B,EAASE,YAAY,CAAC,CAAC4B,WAAY,CAC3BC,cAAe/D,WAAW8B,EAAaL,WAAWsC,eAClDC,eAAiBhE,WAAW8B,EAAaL,WAAWuC,oBAIxC,UAApBlC,EAAatX,MAAkD,UAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,QACzB3B,EAASE,YAAY,CAAC,CAAC+B,MAAM,CAAE,IAC3BnC,EAAaL,YAAcK,EAAaL,WAAWmC,QAA2C,gBAAjC9B,EAAaL,WAAWmC,SACrF5B,EAAS2B,gBAAgB,oBAIT,UAApB7B,EAAatX,MAAkD,QAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,MACzB3B,EAASE,YAAY,CAAC,CAACgC,eAAe,CAAE,KAEpB,UAApBpC,EAAatX,MAAkD,YAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,UACzB3B,EAASE,YAAY,CAAC,CAACgC,eAAe,CAAA,EAAGC,UAAW,2BAEhC,UAApBrC,EAAatX,MAAkD,YAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,WAEL,UAApB7B,EAAatX,MAAkD,YAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,UACzB3B,EAASE,YAAY,CAAC,CAACkC,QAAQ,CAAE,KAEb,UAApBtC,EAAatX,MAAkD,WAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,SACzB3B,EAASE,YAAY,CAAC,CAACmC,OAAO,CAACC,sBAAsB,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,OAElE,UAApB3C,EAAatX,MAAkD,iBAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,sBACzB3B,EAASE,YAAY,CAAC,CAACwC,aAAa,CAAE,KAElB,UAApB5C,EAAatX,MAAkD,YAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,WACzB3B,EAASE,YAAY,CAAC,CAACyC,SAAS,CAAE,KAElC7C,EAAaL,YAAcK,EAAaL,WAAWmD,cAAuD,WAAvC9C,EAAaL,WAAWmD,eAChD,SAAvC9C,EAAaL,WAAWmD,eAAuB5C,EAASE,YAAY,IAC7B,SAAvCJ,EAAaL,WAAWmD,eACxB5C,EAASxX,KAAK,iBACdX,KAAKuX,gBAAgBC,SAAS,OAC9BW,EAASE,YAAYhd,KAAK,CAACue,OAAU,CAAG,MAIxB,UAApB3B,EAAatX,MAAkD,UAAhCsX,EAAa+B,mBAC5C7B,EAAS2B,gBAAgB,QACrB7B,EAAaL,YAAcK,EAAaL,WAAWmC,QAA2C,gBAAjC9B,EAAaL,WAAWmC,SACrF5B,EAAS2B,gBAAgB,oBAGjC3B,EAASC,OAAOH,EAAa+C,OAC7B,IAAIhF,EAAO,EACPiF,EAAa,EAEjB,GADIhD,EAAaL,YAAcK,EAAaL,WAAW5B,SAAQA,EAAOiC,EAAaL,WAAW5B,QAC1FiC,EAAaL,YAAcK,EAAaL,WAAWqD,aACnD,OAAOhD,EAAaL,WAAWqD,cAC3B,IAAK,WACDA,EAAa,EACb,MACJ,IAAK,8BACDA,EAAa,EACb,MACJ,IAAK,+BACDA,EAAa,EAID,YAApBhD,EAAatX,OAAkBsa,EAAa,GAChD,IAAItF,EAAO,CAACwC,SAASA,EAASP,WAAW,CAAC5B,OAAOA,EAAOkF,cAAcD,IAEtEtD,EAAWtc,KAAKsa,EACnB,CAEL,GAAIzY,EAAEie,UAAqB,YAATje,EAAEgD,MAA6B,cAAThD,EAAEgD,MAA+B,qBAAThD,EAAEgD,MAAuC,eAAThD,EAAEgD,KAC9F,IAAI,IAAIkb,KAAQle,EAAEie,SAAU,CACxB,IACIxF,EAAO,CAACwC,SADG,CAACxX,KAAK,gBAAgBnK,IAAI4kB,EAAK5kB,KAChBohB,WAAW,CAAC5B,OAAOoF,EAAKpF,SAEtD2B,EAAWtc,KAAKsa,EACnB,CAML3V,KAAKuX,gBAAgB5B,OAASgC,EAC9B,IAAIvU,EAAMiY,SAAS1E,EAASvT,OACxBC,EAAOgY,SAAS1E,EAAStT,QACzBiY,EAAW,CAAE,EACJ,YAATpe,EAAEgD,OACFob,EAASlY,MAAMA,EACfkY,EAASjY,OAAOA,EACZnG,EAAEqe,aAAere,EAAEse,eACnBF,EAASlY,MAAMiY,SAASne,EAAEqe,aAC1BD,EAASjY,OAAOgY,SAASne,EAAEse,gBAK/Bte,EAAEue,OACFH,EAASG,KAAK,CAACve,EAAEue,OAErBH,EAASI,MAAQL,SAASne,EAAEwe,OAC5BJ,EAASK,QAAUN,SAASne,EAAE0e,KAS9BN,EAASO,MAAM,CAACC,QAAO,IAEnBR,EAASlY,MAAM,KAAOkY,EAASjY,OAAO,OAAMiY,EAASO,MAAO,CAACC,QAAO,IAEpE5e,EAAE6e,SACFT,EAASS,QAAS,GAKtBT,EAAS1Q,UAAU,CAACoR,UAxTC,CACjBC,KAAQ,eACRC,KAAS,eACTC,MAAU,kBACV,UAAW,4BACXC,KAAQ,iBACRC,KAAQ,kBACR,SAAU,4BACVC,IAAO,gBACP,sBAAuB,6BACvB,sBAAuB,6BACvB,sBAAuB,6BACvB,WAAW,mBACX,eAAe,uBACf,mBAAmB,mCACnB,kBAAkB,0BAClB,iBAAiB,yBACjB,wBAAwB,0BAuSgBpf,EAAEqf,kBAG9C,IAiCIC,EAGAC,EApCA7E,EAAa,CAAC8E,WAAW,EAAGC,QAAQ,CAACC,SAASzG,WAAWjZ,EAAE2f,aAM/D,GAJwB,0BAApB3f,EAAEqf,kBACF3E,EAAW+E,QAAQlD,MAAQ,CAACqD,SAAY,MAAOC,UAAa,IAG5D7f,EAAEgb,SAAWhb,EAAE+b,YAAa,CAE5B,IAAI+D,EAAW,CAAE,EACZ9f,EAAE+f,WAAU/f,EAAE+f,SAAS,IACvB/f,EAAE+b,YAGH+D,EAASnI,MAAM,EAFfmI,EAASnI,MAAMsB,WAAWjZ,EAAE+f,UAK5B/f,EAAEggB,sBACFF,EAASnI,MAAMsB,WAAWjZ,EAAE+f,WAEhCrF,EAAWoF,SAAWA,CAGzB,CACD,IACQ9f,EAAEigB,OACFvF,EAAWwF,SAAU,CAACC,eAAe,wBACrCzF,EAAWwF,SAASE,UAAY,CAAC,CAACC,iBAAoB,MAE7D,CAAC,MAAO9gB,GAER,CACD6e,EAAS1D,WAAa,CAACA,GACvB5X,KAAKuX,gBAAgB7U,MAAQ4Y,EAK7BmB,QAAuBzc,KAAKwd,SAAS7G,EAAU,gBAAiB3W,KAAKuX,iBAErEkF,EAAehF,UAAYzX,KAAKuX,gBAAgBE,UAC3CtO,OAAOsU,qBAAoBtU,OAAOsU,mBAAqB,IAC5DtU,OAAOsU,mBAAmBpiB,KAAK,IAAIohB,EAAeiB,OAAOxgB,EAAEwgB,SAC3D,IAAIC,GAAe,EACnB,MAAOA,GAAa,CAEhB,GADoBxU,OAAOsU,mBAAmBG,MAAMC,GAAKA,EAAGpG,WAAWgF,EAAehF,WAAaoG,EAAGC,WACnF,MACnB,IACItB,QAAgBxc,KAAKwd,SAAS7G,EAAS,cAAc8F,EACxD,CAAA,MAAOhgB,GAEJ,MADA+f,EAAU,CAAC5K,OAAM,EAAKmM,UAAS,GACzBthB,CAET,CAEG+f,GAAWA,EAAQwB,QAAUxB,EAAQwB,OAAOjnB,SAAU4mB,GAAe,GACpEA,SACK,IAAI9hB,SAAQ8H,GAAK2J,WAAW3J,EAAG,MAE5C,CAwCD,OAtCK6Y,EAAQuB,WACL5U,OAAO8U,oBAAsB/gB,EAAEghB,SAC/Ble,KAAKme,wBAAwBxH,EAAUzZ,EAAGuf,GAE1Czc,KAAKoe,kBAAkBzH,EAAUzZ,EAAGuf,IAKxCD,EAAQwB,SACRxB,EAAUA,EAAQwB,QAInB7U,OAAOoN,mBACNpN,OAAO6N,4BAA6B,EACpCxB,iBAAiBR,IAAI,CAAC3V,OAAQ,KAI7BzF,MAAM6N,QAAQ+U,KAAUA,EAAU,CAACA,IACxCA,EAAQ1mB,SAAQkoB,IACRA,EAAOK,YACPL,EAAOK,UAAUvoB,SACb,EAAI6K,OAAOyX,SAAQqD,KAAM6C,MACrB,GAAa,mBAAT3d,EAA2B,CACtB2d,IAAWA,EAAUjmB,GAC1B6E,EAAEga,SAAS7e,GAAKimB,EAChB,IAAIC,EAAM,CAAEvD,OAAQ5C,GACpBmG,EAAI9C,KAAOve,EAAEga,SAAS7e,GACtB4e,EAAO5b,KAAKkjB,GACZlmB,GACH,KAGT2H,KAAKyW,OAAO,QACf,IAEEQ,CAIV,CAED,uBAAAkH,CAAwBxH,EAASzZ,EAAEuf,GAC/B,IAAI+B,EAAOxe,KACP0d,EAASxgB,EAAEwgB,QACf,iBACI,IAAIK,GAAW,EACf,MAAOA,GAAS,OACN,IAAIliB,SAAQ8H,GAAK2J,WAAW3J,EAAG,OACrC,IAAI8a,EAAgBtV,OAAOsU,mBAAmBG,MAAMC,GAAKA,EAAGpG,WAAWgF,EAAehF,WAAaoG,EAAGC,WACtG,GAAIW,EACA,MAEJ,IAAIjC,QAAgBgC,EAAKhB,SAAS7G,EAAS,cAAc8F,GACzDgC,EAAgBtV,OAAOsU,mBAAmBG,MAAMC,GAAKA,EAAGpG,WAAWgF,EAAehF,WAAaoG,EAAGC,WAClG,IAAIY,IAAkBD,EACtB,GAAGjC,EAAS,CACR,GAAIA,EAAQwB,OAAO,CACf,IAAIW,EAAS,CAACjB,SAAOlB,WAClBkC,IACCC,EAAOD,iBAAkB,GAE7BpJ,cAAcN,IAAI2J,EACrB,CACEnC,EAAQuB,WAAUA,GAAW,EACnC,CACJ,CACJ,CAtBD,EAuBH,CAED,mBAAMa,CAAcjI,EAAS+G,GACzB,IAAKvU,OAAOsU,qBAAuBtU,OAAOsU,mBAAmB1mB,OAAQ,OACrE,IAEIinB,EAFA1G,EAAOnO,OAAOsU,mBAAmBG,MAAMC,GAAKA,EAAGH,QAAQA,IAC3DpG,EAAMwG,UAAW,EAEjB,IACIE,QAAehe,KAAKwd,SAAS7G,EAAU,cAAc,CAACc,UAAUH,EAAMG,UAAUoH,YAAYvH,EAAMuH,aACrG,CAAC,MAAOpiB,SACC,IAAI+X,eAAgBC,MAAMhY,EAAE0J,WACrC,CACJ,CAED,iBAAAiY,CAAkBzH,EAASzZ,EAAEuf,GACzB,IAAI+B,EAAOxe,KACP0d,EAASxgB,EAAEwgB,QACf,iBACI,IACIlB,EACAsC,EAFAf,GAAW,EAGf,MAAOA,GAAS,CAGZ,SAFM,IAAIliB,SAAQ8H,GAAK2J,WAAW3J,EAAG,OACjBwF,OAAOsU,mBAAmBG,MAAMC,GAAKA,EAAGpG,WAAWgF,EAAehF,WAAaoG,EAAGC,WACnF,MACnB,IACItB,QAAgBgC,EAAKhB,SAAS7G,EAAU,cAAe8F,EAC1D,CAAA,MAAOhgB,SACE,IAAI+X,eAAgBC,MAAMhY,EAAE0J,YAClC4X,GAAS,CACZ,CACD,IAAIvB,EAAQwB,OAAQ,SACpBc,EAAa9a,gBAAIuR,YACjB,IAAIwJ,EAAa,EACbC,EAAaF,EAAWlB,MAAK,CAACC,EAAGoB,KAASF,EAAYE,EAAapB,EAAG3gB,EAAEwgB,QAAUA,KAEtF,IAAKsB,EAAY,SACjB,IAAIld,EAAM0a,EAAQwB,OAAO9f,KAAK2f,IAC1B,IAAIqB,EAAKrB,EAAGQ,UAAU,GAGtB,MAAO,CAACrD,OAFK,yBAAyBkE,EAAG9G,OAE1BqD,KADJyD,EAAGzD,KACK,IAGvBuD,EAAWG,UAAY,IAAIH,EAAWG,aAAard,GAC/C0a,EAAQuB,WACRA,GAAW,EACXiB,EAAWjB,UAAW,GAE1Be,EAAWC,GAAeC,EAC1BzJ,WAAWP,IAAI8J,EAClB,CACJ,CAnCD,EAoCH,CAGD,kBAAAM,CAAmBjI,EAAMkI,GACrB,IAAIC,EAAK,CAAC,QAAQ,QAAQ,WAAW,QAAQ,SAAS,MAAM,UAAU,eAAe,UAAU,UAAU,SAAS,8BAA8B,UAAU,oBAAoB,OAAO,gBACjLC,EAAS,GACb,IAAKpI,EAAMqI,kBACP,OAAIH,EAAkBC,EACfC,EAEX,IAAI,IAAIE,KAAStI,EAAMqI,kBACnB,IAAI,IAAI9X,KAAK4X,EAAM,CACf,IAAII,EAAOhY,EACH,aAAJA,IAAgBgY,EAAO,YACnB,YAAJhY,IAAegY,EAAO,YAEtBD,EAAM9e,OAAO+e,IACbH,EAASlkB,KAAKqM,GACD,UAATgY,GAAkBH,EAASlkB,KAAK,+BACvB,aAATqkB,GAAqBH,EAASlkB,KAAK,QAG9C,CAOL,OALIkkB,IACAA,EAASlkB,KAAK,qBACdkkB,EAASlkB,KAAK,iBAGXkkB,CACV,CACD,uBAAMI,CAAkBhJ,GACpB,IAEI,IAGI0I,EAHAO,QAAa5f,KAAKqX,UAAUV,GAEhC,IAAKiJ,EAAQ,OAAO,EAEpBP,QAAgBrf,KAAKwd,SAAS7G,EAAU,UAAW,CAACkJ,WAAY,YAAW,GAC3E,IAAIN,EAAS,CAAE,EACXO,GAAW,EACf,IAAI,IAAIznB,EAAE,EAAEA,EAAEunB,EAAO7oB,OAAOsB,IAAK,CAC7B,IAAI8e,EAAMyI,EAAOvnB,GACb8e,EAAM5U,KAAKoU,EAASQ,QACnBoI,EAAS,CAAClB,UAAUlH,EAAM4I,wBAAwBH,OAAOA,EAAOzI,MAAMA,EAAM5U,GAAG8c,YAAUE,SAASvf,KAAKof,mBAAmBjI,EAAMkI,IAChIS,GAAW,EAEnB,CAED,GAAIA,EAAkB,OAAOP,EAE7B,IAAIpI,EAAMyI,EAAO,GACjB,QAAKzI,IACLoI,EAAS,CAAClB,UAAUlH,EAAM4I,wBAAwBH,OAAOA,EAAOzI,MAAMA,EAAM5U,GAAG8c,YAAUE,SAASvf,KAAKof,mBAAmBjI,EAAMkI,IACzHE,EACV,CAAC,MAAM9iB,GACJ,OAAO,CACV,CACJ,CAWD,cAAM+gB,CAAS7G,EAASqJ,EAAQ1O,EAAK2O,GAAY,GAC7CtJ,EAASngB,IAAI,IAAI4K,IAAIuV,EAASngB,KAAKogB,OACnCD,EAASngB,IAAIqgB,SAAS,KAAOF,EAASngB,IAAI8Q,MAAM,GAAI,GAAKqP,EAASngB,IAClE,IAAI0pB,EAAS,GACTvJ,EAASwJ,QAAOD,EAAS,IAAIvJ,EAASwJ,OAE1C,IACInC,EACAoC,EACAC,EAHAC,EAAU3J,EAASngB,IAAI0pB,EAAO,gBAAgBF,EAI9CrJ,EAASwJ,QAAUD,EAASvJ,EAASwJ,OACzC,IACIE,QAAmBte,MAAMue,EAAU,CAC/BC,QAAS,CACL,eAAgB,mBAChBC,OAAU,mBAEV,yBAA0B,QAG9BzG,OAAQ,OACRzI,KAAMvH,KAAKC,UAAUsH,KAGzB8O,QAAkBC,EAAY5nB,OAC9B,IACIulB,EAAQjU,KAAK0W,MAAML,EACtB,CAAC,MAAMxO,GACJ,MAAM8O,YAAY9O,EACrB,CACD,GAAIyO,EAAY5J,OAAO,IAEnB,MADA2J,EAAapC,EAAOxlB,KAAK,IAAIwlB,EAAO2C,SAC9BD,cAGV,OAAI1C,IAGG,CAEV,CAAC,MAAMpM,GACJ,GAAIqO,EAAa,OACjB,GAAIrO,aAAiB8O,YAAa,CAC9B,IAAIE,EAKJ,MAJGR,IAAYQ,EAAYR,EAAWxe,QAAQ,WAAY,MACrDgf,GAAaP,EAAYQ,aAAYD,EAAY,iBAAiBP,EAAYQ,YAC/ED,IAAWA,EAAYhP,EAAMzL,kBAC3B,IAAIqO,eAAgBC,MAAMmM,GAC1BhP,CACtB,CAIgB,YAHM,IAAI4C,eAAgBC,MAAM7C,EAAMzL,YAEtCnG,KAAKyW,OAAO,QACN7E,CAEb,CACJ,CAKD,eAAMyF,CAAUV,GAIZ,IAAIyJ,EAHJzJ,EAASngB,IAAI,IAAI4K,IAAIuV,EAASngB,KAAKogB,OACnCD,EAASngB,IAAIqgB,SAAS,KAAOF,EAASngB,IAAI8Q,MAAM,GAAI,GAAKqP,EAASngB,IAGlE,IAAI0pB,EAAS,GACTvJ,EAASwJ,QAAOD,EAAS,IAAIvJ,EAASwJ,OAE1C,IACInC,EACA8C,EAFAR,EAAU3J,EAASngB,IAAI0pB,EAAO,uBAGlC,IACIY,QAAkB/e,MAAMue,EAAU,CAC9BC,QAAS,CACL,eAAgB,mBAChBC,OAAU,mBAEV,yBAA0B,QAG9BzG,OAAQ,QAEZqG,QAAkBU,EAAWroB,OAC7B,IACIulB,EAAQjU,KAAK0W,MAAML,EACtB,CAAC,MAAMxO,GACJ,MAAM8O,YAAY9O,EACrB,CAED,GAAIoM,EAAO+C,OAAQ,CACf,IAAIjf,EAAI,GAER,IAAK,IAAIzJ,EAAE,EAAEA,EAAE2lB,EAAO+C,OAAOhqB,OAAOsB,IAAK,CACrC,IAAI0oB,EAAO/C,EAAO+C,OAAO1oB,GACP,YAAd0oB,EAAOpgB,MAAqBmB,EAAIzG,KAAK0lB,EAC5C,CACD,OAAOjf,CACV,CACD,OAAO,CACV,CAAC,MAAM8P,GACJ,KAAIA,aAAiB8O,aAUjB,YAHM,IAAIlM,eAAgBC,MAAM7C,EAAMzL,YAEtCnG,KAAKyW,OAAO,QACN7E,EAVwB,CAC9B,IAAIgP,EACDR,IAAYQ,EAAYR,EAAWxe,QAAQ,WAAY,MACrDgf,GAAaE,EAAWD,aAAYD,EAAY,iBAAiBE,EAAWD,YAC7ED,IAAWA,EAAYhP,EAAMzL,kBAC3B,IAAIqO,eAAgBC,MAAMmM,EAChD,CAMS,CACJ,CAED,qBAAMI,GACF,MAAO,EACV,CAED,oBAAMjK,CAAeJ,GACjB,aAAa3W,KAAKqX,UAAUV,EAC/B,CAEDY,gBAAgB,CAAE,ECjwBP,MAAM0J,aAEjB,WAAAnhB,GACIE,KAAK2V,OAAO,GACZ3V,KAAKkhB,UAAU,GACflhB,KAAKmhB,WAAW,GAChBnhB,KAAKohB,OAAO,GACZphB,KAAKoD,MAAMpD,KAAKqD,OAAO,KACvBrD,KAAKuC,GAAG,CACX,CACD,SAAA8e,CAAUnkB,GACN8C,KAAK2V,OAAOzY,CACf,CACD,YAAAokB,CAAatjB,EAAExF,GACXwH,KAAKkhB,UAAUljB,EACfgC,KAAKmhB,WAAW3oB,CACnB,CACD,kBAAA+oB,GACIvhB,KAAKkhB,UAAU,4QACflhB,KAAKmhB,WAAW,WACnB,CACD,eAAAK,GAEI,OAAOxhB,KAAKyhB,WAAW,KAAK,KAAK,mBADtB,kwGAEd,CACD,KAAAC,CAAM/gB,EAAKnI,EAAK4K,EAAM,EAAEC,EAAO,GAe3B,OAdID,IACApD,KAAKoD,MAAMA,EACXpD,KAAKqD,OAAOA,GAEV,CACFd,GAAIvC,KAAKuC,KACT/J,KAAKA,EACLmI,KAAKA,EACLyC,MAAMpD,KAAKoD,MACXC,OAAOrD,KAAKqD,OACZiI,EAAE,EACFE,EAAE,EACF3E,SAAQ,EAGf,CACD,UAAA4a,CAAWre,EAAMC,EAAO7K,EAAKwiB,GACzB,IAAItb,EAAEM,KAAK0hB,MAAM,QAAQlpB,EAAK4K,EAAMC,GAGpC,OADA3D,EAAElJ,IAAIwkB,EACCtb,CACV,CACD,eAAMiiB,CAAUve,EAAM,KAAKC,EAAO,KAAK7K,EAAK,OAAOuC,EAAU6mB,EAAUC,EAAOC,EAAKC,EAAe,GAC9F,IAAIriB,EAAEM,KAAK0hB,MAAM,OAAOlpB,EAAK4K,EAAMC,GAOnC,OANA3D,EAAEsiB,gBAAkB,cAChBjnB,IAAW2E,EAAEhH,WAAaqC,EAAUknB,YACxCviB,EAAEkiB,UAAYA,EACdliB,EAAEmiB,OAASA,EACXniB,EAAEqiB,eAAiBA,EACnBriB,EAAEoiB,KAAOA,EACFpiB,CACV,CACD,aAAMwiB,CAAQ9e,EAAM,KAAKC,EAAO,KAAK7K,EAAK,WAAWuC,GACjD,IAAI2E,EAAEM,KAAK0hB,MAAM,KAAKlpB,EAAK4K,EAAMC,GAGjC,OAFA3D,EAAEsiB,gBAAkB,cAChBjnB,IAAW2E,EAAEhH,WAAaqC,EAAUknB,YACjCviB,CACV,CACD,eAAMyiB,CAAU/e,EAAM,KAAKC,EAAO,KAAK7K,EAAK,OAAOuC,GAC/C,IAAI2E,EAAEM,KAAK0hB,MAAM,UAAUlpB,EAAK4K,EAAMC,GAItC,OAHA3D,EAAEsiB,gBAAkB,cACpBtiB,EAAE0iB,eAAe,QACbrnB,IAAW2E,EAAEhH,WAAaqC,EAAUknB,YACjCviB,CACV,CACD,cAAA2iB,CAAe/W,EAAE,EAAEE,EAAE,EAAEpI,EAAM,KAAKC,EAAO,MACjCA,EAAOrD,KAAKqD,SAAQA,EAAOrD,KAAKqD,QAChCD,EAAMpD,KAAKoD,QAAOA,EAAMpD,KAAKoD,OACjCpD,KAAKsiB,YAAY,CACb,CACE/f,GAAM,kBACN5B,KAAQ,mBAEV,CACE4B,GAAM,WACN5B,KAAQ,mBACR2K,EAAKA,EACLE,EAAKA,EACLpI,MAASA,EACTC,OAAUA,EACVkf,iBAAmB,EACnBC,kBAAqB,CAAEpf,MAAS,KAAMC,OAAU,OAElD,CACEd,GAAM,cACN5B,KAAQ,cACR2K,EAAK,EACLE,EAAK,EACLpI,MAAS,IACTC,OAAU,KAInB,CACD,WAAAof,CAAY/I,GACR,IAAIgJ,EAAS1iB,KAAKoD,MACduf,EAAU3iB,KAAKqD,OACH,UAAZqW,IACA1Z,KAAKoD,OAAOsf,EAAS,EACrB1iB,KAAKqiB,eAAeK,EAAS,EAAE,EAAEA,EAASC,IAE9B,WAAZjJ,IACA1Z,KAAKqD,QAAQsf,EAAU,EACvB3iB,KAAKqiB,eAAe,EAAEM,EAAUD,EAASC,IAE7B,SAAZjJ,IACA1Z,KAAKoD,OAAOsf,EAAS,EACrB1iB,KAAKqiB,eAAe,EAAE,EAAEK,EAASC,GACjC3iB,KAAKohB,OAAO,GAAG9V,EAAEoX,EAAS,GAEd,QAAZhJ,IACA1Z,KAAKqD,QAAQsf,EAAU,EACvB3iB,KAAKqiB,eAAe,EAAE,EAAEK,EAASC,GACjC3iB,KAAKohB,OAAO,GAAG5V,EAAEmX,EAAU,EAElC,CACD,OAAAC,CAAQ1iB,GACJF,KAAKE,KAAKA,CACb,CACD,IAAA2iB,GAEI,IAAIC,EAAa,CACbnN,OAAQ3V,KAAK2V,OACbuL,UAAWlhB,KAAKkhB,UAChBC,WAAYnhB,KAAKmhB,YAEjB4B,EAAM,CACN3B,OAAQphB,KAAKohB,OAAO4B,UACpBvsB,SAAU,CAAC2M,MAAOpD,KAAKoD,MAAOC,OAAQrD,KAAKqD,QAC3Cif,YAAatiB,KAAKsiB,YAClBQ,cAGJ,OADI9iB,KAAKE,OAAM6iB,EAAIH,QAAQ5iB,KAAKE,MACzB6iB,CACV,CACD,gBAAME,CAAWC,GAoCb,OAnCIA,EAAcxgB,MAAMsY,OACpBhb,KAAKohB,OAAO/lB,KAAK2E,KAAKyhB,WAAWyB,EAAcxgB,MAAMU,MAAM8f,EAAcxgB,MAAMW,OAAO6f,EAAcxgB,MAAMlK,KAAK0qB,EAAcxgB,MAAMsY,SAEnIhb,KAAKohB,OAAO/lB,KAAK2E,KAAKwhB,mBAEtB0B,EAAcC,WAAWnI,SACzBhb,KAAKohB,OAAO/lB,KAAK2E,KAAKyhB,WAAWyB,EAAcxgB,MAAMU,MAAM8f,EAAcxgB,MAAMW,OAAO6f,EAAcxgB,MAAMlK,KAAK0qB,EAAcC,WAAWnI,SACxIhb,KAAKohB,OAAO,GAAGva,SAAQ,EACvB7G,KAAKohB,OAAO,GAAGgC,QAAQ,aACvBpjB,KAAK4iB,QAAQ,qBAEbM,EAAcvN,QAAQ3V,KAAKqhB,UAAU6B,EAAcvN,OAAOld,MAC1DyqB,EAAcG,cAAcrjB,KAAKshB,aAAa4B,EAAcG,aAAanC,UAAUgC,EAAcG,aAAalC,YAC9G+B,EAAcI,QAAQvoB,WACtBiF,KAAKohB,OAAO/lB,WAAW2E,KAAKkiB,QAAQgB,EAAcI,QAAQlgB,MAAM8f,EAAcI,QAAQjgB,OAAO,WAAW6f,EAAcI,QAAQvoB,YAE9HmoB,EAAcK,KAAKxoB,WACnBiF,KAAKohB,OAAO/lB,WAAW2E,KAAKmiB,UAAUe,EAAcK,KAAKngB,MAAM8f,EAAcK,KAAKlgB,OAAO,OAAO6f,EAAcK,KAAKxoB,YAE9F,SAArBmoB,EAAcviB,MAAiBuiB,EAAczqB,KAAKsC,YAClDiF,KAAKohB,OAAO/lB,WAAW2E,KAAK2hB,UAAU,KAAK,KAAK,OAAOuB,EAAczqB,KAAKsC,UAAUmoB,EAAczqB,KAAKmpB,UAAUsB,EAAczqB,KAAKopB,OAAOqB,EAAczqB,KAAKqpB,OAC9J9hB,KAAK4iB,QAAQ,qBAEQ,YAArBM,EAAcviB,KACdX,KAAKuhB,qBAELvhB,KAAK4iB,QAAQ,oBAEjB5iB,KAAKohB,OAAOphB,KAAKohB,OAAOrqB,OAAO,GAAGoM,UAAS,EAC3CnD,KAAKqiB,iBACoB,gBAArBa,EAAcviB,MAAwBuiB,EAAcM,YAAY9J,YAChE1Z,KAAKyiB,YAAYS,EAAcM,YAAY9J,WAC3C1Z,KAAK4iB,QAAQ,qBAGV5iB,KAAK6iB,MACf,ECnLE,IAAIY,QAAQ,CACf,KAAM,CACFC,YAAa,oDACbhI,MAAO,CACP,CAAEjjB,KAAM,QAAQkI,KAAK,eACrB,CAAElI,KAAM,SAASkI,KAAK,YACtB,CAAElI,KAAM,SAASkI,KAAK,SAASgjB,YAAY,qBAE/CJ,KAAQ,CACJG,YAAa,mDACbhI,MAAO,CACP,CAAEjjB,KAAM,QAAQkI,KAAK,eACrB,CAAElI,KAAM,OAAOkI,KAAK,cACpB,CAAElI,KAAM,SAASkI,KAAK,SAASgjB,YAAY,yEAE/ClrB,KAAQ,CACJirB,YAAa,oBACbhI,MAAO,CACP,CAAEjjB,KAAM,OAAOkI,KAAK,QACpB,CAAElI,KAAM,OAAOkI,KAAK,QACpB,CAAElI,KAAM,SAASkI,KAAK,SAASgjB,YAAY,mBAE/CC,QAAW,CACPF,YAAa,gBACbhI,MAAO,CACH,CAAEjjB,KAAM,SAASkI,KAAK,SAASgjB,YAAY,iCAC3C,CAAElrB,KAAM,QAAQkI,KAAK,oBAG7B6iB,YAAe,CACXE,YAAa,0CACbhI,MAAO,CACH,CAAEjjB,KAAM,QAAQkI,KAAK,eACrB,CAAElI,KAAM,YAAYkI,KAAK,eACzB,CAAElI,KAAM,SAASkI,KAAK,SAASgjB,YAAY,iCAEnDR,WAAc,CACVO,YAAa,0CACbhI,MAAO,CACH,CAAEjjB,KAAM,QAAQkI,KAAK,eACrB,CAAElI,KAAM,sBAAsBkI,KAAK,oBACnC,CAAElI,KAAM,SAASkI,KAAK,SAASgjB,YAAY,+WC0f1CE,EAAO,WAAP1mB,OAAmBA,EAAU,KAAAA,QAAeA,EAAI,KAAA2mB,mBAAA3mB,GAyHhD4mB,EAAO,gBAAP5mB,OAAoB6mB,mBAAA7mB,KAkBpBA,EAAI,KAAA8mB,kBAAA9mB,KA2EA+mB,oBAAA/mB,KA0IRA,EAAc,KAAAgnB,oBAAAhnB,u5BA5X+DA,EAAiB,IAArD3C,aAAA4pB,EAAA,SAAO,YAAPjnB,2EAGI3C,aAAA6pB,EAAA,SAAO,eAAPlnB,OAED3C,aAAA8pB,EAAA,SAAO,cAAPnnB,wUAiBF3C,aAAA+pB,EAAA,SAAO,YAAPpnB,6BAEgB3C,aAAAgqB,EAAA,SAAO,gBAAPrnB,4DA1BrBsnB,0FA6BFA,oIAqNuBtnB,EAAW,kLA0H5DA,EAAmB,0IAQnBA,EAAY,yLAQZA,EAAmB,8DA/XrCvF,OAwYMH,EAAAitB,EAAA7sB,GAvYFL,OA8BMktB,EAAAC,GA7BFntB,OAAgGmtB,EAAAC,eAChGptB,OA2BMmtB,EAAAE,GAzBFrtB,OAAiHqtB,EAAAT,GAAzD5sB,OAAmD4sB,EAAAU,eAC3GttB,OAAoEqtB,EAAAE,eAEpEvtB,OAAgFqtB,EAAAR,eAEhF7sB,OAA4EqtB,EAAAP,eAC5E9sB,OAcUqtB,EAAAG,GAbNxtB,OAAoEwtB,EAAAC,eACpEztB,OAWEwtB,EAAA/qB,eAGNzC,OAAuEqtB,EAAAN,eAEvE/sB,OAAoFqtB,EAAAL,eAG5FhtB,OAoNEktB,EAAAQ,oFACF1tB,OAmH0BktB,EAAAS,8BAE1B3tB,OAMEktB,EAAAU,eAEF5tB,OAMEktB,EAAAW,eACF7tB,OAOEktB,EAAAY,sDA3XqBnoB,EAAO,sBAGNA,EAAU,sBAEVA,EAAS,uBAMNA,EAAW,sBAWdA,EAAO,sBAEKA,EAAW,oDAxBmCA,EAAiB,YAArD3C,aAAA4pB,EAAA,SAAO,YAAPjnB,eAGI3C,aAAA6pB,EAAA,SAAO,eAAPlnB,eAED3C,aAAA8pB,EAAA,SAAO,cAAPnnB,eAiBF3C,aAAA+pB,EAAA,SAAO,YAAPpnB,eAEgB3C,aAAAgqB,EAAA,SAAO,gBAAPrnB,OAI/C,WAAPA,OAAmBA,EAAU,KAAAA,QAAeA,EAAI,2EAyHzC,gBAAPA,6EAkBAA,EAAI,6EA2EAooB,EAAAroB,EAAAC,EAAAF,4CAFkDE,EAAW,iLA0H5DA,EAAmB,qHAQnBA,EAAY,qHAQZA,EAAmB,KAE5BA,EAAc,8QAtViDqoB,EAAAroB,MAAWumB,YAAW,KAKxC,gBAA7BvmB,EAAqB,IAACwD,MAAoB8kB,mBAAAtoB,KAgBb,aAA7BA,EAAqB,IAACwD,MAAiB+kB,mBAAAvoB,KAIV,eAA7BA,EAAqB,IAACwD,MAAmBglB,mBAAAxoB,KAIZ,SAA7BA,EAAqB,IAACwD,MAAailB,mBAAAzoB,KAIN,SAA7BA,EAAqB,IAACwD,MAAaklB,mBAAA1oB,KAaN,WAA7BA,EAAqB,IAACwD,MAAemlB,mBAAA3oB,KAKR,mBAA7BA,EAAqB,IAACwD,MAAuBolB,mBAAA5oB,KAKhB,gBAA7BA,EAAqB,IAACwD,MAAoBqlB,mBAAA7oB,KAkBb,qBAA7BA,EAAqB,IAACwD,MAAyBslB,mBAAA9oB,mBAyB/C,OAAAA,QAAoBA,EAAU,IAACue,MAAM3kB,OAAO,EAACmvB,mlBAD0D,yCACnC,kNAnG/BzB,SAEjBhrB,wBAAA0sB,EAAA,QAAAC,EAAAjpB,MAAWue,2CAAgBve,EAAiB,4DADjCsnB,sEAGMA,mEAqFVtnB,EAAU,kFAAgH,gCAAhFkpB,2CAAkCC,+DAD7EnpB,EAAK,2BAAWA,EAAK,yBAASA,EAAG,gFAQZ3C,aAAA+rB,EAAA,YAAoB,IAApBppB,kJAHvBsnB,izBAjGzC7sB,OA2GMH,EAAA+sB,EAAA3sB,GAzGFL,OA6FMgtB,EAAAQ,GA5FFxtB,OAwFEwtB,EAAAX,GAvFF7sB,OAAqF6sB,EAAAO,2BACrFptB,OAEM6sB,EAAAD,GADF5sB,OAAwE4sB,EAAA+B,eAE5E3uB,OAkFM6sB,EAAAU,sPAENvtB,OAEMwtB,EAAAV,GADE9sB,OAAkL8sB,EAAAkC,eAI9LhvB,OASMgtB,EAAAD,GANF/sB,OAAgM+sB,EAAAgC,eAEhM/uB,OAE2C+sB,EAAAkC,qDAInD7uB,OAAwKH,EAAAivB,EAAA7uB,0BACxKD,OAAiLH,EAAAkvB,EAAA9uB,0BACjLD,OAAsLH,EAAAmvB,EAAA/uB,kFA1GtH,SAAAoF,EAAA,IAAAuoB,KAAAA,EAAAroB,MAAWumB,YAAW,KAAA3pB,SAAA8sB,EAAArB,GAEjD,SAAAvoB,EAAA,IAAAmpB,KAAAA,EAAAjpB,MAAWue,+FAAgBve,EAAiB,KAGnC,gBAA7BA,EAAqB,IAACwD,4EAgBO,aAA7BxD,EAAqB,IAACwD,4EAIO,eAA7BxD,EAAqB,IAACwD,4EAIO,SAA7BxD,EAAqB,IAACwD,4EAIO,SAA7BxD,EAAqB,IAACwD,4EAaO,WAA7BxD,EAAqB,IAACwD,4EAKO,mBAA7BxD,EAAqB,IAACwD,4EAKO,gBAA7BxD,EAAqB,IAACwD,4EAkBO,qBAA7BxD,EAAqB,IAACwD,+HAeKxD,EAAU,yCADXA,EAAK,yCAAWA,EAAK,sCAASA,EAAG,mBAQZ3C,aAAA+rB,EAAA,YAAoB,IAApBppB,u0BA1FpDvF,OACqJH,EAAAwtB,EAAAptB,iBACrJD,OAWEH,EAAAwC,EAAApC,2BARasF,EAAiB,4VAY5BvF,OAAwLH,EAAAqvB,EAAAjvB,yVAIxLD,OAA0LH,EAAAqvB,EAAAjvB,oSAIxHkvB,EAAAzvB,MAAA0vB,EAAA7pB,MAAY0kB,eAD9EjqB,OAAqDH,EAAAwvB,EAAApvB,iBACrDD,OAAgGH,EAAAsvB,EAAAlvB,2BAA3CsF,EAAS,mBAAI,KAAAF,EAAA,IAAA+pB,KAAAA,EAAA7pB,MAAY0kB,gJAMJqF,EAAA/pB,MAAY0kB,OAAM,GAEVsF,EAAAhqB,MAAY0kB,OAAM,GAEtBuF,EAAAjqB,MAAY0kB,OAAM,GAEZwF,EAAAlqB,MAAY0kB,OAAM,gcAT1GjqB,OAAiDH,EAAAmtB,EAAA/sB,iBACjDD,OASMH,EAAAutB,EAAAntB,GAPFL,OAAmGwtB,EAAAZ,2BAEnG5sB,OAA2GwtB,EAAAD,2BAE3GvtB,OAAuGwtB,EAAAX,2BAEvG7sB,OAA6GwtB,EAAAV,qIANnC,KAAArnB,EAAA,IAAAiqB,KAAAA,EAAA/pB,MAAY0kB,OAAM,KAAA9nB,SAAAutB,EAAAJ,GAEV,KAAAjqB,EAAA,IAAAkqB,KAAAA,EAAAhqB,MAAY0kB,OAAM,KAAA9nB,SAAAwtB,EAAAJ,GAEtB,KAAAlqB,EAAA,IAAAmqB,KAAAA,EAAAjqB,MAAY0kB,OAAM,KAAA9nB,SAAAytB,EAAAJ,GAEZ,KAAAnqB,EAAA,IAAAoqB,KAAAA,EAAAlqB,MAAY0kB,OAAM,KAAA9nB,SAAA0tB,EAAAJ,mHAIrE7B,EAAAroB,MAAsBwmB,YAAW,gNAER1pB,EAAA3C,MAAAowB,EAAAvqB,MAAc1E,aAFxEb,OAAyEH,EAAAwvB,EAAApvB,6BACzED,OAC8EH,EAAAwC,EAAApC,2BAAxCsF,EAAW,mBAFhB,SAAAF,EAAA,IAAAuoB,KAAAA,EAAAroB,MAAsBwmB,YAAW,KAAA5pB,SAAA8sB,EAAArB,GAER,EAAAvoB,EAAA,IAAAyqB,KAAAA,EAAAvqB,MAAc1E,OAAIwB,EAAA3C,QAAAowB,oIAKnE,OAAAvqB,MAAgB3E,KAAImvB,gHADkF,mDACzB,wJADtF/vB,OAC8HH,EAAAqvB,EAAAjvB,4OAAnE,0GAA5B,MAAA+vB,EAAAzqB,MAAgB3E,KAAI,sDAApB,UAAAyE,EAAA,IAAA2qB,KAAAA,EAAAzqB,MAAgB3E,KAAI,KAAAuB,SAAAwJ,EAAAqkB,6EAG1C,OAAAzqB,MAAa6d,OAAM6M,uRAajB,iaAVsH,QAA/B1qB,EAAkB,IAACuc,kEAEc,SAA/Bvc,EAAkB,IAACuc,WAEzGpjB,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,MAAa6d,SAAM5hB,KAAAmlB,EAAA,MAAAuJ,+FAEqG,UAA/B3qB,EAAkB,IAACuc,oEAEa,WAA/Bvc,EAAkB,IAACuc,0DAVvH9hB,OAWMH,EAAA6sB,EAAAzsB,GATFL,OAA8I8sB,EAAAM,eAE9IptB,OAAiJ8sB,EAAAF,eAErJ5sB,OAAoD8sB,EAAA/F,eAEpD/mB,OAAyJ8sB,EAAAS,eAErJvtB,OAAuJ8sB,EAAAD,kKAR9B,QAA/BlnB,EAAkB,IAACuc,oDAEc,SAA/Bvc,EAAkB,IAACuc,WAEzG,KAAAzc,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,MAAa6d,kEAE2G,UAA/B7d,EAAkB,IAACuc,oDAEa,WAA/Bvc,EAAkB,IAACuc,qGAOtH,OAAAvc,MAAa6d,OAAM+M,uRAOjB,kIANG,OAAA5qB,KAAkB6d,2BAAMgN,+QAIhB1xB,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,KAAkB6d,SAAM5hB,KAAAmlB,EAAA,MAAAuJ,iCAAlClwB,OAAgDH,EAAA8mB,EAAA1mB,WAAtC,IAAAoF,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,KAAkB6d,qGAJD,kJAuByB,0GAAb,olDAa/DpjB,OAAwDH,EAAAmtB,EAAA/sB,iBACxDD,OAaFH,EAAA4sB,EAAAxsB,GAbmFL,OAKnF6sB,EAAAD,GAHM5sB,OAAsE4sB,EAAA6D,eACzEzwB,OAC8B4sB,EAAA8D,qBAAX/qB,EAAS,gBAC9B3F,OAOD6sB,EAAAU,GANNvtB,OAAwEutB,EAAAoD,eAC/D3wB,OAC+ButB,EAAAqD,qBAAZjrB,EAAU,gBAElC3F,OAA+JutB,EAAA+B,iBAInKlvB,OAAwCH,EAAA4wB,EAAAxwB,2EAJqDsF,EAAU,uCAN3EA,EAAS,sBAATA,EAAS,uBAITA,EAAU,sBAAVA,EAAU,mIAS3BA,EAAI,yBAATpG,OAAIsB,GAAA,yNAAC8E,EAAI,YAATpG,OAAIsB,GAAA,EAAA,4JAAJtB,+EAIG,MAAA6wB,EAAAzqB,OAASwC,MAAK,sDAAd,EAAA1C,EAAA,IAAA2qB,KAAAA,EAAAzqB,OAASwC,MAAK,KAAA5F,SAAAwJ,EAAAqkB,+DAFQA,EAAAzqB,OAASwC,MAAK,yEAAlC/H,OAAyCH,EAAAwvB,EAAApvB,uBAArB,EAAAoF,EAAA,IAAA2qB,KAAAA,EAAAzqB,OAASwC,MAAK,KAAA5F,SAAAwJ,EAAAqkB,iFAoBcU,EAAAnrB,OAAMqF,MAAK,GARnCqhB,EAAA1mB,OAAMwF,YAAU4lB,mBAAAprB,GAGhB4mB,EAAA5mB,OAAMyF,MAAI4lB,mOAJ4BlyB,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,QAAKtJ,KAAAmlB,EAAA,MAAAuJ,kCADzB1uB,KAAAwrB,EAAA,OAAA6D,EAAAtrB,OAAM3G,+BADVgE,aAAA4pB,EAAA,SAAAjnB,OAAM0F,oGAD7CjL,OAaQH,EAAA4sB,EAAAxsB,GAZJL,OAUM6sB,EAAAD,GATA5sB,OAQM4sB,EAAAQ,GAPFptB,OAA0DotB,EAAArG,qEASpE/mB,OAAyD6sB,EAAAU,uBATJ,EAAA9nB,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,wBAC5CvF,OAAMwF,kFAGNxF,OAAMyF,sEALkB,EAAA3F,EAAA,IAAAwrB,KAAAA,EAAAtrB,OAAM3G,+BADVgE,aAAA4pB,EAAA,SAAAjnB,OAAM0F,QAWF,EAAA5F,EAAA,IAAAqrB,KAAAA,EAAAnrB,OAAMqF,MAAK,KAAAzI,SAAA2uB,EAAAJ,wKAPahyB,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMwF,aAAUvJ,KAAAmlB,EAAA,MAAAuJ,WAAlElwB,OAAsEH,EAAA8mB,EAAA1mB,WAApB,EAAAoF,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMwF,kJAGxD/K,OAAwBH,EAAAwvB,EAAApvB,iFAmBEqvB,EAAA/pB,OAAMqF,MAAK,GALnCmmB,EAAAxrB,OAAMwF,YAAUimB,mBAAAzrB,gOADsB7G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,QAAKtJ,KAAAmlB,EAAA,MAAAuJ,qFAH7BttB,aAAA4pB,EAAA,SAAAjnB,OAAM0F,oGAD7CjL,OAWQH,EAAA4sB,EAAAxsB,GAVJL,OAQM6sB,EAAAD,GANA5sB,OAKM4sB,EAAAQ,GAJFptB,OAA0DotB,EAAArG,0CAMpE/mB,OAAyD6sB,EAAAU,2DANJ,EAAA9nB,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,wBAC5CvF,OAAMwF,6FAJcnI,aAAA4pB,EAAA,SAAAjnB,OAAM0F,QASF,EAAA5F,EAAA,IAAAiqB,KAAAA,EAAA/pB,OAAMqF,MAAK,KAAAzI,SAAAutB,EAAAJ,wKAJa5wB,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMwF,aAAUvJ,KAAAmlB,EAAA,MAAAuJ,WAAlElwB,OAAsEH,EAAA8mB,EAAA1mB,WAApB,EAAAoF,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMwF,2GAgB9BkmB,EAAA1rB,OAAMqF,MAAK,mNAHSpJ,KAAAmlB,EAAA,MAAAuK,EAAA3rB,OAAM3E,MAAalC,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,QAAKtJ,KAAAmlB,EAAA,MAAAuJ,8MAJ7FlwB,OAQQH,EAAA4sB,EAAAxsB,GAPJL,OAKM6sB,EAAAD,GAJA5sB,OAGM4sB,EAAAQ,GADFptB,OAA2HotB,EAAArG,eAGrI/mB,OAAyD6sB,EAAAU,2DAHE,EAAA9nB,EAAA,IAAA6rB,KAAAA,EAAA3rB,OAAM3E,uBAAa,EAAAyE,EAAA,KAAA3G,cAAAioB,EAAApd,IAAA2mB,EAAA3qB,OAAMuF,wBAG7C,EAAAzF,EAAA,IAAA4rB,KAAAA,EAAA1rB,OAAMqF,MAAK,KAAAzI,SAAAgvB,EAAAF,qFAeLG,EAAA7rB,OAAMqF,MAAK,yLAL9C/I,wBAAAqtB,EAAA,OAAAmC,EAAA9rB,OAAM+F,MACLzJ,wBAAAqtB,EAAA,QAAAoC,EAAA/rB,OAAMqF,sSANrB5K,OAWQH,EAAAstB,EAAAltB,GAVJL,OAQMutB,EAAAH,GANFptB,OAK2BotB,EAAAkC,eAE/BtvB,OAA+DutB,EAAAX,6DALrD,EAAAnnB,EAAA,IAAAgsB,KAAAA,EAAA9rB,OAAM+F,2CACL,EAAAjG,EAAA,IAAAisB,KAAAA,EAAA/rB,OAAMqF,6CAI4B,EAAAvF,EAAA,IAAA+rB,KAAAA,EAAA7rB,OAAMqF,MAAK,MAAA4hB,EAAA1e,UAAAsjB,6EAvDvDnF,EAAA1mB,OAAM3G,KAAG2yB,mBAAAhsB,GAiBT4mB,EAAA5mB,OAAM6F,QAAMomB,mBAAAjsB,GAeZksB,EAAAlsB,OAAM2F,MAAIwmB,mBAAAnsB,GAYVooB,EAAApoB,OAAM+F,MAAIqmB,kBAAApsB,kNA5CVA,OAAM3G,sFAiBN2G,OAAM6F,yFAeN7F,OAAM2F,uFAYN3F,OAAM+F,0PApDA,QAAd/F,EAAQ,KAACoF,IAA4B,eAAdpF,EAAQ,KAACoF,GAAiBinB,yDAM3CC,EAAAtsB,OAASsF,6BAAd1L,OAAIsB,GAAA,+OADVT,OA8DMH,EAAAwvB,EAAApvB,2KA7DK4xB,EAAAtsB,OAASsF,gBAAd1L,OAAIsB,GAAA,EAAA,iJAAJtB,kIAyEmBoG,EAAS,IAAAusB,yKALlB9xB,OA8GOH,EAAAqtB,EAAAjtB,GA7GHL,OA4GMstB,EAAAmC,mMAvBW9pB,EAAiB,GAAAwsB,utBAT9B/xB,OAmBMH,EAAAstB,EAAAltB,GAnBgBL,OAA4CutB,EAAAE,eAClEztB,OAgBUutB,EAAAX,GAfI5sB,OAEc4sB,EAAAnqB,qBAARkD,EAAM,gBAElB3F,OAC8C4sB,EAAA0C,eAC9CtvB,OAQM4sB,EAAAQ,uGAZMznB,EAAM,sBAANA,EAAM,qLArDVysB,EAAA,CAAA,OAAO,uGAcd,MAAY,QAAZzsB,KAAkB0sB,+EA0BlB1sB,EAAiB,GAAA2sB,qoCA9D1BlyB,OA+BMH,EAAAmtB,EAAA/sB,GA9BFL,OA6BSotB,EAAAmF,2DAKbnyB,OAkBMH,EAAAstB,EAAAltB,2BAXFL,OAUMutB,EAAAX,GARF5sB,OAIC4sB,EAAA8D,qBAFe/qB,EAAS,gBAIzB3F,OACwC4sB,EAAA0C,iBAMhDlvB,OAIMH,EAAA4sB,EAAAxsB,GAJgBL,OAA2C6sB,EAAAY,eAC7DztB,OAEwB6sB,EAAA+D,qBAARjrB,EAAM,gBACpBvF,OAQIH,EAAA6sB,EAAAzsB,oLA/CM+xB,EAAA,CAAA,OAAO,4NAwBCzsB,EAAS,sBAATA,EAAS,sBAcbA,EAAM,sBAANA,EAAM,gQAwBX,6UAFHvF,OAC+EH,EAAAqvB,EAAAjvB,0BAD5CsF,EAAc,8HAxD3CA,EAAM,KAFU6sB,EAAA7mB,SAAA8mB,EAAA9sB,QAAYA,EAAU,GAAG,gBAAa+sB,YACzC/sB,EAAM,8BADrBvF,OAGCH,EAAAuyB,EAAAnyB,uBAHiB,EAAAoF,EAAA,IAAAgtB,KAAAA,EAAA9sB,QAAYA,EAAU,GAAG,gBAAa+sB,gFADvD/sB,EAAM,KAAAgtB,kBAAAhtB,2EAANA,EAAM,KAAAwrB,EAAAzrB,EAAAC,EAAAF,yKAgBfrF,OAA+CH,EAAAwtB,EAAAptB,4JAF/CD,OAA8CH,EAAAwtB,EAAAptB,8EA6B3C,uRAF6BD,OAC+EH,EAAAqvB,EAAAjvB,0BAD5CsF,EAAc,4PAoEjHvF,OAIEH,EAAA2yB,EAAAvyB,2BADiBsF,EAAgB,2JAtYtCA,EAAY,IAAAktB,kBAAAltB,+GAAZA,EAAY,8IANT,IAAAsnB,SAAQ,EACR4B,UAAS,EACTC,iBAAgB,EA5XX,SAAAgE,SAAS9zB,GACd2S,OAAOohB,KAAK/zB,EAAK,UAkINg0B,eAAAC,aAAaC,GACnB,OAAA,IAAA7uB,SAASC,OAEd4uB,EAAYte,SAAS,8BACvBtQ,EAAQ4uB,GAGJ,MAAAnM,MAAUoM,MAChBpM,EAAIqM,OAAM,KACF,MAAAC,EAASp0B,SAASC,cAAc,UAChCyG,EAAM0tB,EAAOC,WAAW,MAE9BD,EAAOznB,MAAQmb,EAAInb,MACnBynB,EAAOxnB,OAASkb,EAAIlb,OACpBlG,EAAI4tB,UAAUxM,EAAK,EAAG,GAChB,MAAAyM,EAAaH,EAAOI,UAAU,aACpCnvB,EAAQkvB,EAAU,EAEpBzM,EAAIpd,IAAMupB,CAAW,+BA1QjB,IAuBAQ,EAvBAjf,EAAOjR,wCACAmwB,GAAcpqB,GACdqqB,YAAAA,GAAc,GAAKrqB,GACnBsqB,aAAAA,GAAa,GAAKtqB,GAClBuqB,UAAAA,EAAY,MAAIvqB,GAChBwqB,WAAAA,EAAa,MAAIxqB,GACjByqB,UAAAA,EAAY,IAAEzqB,GACd0qB,OAAAA,EAAS,IAAE1qB,GACX2qB,WAAAA,EAAa,IAAE3qB,YACf4V,GAAQ5V,eAER4qB,GAAW5qB,aACX6qB,GAAS7qB,aACT8qB,GAAS9qB,aACT+qB,GAAS/qB,qBACTgrB,GAAiBhrB,YAGjBirB,EAAQ,aAGRC,kBAAAA,GAAkB,GAAKlrB,EAG9BmrB,GAAsB,EACtBC,GAAe,EACfC,GAAsB,EACtBC,GAAiB,EACjBC,GAAoB,EACpBC,EAAU,GACVC,EAAI,QA6ERtxB,SAAO,KACHuxB,IAAU,IAYdnxB,aAAW,SACHoxB,EAASzgB,EAAK0gB,WACdC,EAAQF,EAAO1jB,iBAAiB,SAC3B,IAAA,IAAAtJ,KAAKktB,EAAK,CACX,IAAAp2B,EAAMkJ,EAAEnG,aAAa,QACzBmG,EAAExG,iBAAiB,SAAO,KAQtB2zB,EAAc,QAGdvC,SAAS9zB,EAAG,IAGhB,IAAAs2B,EAAQJ,EAAOlnB,cAAc,cAC5BsnB,EAAK,OACN,GAAAA,EAAMpyB,UAAUqyB,SAAS,YAAU,WACnCC,EAAOF,EAAMG,wBAGjBC,EAAA,GAAAC,EAAWhkB,OAAOikB,WAAaJ,EAAKK,iBACpCC,EAAK,GAAMN,EAAKO,SAChBT,EAAMpyB,UAAUmC,IAAI,WAAU,IAE9B,IAAAswB,EAAM,EACNG,EAAM,EAED,SAAAT,EAAcxZ,GAEfA,GAAI6Z,EAAA,GAAEb,GAAiB,GACxBhZ,GAAI6Z,EAAA,GAAEb,GAAiB,GAC1Ba,EAAA,GAAAZ,GAAoB,GACpBhf,iBACI4f,EAAA,GAAAZ,GAAoB,EAAK,GAC1B,OAGH,IAAAtpB,EAAO,GACPwqB,EAAkB,EAClBC,EAAU,CAAA,EAEL,SAAAC,EAAY/sB,GACjBusB,EAAA,GAAAhtB,EAAK,UACLgtB,EAAA,GAAAlqB,EAAOrC,QACP8sB,EAAWhK,QAAQ9iB,IACnBusB,EAAA,GAAAx0B,EAAK,WACLi1B,EAAU,CAAA,QACVC,EAAY,CAAA,QACZC,EAAW,CAAA,QACXC,EAAW,CAAEjM,OAAO,UACpBkM,EAAa,CAAEt1B,KAAK,UACpBu1B,EAAe,CAAA,QACfC,EAAkB,CAAA,OAClBC,EAAiB,CAAA,QACjB3B,EAAU,IACV4B,EAAe,OAEfC,EAAqB,CAAA,EACrBF,EAAiB,CAAA,iBAENG,iBACEF,EAAeX,EAAkB,GAGnChD,eAAA2D,EAAevS,GAItB,GAHAA,EAAI,IAAGA,EAAI,GAGXA,GAAK6R,EAAW/R,MAAM3kB,OAAM,KASxBmsB,EAAa,CACbviB,KAAMqC,EACNN,MAAOkrB,EACPjY,OAAOoY,EACP1K,aAAc2K,EACd1K,QAASqK,EACTpK,KAAMsK,EACNp1B,KAAMq1B,EACNtK,YAAayK,EACb9K,WAAW+K,GAEXnjB,MAAMkW,aACN8B,QAAUhY,EAAEkY,WAAWC,UAE3BgK,EAAA,GAAAnB,EAAmBhJ,GACnBmK,EAAA,GAAArB,EAAU,YACVP,EAAYvgB,EAAE3H,WACdmoB,EAAaxgB,EAAE1H,QACf6pB,EAAA,GAAApB,EAAU,eACN8B,EAAap1B,MAAI00B,EAAA,GAAEpB,EAAU8B,EAAap1B,WAC9C81B,IAKA,GAFJpB,EAAA,GAAAM,EAAkB5R,GAClBsR,EAAA,GAAAkB,EAAsBX,EAAW/R,MAAME,IAC7B,IAANA,GAAoB,eAAT5Y,GAAyB4qB,EAAa5S,SAAWkT,EAAkBlT,OAAM,KAChFA,EAAO4S,EAAa5S,OACxBA,QAAayP,aAAazP,OACtB9d,EAAC,CACDgD,KAAM,mBACNgY,QAAS8C,EAAO5I,MAAM,KAAK,GAC3BsL,QAASpR,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,GACnD5Y,OAAQ,SAEFF,MACRiB,MAAMC,EAAS6X,cAActxB,GAAGjB,MAAMpB,QAC/BA,IAAWA,EAAO,KAAOA,EAAO,GAAGmgB,wBACpC4S,EAAY,CAAA,GAGZ,IAAArP,EAAI,yBAAyB1jB,EAAO,GAAGmgB,WAC3CkT,EAAiB,CAAElT,OAAOuD,IAC1B8P,GAAI,SA0BZJ,EAAkB,CAAA,EACb,SAAAQ,EAAwB/U,QAC7BuU,EAAmBvU,UAAUA,EAASuU,GACtCA,EAAmBA,mBACnBI,QAKAL,EAAe,CAAA,MAQfU,EADAb,EAAW,CAAA,MAoBXc,EADAhB,EAAU,CAAA,MAiDViB,EAtBChB,EAAY,CAAA,MAuBbE,EAAW,CAAEjM,OAAO,IAsBT2I,eAAAqE,EAAW/M,QACtB8M,EAAc9M,KAAKA,EAAI8M,QACvBd,EAAYhM,KAAKA,EAAIgM,SACfc,EAAcE,gBACpBF,EAAczL,WAAW,QAAOyL,OAC5B5T,QAAa4T,EAAcG,mBAC/BH,EAAczL,WAAW,cAAayL,QACtCd,EAAYkB,MAAMhU,EAAM8S,GACxBZ,EAAA,GAAAY,EAAYlM,UAAUgN,EAAchN,UAASkM,OAG7CC,EAAa,CAAEt1B,KAAK,mBAQT61B,IACTrC,EAIFiB,EAAA,EAAA7B,GAAa,aAHF7W,eAAgBC,MAAM,yDAYjC,IAAAvU,EAAK,OAMLxH,EAAI,YAgBC+zB,KACLS,EAAA,GAAAhtB,EAAK,cACNgtB,EAAA,GAAAx0B,EAAKqK,gBAOOynB,eAAAyE,GAAYC,MACN,SAAbA,EAAMvuB,SAeV2qB,EAAU4D,EAAM9rB,WAChBmoB,EAAW2D,EAAM7rB,gBAdI,aAAb6rB,EAAMr1B,KAAiB,CACnB,IAAAmI,QAAiBD,MAAMmtB,EAAMpsB,YAC3BqsB,QAAmBntB,EAASotB,qBAClClC,EAAA,GAAAtB,MAAgBzgB,KAAI,CAAEgkB,GAAe,CAAAxuB,KAAM,mCAC3CmrB,EAAUoD,EAAM1sB,OAChB0qB,EAAA,GAAArB,EAAU,aACVyC,KA2CR,IAAAe,IAAU,+tBA5cLA,IAAa5D,IACdyB,EAAA,EAAAxB,EAAW,QACXwB,EAAA,EAAA1B,EAAU,yBACV0B,EAAA,GAAAhC,EAAkBM,EAAY,IAAIC,EAAQ,aAE1CD,GAAaC,GAAUC,KACnBF,EAAUpf,SAAS,UACnB8gB,EAAA,GAAAhC,EAAkBM,GAEdC,GACAyB,EAAA,GAAAhC,EAAkBM,EAAU5pB,QAAQ,MAAO,IAAK,IAAI6pB,EAAQ,WAC7C,SAAZC,GACCwB,EAAA,GAAAhC,EAAkBM,EAAU5pB,QAAQ,MAAO,IAAK,IAAI6pB,EAAQ,oBAIhEP,EAAkBM,EAAU5pB,QAAQ,MAAO,IAAM,WAClC,SAAZ8pB,QACCR,EAAkBM,EAAU5pB,QAAQ,MAAO,IAAM,cAO1D8pB,GACCpe,0BACQtL,MAEAA,QAAiBD,MAAMmpB,SAClBzuB,GACLywB,EAAA,EAAAjB,GAAoB,GAENiB,EAAA,EAAAjB,IAAdjqB,GAAUC,GACgB,GAC/B,IAIXirB,EAAA,GAAAV,EAAI,SACAmB,EAAWqB,QACNpB,EAAa5S,QAIdkS,EAAA,GAAAX,EAAW,GAAGqB,EAAa5S,OAAMuR,GACjCW,EAAA,GAAAX,EAAW,GAAGoB,EAAWqB,MAAKzC,GAC9BW,EAAA,GAAAV,EAAI,WALJU,EAAA,GAAAX,EAAW,GAAGoB,EAAWqB,MAAKzC,GAC9BW,EAAA,GAAAV,EAAI,WAOR0B,EAAkBlT,SAClBkS,EAAA,GAAAX,EAAW,GAAGqB,EAAa5S,OAAMuR,GACjCW,EAAA,GAAAX,EAAW,GAAG2B,EAAkBlT,OAAMuR,GACtCW,EAAA,GAAAV,EAAI,UAEJsB,EAAYkB,QACZ9B,EAAA,GAAAX,EAAW,GAAGuB,EAAYkB,MAAKzC,GAC/BW,EAAA,GAAAV,EAAI,UAEJqB,EAAYmB,QACPpB,EAAa5S,QAIdkS,EAAA,GAAAX,EAAW,GAAGqB,EAAa5S,OAAMuR,GACjCW,EAAA,GAAAX,EAAW,GAAGsB,EAAYmB,MAAKzC,GAC/BW,EAAA,GAAAV,EAAI,WALJU,EAAA,GAAAX,EAAW,GAAGsB,EAAYmB,MAAKzC,GAC/BW,EAAA,GAAAV,EAAI,WAORoB,EAAa5S,QACbkS,EAAA,GAAAX,EAAW,GAAGqB,EAAa5S,OAAMuR,2EAOvB,KACdW,EAAA,EAAA9B,GAAc,GACTiE,KACDnC,EAAA,EAAAxB,EAAW,QACXwB,EAAA,EAAA1B,EAAU,mCAsKT,SAAiB3N,GACtBqP,EAAA,GAAAc,EAAgBx1B,KAAKqlB,EAAGyR,OAAOn1B,IAAG6zB,GAClCd,EAAA,GAAAc,EAAgB9M,UAAUrD,EAAGyR,OAAOpO,UAAUtf,QAAQ,UAAW,MAAIosB,GACrEK,KAMW7D,eAAc3M,GACzBqP,EAAA,GAAAW,EAAYmB,MAAMnR,EAAGmR,MAAKnB,GACtBD,EAAaxqB,MAAO8pB,EAAA,GAAAW,EAAYzqB,MAAMwqB,EAAaxqB,MAClDyqB,GAAAX,EAAA,GAAAW,EAAYzqB,MAAM,KAAIyqB,GACvBD,EAAavqB,OAAQ6pB,EAAA,GAAAW,EAAYxqB,OAAOuqB,EAAavqB,OACpDwqB,GAAAX,EAAA,GAAAW,EAAYxqB,OAAO,KAAIwqB,GAC5BX,EAAA,GAAAwB,EAActrB,MAAMyqB,EAAYzqB,MAAKsrB,GACrCxB,EAAA,GAAAwB,EAAcrrB,OAAOwqB,EAAYxqB,OAAMqrB,GACvCA,EAAca,SAAS1R,SACb,IAAAhiB,SAAQC,GAAWwR,WAAWxR,EAAS,YACjD+xB,EAAY9yB,UAAU2zB,EAAab,GACnCQ,KAOW7D,eAAmBpS,EAAO4W,EAAMQ,QAC3CzB,EAAct1B,KAAK+2B,EAAYzB,QAC/BJ,EAAWqB,MAAMA,EAAKrB,WAElB,IAAA8B,GAAeC,OAAM,IAEtBC,UACCF,EAAYG,OAAM,GAElBH,EAAYG,OAAOC,SAAe,IAAAF,QAAQG,QAAQ,EAAG,EAAG,GAExDL,EAAYG,OAAOG,SAAe,IAAAJ,QAAQG,QAAQ,EAAG,EAAG,UAEtDnB,EAAiBY,SAASE,GAC5B7B,EAAaxqB,MAAO8pB,EAAA,GAAAS,EAAWvqB,MAAMwqB,EAAaxqB,MACjDuqB,GAAAT,EAAA,GAAAS,EAAWvqB,MAAM,KAAIuqB,GACtBC,EAAavqB,OAAQ6pB,EAAA,GAAAS,EAAWtqB,OAAOuqB,EAAavqB,OACnDsqB,GAAAT,EAAA,GAAAS,EAAWtqB,OAAO,KAAIsqB,GAC3BT,EAAA,GAAAyB,EAAiBvrB,MAAMuqB,EAAWvqB,MAAKurB,GACvCzB,EAAA,GAAAyB,EAAiBtrB,OAAOsqB,EAAWtqB,OAAMsrB,QACzCA,EAAiBvW,OAAOA,EAAMuW,QAC9BhB,EAAW5yB,UAAU4zB,EAAgBhB,GACrCU,KAIY7D,eAAkB/tB,GACxB,MAAAqG,EAAOrG,EAAEhF,OAAOu4B,MAAM,MACxBltB,EAAKnC,OAASmC,EAAKnC,KAAKsvB,WAAW,sBACnCxb,MAAM,wBAAyB3R,EAAKnC,KAAMmC,GAG9CoqB,EAAA,GAAAU,EAAap1B,KAAKsK,EAAKtK,KAAIo1B,OAC3BM,EAAiB,CAAA,GACX,MAAAgC,MAAaC,WACnBD,EAAOh3B,iBAAiB,kBAChBg0B,EAAA,GAAAU,EAAa5S,OAAQjiB,EAAMtB,OAAOoD,OAAM+yB,GACpC,IAAArP,MAAUoM,MACdpM,EAAIpd,IAAMysB,EAAa5S,aACjBuD,EAAI6R,SACVlD,EAAA,GAAAU,EAAaxqB,MAAQmb,EAAInb,MAAKwqB,GAC9BV,EAAA,GAAAU,EAAavqB,OAASkb,EAAIlb,OAAMuqB,GAChCS,GAAI,IAEZ6B,EAAOG,cAAcvtB,IAKV0nB,eAAU/tB,GACrBywB,EAAA,GAAAa,EAAct1B,KAAKgE,EAAEhF,OAAOH,MAAKy2B,QACjCA,EAAct1B,KAAMs1B,EAAct1B,KAAKmJ,QAAQ,MAAQ,KAAGmsB,GACtD,IAAAuC,EAAU7zB,EAAEhF,OAAOH,MAAM+P,mBAE7BunB,EAAcxrB,MAAM,KAAIwrB,QACxBA,EAAcvrB,OAAO,KAAIurB,QACzBA,EAAcn2B,KAAK63B,EAAS1B,SAEtBA,EAAcE,gBACpBF,EAAczL,WAAW,QAAOyL,OAC5B5T,QAAa4T,EAAcG,mBAC/BH,EAAczL,WAAW,cAAayL,QAEtCd,EAAYjM,OAAOyO,EAASxC,GAC5BZ,EAAA,GAAAY,EAAYlM,UAAUgN,EAAchN,UAASkM,QAC7CA,EAAYkB,MAAMhU,EAAM8S,GACnBA,EAAYhM,MAAIoL,EAAA,GAAEY,EAAYhM,KAAK,QAAOgM,QAC/CA,EAAY/yB,UAAU6zB,EAAad,cAexBtD,eAAY/tB,GACvBywB,EAAA,GAAAa,EAAct1B,KAAKgE,EAAEhF,OAAOH,MAAKy2B,eAGjCO,gBAmBApB,EAAA,GAAAhtB,EAAK,WACLgtB,EAAA,EAAA9B,GAAY,eAKZ8B,EAAA,GAAAhtB,EAAK,gBACLxH,EAAI,EAEI6J,GAAM,UACNC,MAAS,WACT7C,MAAS,qBACT8C,QAAO,kBAKfyqB,EAAA,GAAAhtB,EAAK,aACNgtB,EAAA,GAAAx0B,EAAK4J,8BAOJ4qB,EAAA,GAAAhtB,EAAK,eACNgtB,EAAA,GAAAx0B,EAAKuK,qBA0BOunB,eAAY/tB,GACjB,MAAAqG,EAAOrG,EAAEhF,OAAOu4B,MAAM,MACxBltB,EAAKnC,OAASmC,EAAKnC,KAAKsvB,WAAW,YAAcntB,EAAKtK,KAAKqe,SAAS,YAAc/T,EAAKtK,KAAKqe,SAAS,qBACrGpC,MAAM,wBAAyB3R,EAAKnC,KAAMmC,QAG9CgpB,EAAUhpB,EAAKtK,MACT,MAAA03B,MAAaC,WACnBD,EAAOh3B,iBAAiB,kBAChB,GAAA4J,EAAKtK,KAAKqe,SAAS,YAAc/T,EAAKtK,KAAKqe,SAAS,SACpDqW,EAAA,GAAAvB,EAAa5yB,EAAMtB,OAAOoD,QAC1BqyB,EAAA,GAAArB,EAAU,aAEVqB,EAAA,GAAAvB,EAAa5yB,EAAMtB,OAAOoD,QAC1BqyB,EAAA,GAAArB,EAAU,SACN,IAAAtN,MAAUoM,MACdpM,EAAIpd,IAAMwqB,QACJpN,EAAI6R,aACV9E,EAAY/M,EAAInb,WAChBmoB,EAAahN,EAAIlb,QAErBirB,GAAkC,IAGtC4B,EAAOG,cAAcvtB,6BAgFwFoqB,EAAA,GAAAf,GAAa,EAAI,OAIjBe,EAAA,GAAAhB,GAAoB,EAAI,OAU/F2C,EAAW,QAAO,OAElBA,EAAW,YAAW,OAEtBA,EAAW,UAAS,OAEpBA,EAAW,aAAY,OAUgDhC,GAAa,OAO1D4B,EAAwB,MAAK,OAE5BA,EAAwB,OAAM,OAI5BA,EAAwB,QAAO,OAE/BA,EAAwB,SAAQ,OA4BMN,EAAeX,EAAkB,EAAC,OAEzDW,EAAeX,EAAkB,EAAC,0DAM1EoB,EAAa2B,sEACP5B,EAAgB4B,sEACQ7B,EAAa6B,yBAWjEjF,EAAStrB,KAAA1I,yBAITi0B,EAAUvrB,KAAA1I,kBAuC2Bo2B,EAAYwB,EAAMlsB,OAAM,MAgByCisB,GAAYC,EAAK,MAezGD,GAAYC,EAAK,EAuBHzyB,IACI,SAAZivB,OACA/U,EAAS6Z,WAAW,GAAGhC,cAAch4B,IAAMg1B,EAAS7U,GAExC,QAAZ+U,OACA/U,EAAS6Z,WAAW,GAAGhC,cAAch4B,IAAMg1B,EAAS7U,GAGvDuW,EAAA,EAAAxB,EAAajvB,EAAEhF,OAAOH,OAEP,SAAZo0B,OACAF,EAAc7U,EAAS6Z,WAAW,GAAGhC,cAAch4B,KAEvC,QAAZk1B,OACAF,EAAc7U,EAAS6Z,WAAW,GAAGhC,cAAch4B,iBA6B3Cg1B,EAASxrB,KAAA1I,yFACH41B,EAAA,EAAA1B,EAAYA,EAAU5pB,QAAQ,MAAO,IAAE,OAGnBsrB,EAAA,GAAAmC,IAAU,EAAK,aAU7C5D,EAAMzrB,KAAA1I,yBAeNm0B,EAAMzrB,KAAA1I,mBAEwB41B,EAAA,GAAAmC,IAAU,EAAI,OArFpDnC,EAAA,EAAA9B,GAAY,EAAK,OAuH7C8B,EAAA,GAAAhB,GAAsB,EAAK,OAQ3BgB,EAAA,GAAAf,GAAe,EAAK,OAQpBe,EAAA,GAAAd,GAAsB,EAAK,wsNCj3BkBxE,EAAAzqB,KAAK1E,KAAI,4DAApB0E,EAAO,IAAlC3C,aAAAi2B,EAAA,UAAAtzB,OAAUA,EAAC,YAA9BvF,OAAwEH,EAAAg5B,EAAA54B,uBAAf,EAAAoF,GAAA2qB,KAAAA,EAAAzqB,KAAK1E,KAAI,KAAAsB,SAAAwJ,EAAAqkB,4BAApBzqB,EAAO,SAAlC3C,aAAAi2B,EAAA,UAAAtzB,OAAUA,EAAC,+DADvBA,EAAK,wBAAVpG,OAAIsB,GAAA,sIADVT,OAIOH,EAAAi5B,EAAA74B,kFAHIsF,EAAK,WAAVpG,OAAIsB,GAAA,EAAA,gJAAJtB,kGAVK2kB,EAAK,IAAA3a,GACL4vB,QAAAA,EAAQ,GAAC5vB,EAChB6vB,EAAQ,qHAEJlV,GACAwR,EAAA,EAAA0D,EAAQ,IAAIlV,EAAM3kB,OAAO,0mDCC2ByD,aAAAysB,EAAA,oBAAQ,SAAR9pB,cAA1DvF,OAAoIH,EAAAwvB,EAAApvB,gBAA1E2C,aAAAysB,EAAA,oBAAQ,SAAR9pB,iIAG+CjD,UAAA+sB,EAAA,mBAAA,OAAA9pB,KAAO,GAAC,KAAtD3C,aAAAysB,EAAA,oBAAQ,SAAR9pB,cAA3DvF,OAA6HH,EAAAwvB,EAAApvB,gBAApBqC,UAAA+sB,EAAA,mBAAA,OAAA9pB,KAAO,GAAC,UAAtD3C,aAAAysB,EAAA,oBAAQ,SAAR9pB,2JAGwCjD,UAAA0qB,EAAA,mBAAA,OAAAznB,KAAO,GAAC,KAAtD3C,aAAAoqB,EAAA,iBAAQ,SAARznB,4CACmDjD,UAAAkqB,EAAA,mBAAA,OAAAjnB,KAAO,GAAC,KAAtD3C,aAAA4pB,EAAA,oBAAQ,SAARjnB,cAD1DvF,OAAsHH,EAAAmtB,EAAA/sB,iBACtHD,OAA2HH,EAAA2sB,EAAAvsB,gBADxBqC,UAAA0qB,EAAA,mBAAA,OAAAznB,KAAO,GAAC,UAAtD3C,aAAAoqB,EAAA,iBAAQ,SAARznB,WACmDjD,UAAAkqB,EAAA,mBAAA,OAAAjnB,KAAO,GAAC,UAAtD3C,aAAA4pB,EAAA,oBAAQ,SAARjnB,+FARrC,IAAhBA,EAAM,GAACpG,QAAUmtB,kBAAA/mB,KAGD,IAAhBA,EAAM,GAACpG,QAAUotB,kBAAAhnB,KAGD,IAAhBA,EAAM,GAACpG,QAAUszB,gBAAAltB,gJAPxBvF,OAgBMH,EAAAwvB,EAAApvB,kFAfiB,IAAhBsF,EAAM,GAACpG,6EAGS,IAAhBoG,EAAM,GAACpG,6EAGS,IAAhBoG,EAAM,GAACpG,kLAXHqqB,EAAM,IAAArgB,GACN8vB,MAAAA,EAAM,MAAI9vB,2jDCJN,MAAM+vB,OACjBlZ,WAAa,CACTjC,OAAQ,GACR+F,MAAO,EACPD,KAAM,EACNG,IAAK,EACLW,gBAAiB,MACjBrF,SAAU,CAAC,GAAI,GAAI,GAAI,IACvB6Z,YAAa,KACbC,YAAY,EACZ9Y,QAAS,GACTe,YAAa,GACbgY,kBAAmB,IACnBC,qBAAsB,eACtBhxB,KAAM,UACN+c,SAAU,KAKduR,cAAgB,CACZh4B,IAAK,GACL26B,QAAS,GACThR,MAAO,GACP3nB,KAAM,QACNmI,KAAM,QACNswB,kBAAmB,IACnBC,qBAAsB,eACtB9tB,MAAO,OACPC,OAAQ,OACR+tB,OAAO,EACPC,YAAW,EACXC,QAAS,CACLpxB,KAAQ,UACRyV,OAAU,GACV8F,KAAQ,GACRC,MAAS,KACT6V,aAAgB,KAChB3V,IAAO,IACPsF,UAAa,kBACbrE,UAAa,MACbI,SAAY,MACZV,gBAAmB,MACnBiV,YAAe,KAGvBC,WAAW,CACP9b,OAAO,GACPuL,UAAU,GACVwQ,kBAAkB,GAClBC,eAAe,GACfC,YAAY,IAEhBC,aAAe,CACXvS,KAAM,GACNwS,KAAM,IAEVtB,WAAa,GACbuB,iBAAmB,EAGnB,UAAAC,CAAWrxB,GACP,IAAIgW,EACAiB,EACJ,MAAa,WAATjX,GACAgW,EAAW,CACPuG,qBAAoB,EACpB1mB,IAAK,GACL26B,QAAS,GACThR,MAAM,GACN3nB,KAAM,OACNmI,KAAM,SACNyC,MAAO,OACPC,OAAQ,OACR+tB,OAAO,EACPC,YAAW,EACXC,QAAS,CACLpxB,KAAQ,UACRyV,OAAU,GACV8F,KAAQ,GACRC,MAAS,KACT6V,aAAgB,KAChB3V,IAAO,IACPsF,UAAa,kBACbrE,UAAa,MACbI,SAAY,MACZV,gBAAmB,0BAG3B3E,EAAa,CACTjC,OAAQ,GACR+F,MAAO,EACPD,KAAM,EACNG,IAAK,EACLW,gBAAiB,MACjBrF,SAAU,CAAC,GAAI,GAAI,GAAI,IACvB6Z,YAAa,KACbC,YAAY,EACZ9Y,QAAS,GACTe,YAAa,GACbgY,kBAAmB,IACnBC,qBAAsB,eACtBhxB,KAAM,UACN+c,SAAU,KAEP,CAAEuR,cAAe7X,EAAUiB,WAAYA,IAErC,UAATjX,GACAgW,EAAW,CACPuG,qBAAoB,EACpB1mB,IAAK,GACL26B,QAAS,GACThR,MAAM,GACN3nB,KAAM,QACNmI,KAAM,QACNyC,MAAO,OACPC,OAAQ,OACR+tB,OAAO,EACPC,YAAW,EACXC,QAAS,CACLpxB,KAAQ,UACRyV,OAAU,GACV8F,KAAQ,GACRC,MAAS,KACT6V,aAAgB,KAChB3V,IAAO,IACPsF,UAAa,kBACbrE,UAAa,MACbI,SAAY,MACZV,gBAAmB,0BAI3B3E,EAAa,CACTjC,OAAQ,GACR+F,MAAO,EACPD,KAAM,EACNG,IAAK,EACLW,gBAAiB,MACjBrF,SAAU,CAAC,GAAI,GAAI,GAAI,IACvB6Z,YAAa,KACbC,YAAY,EACZ9Y,QAAS,GACTe,YAAa,GACbgY,kBAAmB,IACnBC,qBAAsB,eACtBhxB,KAAM,UACN+c,SAAU,KAEP,CAAEuR,cAAe7X,EAAUiB,WAAYA,SA1ClD,CAgDH,CACD,WAAA9X,GAEC,CACD,eAAMmyB,CAAUd,EAAQhR,GACfA,IAAOA,EAAM,IAClBhX,OAAO+oB,aAAaC,QAAQhB,EAAShR,EACxC,CAED,eAAMiS,CAAUjB,GACZ,IAAKA,EAAS,OAGd,OADahoB,OAAO+oB,aAAaG,QAAQlB,IACxB,EACpB,CACD,sBAAMmB,CAAiBb,SACbzxB,KAAKuyB,OACXvyB,KAAKyxB,WAAWA,QACVzxB,KAAKwyB,MACd,CAED,UAAMA,GACF,IAKIC,EAAU,CAAEjC,WALOzmB,KAAK0W,MAAO1W,KAAKC,UAAUhK,KAAKwwB,aAKVuB,iBAAkB/xB,KAAK+xB,iBAAkBF,aAAc7xB,KAAK6xB,aAAaJ,WAAYzxB,KAAKyxB,YACnI9lB,EAAM5B,KAAKC,UAAUyoB,SACnBtpB,OAAO+oB,aAAaC,QAAQ,SAAUxmB,EAC/C,CACD,UAAM4mB,GAEF,IAAIG,QAAmBR,aAAaG,QAAQ,UAE5C,GAAIK,EAAY,CACZ,IAAIC,EAAU5oB,KAAK0W,MAAMiS,GACzB1yB,KAAKwwB,WAAamC,EAAQnC,WACtBmC,EAAQd,eAAc7xB,KAAK6xB,aAAec,EAAQd,cAClDc,EAAQlB,aAAYzxB,KAAKyxB,WAAakB,EAAQlB,YAClDzxB,KAAK+xB,iBAAmBY,EAAQZ,uBAE1B/xB,KAAKgE,KAEd,CACD,OAAO,IACV,CACD,SAAMnH,CAAI+1B,GACN,IAAIt6B,EAAI0H,KAAKgyB,WAAWY,GACxB5yB,KAAKwwB,WAAWn1B,KAAK/C,GACrB0H,KAAK+xB,iBAAmB/xB,KAAKwwB,WAAWz5B,OAAS,QAC3CiJ,KAAKgE,YACLhE,KAAKwyB,MACd,CACD,YAAM,CAAO5W,GAKT,aAJM5b,KAAKuyB,OACXvyB,KAAK+xB,iBAAmBnW,QAClB5b,KAAKwyB,aACLxyB,KAAKgE,MACJhE,IACV,CAID,SAAMgV,GACF,IAAIne,EAAMkT,KAAK0W,MAAO1W,KAAKC,UAAU,CAAEwkB,cAAexuB,KAAKwuB,cAAe5W,WAAY5X,KAAK4X,cAI3F,GAHK/gB,EAAI23B,cAAc2C,UACnBnxB,KAAKwuB,cAAc2C,QAAWt6B,EAAI23B,cAAc2C,SAAY7kB,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,IAEtGvuB,KAAKwuB,cAAc2C,SAAWnxB,KAAKwuB,cAAc2C,QAAQp6B,OACzD,UACSiJ,KAAKiyB,UAAUjyB,KAAKwuB,cAAc2C,QAAQnxB,KAAKwuB,cAAcrO,MACrE,CAAC,MAAO1jB,GACR,CAELuD,KAAKwwB,WAAWxwB,KAAK+xB,kBAAoBl7B,EAErCmJ,KAAKwuB,cAAc8C,UACnBtxB,KAAKyxB,WAAW9b,OAAO3V,KAAKwuB,cAAc8C,QAAQ3b,OAClD3V,KAAKyxB,WAAWvQ,UAAUlhB,KAAKwuB,cAAc8C,QAAQpQ,iBAEnDlhB,KAAKwyB,MACd,CACD,SAAMxuB,GACF,IAAI6uB,EAAO7yB,KAAKwwB,WAAWxwB,KAAK+xB,kBAChC,GAAKc,EAAL,CAGA,GADA7yB,KAAKwuB,cAAgBqE,EAAKrE,cACtBxuB,KAAKwuB,cAAc2C,SAAWnxB,KAAKwuB,cAAc2C,QAAQp6B,OACzD,IACIiJ,KAAKwuB,cAAcrO,YAAcngB,KAAKoyB,UAAUpyB,KAAKwuB,cAAc2C,QACtE,CAAC,MAAO10B,GACR,CAEDuD,KAAKwuB,cAAc8C,SAAWtxB,KAAKyxB,YAAczxB,KAAKyxB,WAAW9b,SACjE3V,KAAKwuB,cAAc8C,QAAQ3b,OAAO3V,KAAKyxB,WAAW9b,OAClD3V,KAAKwuB,cAAc8C,QAAQpQ,UAAUlhB,KAAKyxB,WAAWvQ,WAEzDlhB,KAAK4X,WAAaib,EAAKjb,UAbZ,CAcd,CACD,YAAM,GACF5X,KAAKwwB,WAAW3vB,OAAOb,KAAK+xB,iBAAiB,GAC7C/xB,KAAK+xB,iBAAiB,QAEhB/xB,KAAKgE,YACLhE,KAAKwyB,MACd,ECpQE,MAAMM,eAET,gBAAAC,GAEI,MAAO,CAAC,CAACv6B,KAAK,cAAcmI,KAAK,QAAQqyB,iBAAgB,GAAM,CAACx6B,KAAK,OAAOmI,KAAK,QAAQqyB,iBAAgB,GAAM,CAACx6B,KAAK,UAAUmI,KAAK,WAAY,CAACnI,KAAK,eAAemI,KAAK,WAAY,CAACnI,KAAK,UAAU,CAACA,KAAK,kBAC3M,CAACA,KAAK,iBAAiBmI,KAAK,UAAU,CAACnI,KAAK,kBAAkBmI,KAAK,UACpE,CAACnI,KAAK,qBAAqB,CAACA,KAAK,qBAAqBmI,KAAK,QAAQqyB,iBAAgB,GAAM,CAACx6B,KAAK,yBAAyB,CAACA,KAAK,8BAA8B,CAACA,KAAK,4BAA4B,CAACA,KAAK,sBACvM,CAOD,gBAAAy6B,CAAiBC,GACb,IAAIC,EAAQ,GACRD,EAASE,OAASF,EAASE,MAAMlvB,SAAWgvB,EAASE,MAAMlvB,QAAQmvB,WAAUF,EAAOD,EAASE,MAAMlvB,QAAQmvB,UAC/G,IAAIC,EAActzB,KAAK+yB,mBAEnBjxB,EAAK,CAACqxB,OAAOppB,KAAK0W,MAAM1W,KAAKC,UAAUmpB,IAASG,gBAAcC,aADjD,CAAC,CAAC/6B,KAAK,iBAExB,IAAI,IAAIH,EAAE,EAAEA,EAAE86B,EAAOp8B,OAAOsB,IAAK,CAC7B,IAAIm7B,EAAML,EAAO96B,GACjB,GAAIm7B,EAAMC,iBAAmBD,EAAME,iBAC/B,IAAI,IAAIjhB,EAAE,EAAEA,EAAE+gB,EAAMC,gBAAgBhhB,IAAK,CACrC,IAAIkhB,EAAS,CAACn7B,KAAKg7B,EAAMh7B,KAAK,IAAIia,EAAE9R,KAAK6yB,EAAME,iBAAiBE,aAAaJ,EAAMh7B,KAAKoI,MAAM6R,GAC9F3Q,EAAIqxB,OAAO93B,KAAKs4B,EACnB,CAEL,GAAiB,gBAAbH,EAAM7yB,KAAsB,CAC5B,GAAuB,IAAnB6yB,EAAMK,WAAgB,SAC1B,IAAI,IAAIphB,EAAE,EAAEA,EAAE+gB,EAAMK,WAAWphB,IAAK,CAChC,IAAIkhB,EAAS,CAACn7B,KAAKg7B,EAAMh7B,KAAK,IAAIia,EAAE9R,KAAK6yB,EAAM7yB,KAAKizB,aAAaJ,EAAMh7B,KAAKoI,MAAM6R,GAClF3Q,EAAIqxB,OAAO93B,KAAKs4B,EACnB,CACJ,CACJ,CACD,OAAO7xB,CACV,ECnCE,MAAMgyB,eACT,WAAAh0B,GACIE,KAAKszB,eAAc,IAAIR,gBAAiBC,kBAE3C,CAMD,QAAAgB,CAASC,EAAUC,GACf,GAAKA,EAAL,CACA,IAAI,IAAI57B,EAAE,EAAEA,EAAE47B,EAAUl9B,OAAOsB,IAAK,CAChC,IAAIm7B,EAAMS,EAAU57B,GACpB,GAAIm7B,EAAMh7B,OAAOw7B,EAAW,OAAOR,CACtC,CACD,IAAI,IAAIn7B,EAAE,EAAEA,EAAE2H,KAAKszB,cAAcv8B,OAAOsB,IAAK,CACzC,IAAIm7B,EAAMxzB,KAAKszB,cAAcj7B,GAC7B,GAAIm7B,EAAMh7B,OAAOw7B,EAAW,OAAOR,CACtC,CARe,CASnB,CACD,UAAAU,CAAWF,GACP,OAAOA,EAAU5nB,SAAS,KAC7B,CACD,YAAA+nB,CAAaH,GACT,GAAKh0B,KAAKk0B,WAAWF,GACrB,OAAOA,EAAU5hB,MAAM,KAAK,EAC/B,CAED,YAAAgiB,CAAa98B,EAAMk8B,GACf,IAAKA,EAAO,MAAO,GACnB,GAAiB,aAAbA,EAAM7yB,MAAkC,YAAb6yB,EAAM7yB,KAAkB,CACnD,GAAY,SAARrJ,EAAgB,OAAO,EAC3B,GAAY,UAARA,EAAiB,OAAO,CAC/B,CACD,MAAiB,WAAbk8B,EAAM7yB,MAAgC,WAAb6yB,EAAM7yB,KAE3BX,KAAKq0B,QAAQb,EAAMc,MACZne,WAAW7e,GAGf+jB,SAAS/jB,GAGbA,CACV,CASD,QAAAi9B,CAAS77B,EAAKs7B,EAAUC,EAAUO,GAC9B,IAAIhB,EAAMxzB,KAAK+zB,SAASC,EAAUC,GAClC,IAAKj0B,KAAKk0B,WAAWF,GAAY,CAC7B,IAAI18B,EAAOoB,EAAKs7B,GAChB,OAAOh0B,KAAKo0B,aAAa98B,EAAMk8B,EAClC,CACD,IAAIiB,EAAWT,EAAU5hB,MAAM,KAAK,GAChCsiB,EAAcV,EAAU5hB,MAAM,KAAK,GACnC/Z,EAAEm8B,EAASC,GACf,IAAK/7B,EAAK+7B,GAAY,KAAM,mBAAqBA,EACjD,IAAK/7B,EAAK+7B,GAAWp8B,GAAI,KAAM,4BAA8Bo8B,EAAY,IAAMp8B,EAE/E,IAAIf,EAAOoB,EAAK+7B,GAAWp8B,GAAGq8B,GAC9B,OAAQ10B,KAAKo0B,aAAa98B,EAAMk8B,EACnC,CAED,QAAAmB,CAASj8B,EAAKpB,EAAM08B,EAAUC,EAAUO,GACpC,IAAIhB,EAAMxzB,KAAK+zB,SAASC,EAAUC,GAClC,IAAKj0B,KAAKk0B,WAAWF,GAEjB,YADAt7B,EAAKs7B,GAAYh0B,KAAKo0B,aAAa98B,EAAMk8B,IAG7C,IAAIiB,EAAWT,EAAU5hB,MAAM,KAAK,GAChCsiB,EAAcV,EAAU5hB,MAAM,KAAK,GACnC/Z,EAAEm8B,EAASC,GACfn9B,EAAM0I,KAAKo0B,aAAa98B,EAAMk8B,GAC9B96B,EAAK+7B,GAAWp8B,GAAGq8B,GAAcp9B,CAEpC,CAED,OAAA+8B,CAAQ/8B,GACJ,MAAqB,iBAAVA,IAAsBmV,MAAMnV,IAGhCA,EAAQ,GAAM,CACtB,CAUH,OAAAs9B,CAAQl8B,EAAKu7B,EAAUY,EAAML,EAAS,CAAE,EAACC,EAAU,IAE/C,GADKI,IAAOA,EAAM,KACbn8B,EAAM,MAAO,CAACA,OAAKo8B,aAAa,CAAA,GACrC,IAAIA,EAAa,GACbC,EAAW,GACf,IAAI,IAAI18B,EAAE,EAAEA,EAAEw8B,EAAM99B,OAAOsB,IAAK,CAE5B,IAGI28B,EAHAC,EAAKJ,EAAMx8B,GACXm7B,EAAMxzB,KAAK+zB,SAASkB,EAAKjB,UAAUC,GACvC,GAAgB,oBAAZQ,GAAkCz0B,KAAKk0B,WAAWV,EAAMh7B,MAAO,SAEnE,IACIw8B,EAAYh1B,KAAKu0B,SAAS77B,EAAMu8B,EAAKjB,UAAWC,EAAWO,EAC9D,CAAC,MAAO/3B,GAEL,QACH,CAED,IAAIy4B,EAAWD,EAAKC,WACpB,IAAK1B,EAED,SAEJ,GAAIiB,GAAyB,oBAAZA,IAAkCz0B,KAAKk0B,WAAWV,EAAMh7B,MAAO,SAChF,GAAIi8B,GAAyB,oBAAZA,GAAkCz0B,KAAKm0B,aAAaX,EAAMh7B,QAAQi8B,EAAW,SAC9FS,EAAWl1B,KAAKo0B,aAAac,EAAW1B,GACxCwB,EAAUh1B,KAAKo0B,aAAaY,EAAUxB,GAEtC,IA2BI2B,EACAC,EA5BAtzB,GAAI,EACR,OAAQmzB,EAAKI,WACT,IAAK,MACL,IAAK,KACGL,IAAYE,IAAYpzB,GAAI,GAChC,MACJ,IAAK,KACL,IAAK,MACGkzB,IAAYE,IAAYpzB,GAAI,GAChC,MACJ,IAAK,IACGkzB,EAAUE,IAAYpzB,GAAI,GAC9B,MACJ,IAAK,KACGkzB,GAAWE,IAAYpzB,GAAI,GAC/B,MACJ,IAAK,KACGkzB,GAAWE,IAAYpzB,GAAI,GAC/B,MACJ,IAAK,IACGkzB,EAAUE,IAAYpzB,GAAI,GAKtC,GAAKA,KAIDmzB,EAAKG,cACLD,EAAgBF,EAAKG,YACrBA,EAAYp1B,KAAK+zB,SAASoB,EAAgBlB,GACrCmB,IAHT,CASA,GAAsB,aAAlBH,EAAKK,WAAyB,CAC9B,IAAIh+B,EAAM29B,EAAKM,YACfv1B,KAAK20B,SAASj8B,EAAKpB,EAAM69B,EAAgBlB,EAAUO,EACtD,CAYD,GAXsB,cAAlBS,EAAKK,aACLR,EAAaz5B,KAAK45B,EAAKG,aACvBA,EAAYI,QAAO,EACnBJ,EAAYK,QAAO,GAGD,cAAlBR,EAAKK,aACLP,EAAW15B,KAAK45B,EAAKG,aACrBA,EAAYK,QAAO,EACnBL,EAAYI,QAAO,GAED,cAAlBP,EAAKK,WAA0B,CAC/B,IAAII,EAAcT,EAAKM,YAEvB,IADcv1B,KAAK+zB,SAASkB,EAAKM,YAAYtB,GAGzC,SAEJ,IAAI38B,EAAM0I,KAAKu0B,SAAS77B,EAAKg9B,EAAczB,EAAUO,GACrDx0B,KAAK20B,SAASj8B,EAAKpB,EAAM69B,EAAgBlB,EAAUO,EACtD,CACD,GAAwB,kBAApBS,EAAKK,WAAgC,CACrC,IAAII,EAAgBT,EAAKM,YAEzB,IADgBv1B,KAAK+zB,SAASkB,EAAKM,YAAatB,GAG5C,SAEJ,IAAI38B,EAAQ0I,KAAKu0B,SAAS77B,EAAMg9B,EAAezB,EAAWO,GACtDhB,EAAQxzB,KAAK+zB,SAASoB,EAAiBlB,GAC3CT,EAAMmC,eAAgB,EACtBnC,EAAMyB,EAAKW,iBAAmBt+B,CACjC,CAtCA,CAwCJ,CACD,MAAO,CAACoB,OAAKo8B,eAChB,EChNE,MAAMe,cAEX,WAAA/1B,CAAYg2B,GACV91B,KAAK81B,SAAWA,EAChB91B,KAAK+1B,YAAc,CAAE,CACtB,CAED,QAAAC,CAASt+B,EAAMu+B,GACb,OAAOA,EAAOrY,MAAKsY,IACjB,MAAOC,EAAIC,EAAIC,EAAQC,GAAWJ,EAAMK,SACxC,IAAKC,EAAIC,EAGT,OAFAD,EAAK9+B,EAAKg/B,IAAI,GACdD,EAAK/+B,EAAKg/B,IAAI,GACPF,GAAML,GAAMK,GAAML,EAAKE,GAAUI,GAAML,GAAMK,GAAML,EAAKE,CAAO,GAEzE,CACD,WAAAK,CAAYC,GACV,OAAO52B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAOq0B,GACrD,CACD,cAAAC,CAAeC,GACb,OAAO92B,KAAK81B,SAASG,OAAOrY,MAAKsY,GAASA,EAAM1zB,QAAUs0B,GAC3D,CACD,aAAAC,CAAcH,EAAQE,GACpB,MAAMp/B,EAAOsI,KAAK81B,SAASr2B,MAAMme,MAAKna,GAAKA,EAAElB,KAAOq0B,IACpD,IAAKl/B,EAAM,OAAO,EAElB,MAAMw+B,EAAQl2B,KAAK81B,SAASG,OAAOrY,MAAKsY,GAASA,EAAM1zB,QAAUs0B,GAAaZ,EAAMK,WACpF,IAAKL,EAAO,OAAO,EAEnB,MAAOC,EAAIC,EAAIC,EAAQC,GAAWJ,EAAMK,SAExC,IAAKC,EAAIC,EAGT,OAFAD,EAAK9+B,EAAKg/B,IAAI,GACdD,EAAK/+B,EAAKg/B,IAAI,GACPF,GAAML,GAAMK,GAAML,EAAKE,GAAUI,GAAML,GAAMK,GAAML,EAAKE,CAChE,CAID,eAAAU,GAEEh3B,KAAK81B,SAASr2B,MAAM3J,SAAQ4B,IACtBA,EAAKu/B,QACPv/B,EAAKu/B,OAAOnhC,SAAQmE,IAClBA,EAAMoZ,KAAO,IAAI,IAGjB3b,EAAKw/B,SACPx/B,EAAKw/B,QAAQphC,SAAQqhC,IACnBA,EAAOvK,MAAQ,EAAE,GAEpB,IAIH5sB,KAAK81B,SAASlJ,MAAM92B,SAAQud,IAC1B,MAAO+jB,EAAQC,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQ0S,EACzDokB,EAAWz3B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAO80B,IACxDK,EAAS13B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAOg1B,IAExDE,GAAYA,EAASP,SAAWO,EAASP,QAAQI,KAC9CG,EAASP,QAAQI,GAAU1K,QAC9B6K,EAASP,QAAQI,GAAU1K,MAAQ,IAErC6K,EAASP,QAAQI,GAAU1K,MAAMvxB,KAAK+7B,IAGpCM,GAAUA,EAAOT,QAAUS,EAAOT,OAAOO,KAC3CE,EAAOT,OAAOO,GAAQnkB,KAAO+jB,EAC9B,GAEJ,CAEF,8BAAAO,GAEG,IAAK,IAAIt/B,EAAI2H,KAAK81B,SAASr2B,MAAM1I,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CACxD,MAAMX,EAAOsI,KAAK81B,SAASr2B,MAAMpH,GACjC,GAAkB,kBAAdX,EAAKiJ,MAA0C,gBAAdjJ,EAAKiJ,KAAwB,CAChE,MAAMi3B,EAAe53B,KAAK81B,SAASlJ,MAAMhP,MAAKvK,GAAQA,EAAK,KAAO3b,EAAK6K,KACjEs1B,EAAe73B,KAAK81B,SAASlJ,MAAMhP,MAAKvK,GAAQA,EAAK,KAAO3b,EAAK6K,KAEvE,GAAIq1B,GAAgBC,EAAc,CAEhC,MAAMC,EAAU,CAAC93B,KAAK81B,SAASiC,aAAe,EAAGF,EAAa,GAAIA,EAAa,GAAID,EAAa,GAAIA,EAAa,GAAIA,EAAa,IAClI53B,KAAK81B,SAASiC,eACd/3B,KAAK81B,SAASlJ,MAAMvxB,KAAKy8B,GAEzB93B,KAAK81B,SAASlJ,MAAQ5sB,KAAK81B,SAASlJ,MAAMzuB,QAAOkV,GAAQA,EAAK,KAAOukB,EAAa,IAAMvkB,EAAK,KAAOwkB,EAAa,KAGjH73B,KAAK81B,SAASr2B,MAAMoB,OAAOxI,EAAG,EAC/B,CACF,CACF,CACF,CAMD,0BAAA2/B,CAA2BZ,GACzB,MAAMa,EAAYj4B,KAAK81B,SAASlJ,MAAMsL,WAAU7kB,GAAQA,EAAK,KAAO+jB,IACpE,IAAmB,IAAfa,EAAkB,OACtB,MAAME,EAAen4B,KAAK81B,SAASlJ,MAAMqL,IAClC1gC,EAAG8/B,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQw3B,EAGpDC,IAAuBp4B,KAAK81B,SAASuC,aACrCC,IAAet4B,KAAK81B,SAASiC,aAC7BQ,IAAev4B,KAAK81B,SAASiC,aAG7BS,EAAgB,CACpBj2B,GAAI61B,EACJz3B,KAAM,gBACN+1B,IAAK,CAAC,EAAG,GACTO,OAAO,CACL,CACIz+B,KAAQ,MACRmI,KAAQ,IACR0S,KAAQ,MAGhBrT,KAAK81B,SAASr2B,MAAMpE,KAAKm9B,GAEzB,MAAMC,EAAW,CAACH,EAAYjB,EAAYC,EAAUc,EAAoB,EAA2Cz3B,GAE7G+3B,EAAW,CAACH,EAAYH,EAAoB,EAAoCb,EAAUC,EAAQ72B,GAExGX,KAAK81B,SAASlJ,MAAMvxB,KAAKo9B,EAAUC,GAEnC14B,KAAK81B,SAASlJ,MAAM/rB,OAAOo3B,EAAW,EACvC,CAGD,0BAAAU,CAA2B7B,GAGzB,MAAM8B,EAAmB54B,KAAK81B,SAASr2B,MAAMtB,QAAOzG,GAAsB,gBAAdA,EAAKiJ,OAAwBzC,KAAIxG,GAAQA,EAAK6K,KAEpGs2B,EAAgB,GACtB,IAAIC,EAAe,GACnB,MAAMC,EAAW,GAEjB/4B,KAAK81B,SAASlJ,MAAM92B,SAAQud,IAC1B,MAAO+jB,EAAQC,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQ0S,EAE/D,GAAIulB,EAAiBxsB,SAASmrB,IAAav3B,KAAK+2B,cAAcM,EAAYP,GAAY,CAEpF+B,EAAcx9B,KAAK+7B,GACnB0B,EAAaz9B,KAAK,IAAIgY,IAEtB,MAAMykB,EAAU,CAAC93B,KAAK81B,SAASiC,aAAe,EAAG/3B,KAAK+1B,YAAYsB,GAAaC,EAAUC,EAAUC,EAAQ72B,GAC3Go4B,EAAS19B,KAAKy8B,GACd93B,KAAK81B,SAASiC,cACf,KAIH/3B,KAAK81B,SAASlJ,MAAQ5sB,KAAK81B,SAASlJ,MAAMzuB,QAAOkV,IAASwlB,EAAczsB,SAASiH,EAAK,MAGtFrT,KAAK81B,SAASlJ,MAAMvxB,QAAQ09B,GAM5BD,EAAahjC,SAAQkjC,IACnB,MAAOC,EAAe5B,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQq4B,EAEtE,IAAIE,EAOJ,GANAl5B,KAAK81B,SAASlJ,MAAM92B,SAAQud,IAC1B,MAAO9b,EAAG4hC,EAAgBC,EAAIC,EAAcC,EAAMC,GAAYlmB,EAClB,kBAAxCrT,KAAK22B,YAAYwC,GAAgBx4B,MAA0BX,KAAK+2B,cAAcsC,EAAavC,IACzFQ,IAAWgC,IAAMJ,EAAsB7lB,EAC5C,IAEC6lB,EAAuB,CAEzB,MAAMM,EAAiBx5B,KAAK+1B,YAAYmD,EAAsB,IAC9D,GAAIM,EAAgB,CAClB,MAAMC,IAAcz5B,KAAK81B,SAASiC,aAC5BD,EAAU,CAAC2B,EAAWpC,EAAYC,EAAUkC,EAAgBlC,EAAU32B,GAE5EX,KAAK81B,SAASlJ,MAAMvxB,KAAKy8B,GACzB93B,KAAKg4B,2BAA2ByB,EACjC,CACF,IAEJ,CAED,+BAAAC,CAAgC5C,EAAU6C,GAExC,MAAMC,EAAgB55B,KAAK62B,eAAeC,GAC1C,IAAK8C,EAAe,OAEpB,IAAIC,EAAY75B,KAAK81B,SAASuC,aAC1ByB,EAAY95B,KAAK81B,SAASiC,aAG9B,MAAMgC,EAAWhwB,KAAK0W,MAAM1W,KAAKC,UAAU4vB,IAC3CG,EAASv3B,MAAQm3B,EACjBI,EAASxD,SAAS,IAAMqD,EAAcrD,SAAS,GAAG,GAClDv2B,KAAK81B,SAASG,OAAO56B,KAAK0+B,GAE1B/5B,KAAK+1B,YAAc,CAAE,EAGrB/1B,KAAK81B,SAASr2B,MAAM3J,SAAQ4B,IAC1B,GAAIsI,KAAK+2B,cAAcr/B,EAAK6K,GAAIu0B,GAAY,CAC1C,MAAMkD,EAAUjwB,KAAK0W,MAAM1W,KAAKC,UAAUtS,IAC1CsiC,EAAQz3B,KAAOs3B,EACfG,EAAQtD,IAAI,IAAMkD,EAAcrD,SAAS,GAAG,GAC5Cv2B,KAAK+1B,YAAYr+B,EAAK6K,IAAMy3B,EAAQz3B,GACpCvC,KAAK81B,SAASr2B,MAAMpE,KAAK2+B,EAE1B,KAGHh6B,KAAK81B,SAASlJ,MAAM92B,SAAQud,IAC1B,MAAO+jB,EAAQC,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQ0S,EAE/D,GAAIrT,KAAK+1B,YAAYsB,IAAer3B,KAAK+1B,YAAYwB,GAAW,CAE9D,MAAMO,EAAU,GACZgC,EACF95B,KAAK+1B,YAAYsB,GACjBC,EACAt3B,KAAK+1B,YAAYwB,GACjBC,EACA72B,GAEFX,KAAK81B,SAASlJ,MAAMvxB,KAAKy8B,EAC1B,KAIH93B,KAAK81B,SAASlJ,MAAM92B,SAAQud,IAC1B,MAAO+jB,EAAQC,EAAYC,EAAUC,EAAUC,EAAQ72B,GAAQ0S,EACzDokB,EAAWz3B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAO80B,IAI9D,GAHer3B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAOg1B,IAGxDv3B,KAAK+2B,cAAcQ,EAAUT,KAAe92B,KAAK+2B,cAAcM,EAAYP,IAC3D,kBAAlBW,EAAS92B,MAA8C,gBAAlB82B,EAAS92B,KAAwB,CAEtE,MACMm3B,EAAU,GADIgC,EACQzC,EAAYC,EAAUt3B,KAAK+1B,YAAYwB,GAAWC,EAAQ72B,GACtFX,KAAK81B,SAASlJ,MAAMvxB,KAAKy8B,EAC1B,KAEH93B,KAAK81B,SAASiC,aAAe+B,EAC7B95B,KAAK81B,SAASuC,aAAewB,EAE7B75B,KAAK24B,2BAA2B7B,GAChC92B,KAAKi6B,cAAcnD,EAEpB,CAOD,aAAAmD,CAAcnD,GACZ,IAAIoD,EAASl6B,KAAK81B,SAASqE,MAAMC,KAAKF,SACtC,GAAKA,EAAL,CACA,IAAK,IAAI7hC,EAAI2H,KAAK81B,SAASr2B,MAAM1I,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CACxD,MAAMX,EAAOsI,KAAK81B,SAASr2B,MAAMpH,GACjC,GAAI2H,KAAK+2B,cAAcr/B,EAAK6K,GAAGu0B,GAAY,CACzC,IAAIuD,EAAaH,EAASxiC,EAAK6K,IAC/B,GAAI83B,EAAc,CAChB,IAAIC,EAAUt6B,KAAK+1B,YAAYr+B,EAAK6K,IAChC+3B,IACFJ,EAASI,GAAWvwB,KAAK0W,MAAM1W,KAAKC,UAAUqwB,IAGjD,CACF,CACF,CAEDr6B,KAAK81B,SAASqE,MAAMC,KAAKF,SAASA,CAfnB,CAgBhB,CACD,eAAAK,CAAgBzD,GACd,IAAK,IAAIz+B,EAAI2H,KAAK81B,SAASr2B,MAAM1I,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CACxD,MAAMX,EAAOsI,KAAK81B,SAASr2B,MAAMpH,GAC7B2H,KAAK+2B,cAAcr/B,EAAK6K,GAAGu0B,KAC7Bp/B,EAAKwI,KAAK,EAEb,CAEF,CACD,YAAAs6B,CAAa/F,EAAUgG,GACrB,IAAIvE,EAAMl2B,KAAK62B,eAAepC,EAAU,MACxC,GAAKyB,EAAL,CAGA,GAFAA,EAAM1zB,MAAMiyB,EAAU,MAEN,IAAZgG,EAIF,OAHAz6B,KAAKu6B,gBAAgB9F,EAAU,OAC/Bz0B,KAAK23B,sCACL33B,KAAKg3B,kBAGP,GAAIyD,EAAU,EACZ,IAAI,IAAIpiC,EAAE,EAAEA,EAAEoiC,EAAU,EAAEpiC,IACxB2H,KAAK05B,gCAAgCjF,EAAU,IAAIp8B,EAAE,IAAIo8B,EAAU,KAAKp8B,EAAE,GAAG,KAGjF2H,KAAK23B,iCACL33B,KAAKg3B,iBAfO,CAgBb,EClTI,MAAM0D,eAET,WAAA56B,CAAYg2B,GACV91B,KAAK81B,SAAWA,EAChB91B,KAAK26B,WAAW,IAAI9E,cAAcC,GAClC91B,KAAK60B,MAAM,IAAIf,eACVgC,EAASqE,MAAMC,OACpBp6B,KAAKkzB,SAAS4C,EAASqE,MAAMC,KAC7Bp6B,KAAKi0B,UAAU,GACXj0B,KAAKkzB,SAASE,OAASpzB,KAAKkzB,SAASE,MAAMlvB,UAC7ClE,KAAKi0B,WAAU,IAAInB,gBAAiBG,iBAAiBjzB,KAAKkzB,UAAUC,QAGvE,CAED,cAAAyH,CAAehE,EAAOp+B,GAClB,IAAIqiC,EAAY76B,KAAK81B,SAASqE,MAAMC,KAAKS,YACzC,IAAI,IAAIC,KAAOD,EACX,GAAIxf,SAASyf,KAAOlE,EAAQ,CACxB,IAAImE,EAAQF,EAAYC,GACxB,IAAI,IAAIziC,EAAE,EAAEA,EAAE0iC,EAAQhkC,OAAOsB,IAAK,CAE9B,GADW0iC,EAAQ1iC,GACRG,OAAOA,EAAM,OAAOH,CAClC,CACJ,CAEL,OAAQ,CACX,CACD,WAAA2iC,CAAYC,GACR,OAAOj7B,KAAK81B,SAASlJ,MAAMhP,MAAKsd,GAAWA,EAAQ,KAAOD,GAE7D,CACD,WAAAtE,CAAYC,GACR,OAAO52B,KAAK81B,SAASr2B,MAAMme,MAAKlmB,GAAQA,EAAK6K,KAAOq0B,GACrD,CAGH,cAAMuE,CAASzG,EAAcD,EAAU,GAAG7zB,EAAM,GAC5C,GAAGuI,OAAO8U,mBAAmB,CACzB,IAAIxf,EAAW0K,OAAO8U,mBAAmBmd,wCAEzC,aADgB38B,EAAS48B,eAAe3G,EAAcD,EAAU7zB,EAEnE,CACD,OAAO,IACV,CAMD,mBAAM06B,CAAcC,EAAUC,GAC1B,GAAGryB,OAAO8U,mBAAmB,CACzB,IAAIxf,EAAW0K,OAAO8U,mBAAmBmd,wCAEzC,aADgB38B,EAAS68B,cAAcC,EAAUC,EAEpD,CACD,OAAO,IACV,CAKD,aAAMC,CAAQzH,GACV,GAAG7qB,OAAO8U,mBAAmB,CACzB,IAAIxf,EAAW0K,OAAO8U,mBAAmBmd,wCAEzC,aADgB38B,EAASg9B,QAAQzH,EAEpC,CACD,OAAO,IACV,CAUD,kBAAMI,CAAa98B,EAAMk8B,EAAMiB,EAAU,GAAG7zB,EAAM,GAC9C,GAAiB,UAAb4yB,EAAM7yB,KAAgB,CAElB,GAAK8zB,EAGE,CACH,IAAIC,EAAclB,EAAMh7B,KAAK4Z,MAAM,KAAK,GACxC,aAAapS,KAAKm7B,SAASzG,EAAaD,EAAU7zB,EACrD,CAJG,aAAaZ,KAAKm7B,SAAS3H,EAAMh7B,KAK5C,CACD,GAAiB,gBAAbg7B,EAAM7yB,KACN,aAAaX,KAAKs7B,cAAc9H,EAAMh7B,MAE1C,GAAiB,SAAbg7B,EAAM7yB,KACN,aAAaX,KAAKy7B,QAAQjI,EAAMh7B,MAEpC,GAAiB,gBAAbg7B,EAAM7yB,KAAsB,CAC5B,IAAIse,EAAI,EACJuU,EAAMI,eACN3U,EAAIuU,EAAM5yB,OAEd,IACI46B,EADIlkC,EAAM8a,MAAM,KACJ6M,GAChB,aAAajf,KAAKs7B,cAAc,KAAKE,EACxC,CAED,MADe,UAAZhI,EAAM7yB,OAAmB6yB,EAAMc,MAAQh9B,IAAOk8B,EAAMc,KAAKh9B,GACpD0I,KAAK60B,MAAMT,aAAa98B,EAAMk8B,EACzC,CAOD,mBAAMkI,CAAclI,EAAMkC,EAAcp+B,GACpC,IAAK,IAAIs/B,KAAU52B,KAAKkzB,SAASgH,SAAU,CACvC,IAAIyB,EAAY37B,KAAKkzB,SAASgH,SAAStD,GAEvC,IAAK+E,IAAgBA,EAAY5kC,OAAQ,SACzC,IAAI6kC,EAAUvgB,SAASub,GACnBl/B,EAAKsI,KAAK26B,WAAWhE,YAAYiF,GACrC,IAAKlkC,EAED,SAMJ,IAAIy9B,EAAgB,GAChB0G,GAAa,EACbC,EAAW,KACf,GAAIpkC,EAAKw/B,SAAWx/B,EAAKw/B,QAAQngC,QAAUW,EAAKw/B,QAAQ,GAAG6E,OAAQ,CAC/D5G,EAAgBz9B,EAAKw/B,QAAQ,GAAG6E,OAAOvjC,KACvC,IAAIyiC,EAAOvjC,EAAKw/B,QAAQ,GAAGtK,MAAM,GAE7BoP,EADKh8B,KAAKg7B,YAAYC,GACJ,GACtBY,EAAY77B,KAAK46B,eAAeoB,EAAa7G,GACzC0G,GAAa,IACbC,EAAW97B,KAAK22B,YAAYqF,GAEnC,CACD,GAAItkC,EACA,IAAI,IAAIW,EAAE,EAAEA,EAAEsjC,EAAY5kC,OAAOsB,IAAK,CAClC,IAAI4jC,EAAQN,EAAYtjC,GAEpB4jC,GAAWA,EAAQC,YAAYxG,IAC/Bp+B,QAAY0I,KAAKo0B,aAAa98B,EAAMk8B,GAEpC97B,EAAKykC,eAAe9gB,SAAS4gB,EAAQG,UAAU9kC,EAC3CwkC,IACAA,EAAWK,eAAeN,GAAavkC,GAGlD,CAGR,CACJ,CAUD,wBAAM+kC,CAAmB7I,EAAMkC,EAAcoB,EAAUx/B,EAAMm9B,EAAU7zB,GACnE,IAAK,IAAIvI,EAAE,EAAEA,EAAE2H,KAAK81B,SAASr2B,MAAM1I,OAAOsB,IAAK,CAC3C,IAAIX,EAAKsI,KAAK81B,SAASr2B,MAAMpH,GAC7B,GAAI2H,KAAK26B,WAAW5D,cAAcr/B,EAAK6K,GAAGu0B,GAAY,CAClD,IAAI6E,EAAY37B,KAAKkzB,SAASgH,SAASxiC,EAAK6K,IAC5C,GAAGo5B,GAAeA,EAAY5kC,OAC1B,IAAK,IAAIsB,EAAI,EAAGA,EAAIsjC,EAAY5kC,OAAQsB,IAAK,CACzC,IAAI4jC,EAAUN,EAAYtjC,GACtB4jC,GAAWA,EAAQC,YAAcxG,IACjCp+B,QAAc0I,KAAKo0B,aAAa98B,EAAOk8B,EAAOiB,EAAW7zB,GACzDlJ,EAAKykC,eAAe9gB,SAAS4gB,EAAQG,UAAY9kC,EAExD,CAER,CACJ,CACJ,CAED,kBAAAglC,GAGI,IAAK,IAAIjkC,EAAI2H,KAAK81B,SAASr2B,MAAM1I,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CACtD,MAAMX,EAAOsI,KAAK81B,SAASr2B,MAAMpH,GACjC,IAAIkkC,GAAgB,EAKpB,GAJGv8B,KAAK81B,SAASqE,MAAMC,KAAKoC,cAAgBx8B,KAAK81B,SAASqE,MAAMC,KAAKoC,aAAazlC,SAC9EwlC,EAAiBv8B,KAAK81B,SAASqE,MAAMC,KAAKoC,aAAapwB,SAAS1U,EAAKiJ,OAGrE47B,GAA+B,kBAAd7kC,EAAKiJ,KAA0B,CAChD,MAAMi3B,EAAe53B,KAAK81B,SAASlJ,MAAMhP,MAAKvK,GAAQA,EAAK,KAAO3b,EAAK6K,KAGnEq1B,IAAc53B,KAAK81B,SAASlJ,MAAQ5sB,KAAK81B,SAASlJ,MAAMzuB,QAAOkV,GAAQA,EAAK,KAAOukB,EAAa,MAGpG53B,KAAK81B,SAASr2B,MAAMoB,OAAOxI,EAAG,EACjC,CACJ,CACJ,CAUD,eAAMokC,CAAU/jC,GACZ,GAAKsH,KAAKkzB,UACLlzB,KAAKkzB,SAASgH,SACnB,IAAK,IAAI1hC,KAAQE,EAAM,CACnB,IAAIpB,EAAMoB,EAAKF,GACf,GAAKoB,MAAM6N,QAAQnQ,GAGZ,CAEH,IAAIm9B,EAAUj8B,EACd,IAAI,IAAIH,EAAE,EAAEA,EAAEK,EAAK+7B,GAAW19B,OAAOsB,IAAK,CACtC,IAAIE,EAAQG,EAAK+7B,GAAWp8B,GAC5B,IAAI,IAAIqkC,KAAYnkC,EAAS,CACzB,IAAIy7B,EAAUS,EAAU,MAAMiI,EAC1BC,EAAelI,EAAU,IAAIp8B,EAAE,KAAKqkC,EACpCplC,EAAMiB,EAAQmkC,GACdlJ,EAAMxzB,KAAK60B,MAAMd,SAASC,EAAUh0B,KAAKi0B,iBACvCj0B,KAAK07B,cAAclI,EAAMmJ,EAAerlC,GAC9C,IAAIw/B,EAAUrC,EAAU,IAAIp8B,EAAE,UACxB2H,KAAKq8B,mBAAmB7I,EAAMQ,EAAU8C,EAAUx/B,EAAMm9B,EAAUp8B,EAC3E,CACJ,CACJ,KAlB0B,CACvB,IAAIm7B,EAAMxzB,KAAK60B,MAAMd,SAASv7B,EAAKwH,KAAKi0B,WACpCT,SAAaxzB,KAAK07B,cAAclI,EAAMA,EAAMh7B,KAAKlB,EACrE,CAgBS,CAEJ,CAQD,iBAAAslC,CAAkBlkC,GACd,IAAK,IAAIF,KAAQE,EAAM,CACnB,IAAIpB,EAAMoB,EAAKF,GACXg7B,EAAMxzB,KAAK60B,MAAMd,SAASv7B,EAAKwH,KAAKi0B,WACxC,GAAIT,GAASA,EAAMC,iBAAmBD,EAAME,iBAAkB,CAC1D,IAAIxd,EAAI5e,EAAM8a,MAAM,KACpB,IAAI,IAAI/Z,EAAE,EAAEA,EAAEm7B,EAAMC,gBAAgBp7B,IAAK,CACrC,IAAIkS,EAAE2L,EAAI7d,GAENwkC,EAAW,CAACrkC,KAAKA,EAAK,IAAIH,EAAEsI,KAAK6yB,EAAME,iBAAiBY,KAAKne,WAAW5L,IAE5EA,EAAEvK,KAAK60B,MAAMT,aAAc7pB,EAAEsyB,GAC7BnkC,EAAKF,EAAK,IAAIH,GAAGkS,CACpB,CACJ,CACJ,CACJ,EC1QE,MAAMuyB,iBAET,WAAAh9B,CAAYg2B,GACR91B,KAAK81B,SAASA,EACTA,EAASqE,MAAMC,OACpBp6B,KAAKkzB,SAAS4C,EAASqE,MAAMC,KAC7Bp6B,KAAKi0B,UAAU,GACXj0B,KAAKkzB,SAASE,OAASpzB,KAAKkzB,SAASE,MAAMlvB,UAC3ClE,KAAKi0B,WAAU,IAAInB,gBAAiBG,iBAAiBjzB,KAAKkzB,UAAUC,QAE3E,CAKD,aAAA4J,CAAcrkC,GACV,IAAIskC,EAAK,IAAInH,cAAc71B,KAAK81B,UAChC,IAAK,IAAIt9B,KAAQE,EAAM,CACnB,IAAIpB,EAAMoB,EAAKF,GACXoB,MAAM6N,QAAQnQ,IACd0lC,EAAKxC,aAAahiC,EAAKE,EAAKF,GAAMzB,OAEzC,CACJ,CAKD,eAAAkmC,CAAgBvkC,GACZ,IAAIm8B,EAAM,IAAIf,eAEd,GAAI9zB,KAAKkzB,SAAS2B,MAAlB,CACAA,EAAMD,QAAQl8B,EAAKsH,KAAKi0B,UAAUj0B,KAAKkzB,SAAS2B,MAAM,CAAE,EAAC,mBAEzD,IAAK,IAAIr8B,KAAQE,EAAM,CACnB,IAAIpB,EAAMoB,EAAKF,GACf,GAAIoB,MAAM6N,QAAQnQ,GACd,IAAI,IAAIe,EAAE,EAAEA,EAAEK,EAAKF,GAAMzB,OAAOsB,IAAK,CACjCw8B,EAAM,IAAIf,eACV,IAAIU,EAAS,CAAE,EACfA,EAASh8B,GAAMH,EACfw8B,EAAMD,QAAQl8B,EAAKsH,KAAKi0B,UAAUj0B,KAAKkzB,SAAS2B,MAAML,EAASh8B,EAClE,CAER,CAb+B,CAenC,CAMD,eAAMikC,CAAU/jC,GACZ,IAAIwkC,EAAG,IAAIxC,eAAe16B,KAAK81B,gBACzBoH,EAAGT,UAAU/jC,EAEtB,CACD,iBAAAkkC,CAAkBlkC,GACP,IAAIgiC,eAAe16B,KAAK81B,UAC5B8G,kBAAkBlkC,EACxB,CACD,aAAMk8B,CAAQl8B,GACVsH,KAAK+8B,cAAcrkC,GACnBsH,KAAKi9B,gBAAgBvkC,GACrBsH,KAAK48B,kBAAkBlkC,SACjBsH,KAAKy8B,UAAU/jC,EACxB,CAED,WAAAykC,GACI,MAAO,CACHxnB,OAAQ,cACRkC,eAAgB,OAChBulB,SAAS,EACTC,WAAW,CACP,CAAE18B,KAAK,OAAO+B,MAAM,SACpB,CAAE/B,KAAK,QAAQ+B,MAAM,SACrB,CAAE/B,KAAK,WAAW+B,MAAM,UAG5B+Y,KAAM,IACNC,MAAO,GAEd,ECtFL,IAAI0e,MCEmB,SAAUkD,QAY7B,IAAIC,UAAaD,OAAOC,UAAY,CAChCC,QAAS,GAETC,iBAAkB,GAElBC,kBAAmB,GACnBC,kBAAmB,GACnBC,iBAAkB,GAClBC,mBAAoB,GACpBC,WAAY,IACZC,eAAgB,GAChBC,sBAAuB,GACvBC,qBAAsB,GACtBC,iBAAkB,OAClBC,0BAA2B,OAC3BC,eAAgB,GAChBC,gBAAiB,OACjBC,kBAAmB,GACnBC,mBAAoB,OACpBC,qBAAsB,UACtBC,sBAAuB,OACvBC,mBAAoB,MACpBC,uBAAwB,OACxBC,qBAAsB,kBACtBC,mBAAoB,GAEpBC,eAAgB,OAChBC,qBAAsB,OACtBC,kBAAmB,OACnBC,4BAA6B,OAE7BC,WAAY,OACZC,iBAAkB,OAClBC,sBAAuB,OAEvBC,oBAAqB,IACrBC,iBAAkB,CAAC,IAAK,KACxBC,aAAc,CAAC,UAAW,MAAO,QAAS,QAG1CC,UAAW,EACXC,YAAa,EACbC,aAAc,EACdC,WAAY,EACZC,YAAa,EACbC,WAAY,EAGZC,MAAO,EACPC,OAAQ,EAERC,OAAQ,EACRC,QAAS,EAETC,WAAY,CAAC,SAAU,WAAY,QAAS,cAC5CC,kBAAkB,CAAC,OAAO,OAAO,OAAO,OAAO,QAC/CC,OAAQ,EACRC,SAAU,EACVC,MAAO,EACPC,WAAY,EAEZC,GAAI,EACJC,KAAM,EACNC,KAAM,EACNC,MAAO,EACPC,OAAQ,EAERC,kBAAmB,CAAC,WAAY,SAAU,UAC1CC,cAAe,EACfC,YAAa,EACbC,YAAa,EAEbC,aAAc,EACdC,SAAU,EACVC,kBAAmB,EACnBC,eAAgB,EAChBC,gBAAiB,WAEjBC,MAAO,KACPC,iBAAkB,GAElBC,OAAO,EACPC,kBAAkB,EAClBC,cAAc,EACdC,eAAe,EACfC,sBAAuB,CAAE,EACzBC,6BAA8B,CAAE,EAChCC,MAAO,CAAE,EACTC,QAAS,CAAE,EAEXC,iBAAkB,CAAE,EACpBC,sBAAsB,EAEtBC,2BAA2B,EAC3BC,2BAA2B,EAE3BC,6BAA6B,EAC7BC,kCAAmC,IAEnCC,gCAAgC,EAChCC,wBAAwB,EAExBC,4BAA4B,EAC5BC,uBAAuB,EACvBC,yBAAyB,EAEzBC,sBAAsB,EAGtBC,yBAA0B,CAAE,EAC5BC,0BAA2B,CAAE,EAC7BC,cAAe,GACfC,eAAgB,GAChBC,sBAAuB,GACvBC,uBAAwB,GAExBC,yBAAyB,EAEzBC,uBAAuB,EAEvBC,+BAA+B,EAE/BC,oCAAoC,EAEpCC,kCAAkC,EAElCC,qBAAsB,UAGtBC,+CAA+C,EAI/CC,WAAW,EASXC,iBAAkB,SAAS/iC,EAAMgjC,GAC7B,IAAKA,EAAWx/B,UACZ,KAAM,uEAEVw/B,EAAWhjC,KAAOA,EAEd48B,UAAUiE,MAId,MAAMoC,EAAYD,EAAWnrC,KAEvBk+B,EAAM/1B,EAAKkjC,YAAY,KAQ7B,IAAK,IAAIxrC,KAPTsrC,EAAWG,SAAWnjC,EAAK4tB,UAAU,EAAGmI,GAEnCiN,EAAWnhC,QACZmhC,EAAWnhC,MAAQohC,GAITG,WAAW5/B,UAChBw/B,EAAWx/B,UAAU9L,KACtBsrC,EAAWx/B,UAAU9L,GAAK0rC,WAAW5/B,UAAU9L,IAIvD,MAAM2rC,EAAOhkC,KAAK4hC,sBAAsBjhC,GAIxC,IAAKjL,OAAOyO,UAAUC,eAAeR,KAAM+/B,EAAWx/B,UAAW,WAC7DzO,OAAOmO,eAAe8/B,EAAWx/B,UAAW,QAAS,CACjD6Q,IAAK,SAASzK,GACV,OAAQA,GACJ,IAAK,iBACMvK,KAAKikC,OACZ,MACJ,IAAK,MACDjkC,KAAKikC,OAAS1G,UAAUiC,UACxB,MACJ,IAAK,QACDx/B,KAAKikC,OAAS1G,UAAUkC,YACxB,MACJ,IAAK,SACDz/B,KAAKikC,OAAS1G,UAAUmC,aACxB,MACJ,IAAK,OACD1/B,KAAKikC,OAAS1G,UAAUoC,WACxB,MACJ,QACI3/B,KAAKikC,OAAS15B,EAEzB,EACDvG,IAAK,WACD,OAAOhE,KAAKikC,MACf,EACDlgC,YAAY,EACZD,cAAc,IAKd6/B,EAAWO,sBACX,IAAK,IAAI7rC,KAAKsrC,EAAWO,qBAAsB,CAC3C,MAAMC,EAAMR,EAAWO,qBAAqB7rC,GACzC8rC,GAAOA,EAAIrkC,cAAgBqM,SAC1BnM,KAAK6hC,6BAA8BsC,EAAIC,eAAkBT,EAEhE,CAIT3jC,KAAK4hC,sBAAsBjhC,GAAQgjC,EAC/BA,EAAW7jC,YAAYtH,OACvBwH,KAAK8hC,MAAM8B,GAAaD,GAExBpG,UAAU8G,sBACV9G,UAAU8G,qBAAqB1jC,EAAMgjC,GAErCK,GAAQzG,UAAU+G,oBAClB/G,UAAU+G,mBAAmB3jC,EAAMgjC,EAAYK,GAI/CL,EAAWx/B,UAAUogC,iBASrBvkC,KAAK2iC,sBACL,IAAIgB,EAAWA,EAAWnhC,OAAS,UAE1C,EAODgiC,mBAAoB,SAAS7jC,GACzB,MAAMgjC,EACFhjC,EAAKb,cAAgBqM,OACfnM,KAAK4hC,sBAAsBjhC,GAC3BA,EACV,IAAKgjC,EACD,KAAM,wBAA0BhjC,SAE7BX,KAAK4hC,sBAAsB+B,EAAWhjC,MACzCgjC,EAAW7jC,YAAYtH,aAChBwH,KAAK8hC,MAAM6B,EAAW7jC,YAAYtH,KAEhD,EAQDisC,wBAAyB,SAAS9jC,EAAM+jC,EAAWC,GAC/CA,EAAMA,IAAO,EACb,MAMMC,GALFjkC,EAAKb,cAAgBqM,QACgB,cAArCnM,KAAK4hC,sBAAsBjhC,GACrBX,KAAK4hC,sBAAsBjhC,GAC3BA,GAEoBb,YAAYa,KAE1C,IAAIkkC,EAAW,GAEXA,EADqB,iBAAdH,EACIA,EAAUtyB,MAAM,KACpBsyB,GAAa1kC,KAAKggC,OAAS0E,GAAa1kC,KAAKigC,OACzC,CAAC,WAED,CAAC,KAGhB,IAAK,IAAI5nC,EAAI,EAAGA,EAAIwsC,EAAS9tC,SAAUsB,EAAG,CACtC,IAAIysC,EAAWD,EAASxsC,GACP,KAAbysC,IACAA,EAAW,KAEf,MAAMC,EAAaJ,EACb,4BACA,gCAC6Bza,IAA/BlqB,KAAK+kC,GAAYD,KACjB9kC,KAAK+kC,GAAYD,GAAY,CAAErlC,MAAO,KAErCO,KAAK+kC,GAAYD,GAAUrlC,MAAM2M,SAASw4B,IAC3C5kC,KAAK+kC,GAAYD,GAAUrlC,MAAMpE,KAAKupC,GAIrCD,EAMI3kC,KAAK+iC,eAAe32B,SAAS04B,EAASV,iBACvCpkC,KAAK+iC,eAAe1nC,KAAKypC,EAASV,eAClCpkC,KAAK+iC,eAAeiC,QAPnBhlC,KAAK8iC,cAAc12B,SAAS04B,EAASV,iBACtCpkC,KAAK8iC,cAAcznC,KAAKypC,EAASV,eACjCpkC,KAAK8iC,cAAckC,OAQ9B,CACJ,EAYDC,mBAAoB,SAChBzsC,EACA0sC,EACAC,EACAC,EACAC,GAKA,IAHA,IAAIC,EAAS1rC,MAAMsrC,EAAKnuC,QACpBwuC,EAAO,GACPC,EAAQjI,UAAUkI,kBAAkBP,GAC/B7sC,EAAI,EAAGA,EAAImtC,EAAMzuC,SAAUsB,EAChCktC,GACI,kBACAC,EAAMntC,GACN,MACC8sC,GAAeA,EAAY9sC,GACtB,IAAM8sC,EAAY9sC,GAAK,IACvB,KACN,OAERktC,GACI,yBACCH,EAAc,IAAMA,EAAc,IAAM,GACzC,OACAC,IACAE,GACI,qBAAuBx7B,KAAKC,UAAUq7B,GAAc,OAE5D,IAAIK,EAAWz8B,SAASs8B,GACxBG,EAASljC,MAAQhK,EAAK4Z,MAAM,KAAK1V,MACjCgpC,EAASC,KAAO,kBAAoBT,EAAK1sC,KACzCktC,EAASvhC,UAAUyhC,UAAY,WAC3B,IAAK,IAAIvtC,EAAI,EAAGA,EAAIitC,EAAOvuC,SAAUsB,EACjCitC,EAAOjtC,GAAK2H,KAAK6lC,aAAaxtC,GAElC,IAAIsL,EAAIuhC,EAAKz5B,MAAMzL,KAAMslC,GACzBtlC,KAAK8lC,cAAc,EAAGniC,EACtC,EACY3D,KAAK0jC,iBAAiBlrC,EAAMktC,EAC/B,EAKDK,qBAAsB,WAClB/lC,KAAK4hC,sBAAwB,GAC7B5hC,KAAK6hC,6BAA+B,GACpC7hC,KAAK8hC,MAAQ,GACb9hC,KAAKgiC,iBAAmB,EAC3B,EAQDgE,cAAe,SAASxtC,EAAM0sC,GAE1B,IAAK,IAAI7sC,KADT0rC,WAAW5/B,UAAU3L,GAAQ0sC,EACfllC,KAAK4hC,sBAAuB,CACtC,IAAIjhC,EAAOX,KAAK4hC,sBAAsBvpC,GAClCsI,EAAKwD,UAAU3L,KACfmI,EAAKwD,UAAU,IAAM3L,GAAQmI,EAAKwD,UAAU3L,IAEhDmI,EAAKwD,UAAU3L,GAAQ0sC,CAC1B,CACJ,EAUDe,WAAY,SAAStlC,EAAM6B,EAAOvJ,GAC9B,IAAI0qC,EAAa3jC,KAAK4hC,sBAAsBjhC,GAC5C,IAAKgjC,EAMD,OALIpG,UAAUiE,MAKP,KAGKmC,EAAWx/B,UAE3B3B,EAAQA,GAASmhC,EAAWnhC,OAAS7B,EAErC,IAAIjJ,EAAO,KAEX,GAAI6lC,UAAUkE,iBACV,IACI/pC,EAAO,IAAIisC,EAAWnhC,EACzB,CAAC,MAAO0jC,GAEL,OAAO,IACV,MAEDxuC,EAAO,IAAIisC,EAAWnhC,GA6B1B,GA1BA9K,EAAKiJ,KAAOA,GAEPjJ,EAAK8K,OAASA,IACf9K,EAAK8K,MAAQA,GAEZ9K,EAAK2tC,aACN3tC,EAAK2tC,WAAa,IAEjB3tC,EAAKyuC,kBACNzuC,EAAKyuC,gBAAkB,IAEtBzuC,EAAK0uC,QACN1uC,EAAK0uC,MAAQ,IAEZ1uC,EAAK2d,OACN3d,EAAK2d,KAAO3d,EAAK2uC,eAGhB3uC,EAAKg/B,MACNh/B,EAAKg/B,IAAM6G,UAAU+B,iBAAiB71B,UAErC/R,EAAKwI,OACNxI,EAAKwI,KAAOq9B,UAAU6C,QAItBnnC,EACA,IAAK,IAAIZ,KAAKY,EACVvB,EAAKW,GAAKY,EAAQZ,GAS1B,OAJKX,EAAK4uC,eACN5uC,EAAK4uC,gBAGF5uC,CACV,EAQD6uC,YAAa,SAAS5lC,GAClB,OAAOX,KAAK4hC,sBAAsBjhC,EACrC,EASD6lC,uBAAwB,SAAS1C,EAAU3lC,GACvC,IAAIwF,EAAI,GACR,IAAK,IAAItL,KAAK2H,KAAK4hC,sBAAuB,CACtC,IAAIjhC,EAAOX,KAAK4hC,sBAAsBvpC,GAClCsI,EAAKxC,QAAUA,IAIH,IAAZ2lC,EACqB,MAAjBnjC,EAAKmjC,UACLngC,EAAEtI,KAAKsF,GAEJA,EAAKmjC,UAAYA,GACxBngC,EAAEtI,KAAKsF,GAEd,CAMD,OAJIX,KAAKiiC,sBACLt+B,EAAEqhC,MAAK,SAAS9uC,EAAEC,GAAG,OAAOD,EAAEsM,MAAMikC,cAActwC,EAAEqM,MAAM,IAGvDmB,CACV,EAQD+iC,uBAAwB,SAAUvoC,GAC9B,IAAIwoC,EAAa,CAAE,GAAI,GACvB,IAAK,IAAItuC,KAAK2H,KAAK4hC,sBAAuB,CACtC,IAAIjhC,EAAOX,KAAK4hC,sBAAsBvpC,GACtC,GAAKsI,EAAKmjC,WAAanjC,EAAKimC,UAC5B,CACI,GAAGjmC,EAAKxC,QAAUA,EACd,SACJwoC,EAAWhmC,EAAKmjC,UAAY,CAC/B,CACJ,CACD,IAAIjpC,EAAS,GACb,IAAK,IAAIxC,KAAKsuC,EACV9rC,EAAOQ,KAAKhD,GAEhB,OAAO2H,KAAKiiC,qBAAuBpnC,EAAOmqC,OAASnqC,CACtD,EAGDgsC,YAAa,SAASC,GAIlB,IAHA,IAAIC,EAAMtwC,SAASuwC,qBAAqB,UAEpCC,EAAe,GACV5uC,EAAE,EAAGA,EAAI0uC,EAAIhwC,OAAQsB,IAC1B4uC,EAAa5rC,KAAK0rC,EAAI1uC,IAG1B,IAAI6uC,EAAazwC,SAASuwC,qBAAqB,QAAQ,GACvDF,EAAkBrwC,SAASsV,SAASpV,KAAOmwC,EAE3C,IAASzuC,EAAE,EAAGA,EAAI4uC,EAAalwC,OAAQsB,IAAK,CACxC,IAAI8I,EAAM8lC,EAAa5uC,GAAG8I,IAC1B,GACKA,GACDA,EAAImV,OAAO,EAAGwwB,EAAgB/vC,SAAW+vC,EAK7C,IACQvJ,UAAUiE,MAGd,IAAI2F,EAAgB1wC,SAASC,cAAc,UAC3CywC,EAAcxmC,KAAO,kBACrBwmC,EAAchmC,IAAMA,EACpB+lC,EAAWvvC,YAAYwvC,GACvBD,EAAWjvC,YAAYgvC,EAAa5uC,GACvC,CAAC,MAAO6tC,GACL,GAAI3I,UAAUmE,aACV,MAAMwE,EAEN3I,UAAUiE,KAGjB,CACJ,CAEGjE,UAAUiE,KAGjB,EAGD4F,YAAa,SAASvwC,EAAKY,GACvB,GAAW,MAAPZ,EACA,OAAO,KAEX,IAAI8M,EAAIoG,KAAK0W,MAAM1W,KAAKC,UAAUnT,IAClC,IAAKY,EACD,OAAOkM,EAGX,IAAK,IAAItL,KAAKsL,EACVlM,EAAOY,GAAKsL,EAAEtL,GAElB,OAAOZ,CACV,EAKD4vC,OAAQ,WACJ,OAAQ,CAAC,MAAM,KAAK,KAAK,KAAK,MAAMzlC,QAAQ,UAAS1L,IAAIA,EAAgB,GAAdoW,KAAK8C,UAAalZ,EAAE,GAAGiQ,SAAS,KAC9F,EASDmhC,kBAAmB,SAASC,EAAQC,GAGhC,GAFY,IAARD,GAAuB,MAATA,IAAcA,EAAS,GAC7B,IAARC,GAAuB,MAATA,IAAcA,EAAS,IAEpCD,IACGC,GACDD,GAAUC,GACTD,GAAUhK,UAAUyC,OAASwH,GAAUjK,UAAU0C,OAErD,OAAO,EAUX,GANAsH,EAASp7B,OAAOo7B,GAChBC,EAASr7B,OAAOq7B,GAChBD,EAASA,EAAOnD,cAChBoD,EAASA,EAAOpD,eAGY,GAAxBmD,EAAO/pC,QAAQ,OAAsC,GAAxBgqC,EAAOhqC,QAAQ,KAC5C,OAAO+pC,GAAUC,EAMrB,IAFA,IAAIC,EAAoBF,EAAOn1B,MAAM,KACjCs1B,EAAoBF,EAAOp1B,MAAM,KAC5B/Z,EAAI,EAAGA,EAAIovC,EAAkB1wC,SAAUsB,EAC5C,IAAK,IAAIsvC,EAAI,EAAGA,EAAID,EAAkB3wC,SAAU4wC,EAC5C,GAAG3nC,KAAKsnC,kBAAkBG,EAAkBpvC,GAAGqvC,EAAkBC,IAE7D,OAAO,EAKnB,OAAO,CACV,EAUDC,uBAAwB,SAASC,EAAWnkB,EAAahrB,GACrDsH,KAAKgiC,iBAAiBte,EAAY0gB,eAAiB,CAC/CzjC,KAAMknC,EACNlC,KAAMjiB,EACNhrB,KAAMA,EAEb,EAWDovC,UAAW,SAAUtxC,EAAKmK,EAAMonC,EAAaC,GAEzC,IAAIxxC,EACA,OAAO,KAGX,GADAmK,EAAOA,GAAQ,OACXnK,EAAIsJ,cAAgBqM,OAKpB,MAHwB,QAApB3V,EAAI8f,OAAO,EAAG,IAAgBinB,UAAU+D,QACxC9qC,EAAM+mC,UAAU+D,MAAQ9qC,EAAI8f,OAAO9f,EAAIgH,QAAQ,KAAO,IAEnDuE,MAAMvL,GACRyF,MAAK,SAAS+F,GACX,IAAIA,EAASC,GACT,MAAM,IAAIhH,MAAM,kBACpB,MAAW,eAAR0F,EACQqB,EAASotB,cACJ,QAARzuB,GAA0B,UAARA,EACfqB,EAASvJ,OACJ,QAARkI,EACGqB,EAASE,OACJ,QAARvB,EACGqB,EAASimC,YADf,CAE7B,IACqBhsC,MAAK,SAASvD,GACRqvC,GACCA,EAAYrvC,EACxC,IACqB6U,OAAM,SAASqE,GAETo2B,GACCA,EAASp2B,EACrC,IAEiB,GAAIpb,EAAIsJ,cAAgBooC,MAAQ1xC,EAAIsJ,cAAgBqL,KACzD,CACI,IAAI+kB,EAAS,IAAIC,WASjB,GARAD,EAAOtF,OAAS,SAASnuB,GAErB,IAAI8N,EAAI9N,EAAEhF,OAAOoD,OACL,QAAR8F,IACA4J,EAAIR,KAAK0W,MAAMlW,IAChBw9B,GACCA,EAAYx9B,EACnB,EACU,eAAR5J,EACC,OAAOuvB,EAAOiY,kBAAkB3xC,GAC/B,GAAW,QAARmK,GAA0B,QAARA,EACtB,OAAOuvB,EAAOkY,WAAW5xC,GACxB,GAAW,QAARmK,EACJ,OAAOuvB,EAAOmY,mBAAmB7xC,EACxC,CACD,OAAO,IACV,GAmCL,SAAS8xC,OAAO9kC,GACR+5B,UAAUiE,MAGdxhC,KAAKuoC,oBAAsB,KAC3BvoC,KAAKlD,QAED0G,GACAxD,KAAKwoC,UAAUhlC,EAEtB,CAo/CD,SAASilC,MAAMlmC,EAAI5B,EAAM+nC,EAAWC,EAAaC,EAAWC,GACxD7oC,KAAKuC,GAAKA,EACVvC,KAAKW,KAAOA,EACZX,KAAK0oC,UAAYA,EACjB1oC,KAAK2oC,YAAcA,EACnB3oC,KAAK4oC,UAAYA,EACjB5oC,KAAK6oC,YAAcA,EAEnB7oC,KAAK8oC,MAAQ,KACb9oC,KAAK+oC,KAAO,IAAIC,aAAa,EAChC,CA8FD,SAASjF,WAAWvhC,GAChBxC,KAAKipC,MAAMzmC,EACd,CA27ED,SAAS0mC,YAAY1mC,GACjBxC,KAAKipC,MAAMzmC,EACd,CAuGD,SAAS2mC,aAAa5wC,EAAS6wC,GAC3BppC,KAAKqpC,OAAS,IAAIL,aAAa,CAAC,EAAG,IACnChpC,KAAKspC,MAAQ,EACbtpC,KAAKupC,UAAY,GACjBvpC,KAAKwpC,UAAY,GACjBxpC,KAAKypC,SAAW,KAChBzpC,KAAK0pC,SAAU,EACf1pC,KAAK2pC,WAAa,CAAC,EAAG,GACtB3pC,KAAKzH,QAAU,KACfyH,KAAK4pC,aAAe,IAAIZ,aAAa,GAEjCzwC,IACAyH,KAAKzH,QAAUA,EACV6wC,GACDppC,KAAK6pC,WAAWtxC,GAG3B,CAuND,SAASuxC,aAAajf,EAAQkf,EAAO9wC,GACjC+G,KAAK/G,QAAUA,EAAUA,GAAW,CAAA,EAIpC+G,KAAKgqC,iBAAmBF,aAAaG,yBAEjCpf,GAAUA,EAAO/qB,cAAgBqM,SACjC0e,EAASp0B,SAAS+O,cAAcqlB,IAGpC7qB,KAAKkqC,GAAK,IAAIf,aACdnpC,KAAKmqC,mBAAoB,EAEzBnqC,KAAKoqC,gBAAuB7M,UAAUa,eAAiB,WACvDp+B,KAAKqqC,gBACD,UAAY9M,UAAUe,kBAAoB,WAC9Ct+B,KAAKsqC,iBAAmB/M,UAAUW,iBAClCl+B,KAAKuqC,mBAAqBhN,UAAU2B,WACpCl/B,KAAKwqC,yBAA2B,CAC5BC,UAAW,OACXC,SAAU,OACVC,WAAY,OACZC,UAAW,QAEf5qC,KAAK6qC,gCAAkC,CAItC,EACD7qC,KAAK8qC,mCAAqC,CAIlD,EAEQ9qC,KAAK+qC,oBAAqB,EAC1B/qC,KAAKgrC,eAAgB,EACrBhrC,KAAKirC,aAAe,EACpBjrC,KAAKkrC,iBAAkB,EACvBlrC,KAAKmrC,kBAAmB,EACxBnrC,KAAKorC,uBAAyB,OAE9BprC,KAAKqrC,WAAY,EACjBrrC,KAAKsrC,sBAAuB,EAC5BtrC,KAAKurC,WAAY,EACjBvrC,KAAKwrC,WAAY,EACjBxrC,KAAKyrC,kBAAmB,EACxBzrC,KAAK0rC,iBAAkB,EACvB1rC,KAAK2rC,mBAAoB,EACzB3rC,KAAK4rC,cAAe,EACpB5rC,KAAK6rC,iBAAkB,EACvB7rC,KAAK8rC,uBAAwB,EAC7B9rC,KAAK+rC,eAAgB,EAErB/rC,KAAKgsC,WAAY,EACjBhsC,KAAKisC,mBAAqB,KAE1BjsC,KAAK7B,OAAS,KAEd6B,KAAKksC,iCAAkC,EACvClsC,KAAKmsC,0BAA2B,EAChCnsC,KAAKosC,gBAAiB,EACtBpsC,KAAKqsC,sBAAuB,EAC5BrsC,KAAKssC,4BAA6B,EAClCtsC,KAAKusC,2BAA4B,EACjCvsC,KAAKwsC,2BAA4B,EACjCxsC,KAAKysC,0BAA2B,EAChCzsC,KAAK0sC,wBAAyB,EAC9B1sC,KAAK2sC,wBAAyB,EAC9B3sC,KAAK4sC,sBAAuB,EAC5B5sC,KAAK6sC,qBAAsB,EAE3B7sC,KAAK8sC,kBAAoBvP,UAAUyD,YAEnChhC,KAAK+sC,MAAQ,CAAC,EAAG,GACjB/sC,KAAKgtC,YAAc,CAAC,EAAG,GACvBhtC,KAAKitC,aAAejtC,KAAKgtC,YAGzBhtC,KAAKktC,YAAc,KACnBltC,KAAKmtC,qBAAuB,KAG5BntC,KAAKotC,QAAU,KACfptC,KAAKqtC,iBAAmB,KACxBrtC,KAAKstC,iBAAmB,KACxBttC,KAAKutC,cAAgB,KACrBvtC,KAAKwtC,kBAAoB,KACzBxtC,KAAKytC,YAAc,KACnBztC,KAAK0tC,kBAAoB,KACzB1tC,KAAK2tC,mBAAqB,KAC1B3tC,KAAK4tC,eAAiB,KACtB5tC,KAAK6tC,cAAgB,KAErB7tC,KAAK8tC,kBAAoB,EACzB9tC,KAAK+tC,aAAe,EAEpB/tC,KAAKguC,aAAe,KACpBhuC,KAAKiuC,YAAc,KACnBjuC,KAAKkuC,iBAAmB,KACxBluC,KAAKmuC,oBAAsB,CAAC,EAAG,GAC/BnuC,KAAK4pC,aAAe5pC,KAAKkqC,GAAGN,aAC5B5pC,KAAKouC,cAAgB,GAErBpuC,KAAKquC,SAAWp1C,EAAQo1C,UAAY,KAGhCtE,GACAA,EAAMuE,aAAatuC,MAGvBA,KAAKuuC,UAAU1jB,EAAO5xB,EAAQmwC,aAC9BppC,KAAKlD,QAEA7D,EAAQu1C,aACTxuC,KAAKyuC,iBAGTzuC,KAAK0uC,WAAaz1C,EAAQy1C,UAC7B,CA3gJyB,oBAAfC,YACPpR,UAAUqR,QAAUD,YAAYE,IAAI7jC,KAAK2jC,aACnB,oBAARG,MAAuBA,KAAKD,IAC1CtR,UAAUqR,QAAUE,KAAKD,IAAI7jC,KAAK8jC,MACT,oBAAX//B,QACdwuB,UAAUqR,QAAU,WAChB,IAAIrrC,EAAIwL,QAAQggC,SAChB,MAAc,KAAPxrC,EAAE,GAAoB,KAAPA,EAAE,EACpC,EAEQg6B,UAAUqR,QAAU,WAChB,OAAO,IAAIE,MAAOF,SAC9B,EA+BItR,OAAOgL,OAAS/K,UAAU+K,OAASA,OAGnCA,OAAO0G,gBAAkB,CAAC,SAAU,SAAU,WAG9C1G,OAAOnkC,UAAU8qC,kBAAoB,WACjC,OAAOjvC,KAAKgvC,iBAAmB1G,OAAO0G,eAC9C,EAEI1G,OAAO4G,eAAiB,EACxB5G,OAAO6G,eAAiB,EAOxB7G,OAAOnkC,UAAUrH,MAAQ,WAUrB,GATAkD,KAAK8U,OACL9U,KAAKyW,OAAS6xB,OAAO4G,eAErBlvC,KAAKq4B,aAAe,EACpBr4B,KAAK+3B,aAAe,EAEpB/3B,KAAKovC,UAAY,EAGbpvC,KAAKqvC,OACL,IAAK,IAAIh3C,EAAI,EAAGA,EAAI2H,KAAKqvC,OAAOt4C,SAAUsB,EAAG,CACzC,IAAIX,EAAOsI,KAAKqvC,OAAOh3C,GACnBX,EAAK43C,WACL53C,EAAK43C,WAEZ,CAILtvC,KAAKqvC,OAAS,GACdrvC,KAAKuvC,aAAe,GACpBvvC,KAAKwvC,gBAAkB,GACvBxvC,KAAKyvC,kBAAoB,KAGzBzvC,KAAK0vC,QAAU,GAGf1vC,KAAK4sB,MAAQ,GAGb5sB,KAAK2vC,UAAY,EAGjB3vC,KAAK4vC,OAAS,GACd5vC,KAAK6vC,KAAO,GACZ7vC,KAAKm6B,MAAQ,GAGbn6B,KAAK8vC,WAAa,EAClB9vC,KAAK+vC,YAAc,EACnB/vC,KAAKgwC,UAAY,EACjBhwC,KAAKiwC,gBAAkB,IACvBjwC,KAAKkwC,aAAe,IACpBlwC,KAAKmwC,iBAAmB,EACxBnwC,KAAKowC,UAAY,EAEjBpwC,KAAKqwC,cAAe,EAEpBrwC,KAAKswC,gBAAkB,GACvBtwC,KAAKuwC,gBAAkB,GACvBvwC,KAAKwwC,qBAAuB,GAG5BxwC,KAAKi3B,OAAS,GACdj3B,KAAKk3B,QAAU,GAGfl3B,KAAKywC,SAELzwC,KAAK0wC,mBAAmB,QAChC,EAQIpI,OAAOnkC,UAAUmqC,aAAe,SAASqC,GACrC,GAAIA,EAAY7wC,aAAegqC,aAC3B,KAAM,+CAEN6G,EAAY5G,OAAS4G,EAAY5G,OAAS/pC,MAC1C2wC,EAAY5G,MAAM6G,aAAaD,GAGnCA,EAAY5G,MAAQ/pC,KAEfA,KAAKuoC,sBACNvoC,KAAKuoC,oBAAsB,IAE/BvoC,KAAKuoC,oBAAoBltC,KAAKs1C,EACtC,EAOIrI,OAAOnkC,UAAUysC,aAAe,SAASD,GACrC,GAAK3wC,KAAKuoC,oBAAV,CAIA,IAAI7R,EAAM12B,KAAKuoC,oBAAoB/qC,QAAQmzC,IAC/B,GAARja,IAGJia,EAAY5G,MAAQ,KACpB/pC,KAAKuoC,oBAAoB1nC,OAAO61B,EAAK,GAPpC,CAQT,EAQI4R,OAAOnkC,UAAU0Q,MAAQ,SAASg8B,GAC9B,GAAI7wC,KAAKyW,QAAU6xB,OAAO6G,eAA1B,CAGAnvC,KAAKyW,OAAS6xB,OAAO6G,eAEjBnvC,KAAK8wC,aACL9wC,KAAK8wC,cAGT9wC,KAAK+wC,oBAAoB,WAGzB/wC,KAAKowC,UAAY7S,UAAUqR,UAC3B5uC,KAAKmwC,iBAAmBnwC,KAAKowC,UAE7B,IAAI5xB,EAAOxe,KAGX,GAAiB,IAJjB6wC,EAAWA,GAAY,IAIgB,oBAAV1nC,QAAyBA,OAAO6nC,sBAAwB,CACjF,SAASC,KAC2B,GAA5BzyB,EAAK0yB,qBAGT/nC,OAAO6nC,sBAAsBC,GAC1BzyB,EAAK2yB,cACJ3yB,EAAK2yB,eACT3yB,EAAK4yB,QAAQ,GAAI5yB,EAAK6xB,cACnB7xB,EAAK6yB,aACJ7yB,EAAK6yB,cACZ,CACDrxC,KAAKkxC,oBAAsB,EAC3BD,GACZ,MACYjxC,KAAKkxC,mBAAqBjjC,aAAY,WAE/BuQ,EAAK2yB,cACJ3yB,EAAK2yB,eACT3yB,EAAK4yB,QAAQ,GAAI5yB,EAAK6xB,cACnB7xB,EAAK6yB,aACJ7yB,EAAK6yB,aACZ,GAAER,EAtCN,CAwCT,EAOIvI,OAAOnkC,UAAU2Q,KAAO,WAChB9U,KAAKyW,QAAU6xB,OAAO4G,iBAI1BlvC,KAAKyW,OAAS6xB,OAAO4G,eAEjBlvC,KAAKsxC,aACLtxC,KAAKsxC,cAGsB,MAA3BtxC,KAAKkxC,sBAC2B,GAA5BlxC,KAAKkxC,oBACLhjC,cAAclO,KAAKkxC,oBAEvBlxC,KAAKkxC,mBAAqB,MAG9BlxC,KAAK+wC,oBAAoB,UACjC,EAUIzI,OAAOnkC,UAAUitC,QAAU,SAASx1B,EAAK21B,EAAqBC,GAC1D51B,EAAMA,GAAO,EAEb,IAAI/G,EAAQ0oB,UAAUqR,UACtB5uC,KAAK8vC,WAAa,MAASj7B,EAAQ7U,KAAKowC,WAExC,IAAI3wC,EAAQO,KAAKyvC,kBACXzvC,KAAKyvC,kBACLzvC,KAAKqvC,OACX,GAAK5vC,EAAL,CAMA,GAFA+xC,EAAQA,GAAS/xC,EAAM1I,OAEnBw6C,EAAqB,CAErB,IAAK,IAAIl5C,EAAI,EAAGA,EAAIujB,EAAKvjB,IAAK,CAC1B,IAAK,IAAIsvC,EAAI,EAAGA,EAAI6J,IAAS7J,EAAG,EACxBjwC,EAAO+H,EAAMkoC,IACRznC,MAAQq9B,UAAU6C,QAAU1oC,EAAKkuC,WAEtCluC,EAAK+5C,WAEZ,CAEDzxC,KAAKgwC,WAAahwC,KAAKiwC,gBACnBjwC,KAAK0xC,eACL1xC,KAAK0xC,eAEZ,CAEG1xC,KAAK2xC,gBACL3xC,KAAK2xC,gBAErB,MACY,IAEI,IAASt5C,EAAI,EAAGA,EAAIujB,EAAKvjB,IAAK,CAC1B,IAASsvC,EAAI,EAAGA,EAAI6J,IAAS7J,EAAG,CAC5B,IAAIjwC,KAAO+H,EAAMkoC,IACRznC,MAAQq9B,UAAU6C,QAAU1oC,EAAKkuC,WACtCluC,EAAKkuC,WAEZ,CAED5lC,KAAKgwC,WAAahwC,KAAKiwC,gBACnBjwC,KAAK0xC,eACL1xC,KAAK0xC,eAEZ,CAEG1xC,KAAK2xC,gBACL3xC,KAAK2xC,iBAET3xC,KAAK4xC,qBAAsB,CAC9B,CAAC,MAAO1L,GAEL,GADAlmC,KAAK4xC,qBAAsB,EACvBrU,UAAUmE,aACV,MAAMwE,EAEN3I,UAAUiE,MAGdxhC,KAAK8U,MACR,CAGL,IAAI+5B,EAAMtR,UAAUqR,UAChBiD,EAAUhD,EAAMh6B,EACL,GAAXg9B,IACAA,EAAU,GAEd7xC,KAAK8xC,eAAiB,KAAQD,EAC9B7xC,KAAK8vC,YAAc,KAAQ+B,EAC3B7xC,KAAK2vC,WAAa,EAClB3vC,KAAKkwC,aAA+C,MAA/BrB,EAAM7uC,KAAKmwC,kBAChCnwC,KAAKmwC,iBAAmBtB,EACxB7uC,KAAKswC,gBAAkB,GACvBtwC,KAAKuwC,gBAAkB,GACvBvwC,KAAKwwC,qBAAuB,EArE3B,CAsET,EAOIlI,OAAOnkC,UAAU4tC,qBAAuB,WACpC/xC,KAAKwvC,gBAAkBxvC,KAAKgyC,uBAAsB,GAClDhyC,KAAKyvC,kBAAoB,GACzB,IAAK,IAAIp3C,EAAI,EAAGA,EAAI2H,KAAKwvC,gBAAgBz4C,SAAUsB,EAC3C2H,KAAKwvC,gBAAgBn3C,GAAGutC,WACxB5lC,KAAKyvC,kBAAkBp0C,KAAK2E,KAAKwvC,gBAAgBn3C,GAGjE,EAGIiwC,OAAOnkC,UAAU6tC,sBAAwB,SACrCC,EACAC,GASA,IAPA,IAAIC,EAAI,GACJC,EAAI,GACJC,EAAI,CAAA,EACJC,EAAgB,CAAA,EAChBC,EAAkB,CAAA,EAGbl6C,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EAAG,CAChD,IAAIX,EAAOsI,KAAKqvC,OAAOh3C,GACvB,IAAI45C,GAAmBv6C,EAAKkuC,UAA5B,CAIAyM,EAAE36C,EAAK6K,IAAM7K,EAEb,IAAIkkB,EAAM,EACV,GAAIlkB,EAAKu/B,OACL,IAAK,IAAI0Q,EAAI,EAAG6K,EAAK96C,EAAKu/B,OAAOlgC,OAAQ4wC,EAAI6K,EAAI7K,IACzCjwC,EAAKu/B,OAAO0Q,IAA6B,MAAvBjwC,EAAKu/B,OAAO0Q,GAAGt0B,OACjCuI,GAAO,GAKR,GAAPA,GAEAw2B,EAAE/2C,KAAK3D,GACHw6C,IACAx6C,EAAK+6C,OAAS,KAIdP,IACAx6C,EAAK+6C,OAAS,GAElBF,EAAgB76C,EAAK6K,IAAMqZ,EAxB9B,CA0BJ,CAED,KACoB,GAAZw2B,EAAEr7C,QADG,CAMLW,EAAO06C,EAAEM,QAIb,GAHAP,EAAE92C,KAAK3D,UACA26C,EAAE36C,EAAK6K,IAET7K,EAAKw/B,QAKV,IAAS7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,OAAQsB,IAAK,CAC1C,IAAI8+B,EAASz/B,EAAKw/B,QAAQ7+B,GAE1B,GACc,MAAV8+B,GACgB,MAAhBA,EAAOvK,OACgB,GAAvBuK,EAAOvK,MAAM71B,OAMjB,IAAS4wC,EAAI,EAAGA,EAAIxQ,EAAOvK,MAAM71B,OAAQ4wC,IAAK,CAC1C,IAAIgL,EAAUxb,EAAOvK,MAAM+a,GACvBt0B,EAAOrT,KAAK4sB,MAAM+lB,GACtB,GAAKt/B,IAKDi/B,EAAcj/B,EAAK9Q,IAAvB,CAIA,IAAIqwC,EAAc5yC,KAAK22B,YAAYtjB,EAAKu1B,WACrB,MAAfgK,GAMAV,KACEU,EAAYH,QACVG,EAAYH,QAAU/6C,EAAK+6C,UAE/BG,EAAYH,OAAS/6C,EAAK+6C,OAAS,GAGvCH,EAAcj/B,EAAK9Q,KAAM,EACzBgwC,EAAgBK,EAAYrwC,KAAO,EACI,GAAnCgwC,EAAgBK,EAAYrwC,KAC5B6vC,EAAE/2C,KAAKu3C,IAfPN,EAAcj/B,EAAK9Q,KAAM,CAJ5B,CAqBJ,CACJ,CACJ,CAGD,IAAK,IAAIlK,KAAKg6C,EACVF,EAAE92C,KAAKg3C,EAAEh6C,IAGT85C,EAAEp7C,QAAUiJ,KAAKqvC,OAAOt4C,QAAUwmC,UAAUiE,MAOhD,IAHI9hC,EAAIyyC,EAAEp7C,OAGDsB,EAAI,EAAGA,EAAIqH,IAAKrH,EACrB85C,EAAE95C,GAAGw6C,MAAQx6C,EAIjB85C,EAAIA,EAAEnN,MAAK,SAAS8N,EAAGC,GACnB,IAAIC,EAAKF,EAAEhzC,YAAYmzC,UAAYH,EAAEG,UAAY,EAC7CC,EAAKH,EAAEjzC,YAAYmzC,UAAYF,EAAEE,UAAY,EACjD,OAAID,GAAME,EAECJ,EAAED,MAAQE,EAAEF,MAEhBG,EAAKE,CACxB,IAGQ,IAAS76C,EAAI,EAAGA,EAAIqH,IAAKrH,EACrB85C,EAAE95C,GAAGw6C,MAAQx6C,EAGjB,OAAO85C,CACf,EAQI7J,OAAOnkC,UAAUgvC,aAAe,SAASz7C,GAKrC,IAJA,IAAI07C,EAAY,GACZC,EAAU,CAAC37C,GACX47C,EAAU,CAAA,EAEPD,EAAQt8C,QAAQ,CACnB,IAAI45B,EAAU0iB,EAAQX,QACtB,GAAK/hB,EAAQsG,OAAb,CAGKqc,EAAQ3iB,EAAQpuB,KAAOouB,GAAWj5B,IACnC47C,EAAQ3iB,EAAQpuB,KAAM,EACtB6wC,EAAU/3C,KAAKs1B,IAGnB,IAAK,IAAIt4B,EAAI,EAAGA,EAAIs4B,EAAQsG,OAAOlgC,SAAUsB,EAAG,CAC5C,IAAI4B,EAAQ02B,EAAQ4iB,aAAal7C,GAC7B4B,IAAsC,GAA7Bm5C,EAAU51C,QAAQvD,IAC3Bo5C,EAAQh4C,KAAKpB,EAEpB,CAXA,CAYJ,CAKD,OAHAm5C,EAAUpO,MAAK,SAAS9uC,EAAGC,GACvB,OAAOD,EAAE28C,MAAQ18C,EAAE08C,KAC/B,IACeO,CACf,EAMI9K,OAAOnkC,UAAUqvC,QAAU,SAAUC,EAAQC,GACzCD,EAASA,GAAU,IAEnB,MAAMh0C,EAAQO,KAAKgyC,uBAAsB,GAAO,GAC1C2B,EAAU,GAChB,IAAK,IAAIt7C,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAAG,CACnC,MAAMX,EAAO+H,EAAMpH,GACbu7C,EAAMl8C,EAAK+6C,QAAU,EACtBkB,EAAQC,KACTD,EAAQC,GAAO,IAEnBD,EAAQC,GAAKv4C,KAAK3D,EACrB,CAED,IAAI4T,EAAImoC,EAER,IAAK,IAAIp7C,EAAI,EAAGA,EAAIs7C,EAAQ58C,SAAUsB,EAAG,CACrC,MAAMw7C,EAASF,EAAQt7C,GACvB,IAAKw7C,EACD,SAEJ,IAAIC,EAAW,IACXtoC,EAAIioC,EAASlW,UAAUG,kBAC3B,IAAK,IAAIiK,EAAI,EAAGA,EAAIkM,EAAO98C,SAAU4wC,EAAG,CACpC,MAAMjwC,EAAOm8C,EAAOlM,GACpBjwC,EAAKg/B,IAAI,GAAMgd,GAAUnW,UAAU8D,gBAAmB71B,EAAIF,EAC1D5T,EAAKg/B,IAAI,GAAMgd,GAAUnW,UAAU8D,gBAAmB/1B,EAAIE,EAC1D,MAAMuoC,EAAkBL,GAAUnW,UAAU8D,gBAAmB,EAAI,EAC/D3pC,EAAK2d,KAAK0+B,GAAkBD,IAC5BA,EAAWp8C,EAAK2d,KAAK0+B,IAEzB,MAAMC,EAAmBN,GAAUnW,UAAU8D,gBAAmB,EAAI,EACpE71B,GAAK9T,EAAK2d,KAAK2+B,GAAmBP,EAASlW,UAAUG,iBACxD,CACDpyB,GAAKwoC,EAAWL,CACnB,CAEDzzC,KAAKi0C,gBAAe,GAAM,EAClC,EAOI3L,OAAOnkC,UAAUyqC,QAAU,WACvB,OAAO5uC,KAAK8vC,UACpB,EAQIxH,OAAOnkC,UAAU+vC,aAAe,WAC5B,OAAOl0C,KAAKgwC,SACpB,EASI1H,OAAOnkC,UAAUgwC,eAAiB,WAC9B,OAAOn0C,KAAKkwC,YACpB,EAQI5H,OAAOnkC,UAAU4sC,oBAAsB,SAASqD,EAAW9O,EAAQplC,GAC/DA,EAAOA,GAAQq9B,UAAU6C,OAEzB,IAAI3gC,EAAQO,KAAKwvC,gBAAkBxvC,KAAKwvC,gBAAkBxvC,KAAKqvC,OAC/D,GAAK5vC,EAIL,IAAK,IAAIkoC,EAAI,EAAGjoC,EAAID,EAAM1I,OAAQ4wC,EAAIjoC,IAAKioC,EAAG,CAC1C,IAAIjwC,EAAO+H,EAAMkoC,GAGbjwC,EAAKoI,cAAgBy9B,UAAU8W,UAClB,aAAbD,EAQC18C,EAAK08C,IAAc18C,EAAKwI,MAAQA,SAGtBgqB,IAAXob,EACA5tC,EAAK08C,KACE9O,GAAUA,EAAOxlC,cAAgBlG,MACxClC,EAAK08C,GAAW3oC,MAAM/T,EAAM4tC,GAE5B5tC,EAAK08C,GAAW9O,IAdZ5tC,EAAKwI,MAAQA,GACbxI,EAAKq5C,oBAAoBqD,EAAW9O,EAAQplC,EAevD,CACT,EAEIooC,OAAOnkC,UAAUusC,mBAAqB,SAAS4D,EAAQhP,GACnD,GAAKtlC,KAAKuoC,oBAIV,IAAK,IAAIlwC,EAAI,EAAGA,EAAI2H,KAAKuoC,oBAAoBxxC,SAAUsB,EAAG,CACtD,IAAIkF,EAAIyC,KAAKuoC,oBAAoBlwC,GAC7BkF,EAAE+2C,IACF/2C,EAAE+2C,GAAQ7oC,MAAMlO,EAAG+nC,EAE1B,CACT,EAQIgD,OAAOnkC,UAAUtH,IAAM,SAASnF,EAAM68C,GAClC,GAAK78C,EAAL,CAKA,GAAIA,EAAKoI,cAAgBopC,YAMrB,OALAlpC,KAAK0vC,QAAQr0C,KAAK3D,GAClBsI,KAAKi0C,gBAAe,GACpBj0C,KAAKywC,SACL/4C,EAAKqyC,MAAQ/pC,UACbA,KAAKovC,WAiBT,IAZgB,GAAZ13C,EAAK6K,IAA0C,MAA9BvC,KAAKuvC,aAAa73C,EAAK6K,MAIpCg7B,UAAUkG,UACV/rC,EAAK6K,GAAKg7B,UAAU8J,SAGpB3vC,EAAK6K,KAAOvC,KAAKq4B,cAIrBr4B,KAAKqvC,OAAOt4C,QAAUwmC,UAAU8B,oBAChC,KAAM,oDAyCV,OArCI9B,UAAUkG,UACK,MAAX/rC,EAAK6K,KAA0B,GAAZ7K,EAAK6K,KACxB7K,EAAK6K,GAAKg7B,UAAU8J,UAGT,MAAX3vC,EAAK6K,KAA0B,GAAZ7K,EAAK6K,GACxB7K,EAAK6K,KAAOvC,KAAKq4B,aACVr4B,KAAKq4B,aAAe3gC,EAAK6K,KAChCvC,KAAKq4B,aAAe3gC,EAAK6K,IAIjC7K,EAAKqyC,MAAQ/pC,KACbA,KAAKovC,WAELpvC,KAAKqvC,OAAOh0C,KAAK3D,GACjBsI,KAAKuvC,aAAa73C,EAAK6K,IAAM7K,EAEzBA,EAAK88C,SACL98C,EAAK88C,QAAQx0C,MAGbA,KAAK4vC,OAAO7D,eACZr0C,EAAK+8C,cAGJF,GACDv0C,KAAK+xC,uBAGL/xC,KAAK00C,aACL10C,KAAK00C,YAAYh9C,GAGrBsI,KAAKi0C,gBAAe,GACpBj0C,KAAKywC,SAEE/4C,CAnEN,CAoET,EAQI4wC,OAAOnkC,UAAUyE,OAAS,SAASlR,GAC/B,GAAIA,EAAKoI,cAAgBy9B,UAAU2L,YAAa,CAC5C,IAAItoC,EAAQZ,KAAK0vC,QAAQlyC,QAAQ9F,GAQjC,OAPc,GAAVkJ,GACAZ,KAAK0vC,QAAQ7uC,OAAOD,EAAO,GAE/BlJ,EAAKqyC,MAAQ,KACb/pC,KAAKovC,WACLpvC,KAAKi0C,gBAAe,GAAM,QAC1Bj0C,KAAKywC,QAER,CAED,GAAkC,MAA9BzwC,KAAKuvC,aAAa73C,EAAK6K,MAIvB7K,EAAKi9C,cAAT,CAOA,GAHA30C,KAAK40C,eAGDl9C,EAAKu/B,OACL,IAAK,IAAI5+B,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,OAAQsB,IAAK,CAExB,OADbihC,EAAO5hC,EAAKu/B,OAAO5+B,IACdgb,MACL3b,EAAKm9C,gBAAgBx8C,EAE5B,CAIL,GAAIX,EAAKw/B,QACL,IAAS7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,OAAQsB,IAAK,CAC1C,IAAIihC,EACc,OADdA,EAAO5hC,EAAKw/B,QAAQ7+B,IACfu0B,OAAiB0M,EAAK1M,MAAM71B,QACjCW,EAAKo9C,iBAAiBz8C,EAE7B,CAcL,GARIX,EAAK43C,WACL53C,EAAK43C,YAGT53C,EAAKqyC,MAAQ,KACb/pC,KAAKovC,WAGDpvC,KAAKuoC,oBACL,IAASlwC,EAAI,EAAGA,EAAI2H,KAAKuoC,oBAAoBxxC,SAAUsB,EAAG,CACtD,IAAIwyB,EAAS7qB,KAAKuoC,oBAAoBlwC,GAClCwyB,EAAOkqB,eAAer9C,EAAK6K,YACpBsoB,EAAOkqB,eAAer9C,EAAK6K,IAElCsoB,EAAOmqB,cAAgBt9C,IACvBmzB,EAAOmqB,aAAe,KAE7B,CAIL,IAAIte,EAAM12B,KAAKqvC,OAAO7xC,QAAQ9F,IAClB,GAARg/B,GACA12B,KAAKqvC,OAAOxuC,OAAO61B,EAAK,UAErB12B,KAAKuvC,aAAa73C,EAAK6K,IAE1BvC,KAAKi1C,eACLj1C,KAAKi1C,cAAcv9C,GAIvBsI,KAAK0wC,mBAAmB,eAExB1wC,KAAKi0C,gBAAe,GAAM,GAC1Bj0C,KAAKk1C,cACLl1C,KAAKywC,SAELzwC,KAAK+xC,sBAjEJ,CAkET,EAQIzJ,OAAOnkC,UAAUwyB,YAAc,SAASp0B,GACpC,OAAU,MAANA,EACO,KAEJvC,KAAKuvC,aAAahtC,EACjC,EAQI+lC,OAAOnkC,UAAUgxC,iBAAmB,SAASC,EAAav6C,IACtDA,EAASA,GAAU,IACZ9D,OAAS,EAChB,IAAK,IAAIsB,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EACzC2H,KAAKqvC,OAAOh3C,GAAGyH,cAAgBs1C,GAC/Bv6C,EAAOQ,KAAK2E,KAAKqvC,OAAOh3C,IAGhC,OAAOwC,CACf,EAQIytC,OAAOnkC,UAAUkxC,gBAAkB,SAAS10C,EAAM9F,GAC1C8F,EAAOA,EAAKyjC,eAChBvpC,EAASA,GAAU,IACZ9D,OAAS,EAChB,IAAK,IAAIsB,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EACzC2H,KAAKqvC,OAAOh3C,GAAGsI,KAAKyjC,eAAiBzjC,GACrC9F,EAAOQ,KAAK2E,KAAKqvC,OAAOh3C,IAGhC,OAAOwC,CACf,EAQIytC,OAAOnkC,UAAUmxC,gBAAkB,SAAS9yC,GACxC,IAAK,IAAInK,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EAC7C,GAAI2H,KAAKqvC,OAAOh3C,GAAGmK,OAASA,EACxB,OAAOxC,KAAKqvC,OAAOh3C,GAG3B,OAAO,IACf,EAQIiwC,OAAOnkC,UAAUoxC,iBAAmB,SAAS/yC,GAEzC,IADA,IAAI3H,EAAS,GACJxC,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EACzC2H,KAAKqvC,OAAOh3C,GAAGmK,OAASA,GACxB3H,EAAOQ,KAAK2E,KAAKqvC,OAAOh3C,IAGhC,OAAOwC,CACf,EAUIytC,OAAOnkC,UAAUqxC,aAAe,SAASlqC,EAAGE,EAAGiqC,EAAYhC,GAGvD,IADA,IACSp7C,GAFTo9C,EAAaA,GAAcz1C,KAAKqvC,QAERt4C,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CAC7C,IAAIoL,EAAIgyC,EAAWp9C,GACfq9C,EAAajyC,EAAE3D,YAAY61C,YAAcpY,UAAU2D,SACvD,GAAIz9B,EAAEmyC,cAActqC,EAAGE,EAAGioC,EAAQiC,GAK9B,OAAOjyC,CAGd,CACD,OAbW,IAcnB,EASI6kC,OAAOnkC,UAAU0xC,cAAgB,SAASvqC,EAAGE,GACzC,IAAK,IAAInT,EAAI2H,KAAK0vC,QAAQ34C,OAAS,EAAGsB,GAAK,EAAGA,IAAK,CAC/C,IAAI0S,EAAI/K,KAAK0vC,QAAQr3C,GACrB,GAAI0S,EAAE6qC,cAActqC,EAAGE,EAAG,GAAG,GACzB,OAAOT,CAEd,CACD,OAAO,IACf,EAOIu9B,OAAOnkC,UAAU2xC,eAAiB,WAE9B,IAAK,IAAIz9C,EAAI,EAAGA,EAAI2H,KAAKqvC,OAAOt4C,OAAQsB,IAAK,CACzC,IAAIX,EAAOsI,KAAKqvC,OAAOh3C,GACnB09C,EAAOxY,UAAUqE,sBAAsBlqC,EAAKiJ,MAChD,GAAIjJ,EAAKoI,aAAei2C,EAAxB,CAIA,IAAIC,EAAUzY,UAAU0I,WAAWvuC,EAAKiJ,MAExCX,KAAKqvC,OAAOh3C,GAAK29C,EACjBA,EAAQxN,UAAU9wC,EAAKu+C,aACvBD,EAAQjM,MAAQ/pC,KAChBA,KAAKuvC,aAAayG,EAAQzzC,IAAMyzC,EAC5Bt+C,EAAKu/B,SACL+e,EAAQ/e,OAASv/B,EAAKu/B,OAAOxtB,UAE7B/R,EAAKw/B,UACL8e,EAAQ9e,QAAUx/B,EAAKw/B,QAAQztB,SAZlC,CAcJ,CACDzJ,KAAK+xC,sBACb,EAIIzJ,OAAOnkC,UAAU0E,SAAW,SAASyrC,EAAQ4B,EAAOj9C,GAChD+G,KAAKm2C,aAAen2C,KAAKm1C,iBACrB5X,UAAU6Y,WACVp2C,KAAKm2C,cAET,IAAK,IAAI99C,EAAI,EAAGA,EAAI2H,KAAKm2C,aAAap/C,SAAUsB,EAAG,CAC/C,IAAIX,EAAOsI,KAAKm2C,aAAa99C,GAC7B,GAAIX,EAAK2tC,WAAW7sC,MAAQ87C,EAA5B,CAIA58C,EAAK2+C,SAAS/B,EAAQ4B,EAAOj9C,GAC7B,KAHC,CAIJ,CACT,EAEIqvC,OAAOnkC,UAAUmyC,QAAU,SAAShC,EAAQ4B,GACpCl2C,KAAKu2C,WACLv2C,KAAKu2C,UAAUjC,EAAQ4B,EAEnC,EASI5N,OAAOnkC,UAAUqyC,SAAW,SAASh+C,EAAMmI,EAAMrJ,GACjC0I,KAAKi3B,OAAOz+B,KAMxBwH,KAAK40C,eACL50C,KAAKi3B,OAAOz+B,GAAQ,CAAEA,KAAMA,EAAMmI,KAAMA,EAAMrJ,MAAOA,GACrD0I,KAAKovC,WACLpvC,KAAKk1C,cAEDl1C,KAAKy2C,cACLz2C,KAAKy2C,aAAaj+C,EAAMmI,GAGxBX,KAAK02C,uBACL12C,KAAK02C,wBAEjB,EAQIpO,OAAOnkC,UAAUwyC,aAAe,SAASn+C,EAAME,GAC3C,IAAIuB,EAAQ+F,KAAKi3B,OAAOz+B,GACnByB,IAGLA,EAAM3C,MAAQoB,EACtB,EAQI4vC,OAAOnkC,UAAU0hC,aAAe,SAASrtC,GACrC,IAAIyB,EAAQ+F,KAAKi3B,OAAOz+B,GACxB,OAAKyB,EAGEA,EAAM3C,MAFF,IAGnB,EAQIgxC,OAAOnkC,UAAUyyC,YAAc,SAASC,EAAUr+C,GAC9C,GAAIA,GAAQq+C,EAAZ,CAIA,IAAK72C,KAAKi3B,OAAO4f,GACb,OAAO,EAGX,GAAI72C,KAAKi3B,OAAOz+B,GAEZ,OAAO,EAGXwH,KAAKi3B,OAAOz+B,GAAQwH,KAAKi3B,OAAO4f,UACzB72C,KAAKi3B,OAAO4f,GACnB72C,KAAKovC,WAEDpvC,KAAK82C,gBACL92C,KAAK82C,eAAeD,EAAUr+C,GAG9BwH,KAAK02C,uBACL12C,KAAK02C,uBApBR,CAsBT,EAQIpO,OAAOnkC,UAAU4yC,gBAAkB,SAASv+C,EAAMmI,GAC9C,IAAKX,KAAKi3B,OAAOz+B,GACb,OAAO,EAIPwH,KAAKi3B,OAAOz+B,GAAMmI,MAClBwL,OAAOnM,KAAKi3B,OAAOz+B,GAAMmI,MAAMyjC,eAC/Bj4B,OAAOxL,GAAMyjC,gBAKjBpkC,KAAKi3B,OAAOz+B,GAAMmI,KAAOA,EACzBX,KAAKovC,WACDpvC,KAAKg3C,oBACLh3C,KAAKg3C,mBAAmBx+C,EAAMmI,GAE1C,EAQI2nC,OAAOnkC,UAAU8yC,YAAc,SAASz+C,GACpC,QAAKwH,KAAKi3B,OAAOz+B,YAIVwH,KAAKi3B,OAAOz+B,GACnBwH,KAAKovC,WAEDpvC,KAAKk3C,gBACLl3C,KAAKk3C,eAAe1+C,GAGpBwH,KAAK02C,uBACL12C,KAAK02C,yBAEF,EACf,EASIpO,OAAOnkC,UAAUgzC,UAAY,SAAS3+C,EAAMmI,EAAMrJ,GAC9C0I,KAAKk3B,QAAQ1+B,GAAQ,CAAEA,KAAMA,EAAMmI,KAAMA,EAAMrJ,MAAOA,GACtD0I,KAAKovC,WAEDpvC,KAAKo3C,eACLp3C,KAAKo3C,cAAc5+C,EAAMmI,GAGzBX,KAAK02C,uBACL12C,KAAK02C,uBAEjB,EAQIpO,OAAOnkC,UAAU2hC,cAAgB,SAASttC,EAAMlB,GAC5C,IAAI6/B,EAASn3B,KAAKk3B,QAAQ1+B,GACrB2+B,IAGLA,EAAO7/B,MAAQA,EACvB,EAQIgxC,OAAOnkC,UAAUkzC,cAAgB,SAAS7+C,GACtC,IAAI2+B,EAASn3B,KAAKk3B,QAAQ1+B,GAC1B,OAAK2+B,EAGEA,EAAO7/B,MAFH,IAGnB,EAQIgxC,OAAOnkC,UAAUmzC,aAAe,SAAST,EAAUr+C,GAC/C,QAAKwH,KAAKk3B,QAAQ2f,MAId72C,KAAKk3B,QAAQ1+B,KAKjBwH,KAAKk3B,QAAQ1+B,GAAQwH,KAAKk3B,QAAQ2f,UAC3B72C,KAAKk3B,QAAQ2f,GACpB72C,KAAKovC,WAEDpvC,KAAKu3C,iBACLv3C,KAAKu3C,gBAAgBV,EAAUr+C,QAG/BwH,KAAK02C,uBACL12C,KAAK02C,0BAEjB,EAQIpO,OAAOnkC,UAAUqzC,iBAAmB,SAASh/C,EAAMmI,GAC/C,IAAKX,KAAKk3B,QAAQ1+B,GACd,OAAO,EAIPwH,KAAKk3B,QAAQ1+B,GAAMmI,MACnBwL,OAAOnM,KAAKk3B,QAAQ1+B,GAAMmI,MAAMyjC,eAChCj4B,OAAOxL,GAAMyjC,gBAKjBpkC,KAAKk3B,QAAQ1+B,GAAMmI,KAAOA,EAC1BX,KAAKovC,WACDpvC,KAAKy3C,qBACLz3C,KAAKy3C,oBAAoBj/C,EAAMmI,GAE3C,EAOI2nC,OAAOnkC,UAAUuzC,aAAe,SAASl/C,GACrC,QAAKwH,KAAKk3B,QAAQ1+B,YAGXwH,KAAKk3B,QAAQ1+B,GACpBwH,KAAKovC,WAEDpvC,KAAK23C,iBACL33C,KAAK23C,gBAAgBn/C,GAGrBwH,KAAK02C,uBACL12C,KAAK02C,yBAEF,EACf,EAEIpO,OAAOnkC,UAAUyzC,aAAe,SAASp/C,EAAMlB,GAE3C,IADA,IAAImI,EAAQO,KAAKu1C,iBAAiB/8C,GACzBH,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAChCoH,EAAMpH,GAAGk+C,UAAUj/C,EAE/B,EAEIgxC,OAAOnkC,UAAU0zC,YAAc,SAASr/C,EAAM0sC,GAE1C,IADA,IAAIzlC,EAAQO,KAAKu1C,iBAAiB/8C,GACzBH,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAChCoH,EAAMpH,GAAGy/C,WAAW5S,EAEhC,EAGIoD,OAAOnkC,UAAUywC,aAAe,SAASmD,GACjC/3C,KAAK4tC,gBACL5tC,KAAK4tC,eAAe5tC,KAAK+3C,GAE7B/3C,KAAK0wC,mBAAmB,iBAAkB1wC,KAClD,EAGIsoC,OAAOnkC,UAAU+wC,YAAc,SAAS6C,GAChC/3C,KAAK6tC,eACL7tC,KAAK6tC,cAAc7tC,KAAK+3C,GAE5B/3C,KAAK0wC,mBAAmB,gBAAiB1wC,KACjD,EAEIsoC,OAAOnkC,UAAU6zC,iBAAmB,SAAStgD,EAAMugD,GAC/Cj4C,KAAK+xC,uBACD/xC,KAAKk4C,oBACLl4C,KAAKk4C,mBAAmBxgD,GAE5BsI,KAAKovC,WACLpvC,KAAK0wC,mBAAmB,qBAChC,EAOIpI,OAAOnkC,UAAUg0C,OAAS,WACtB,IAAKn4C,KAAKuoC,oBACN,OAAO,EAGX,IAAK,IAAIlwC,EAAI,EAAGA,EAAI2H,KAAKuoC,oBAAoBxxC,SAAUsB,EAAG,CAEtD,GADQ2H,KAAKuoC,oBAAoBlwC,GAC3BkzC,UACF,OAAO,CAEd,CACD,OAAO,CACf,EAMIjD,OAAOnkC,UAAUi0C,oBAAsB,WACnC,IAAK,IAAI//C,KAAK2H,KAAK4sB,MAAO,CACtB,IAAIqrB,EAAYj4C,KAAK4sB,MAAMv0B,GACtB4/C,IAGDA,EAAUI,aACVJ,EAAUI,WAAa,GAE9B,CACT,EAGI/P,OAAOnkC,UAAUssC,OAAS,WAClBlT,UAAUiE,MAGdxhC,KAAK0wC,mBAAmB,WAAY,EAAC,GAAM,IACvC1wC,KAAKs4C,WACLt4C,KAAKs4C,UAAUt4C,KAE3B,EAEIsoC,OAAOnkC,UAAU8vC,eAAiB,SAASsE,EAAIC,GAC3Cx4C,KAAK0wC,mBAAmB,WAAY,CAAC6H,EAAIC,GACjD,EAOIlQ,OAAOnkC,UAAUs0C,WAAa,SAAS9F,GACnC,IAAIt/B,EAAOrT,KAAK4sB,MAAM+lB,GACtB,GAAKt/B,EAAL,CAGA,IAAI3b,EAAOsI,KAAK22B,YAAYtjB,EAAKu1B,WAC7BlxC,GACAA,EAAKm9C,gBAAgBxhC,EAAKw1B,YAH7B,CAKT,EAQIP,OAAOnkC,UAAU8xC,UAAY,WAEzB,IADA,IAAIyC,EAAa,GACRrgD,EAAI,EAAGqH,EAAIM,KAAKqvC,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EAC7CqgD,EAAWr9C,KAAK2E,KAAKqvC,OAAOh3C,GAAG49C,aAInC,IAAIrpB,EAAQ,GACZ,IAAK,IAAIv0B,KAAK2H,KAAK4sB,MAAO,CAEtB,IAAIvZ,EAAOrT,KAAK4sB,MAAMv0B,GACtB,IAAKgb,EAAK4iC,UAAW,CAKjB,IAAI0C,EAAQ,IAAIlQ,MAChB,IAAK,IAAId,KAAKt0B,EACVslC,EAAMhR,GAAKt0B,EAAKs0B,GAEpB3nC,KAAK4sB,MAAMv0B,GAAKsgD,EAChBtlC,EAAOslC,CACV,CAED/rB,EAAMvxB,KAAKgY,EAAK4iC,YACnB,CAED,IAAI2C,EAAc,GAClB,IAASvgD,EAAI,EAAGA,EAAI2H,KAAK0vC,QAAQ34C,SAAUsB,EACvCugD,EAAYv9C,KAAK2E,KAAK0vC,QAAQr3C,GAAG49C,aAGrC,IAAIv9C,EAAO,CACP2/B,aAAcr4B,KAAKq4B,aACnBN,aAAc/3B,KAAK+3B,aACnBt4B,MAAOi5C,EACP9rB,MAAOA,EACPqJ,OAAQ2iB,EACRhJ,OAAQ5vC,KAAK4vC,OACbzV,MAAOn6B,KAAKm6B,MACZjqB,QAASqtB,UAAUC,SAMvB,OAHGx9B,KAAK64C,aACJ74C,KAAK64C,YAAYngD,GAEdA,CACf,EAQI4vC,OAAOnkC,UAAUqkC,UAAY,SAAS9vC,EAAMogD,GACxC,GAAKpgD,EAAL,CAIKogD,GACD94C,KAAKlD,QAGT,IAAI2C,EAAQ/G,EAAK+G,MAGjB,GAAI/G,EAAKk0B,OAASl0B,EAAKk0B,MAAM9sB,cAAgBlG,MAAO,CAEhD,IADA,IAAIgzB,EAAQ,GACHv0B,EAAI,EAAGA,EAAIK,EAAKk0B,MAAM71B,SAAUsB,EAAG,CACxC,IAAI0gD,EAAYrgD,EAAKk0B,MAAMv0B,GAC3B,GAAI0gD,EAAJ,CAKA,IAAI1lC,EAAO,IAAIo1B,MACfp1B,EAAKm1B,UAAUuQ,GACfnsB,EAAMvZ,EAAK9Q,IAAM8Q,CAHhB,CAIJ,CACD3a,EAAKk0B,MAAQA,CAChB,CAGD,IAAK,IAAIv0B,KAAKK,EACF,SAALL,GAAqB,UAALA,IAEnB2H,KAAK3H,GAAKK,EAAKL,IAGnB,IAAIuZ,GAAQ,EAIZ,GADA5R,KAAKqvC,OAAS,GACV5vC,EAAO,CACEpH,EAAI,EAAb,IAAK,IAAWqH,EAAID,EAAM1I,OAAQsB,EAAIqH,IAAKrH,EAAG,CAC1C,IAAI2gD,EAASv5C,EAAMpH,IACfX,EAAO6lC,UAAU0I,WAAW+S,EAAOr4C,KAAMq4C,EAAOx2C,UAE5C+6B,UAAUiE,OAOd9pC,EAAO,IAAIqsC,YACNkV,mBAAqBD,EAC1BthD,EAAKwhD,YAAa,EAClBtnC,GAAQ,GAIZla,EAAK6K,GAAKy2C,EAAOz2C,GACjBvC,KAAKnD,IAAInF,GAAM,EAClB,CAGD,IAASW,EAAI,EAAGqH,EAAID,EAAM1I,OAAQsB,EAAIqH,IAAKrH,EAAG,CAC1C,IACIX,EADAshD,EAASv5C,EAAMpH,IACfX,EAAOsI,KAAK22B,YAAYqiB,EAAOz2C,MAE/B7K,EAAK8wC,UAAUwQ,EAEtB,CACJ,CAID,GADAh5C,KAAK0vC,QAAQ34C,OAAS,EAClB2B,EAAKu9B,OACL,IAAS59B,EAAI,EAAGA,EAAIK,EAAKu9B,OAAOl/B,SAAUsB,EAAG,CACzC,IAAI69B,EAAQ,IAAIqH,UAAU2L,YAC1BhT,EAAMsS,UAAU9vC,EAAKu9B,OAAO59B,IAC5B2H,KAAKnD,IAAIq5B,EACZ,CAYL,OATAl2B,KAAK+xC,uBAEL/xC,KAAKm6B,MAAQzhC,EAAKyhC,OAAS,CAAA,EAExBn6B,KAAKm5C,aACJn5C,KAAKm5C,YAAYzgD,GAErBsH,KAAKovC,WACLpvC,KAAKi0C,gBAAe,GAAM,GACnBriC,CAxFN,CAyFT,EAEI02B,OAAOnkC,UAAUouB,KAAO,SAAS/7B,EAAKmG,GAClC,IAAI6hB,EAAOxe,KAGX,GAAGxJ,EAAIsJ,cAAgBooC,MAAQ1xC,EAAIsJ,cAAgBqL,KACnD,CACI,IAAI+kB,EAAS,IAAIC,WASjB,OARAD,EAAOh3B,iBAAiB,QAAQ,SAASH,GACrC,IAAIL,EAAOqR,KAAK0W,MAAM1nB,EAAMtB,OAAOoD,QACnC2jB,EAAKgqB,UAAU9vC,GACZiE,GACCA,GACpB,SAEYuzB,EAAOkY,WAAW5xC,EAErB,CAGD,IAAI4iD,EAAM,IAAIC,eACdD,EAAI7uB,KAAK,MAAO/zB,GAAK,GACrB4iD,EAAIE,KAAK,MACTF,EAAIxuB,OAAS,SAAS2uB,GAClB,GAAmB,MAAfH,EAAI3iC,OAAR,CAIA,IAAI/d,EAAOqR,KAAK0W,MAAO24B,EAAIp3C,UAC3Bwc,EAAKgqB,UAAU9vC,GACZiE,GACCA,GAJH,CAKb,EACQy8C,EAAII,QAAU,SAAStT,GAE/B,CACA,EAEIoC,OAAOnkC,UAAUs1C,YAAc,SAAS/hD,EAAMgiD,EAAKC,GAEvD,EAeIlR,MAAMtkC,UAAUqkC,UAAY,SAAShlC,GAC7BA,EAAE1D,cAAgBlG,OAClBoG,KAAKuC,GAAKiB,EAAE,GACZxD,KAAK0oC,UAAYllC,EAAE,GACnBxD,KAAK2oC,YAAcnlC,EAAE,GACrBxD,KAAK4oC,UAAYplC,EAAE,GACnBxD,KAAK6oC,YAAcrlC,EAAE,GACrBxD,KAAKW,KAAO6C,EAAE,KAEdxD,KAAKuC,GAAKiB,EAAEjB,GACZvC,KAAKW,KAAO6C,EAAE7C,KACdX,KAAK0oC,UAAYllC,EAAEklC,UACnB1oC,KAAK2oC,YAAcnlC,EAAEmlC,YACrB3oC,KAAK4oC,UAAYplC,EAAEolC,UACnB5oC,KAAK6oC,YAAcrlC,EAAEqlC,YAEjC,EAEIJ,MAAMtkC,UAAU8xC,UAAY,WACxB,MAAO,CACHj2C,KAAKuC,GACLvC,KAAK0oC,UACL1oC,KAAK2oC,YACL3oC,KAAK4oC,UACL5oC,KAAK6oC,YACL7oC,KAAKW,KAEjB,EAEI48B,UAAUkL,MAAQA,MAmElBnL,OAAOyG,WAAaxG,UAAUwG,WAAaA,WAE3CA,WAAW5/B,UAAU8kC,MAAQ,SAASzmC,GAClCxC,KAAKwC,MAAQA,GAAS,UACtBxC,KAAKqV,KAAO,CAACkoB,UAAUO,WAAY,IACnC99B,KAAK+pC,MAAQ,KAEb/pC,KAAK+oC,KAAO,IAAIC,aAAa,GAAI,IAEjCtzC,OAAOmO,eAAe7D,KAAM,MAAO,CAC/BgV,IAAK,SAASzK,IACLA,GAAKA,EAAExT,OAAS,IAGrBiJ,KAAK+oC,KAAK,GAAKx+B,EAAE,GACjBvK,KAAK+oC,KAAK,GAAKx+B,EAAE,GACpB,EACDvG,IAAK,WACD,OAAOhE,KAAK+oC,IACf,EACDhlC,YAAY,IAGZw5B,UAAUkG,UACVzjC,KAAKuC,GAAKg7B,UAAU8J,SAGpBrnC,KAAKuC,IAAM,EAEfvC,KAAKW,KAAO,KAGZX,KAAKi3B,OAAS,GACdj3B,KAAKk3B,QAAU,GACfl3B,KAAK45C,YAAc,GAGnB55C,KAAKqlC,WAAa,GAClBrlC,KAAKmmC,gBAAkB,GAEvBnmC,KAAKomC,MAAQ,EACrB,EAMIrC,WAAW5/B,UAAUqkC,UAAY,SAASuP,GAItC,IAAK,IAAIpQ,KAHL3nC,KAAK+pC,OACL/pC,KAAK+pC,MAAMqF,WAED2I,EACV,GAAS,cAALpQ,EAWW,MAAXoQ,EAAKpQ,KAEoB,iBAAXoQ,EAAKpQ,GAEf3nC,KAAK2nC,IAAM3nC,KAAK2nC,GAAGa,UACnBxoC,KAAK2nC,GAAGa,UAAUuP,EAAKpQ,IAEvB3nC,KAAK2nC,GAAKpK,UAAU6J,YAAY2Q,EAAKpQ,GAAI3nC,KAAK2nC,IAIlD3nC,KAAK2nC,GAAKoQ,EAAKpQ,SApBf,IAAK,IAAIl1B,KAAKslC,EAAK1S,WACfrlC,KAAKqlC,WAAW5yB,GAAKslC,EAAK1S,WAAW5yB,GACjCzS,KAAK65C,mBACL75C,KAAK65C,kBAAmBpnC,EAAGslC,EAAK1S,WAAW5yB,IAyB3D,GAJKslC,EAAKv1C,QACNxC,KAAKwC,MAAQxC,KAAKF,YAAY0C,OAG9BxC,KAAKi3B,OACL,IAAK,IAAI5+B,EAAI,EAAGA,EAAI2H,KAAKi3B,OAAOlgC,SAAUsB,EAAG,CACzC,IAAI4B,EAAQ+F,KAAKi3B,OAAO5+B,GACpB4/C,EAAYj4C,KAAK+pC,MAAQ/pC,KAAK+pC,MAAMnd,MAAM3yB,EAAMoZ,MAAQ,KACxDrT,KAAK85C,qBACL95C,KAAK85C,oBAAqBvc,UAAUuC,MAAOznC,GAAG,EAAM4/C,EAAWh+C,GAE/D+F,KAAKy2C,cACLz2C,KAAKy2C,aAAax8C,EAEzB,CAGL,GAAI+F,KAAKk3B,QACL,IAAS7+B,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQngC,SAAUsB,EAAG,CAC1C,IAAI8+B,EAASn3B,KAAKk3B,QAAQ7+B,GAC1B,GAAK8+B,EAAOvK,MAAZ,CAGA,IAAS+a,EAAI,EAAGA,EAAIxQ,EAAOvK,MAAM71B,SAAU4wC,EAAG,CACtCsQ,EAAYj4C,KAAK+pC,MAAS/pC,KAAK+pC,MAAMnd,MAAMuK,EAAOvK,MAAM+a,IAAM,KAC9D3nC,KAAK85C,qBACL95C,KAAK85C,oBAAqBvc,UAAUwC,OAAQ1nC,GAAG,EAAM4/C,EAAW9gB,EACvE,CAEGn3B,KAAKo3C,eACLp3C,KAAKo3C,cAAcjgB,EARtB,CASJ,CAGL,GAAIn3B,KAAK+6B,QACT,CACI,IAAS1iC,EAAI,EAAGA,EAAI2H,KAAK+6B,QAAQhkC,SAAUsB,EAC3C,CACI,IAAIoS,EAAIzK,KAAK+6B,QAAQ1iC,GACjBoS,IAEDA,EAAExR,SAAWwR,EAAExR,QAAQ8gD,UAAsD7vB,MAAzClqB,KAAKqlC,WAAY56B,EAAExR,QAAQ8gD,YAC9DtvC,EAAEnT,MAAQyS,KAAK0W,MAAO1W,KAAKC,UAAWhK,KAAKqlC,WAAY56B,EAAExR,QAAQ8gD,aACxE,CACD,GAAIhC,EAAK5b,eACL,IAAS9jC,EAAI,EAAGA,EAAI0/C,EAAK5b,eAAeplC,SAAUsB,EAC1C2H,KAAK+6B,QAAQ1iC,KACb2H,KAAK+6B,QAAQ1iC,GAAGf,MAAQygD,EAAK5b,eAAe9jC,GAI3D,CAEG2H,KAAKm5C,aACLn5C,KAAKm5C,YAAYpB,EAE7B,EAOIhU,WAAW5/B,UAAU8xC,UAAY,WAE7B,IAAIzyC,EAAI,CACJjB,GAAIvC,KAAKuC,GACT5B,KAAMX,KAAKW,KACX+1B,IAAK12B,KAAK02B,IACVrhB,KAAMrV,KAAKqV,KACX+wB,MAAO7I,UAAU6J,YAAYpnC,KAAKomC,OAClCyM,MAAO7yC,KAAK6yC,MACZ3yC,KAAMF,KAAKE,MAIf,GAAIF,KAAKF,cAAgBikC,YAAc/jC,KAAKi5C,mBACxC,OAAOj5C,KAAKi5C,mBAOhB,GAJIj5C,KAAKi3B,SACLzzB,EAAEyzB,OAASj3B,KAAKi3B,QAGhBj3B,KAAKk3B,QAAS,CAEd,IAAK,IAAI7+B,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQngC,OAAQsB,WAC9B2H,KAAKk3B,QAAQ7+B,GAAGywC,MAE3BtlC,EAAE0zB,QAAUl3B,KAAKk3B,OACpB,CAUD,GARIl3B,KAAKwC,OAASxC,KAAKwC,OAASxC,KAAKF,YAAY0C,QAC7CgB,EAAEhB,MAAQxC,KAAKwC,OAGfxC,KAAKqlC,aACL7hC,EAAE6hC,WAAa9H,UAAU6J,YAAYpnC,KAAKqlC,aAG1CrlC,KAAK+6B,SAAW/6B,KAAKg6C,kBAAmB,CACxCx2C,EAAE24B,eAAiB,GACnB,IAAS9jC,EAAI,EAAGA,EAAI2H,KAAK+6B,QAAQhkC,SAAUsB,EACpC2H,KAAK+6B,QAAQ1iC,GACZmL,EAAE24B,eAAe9jC,GAAK2H,KAAK+6B,QAAQ1iC,GAAGf,MAEtCkM,EAAE24B,eAAe9jC,GAAK,IAEjC,CA2BD,OAzBKmL,EAAE7C,OACH6C,EAAE7C,KAAOX,KAAKF,YAAYa,MAG1BX,KAAK25C,QACLn2C,EAAEm2C,MAAQ35C,KAAK25C,OAEf35C,KAAKi6C,UACLz2C,EAAEy2C,QAAUj6C,KAAKi6C,SAEjBj6C,KAAKk6C,WACL12C,EAAE02C,SAAWl6C,KAAKk6C,UAElBl6C,KAAKm6C,QACL32C,EAAE22C,MAAQn6C,KAAKm6C,OAGfn6C,KAAK64C,aACD74C,KAAK64C,YAAYr1C,GAOlBA,CACf,EAGIugC,WAAW5/B,UAAUi2C,MAAQ,WACzB,IAAI1iD,EAAO6lC,UAAU0I,WAAWjmC,KAAKW,MACrC,IAAKjJ,EACD,OAAO,KAIX,IAAIgB,EAAO6kC,UAAU6J,YAAYpnC,KAAKi2C,aAGtC,GAAIv9C,EAAKu+B,OACL,IAAK,IAAI5+B,EAAI,EAAGA,EAAIK,EAAKu+B,OAAOlgC,SAAUsB,EACtCK,EAAKu+B,OAAO5+B,GAAGgb,KAAO,KAI9B,GAAI3a,EAAKw+B,QACL,IAAS7+B,EAAI,EAAGA,EAAIK,EAAKw+B,QAAQngC,SAAUsB,EACnCK,EAAKw+B,QAAQ7+B,GAAGu0B,QAChBl0B,EAAKw+B,QAAQ7+B,GAAGu0B,MAAM71B,OAAS,GAc3C,cATO2B,EAAS,GAEZ6kC,UAAUkG,YACV/qC,EAAS,GAAI6kC,UAAU8J,UAI3B3vC,EAAK8wC,UAAU9vC,GAERhB,CACf,EAOIqsC,WAAW5/B,UAAUgC,SAAW,WAC5B,OAAO4D,KAAKC,UAAUhK,KAAKi2C,YACnC,EAQIlS,WAAW5/B,UAAUk2C,SAAW,WAC5B,OAAOr6C,KAAKwC,OAASxC,KAAKF,YAAY0C,KAC9C,EAQIuhC,WAAW5/B,UAAU5J,YAAc,SAAS/B,EAAMlB,GAI9C,GAHK0I,KAAKqlC,aACNrlC,KAAKqlC,WAAa,IAElB/tC,IAAU0I,KAAKqlC,WAAW7sC,GAA9B,CAEA,IAAI8hD,EAAat6C,KAAKqlC,WAAW7sC,GAMjC,GALAwH,KAAKqlC,WAAW7sC,GAAQlB,EACpB0I,KAAK65C,oBACmD,IAApD75C,KAAK65C,kBAAkBrhD,EAAMlB,EAAOgjD,KACpCt6C,KAAKqlC,WAAW7sC,GAAQ8hD,GAE7Bt6C,KAAK+6B,QACJ,IAAI,IAAI1iC,EAAI,EAAGA,EAAI2H,KAAK+6B,QAAQhkC,SAAUsB,EAC1C,CACI,IAAIoS,EAAIzK,KAAK+6B,QAAQ1iC,GACrB,GAAIoS,GAEDA,EAAExR,QAAQ8gD,UAAYvhD,EACzB,CACIiS,EAAEnT,MAAQA,EACV,KACH,CACJ,CAlBM,CAmBnB,EASIysC,WAAW5/B,UAAU2hC,cAAgB,SAASxM,EAAM5gC,GAChD,GAAKsH,KAAKk3B,YAQG,GAAToC,GAAcA,GAAQt5B,KAAKk3B,QAAQngC,QAAvC,CAIA,IAAIwjD,EAAcv6C,KAAKk3B,QAAQoC,GAC/B,GAAKihB,IAKLA,EAAYzR,MAAQpwC,EAGhBsH,KAAKk3B,QAAQoC,GAAM1M,OACnB,IAAK,IAAIv0B,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQoC,GAAM1M,MAAM71B,OAAQsB,IAAK,CACtD,IAAIs6C,EAAU3yC,KAAKk3B,QAAQoC,GAAM1M,MAAMv0B,GACnCgb,EAAOrT,KAAK+pC,MAAMnd,MAAM+lB,GACzBt/B,IACCA,EAAK3a,KAAOA,EACnB,CAjBJ,CAmBT,EAQIqrC,WAAW5/B,UAAUq2C,kBAAoB,SAASlhB,EAAM34B,GACpD,GAAKX,KAAKk3B,YAGG,GAAToC,GAAcA,GAAQt5B,KAAKk3B,QAAQngC,QAAvC,CAGA,IAAIwjD,EAAcv6C,KAAKk3B,QAAQoC,GAC/B,GAAKihB,IAILA,EAAY55C,KAAOA,EAGfX,KAAKk3B,QAAQoC,GAAM1M,OACnB,IAAK,IAAIv0B,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQoC,GAAM1M,MAAM71B,OAAQsB,IAAK,CACtD,IAAIs6C,EAAU3yC,KAAKk3B,QAAQoC,GAAM1M,MAAMv0B,GACvC2H,KAAK+pC,MAAMnd,MAAM+lB,GAAShyC,KAAOA,CACpC,CAbJ,CAeT,EASIojC,WAAW5/B,UAAU0hC,aAAe,SAASvM,EAAMmhB,GAC/C,GAAKz6C,KAAKi3B,UAINqC,GAAQt5B,KAAKi3B,OAAOlgC,QAAoC,MAA1BiJ,KAAKi3B,OAAOqC,GAAMjmB,MAApD,CAIA,IAAIs/B,EAAU3yC,KAAKi3B,OAAOqC,GAAMjmB,KAC5BA,EAAOrT,KAAK+pC,MAAMnd,MAAM+lB,GAC5B,IAAKt/B,EAED,OAAO,KAGX,IAAKonC,EACD,OAAOpnC,EAAK3a,KAIhB,IAAIhB,EAAOsI,KAAK+pC,MAAMpT,YAAYtjB,EAAKq1B,WACvC,OAAKhxC,GAIDA,EAAKgjD,iBACLhjD,EAAKgjD,iBAAiBrnC,EAAKs1B,aACpBjxC,EAAKkuC,WACZluC,EAAKkuC,YAGFvyB,EAAK3a,MATD2a,EAAK3a,IAhBf,CA0BT,EAQIqrC,WAAW5/B,UAAUw2C,iBAAmB,SAASrhB,GAC7C,IAAKt5B,KAAKi3B,OACN,OAAO,KAGX,GAAIqC,GAAQt5B,KAAKi3B,OAAOlgC,QAAoC,MAA1BiJ,KAAKi3B,OAAOqC,GAAMjmB,KAChD,OAAO,KAEX,IAAIs/B,EAAU3yC,KAAKi3B,OAAOqC,GAAMjmB,KAC5BA,EAAOrT,KAAK+pC,MAAMnd,MAAM+lB,GAC5B,IAAKt/B,EAED,OAAO,KAEX,IAAI3b,EAAOsI,KAAK+pC,MAAMpT,YAAYtjB,EAAKq1B,WACvC,IAAKhxC,EACD,OAAO2b,EAAK1S,KAEhB,IAAI45C,EAAc7iD,EAAKw/B,QAAQ7jB,EAAKs1B,aACpC,OAAI4R,EACOA,EAAY55C,KAEhB,IACf,EASIojC,WAAW5/B,UAAUy2C,mBAAqB,SACtCC,EACAJ,GAEA,IAAInhB,EAAOt5B,KAAK86C,cAAcD,GAC9B,OAAa,GAATvhB,EACO,KAEJt5B,KAAK6lC,aAAavM,EAAMmhB,EACvC,EAQI1W,WAAW5/B,UAAU42C,iBAAmB,SAASzhB,GAC7C,QAAKt5B,KAAKi3B,SAGHqC,EAAOt5B,KAAKi3B,OAAOlgC,QAAoC,MAA1BiJ,KAAKi3B,OAAOqC,GAAMjmB,KAC9D,EAQI0wB,WAAW5/B,UAAU62C,aAAe,SAAS1hB,GACzC,OAAKt5B,KAAKi3B,QAGNqC,EAAOt5B,KAAKi3B,OAAOlgC,OACZiJ,KAAKi3B,OAAOqC,GAHZ,IAMnB,EAQIyK,WAAW5/B,UAAU82C,aAAe,SAAS3hB,GACzC,IAAKt5B,KAAKi3B,OACN,OAAO,KAEX,GAAIqC,EAAOt5B,KAAKi3B,OAAOlgC,OAAQ,CAC3B,IAAImkD,EAAYl7C,KAAKi3B,OAAOqC,GAC5B,OAAOt5B,KAAK+pC,MAAMnd,MAAOsuB,EAAU7nC,KACtC,CACD,OAAO,IACf,EAQI0wB,WAAW5/B,UAAUovC,aAAe,SAASja,GACzC,IAAKt5B,KAAKi3B,OACN,OAAO,KAEX,GAAIqC,GAAQt5B,KAAKi3B,OAAOlgC,OACpB,OAAO,KAEX,IAAIkD,EAAQ+F,KAAKi3B,OAAOqC,GACxB,IAAKr/B,GAAwB,OAAfA,EAAMoZ,KAChB,OAAO,KAEX,IAAI4kC,EAAYj4C,KAAK+pC,MAAMnd,MAAM3yB,EAAMoZ,MACvC,OAAK4kC,EAGEj4C,KAAK+pC,MAAMpT,YAAYshB,EAAUvP,WAF7B,IAGnB,EAQI3E,WAAW5/B,UAAUg3C,mBAAqB,SAAS3iD,GAC/C,IAAKwH,KAAKi3B,SAAWj3B,KAAKi3B,OAAOlgC,OAC7B,OAAOiJ,KAAKqlC,WAAarlC,KAAKqlC,WAAW7sC,GAAQ,KAGrD,IAAK,IAAIH,EAAI,EAAGqH,EAAIM,KAAKi3B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAG,CAChD,IAAI+iD,EAAap7C,KAAKi3B,OAAO5+B,GAC7B,GAAIG,GAAQ4iD,EAAW5iD,MAA2B,MAAnB4iD,EAAW/nC,KAAc,CACpD,IAAIA,EAAOrT,KAAK+pC,MAAMnd,MAAMwuB,EAAW/nC,MACvC,GAAIA,EACA,OAAOA,EAAK3a,IAEnB,CACJ,CACD,OAAOsH,KAAKqlC,WAAW7sC,EAC/B,EAQIurC,WAAW5/B,UAAUkzC,cAAgB,SAAS/d,GAC1C,OAAKt5B,KAAKk3B,QAGNoC,GAAQt5B,KAAKk3B,QAAQngC,OACd,KAGAiJ,KAAKk3B,QAAQoC,GACZwP,MAPD,IAQnB,EAQI/E,WAAW5/B,UAAUk3C,cAAgB,SAAS/hB,GAC1C,OAAKt5B,KAAKk3B,SAGNoC,EAAOt5B,KAAKk3B,QAAQngC,OACbiJ,KAAKk3B,QAAQoC,GAHb,IAMnB,EAQIyK,WAAW5/B,UAAUm3C,kBAAoB,SAAShiB,GAC9C,QAAKt5B,KAAKk3B,UAINoC,EAAOt5B,KAAKk3B,QAAQngC,QACpBiJ,KAAKk3B,QAAQoC,GAAM1M,OACnB5sB,KAAKk3B,QAAQoC,GAAM1M,MAAM71B,OAErC,EAOIgtC,WAAW5/B,UAAUo3C,qBAAuB,WACxC,IAAKv7C,KAAKk3B,QACN,OAAO,EAEX,IAAK,IAAI7+B,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQngC,SAAUsB,EACvC,GAAI2H,KAAKk3B,QAAQ7+B,GAAGu0B,OAAS5sB,KAAKk3B,QAAQ7+B,GAAGu0B,MAAM71B,OAC/C,OAAO,EAGf,OAAO,CACf,EAQIgtC,WAAW5/B,UAAUq3C,eAAiB,SAASliB,GAC3C,IAAKt5B,KAAKk3B,SAAkC,GAAvBl3B,KAAKk3B,QAAQngC,OAC9B,OAAO,KAGX,GAAIuiC,GAAQt5B,KAAKk3B,QAAQngC,OACrB,OAAO,KAGX,IAAIogC,EAASn3B,KAAKk3B,QAAQoC,GAC1B,IAAKnC,EAAOvK,OAAgC,GAAvBuK,EAAOvK,MAAM71B,OAC9B,OAAO,KAIX,IADA,IAAI4M,EAAI,GACCtL,EAAI,EAAGA,EAAI8+B,EAAOvK,MAAM71B,OAAQsB,IAAK,CAC1C,IAAIs6C,EAAUxb,EAAOvK,MAAMv0B,GACvBgb,EAAOrT,KAAK+pC,MAAMnd,MAAM+lB,GAC5B,GAAIt/B,EAAM,CACN,IAAIu/B,EAAc5yC,KAAK+pC,MAAMpT,YAAYtjB,EAAKu1B,WAC1CgK,GACAjvC,EAAEtI,KAAKu3C,EAEd,CACJ,CACD,OAAOjvC,CACf,EAEIogC,WAAW5/B,UAAUs3C,kBAAoB,WACrC,IAAIC,EAAQ17C,KAAK86C,cAAc,aAC/B,OAAc,GAAVY,GACY17C,KAAKw2C,SAAS,YAAajZ,UAAUyC,MAAO,CAAC2b,UAAU,EAAMC,YAAY,IAC9E57C,KAAK86C,cAAc,cAEvBY,CACV,EAED3X,WAAW5/B,UAAU03C,oBAAsB,WACvC,IAAIH,EAAQ17C,KAAK87C,eAAe,cAChC,OAAc,GAAVJ,GACa17C,KAAKm3C,UAAU,aAAc5Z,UAAU0C,OAAQ,CAAC0b,UAAU,EAAMC,YAAY,IAClF57C,KAAK87C,eAAe,eAExBJ,CACV,EAED3X,WAAW5/B,UAAU43C,mBAAqB,SAAS7F,EAAOj9C,GACtD,IAAIyiD,EAAQ17C,KAAK87C,eAAe,eAClB,GAAVJ,GAKA17C,KAAKg8C,YAAYN,EAAOxF,EAAO,KAAMj9C,EAG5C,EAED8qC,WAAW5/B,UAAU83C,WAAa,SAASC,GACvC,OAAOA,GACH,KAAK3e,UAAU8C,SAEX,MAEJ,KAAK9C,UAAUgD,WACXvgC,KAAKy7C,oBACLz7C,KAAK67C,sBACL,MAEJ,KAAKte,UAAU+C,MAGf,KAAK/C,UAAU6C,OAGf,KAAK7C,UAAU4e,WACX,MAEJ,QACI,OAAO,EAIf,OADAn8C,KAAKE,KAAOg8C,GACL,CACf,EAQInY,WAAW5/B,UAAUstC,UAAY,SAASyE,EAAOj9C,GAC7CA,EAAUA,GAAW,GACjB+G,KAAK4lC,YAGA3sC,EAAQmjD,cAAanjD,EAAQmjD,YAAcp8C,KAAKuC,GAAG,SAAS+J,KAAKoL,MAAoB,KAAdpL,KAAK8C,WAEjFpP,KAAK+pC,MAAMuG,gBAAgBtwC,KAAKuC,KAAM,EAEtCvC,KAAK4lC,UAAUsQ,EAAOj9C,GAEtB+G,KAAK+pC,MAAMuG,gBAAgBtwC,KAAKuC,KAAM,EAGtCvC,KAAKq8C,aAAer8C,KAAK+pC,MAAM4F,UAC5B12C,GAAWA,EAAQmjD,cAClBp8C,KAAKo8C,YAAcnjD,EAAQmjD,YAC3Bp8C,KAAK+pC,MAAMyG,qBAAqBxwC,KAAKuC,IAAMtJ,EAAQmjD,cAG3Dp8C,KAAKs8C,kBAAoB,EACtBt8C,KAAK+7C,oBAAoB/7C,KAAK+7C,mBAAmB7F,EAAOj9C,EACnE,EAQI8qC,WAAW5/B,UAAUkyC,SAAW,SAAS/B,EAAQ4B,EAAOj9C,GACpDA,EAAUA,GAAW,GACjB+G,KAAK6I,WAGA5P,EAAQmjD,cAAanjD,EAAQmjD,YAAcp8C,KAAKuC,GAAG,KAAK+xC,GAAc,UAAU,IAAIhoC,KAAKoL,MAAoB,KAAdpL,KAAK8C,WAEzGpP,KAAK+pC,MAAMwG,gBAAgBvwC,KAAKuC,IAAO+xC,GAAc,YAErDt0C,KAAK6I,SAASyrC,EAAQ4B,EAAOj9C,GAE7B+G,KAAK+pC,MAAMwG,gBAAgBvwC,KAAKuC,KAAM,EAGnCtJ,GAAWA,EAAQmjD,cAClBp8C,KAAKo8C,YAAcnjD,EAAQmjD,YAC3Bp8C,KAAK+pC,MAAMyG,qBAAqBxwC,KAAKuC,IAAMtJ,EAAQmjD,cAG3Dp8C,KAAKu8C,iBAAmB,EACrBv8C,KAAK+7C,oBAAoB/7C,KAAK+7C,mBAAmB7F,EAAOj9C,EACnE,EAQI8qC,WAAW5/B,UAAUmyC,QAAU,SAAShC,EAAQ4B,EAAOj9C,GACnD,GAAK+G,KAAKk3B,SAAYl3B,KAAKk3B,QAAQngC,OAAnC,CAIIiJ,KAAK+pC,QACL/pC,KAAK+pC,MAAMyS,mBAAqBjf,UAAUqR,WAE9C,IAAK,IAAIv2C,EAAI,EAAGA,EAAI2H,KAAKk3B,QAAQngC,SAAUsB,EAAG,CAC1C,IAAI8+B,EAASn3B,KAAKk3B,QAAQ7+B,IACpB8+B,GAAUA,EAAOx2B,OAAS48B,UAAUyC,OAAUsU,GAAUnd,EAAO3+B,MAAQ87C,GAE7Et0C,KAAKg8C,YAAY3jD,EAAG69C,EAAO,KAAMj9C,EACpC,CAVA,CAWT,EASI8qC,WAAW5/B,UAAU63C,YAAc,SAAS1iB,EAAM4c,EAAOvD,EAAS15C,GAE9D,GADAA,EAAUA,GAAW,GAChB+G,KAAKk3B,SAIC,MAARoC,EAAH,CAMGA,EAAKx5B,YAGR,IAAIq3B,EAASn3B,KAAKk3B,QAAQoC,GAC1B,GAAKnC,EAAL,CAIA,IAAIvK,EAAQuK,EAAOvK,MACnB,GAAKA,GAAUA,EAAM71B,OAArB,CAIIiJ,KAAK+pC,QACL/pC,KAAK+pC,MAAMyS,mBAAqBjf,UAAUqR,WAI9C,IAAK,IAAIn8B,EAAI,EAAGA,EAAIma,EAAM71B,SAAU0b,EAAG,CACnC,IAAIlQ,EAAKqqB,EAAMna,GACf,GAAe,MAAXkgC,GAAmBA,GAAWpwC,EAAlC,CAIA,IAAI01C,EAAYj4C,KAAK+pC,MAAMnd,MAAMA,EAAMna,IACvC,GAAKwlC,EAAL,CAIAA,EAAUI,WAAa9a,UAAUqR,UACjC,IAAIl3C,EAAOsI,KAAK+pC,MAAMpT,YAAYshB,EAAUrP,WAC5C,GAAKlxC,EAAL,CAMA,IAAI+kD,EAAoB/kD,EAAKu/B,OAAOghB,EAAUpP,aAE9C,GAAInxC,EAAKwI,OAASq9B,UAAUgD,WAGnBtnC,EAAQmjD,cAAanjD,EAAQmjD,YAAcp8C,KAAKuC,GAAG,UAAU+J,KAAKoL,MAAoB,KAAdpL,KAAK8C,WAC9E1X,EAAKkuC,WAELluC,EAAK+5C,UAAUyE,EAAOj9C,QAGzB,GAAIvB,EAAKmR,SAAU,CAEf5P,EAAQmjD,cAAanjD,EAAQmjD,YAAcp8C,KAAKuC,GAAG,QAAQ+J,KAAKoL,MAAoB,KAAdpL,KAAK8C,WAE5EqtC,EAAoB/kD,EAAKu/B,OAAOghB,EAAUpP,aAE9CnxC,EAAK2+C,SAASoG,EAAkBjkD,KAAM09C,EAAOj9C,EAChD,CArBA,CANA,CALA,CAiCJ,CA7CA,CALA,CARA,CA2DT,EAQI8qC,WAAW5/B,UAAUu4C,mBAAqB,SAASpjB,EAAMqZ,GACrD,GAAK3yC,KAAKk3B,QAAV,CAIA,IAAIC,EAASn3B,KAAKk3B,QAAQoC,GAC1B,GAAKnC,EAAL,CAIA,IAAIvK,EAAQuK,EAAOvK,MACnB,GAAKA,GAAUA,EAAM71B,OAKrB,IAAK,IAAI0b,EAAI,EAAGA,EAAIma,EAAM71B,SAAU0b,EAAG,CACnC,IAAIlQ,EAAKqqB,EAAMna,GACf,GAAe,MAAXkgC,GAAmBA,GAAWpwC,EAAlC,CAIA,IAAI01C,EAAYj4C,KAAK+pC,MAAMnd,MAAMA,EAAMna,IAClCwlC,IAILA,EAAUI,WAAa,EANtB,CAOJ,CApBA,CALA,CA0BT,EAOItU,WAAW5/B,UAAUw4C,QAAU,SAAStnC,GAEpCrV,KAAKqV,KAAOA,EACTrV,KAAK48C,UACJ58C,KAAK48C,SAAS58C,KAAKqV,KAC1B,EAUD0uB,WAAW5/B,UAAU04C,YAAc,SAC/BrkD,EACAskD,EACAn8C,EACAo8C,GAEA,IAAIv5C,EAAI,CAAEhL,KAAMA,EAAMmI,KAAMA,EAAMm8C,cAAeA,GACjD,GAAIC,EACA,IAAK,IAAI1kD,KAAK0kD,EACVv5C,EAAEnL,GAAK0kD,EAAW1kD,GAW1B,OARK2H,KAAKmmC,kBACNnmC,KAAKmmC,gBAAkB,IAE3BnmC,KAAKmmC,gBAAgB9qC,KAAKmI,GACrBxD,KAAKqlC,aACNrlC,KAAKqlC,WAAa,IAEtBrlC,KAAKqlC,WAAW7sC,GAAQskD,EACjBt5C,CACf,EAWIugC,WAAW5/B,UAAUgzC,UAAY,SAAS3+C,EAAMmI,EAAMo8C,GAClD,IAAI5lB,EAAS,CAAE3+B,KAAMA,EAAMmI,KAAMA,EAAMisB,MAAO,MAC9C,GAAImwB,EACA,IAAK,IAAI1kD,KAAK0kD,EACV5lB,EAAO9+B,GAAK0kD,EAAW1kD,GAgB/B,OAZK2H,KAAKk3B,UACNl3B,KAAKk3B,QAAU,IAEnBl3B,KAAKk3B,QAAQ77B,KAAK87B,GACdn3B,KAAKo3C,eACLp3C,KAAKo3C,cAAcjgB,GAGnBoG,UAAUoF,sBAAsBpF,UAAUkH,wBAAwBzkC,KAAKW,GAAK,GAEhFX,KAAK28C,QAAS38C,KAAKqmC,eACnBrmC,KAAKi0C,gBAAe,GAAM,GACnB9c,CACf,EAOI4M,WAAW5/B,UAAU64C,WAAa,SAASltC,GACvC,IAAK,IAAIzX,EAAI,EAAGA,EAAIyX,EAAM/Y,SAAUsB,EAAG,CACnC,IAAI0/C,EAAOjoC,EAAMzX,GACbmL,EAAI,CAAEhL,KAAMu/C,EAAK,GAAIp3C,KAAMo3C,EAAK,GAAI1kC,KAAM,MAC9C,GAAIvD,EAAM,GACN,IAAK,IAAI63B,KAAKoQ,EAAK,GACfv0C,EAAEmkC,GAAKoQ,EAAK,GAAGpQ,GAIlB3nC,KAAKk3B,UACNl3B,KAAKk3B,QAAU,IAEnBl3B,KAAKk3B,QAAQ77B,KAAKmI,GACdxD,KAAKo3C,eACLp3C,KAAKo3C,cAAc5zC,GAGnB+5B,UAAUoF,sBAAsBpF,UAAUkH,wBAAwBzkC,KAAK+3C,EAAK,IAAG,EAEtF,CAED/3C,KAAK28C,QAAS38C,KAAKqmC,eACnBrmC,KAAKi0C,gBAAe,GAAM,EAClC,EAOIlQ,WAAW5/B,UAAUuzC,aAAe,SAASpe,GACzCt5B,KAAK80C,iBAAiBxb,GACtBt5B,KAAKk3B,QAAQr2B,OAAOy4B,EAAM,GAC1B,IAAK,IAAIjhC,EAAIihC,EAAMjhC,EAAI2H,KAAKk3B,QAAQngC,SAAUsB,EAC1C,GAAK2H,KAAKk3B,QAAQ7+B,IAAO2H,KAAKk3B,QAAQ7+B,GAAGu0B,MAIzC,IADA,IAAIA,EAAQ5sB,KAAKk3B,QAAQ7+B,GAAGu0B,MACnB+a,EAAI,EAAGA,EAAI/a,EAAM71B,SAAU4wC,EAAG,CACnC,IAAIt0B,EAAOrT,KAAK+pC,MAAMnd,MAAMA,EAAM+a,IAC7Bt0B,IAGLA,EAAKs1B,aAAe,EACvB,CAGL3oC,KAAK28C,QAAS38C,KAAKqmC,eACfrmC,KAAK23C,iBACL33C,KAAK23C,gBAAgBre,GAEzBt5B,KAAKi0C,gBAAe,GAAM,EAClC,EASIlQ,WAAW5/B,UAAUqyC,SAAW,SAASh+C,EAAMmI,EAAMo8C,GAEjD,IAAI9iD,EAAQ,CAAEzB,KAAMA,EAAMmI,KAD1BA,EAAOA,GAAQ,EACuB0S,KAAM,MAC5C,GAAI0pC,EACA,IAAK,IAAI1kD,KAAK0kD,EACV9iD,EAAM5B,GAAK0kD,EAAW1kD,GAkB9B,OAdK2H,KAAKi3B,SACNj3B,KAAKi3B,OAAS,IAGlBj3B,KAAKi3B,OAAO57B,KAAKpB,GACjB+F,KAAK28C,QAAS38C,KAAKqmC,eAEfrmC,KAAKy2C,cACLz2C,KAAKy2C,aAAax8C,GAGtBsjC,UAAUkH,wBAAwBzkC,KAAKW,GAEvCX,KAAKi0C,gBAAe,GAAM,GACnBh6C,CACf,EAOI8pC,WAAW5/B,UAAU84C,UAAY,SAASntC,GACtC,IAAK,IAAIzX,EAAI,EAAGA,EAAIyX,EAAM/Y,SAAUsB,EAAG,CACnC,IAAI0/C,EAAOjoC,EAAMzX,GACbmL,EAAI,CAAEhL,KAAMu/C,EAAK,GAAIp3C,KAAMo3C,EAAK,GAAI1kC,KAAM,MAC9C,GAAIvD,EAAM,GACN,IAAK,IAAI63B,KAAKoQ,EAAK,GACfv0C,EAAEmkC,GAAKoQ,EAAK,GAAGpQ,GAIlB3nC,KAAKi3B,SACNj3B,KAAKi3B,OAAS,IAElBj3B,KAAKi3B,OAAO57B,KAAKmI,GACbxD,KAAKy2C,cACLz2C,KAAKy2C,aAAajzC,GAGtB+5B,UAAUkH,wBAAwBzkC,KAAK+3C,EAAK,GAC/C,CAED/3C,KAAK28C,QAAS38C,KAAKqmC,eACnBrmC,KAAKi0C,gBAAe,GAAM,EAClC,EAOIlQ,WAAW5/B,UAAU8yC,YAAc,SAAS3d,GACxCt5B,KAAK60C,gBAAgBvb,GAErB,IADA,IAAI4hB,EAAYl7C,KAAKi3B,OAAOp2B,OAAOy4B,EAAM,GAChCjhC,EAAIihC,EAAMjhC,EAAI2H,KAAKi3B,OAAOlgC,SAAUsB,EACzC,GAAK2H,KAAKi3B,OAAO5+B,GAAjB,CAGA,IAAIgb,EAAOrT,KAAK+pC,MAAMnd,MAAM5sB,KAAKi3B,OAAO5+B,GAAGgb,MACtCA,IAGLA,EAAKw1B,aAAe,EALnB,CAOL7oC,KAAK28C,QAAS38C,KAAKqmC,eACfrmC,KAAKk3C,gBACLl3C,KAAKk3C,eAAe5d,EAAM4hB,EAAU,IAExCl7C,KAAKi0C,gBAAe,GAAM,EAClC,EAUIlQ,WAAW5/B,UAAU+4C,cAAgB,SAAS1kD,EAAMmI,EAAM+1B,EAAKhd,GAC3D,IAAIlW,EAAI,CACJhL,KAAMA,EACNmI,KAAMA,EACN+1B,IAAKA,EACLhd,UAAWA,EACXkT,MAAO,MAGX,OADA5sB,KAAK45C,YAAYv+C,KAAKmI,GACfA,CACf,EAQIugC,WAAW5/B,UAAUkiC,YAAc,SAAS1B,GACxC,GAAI3kC,KAAKF,YAAYuV,KACjB,OAAOrV,KAAKF,YAAYuV,KAAK5L,SAGjC,IAAI0zC,EAAO7wC,KAAKC,IACZvM,KAAKi3B,OAASj3B,KAAKi3B,OAAOlgC,OAAS,EACnCiJ,KAAKk3B,QAAUl3B,KAAKk3B,QAAQngC,OAAS,GAErCse,EAAOsvB,GAAO,IAAIqE,aAAa,CAAC,EAAG,IACvCmU,EAAO7wC,KAAKC,IAAI4wC,EAAM,GACtB,IAAIv7B,EAAY2b,UAAUa,eAEtBgf,EAAcC,EAAkBr9C,KAAKwC,OACrC86C,EAAc,EACdC,EAAe,EAEnB,GAAIv9C,KAAKi3B,OACL,IAAK,IAAI5+B,EAAI,EAAGqH,EAAIM,KAAKi3B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAG,CAChD,IAAI4B,EAAQ+F,KAAKi3B,OAAO5+B,GAGpBilD,GADAE,EAAaH,EADNpjD,EAAMgrB,OAAShrB,EAAMzB,MAAQ,OAGpC8kD,EAAcE,EAErB,CAGL,GAAIx9C,KAAKk3B,QACL,IAAS7+B,EAAI,EAAGqH,EAAIM,KAAKk3B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAAG,CACjD,IAEImlD,EAFArmB,EAASn3B,KAAKk3B,QAAQ7+B,GAGtBklD,GADAC,EAAaH,EADNlmB,EAAOlS,OAASkS,EAAO3+B,MAAQ,OAGtC+kD,EAAeC,EAEtB,CAGLnoC,EAAK,GAAK/I,KAAKC,IAAI+wC,EAAcC,EAAe,GAAIH,GACpD/nC,EAAK,GAAK/I,KAAKC,IAAI8I,EAAK,GAAIkoB,UAAUO,YAClC99B,KAAK+6B,SAAW/6B,KAAK+6B,QAAQhkC,SAC7Bse,EAAK,GAAK/I,KAAKC,IAAI8I,EAAK,GAA2B,IAAvBkoB,UAAUO,aAG1CzoB,EAAK,IAAMrV,KAAKF,YAAY29C,cAAgB,GAAKN,EAAO5f,UAAUK,iBAElE,IAAI8f,EAAiB,EACrB,GAAI19C,KAAK+6B,SAAW/6B,KAAK+6B,QAAQhkC,OAAQ,CACrC,IAASsB,EAAI,EAAGqH,EAAIM,KAAK+6B,QAAQhkC,OAAQsB,EAAIqH,IAAKrH,EAC1C2H,KAAK+6B,QAAQ1iC,GAAGguC,YAChBqX,GAAkB19C,KAAK+6B,QAAQ1iC,GAAGguC,YAAYhxB,EAAK,IAAI,GAAK,EAE5DqoC,GAAkBngB,UAAUM,mBAAqB,EAEzD6f,GAAkB,CACrB,CAUD,SAASL,EAAkB5kD,GACvB,OAAKA,EAGEmpB,EAAYnpB,EAAK1B,OAAS,GAFtB,CAGd,CAWD,OAvBIiJ,KAAK29C,WACLtoC,EAAK,GAAK/I,KAAKC,IAAK8I,EAAK,GAAIqoC,GACA,MAAxB19C,KAAK49C,gBACVvoC,EAAK,GAAK/I,KAAKC,IAAK8I,EAAK,GAAIqoC,EAAiB19C,KAAK49C,iBAEnDvoC,EAAK,IAAMqoC,EAUX19C,KAAKF,YAAY+9C,YACjBxoC,EAAK,GAAKrV,KAAKF,YAAY+9C,aAE3BxoC,EAAK,GAAKrV,KAAKF,YAAY+9C,YAG/BxoC,EAAK,IAAM,EAEJA,CACf,EAEI0uB,WAAW5/B,UAAU25C,eAAiB,SAASC,EAASC,GACpD,IAAIb,EAAOn9C,KAAKk3B,QAAUl3B,KAAKk3B,QAAQngC,OAAS,EAC5CknD,GAAkBj+C,KAAKF,YAAY29C,cAAgB,GAAKN,EAAO5f,UAAUK,iBAC7E,OAAOsgB,kBAAkBH,EACrBC,EACAh+C,KAAK02B,IAAI,GAAK12B,KAAKqV,KAAK,GAAK,GAC7BrV,KAAK02B,IAAI,GAAKpqB,KAAKC,IAAIvM,KAAKqV,KAAK,GAAK,GAAI4oC,GAC1C,GACA,GAEP,EASDla,WAAW5/B,UAAUg6C,gBAAkB,SAAUpE,GAE7C,IAAIhC,EAAO,KAIX,GAAI/3C,KAAKmmC,gBACL,IAAK,IAAI9tC,EAAI,EAAGA,EAAI2H,KAAKmmC,gBAAgBpvC,SAAUsB,EAC/C,GAAI2H,KAAKmmC,gBAAgB9tC,GAAGG,MAAQuhD,EAAU,CAC1ChC,EAAO/3C,KAAKmmC,gBAAgB9tC,GAC5B,KACH,CAsBT,OAlBG2H,KAAKF,YAAY,IAAMi6C,KACtBhC,EAAO/3C,KAAKF,YAAY,IAAMi6C,IAE/B/5C,KAAKF,YAAYs+C,cAAgBp+C,KAAKF,YAAYs+C,aAAarE,KAC9DhC,EAAO/3C,KAAKF,YAAYs+C,aAAarE,KAGpChC,GAAQ/3C,KAAKq+C,oBACdtG,EAAO/3C,KAAKq+C,kBAAkBtE,IAG7BhC,IACDA,EAAO,CAAA,GACPA,EAAKp3C,OACLo3C,EAAKp3C,YAAcX,KAAKqlC,WAAW0U,IACrB,SAAfhC,EAAKhc,SACJgc,EAAKp3C,KAAO,QAETo3C,CACV,EAaDhU,WAAW5/B,UAAUm6C,UAAY,SAAU39C,EAAMnI,EAAMlB,EAAOqF,EAAU1D,GAE/D+G,KAAK+6B,UACN/6B,KAAK+6B,QAAU,KAGf9hC,GAAW0D,GAAYA,EAASmD,cAAgBpK,SAEhDuD,EAAU0D,EACVA,EAAW,MAGZ1D,GAAWA,EAAQ6G,cAAgBqM,SAClClT,EAAU,CAAE8gD,SAAU9gD,IAEvB0D,GAAYA,EAASmD,cAAgBqM,SAEhClT,IACAA,EAAU,CAAA,GACdA,EAAQ8gD,SAAWp9C,EACnBA,EAAW,MAGZA,GAAYA,EAASmD,cAAgBmJ,WAGpCtM,EAAW,MAGf,IAAI8N,EAAI,CACJ9J,KAAMA,EAAKyjC,cACX5rC,KAAMA,EACNlB,MAAOA,EACPqF,SAAUA,EACV1D,QAASA,GAAW,CAAE,GAU1B,QAPoBixB,IAAhBzf,EAAExR,QAAQuS,IACVf,EAAEe,EAAIf,EAAExR,QAAQuS,IAGf7O,IAAa8N,EAAExR,QAAQ0D,UAAa8N,EAAExR,QAAQ8gD,SAGvC,SAARp5C,IAAoB8J,EAAExR,QAAQslD,OAC9B,KAAM,iGAIV,OAFAv+C,KAAK+6B,QAAQ1/B,KAAKoP,GAClBzK,KAAK28C,QAAS38C,KAAKqmC,eACZ57B,CACf,EAEIs5B,WAAW5/B,UAAUq6C,gBAAkB,SAASC,GAK5C,OAJKz+C,KAAK+6B,UACN/6B,KAAK+6B,QAAU,IAEnB/6B,KAAK+6B,QAAQ1/B,KAAKojD,GACXA,CACf,EASI1a,WAAW5/B,UAAUu6C,YAAc,SAAS/Z,EAAKga,GAC7Cha,EAAMA,GAAO,IAAIqE,aAAa,GAC9B,MAAM4V,EAAU5+C,KAAK02B,IACfmoB,EAAc7+C,KAAKomC,MAAM0Y,UACzBC,EAAW/+C,KAAKqV,KAEtB,IAAI2pC,EAAc,EAEdC,EAAgB,EAChBC,EAAa,EACbC,EAAgB,EAyBpB,OAvBIR,IAEAK,EAAc,EAEdC,EAAe,EAAID,EAEnBE,EAAa,EAEbC,EAAgB,EAAID,GAGxBva,EAAI,GAAKia,EAAQ,GAAKI,EACtBra,EAAI,GAAKia,EAAQ,GAAKrhB,UAAUG,kBAAoBwhB,EACpDva,EAAI,GAAKka,GACJ7+C,KAAKo/C,kBAAoB7hB,UAAUU,sBAAwBghB,EAC5DF,EAAS,GAAKE,EAClBta,EAAI,GAAKka,EACLthB,UAAUG,kBAAoByhB,EAC9BJ,EAAS,GAAKxhB,UAAUG,kBAAoByhB,EAE5Cn/C,KAAKq/C,YACLr/C,KAAKq/C,WAAW1a,GAEbA,CACf,EASIZ,WAAW5/B,UAAUyxC,cAAgB,SAAStqC,EAAGE,EAAGioC,EAAQiC,GACxDjC,EAASA,GAAU,EAEnB,IAAI6L,EAAat/C,KAAK+pC,OAAS/pC,KAAK+pC,MAAMoO,SAAW,EAAI5a,UAAUG,kBAInE,GAHIgY,IACA4J,EAAa,GAEbt/C,KAAKomC,OAASpmC,KAAKomC,MAAM0Y,WAEzB,GACIZ,kBACI5yC,EACAE,EACAxL,KAAK02B,IAAI,GAAK+c,EACdzzC,KAAK02B,IAAI,GAAK6G,UAAUG,kBAAoB+V,GAC3CzzC,KAAKo/C,kBAAoB7hB,UAAUU,sBACpC,EAAIwV,EACJlW,UAAUG,kBAAoB,EAAI+V,GAGtC,OAAO,OAER,GACHzzC,KAAK02B,IAAI,GAAK,EAAI+c,EAASnoC,GAC3BtL,KAAK02B,IAAI,GAAK12B,KAAKqV,KAAK,GAAK,EAAIo+B,EAASnoC,GAC1CtL,KAAK02B,IAAI,GAAK4oB,EAAa7L,EAASjoC,GACpCxL,KAAK02B,IAAI,GAAK12B,KAAKqV,KAAK,GAAKo+B,EAASjoC,EAEtC,OAAO,EAEX,OAAO,CACf,EASIu4B,WAAW5/B,UAAUo7C,kBAAoB,SAASj0C,EAAGE,GAEjD,IAAIg0C,EAAW,IAAIxW,aAAa,GAChC,GAAIhpC,KAAKi3B,OACL,IAAK,IAAI5+B,EAAI,EAAGqH,EAAIM,KAAKi3B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAG,CAChD,IAAI4B,EAAQ+F,KAAKi3B,OAAO5+B,GAExB,GADA2H,KAAKy/C,kBAAiB,EAAMpnD,EAAGmnD,GAE3BtB,kBACI5yC,EACAE,EACAg0C,EAAS,GAAK,GACdA,EAAS,GAAK,EACd,GACA,IAGJ,MAAO,CAAEvlD,MAAOA,EAAOq/B,KAAMjhC,EAAGmnD,SAAUA,EAEjD,CAGL,GAAIx/C,KAAKk3B,QACL,IAAS7+B,EAAI,EAAGqH,EAAIM,KAAKk3B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAAG,CACjD,IAAI8+B,EAASn3B,KAAKk3B,QAAQ7+B,GAE1B,GADA2H,KAAKy/C,kBAAiB,EAAOpnD,EAAGmnD,GAE5BtB,kBACI5yC,EACAE,EACAg0C,EAAS,GAAK,GACdA,EAAS,GAAK,EACd,GACA,IAGJ,MAAO,CAAEroB,OAAQA,EAAQmC,KAAMjhC,EAAGmnD,SAAUA,EAEnD,CAGL,OAAO,IACf,EASIzb,WAAW5/B,UAAU22C,cAAgB,SAAStiD,EAAOknD,GACjD,IAAK1/C,KAAKi3B,OACN,OAAQ,EAEZ,IAAK,IAAI5+B,EAAI,EAAGqH,EAAIM,KAAKi3B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAC7C,GAAIG,GAAQwH,KAAKi3B,OAAO5+B,GAAGG,KACvB,OAAQknD,EAAgB1/C,KAAKi3B,OAAO5+B,GAAhBA,EAG5B,OAAQ,CAChB,EASI0rC,WAAW5/B,UAAU23C,eAAiB,SAAStjD,EAAMknD,GAEjD,GADAA,EAAYA,IAAa,GACpB1/C,KAAKk3B,QACN,OAAQ,EAEZ,IAAK,IAAI7+B,EAAI,EAAGqH,EAAIM,KAAKk3B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAC9C,GAAIG,GAAQwH,KAAKk3B,QAAQ7+B,GAAGG,KACxB,OAAQknD,EAAgB1/C,KAAKk3B,QAAQ7+B,GAAjBA,EAG5B,OAAQ,CAChB,EAUI0rC,WAAW5/B,UAAUw7C,kBAAoB,SAASC,GAC1CA,EAASA,GAAU,GAAvB,IAIIC,EAAOnqD,OAAOsR,OAHJ,CAAC04C,WAAW,EACrBI,iBAAkB,IAEUF,GACjC,IAAK5/C,KAAKi3B,OACN,OAAQ,EAEZ,IAAK,IAAI5+B,EAAI,EAAGqH,EAAIM,KAAKi3B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAC7C,KAAI2H,KAAKi3B,OAAO5+B,GAAGgb,MAA+B,MAAvBrT,KAAKi3B,OAAO5+B,GAAGgb,MAGtCwsC,EAAKC,kBAAoBD,EAAKC,iBAAiB1zC,UAAYyzC,EAAKC,iBAAiB1zC,SAASpM,KAAKi3B,OAAO5+B,GAAGsI,OAG7G,OAAQk/C,EAAKH,UAAgB1/C,KAAKi3B,OAAO5+B,GAAhBA,EAE7B,OAAQ,CAChB,EAQI0rC,WAAW5/B,UAAU47C,mBAAqB,SAASH,GAC3CA,EAASA,GAAU,GAAvB,IAIIC,EAAOnqD,OAAOsR,OAHJ,CAAE04C,WAAW,EACtBI,iBAAkB,IAEUF,GACjC,IAAK5/C,KAAKk3B,QACN,OAAQ,EAEZ,IAAK,IAAI7+B,EAAI,EAAGqH,EAAIM,KAAKk3B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAC9C,KAAI2H,KAAKk3B,QAAQ7+B,GAAGu0B,OAAkC,MAAzB5sB,KAAKk3B,QAAQ7+B,GAAGu0B,OAGzCizB,EAAKC,kBAAoBD,EAAKC,iBAAiB1zC,UAAYyzC,EAAKC,iBAAiB1zC,SAASpM,KAAKk3B,QAAQ7+B,GAAGsI,OAG9G,OAAQk/C,EAAKH,UAAgB1/C,KAAKk3B,QAAQ7+B,GAAjBA,EAE7B,OAAQ,CAChB,EAKI0rC,WAAW5/B,UAAU67C,oBAAsB,SAASr/C,EAAM++C,EAAWO,EAAgBC,GACjF,OAAOlgD,KAAKmgD,gBAAe,EAAMx/C,EAAM++C,EAAWO,EAAgBC,EAC1E,EAKInc,WAAW5/B,UAAUi8C,qBAAuB,SAASz/C,EAAM++C,EAAWO,EAAgBC,GAClF,OAAOlgD,KAAKmgD,gBAAe,EAAOx/C,EAAM++C,EAAWO,EAAgBC,EAC3E,EAWInc,WAAW5/B,UAAUg8C,eAAiB,SAASlmD,EAAO0G,EAAM++C,EAAWO,EAAgBC,GAEnFR,EAAYA,IAAa,EACzBO,EAAiBA,IAAkB,EACnCC,EAAmBA,IAAoB,EACvC,IAAIG,GAJJpmD,EAAQA,IAAS,GAII+F,KAAKi3B,OAASj3B,KAAKk3B,QACxC,IAAKmpB,EACD,OAAQ,EAGA,IAAR1/C,GAAsB,KAARA,IAAaA,EAAO,GACtC,IAAK,IAAItI,EAAI,EAAGqH,EAAI2gD,EAAOtpD,OAAQsB,EAAIqH,IAAKrH,EAAG,CAE3C,IAAIioD,GAAW3/C,EAAK,IAAIyjC,cAAchyB,MAAM,KAE5CmuC,IADIA,EAAwB,KAAhBF,EAAOhoD,GAAGsI,MAA2B,KAAhB0/C,EAAOhoD,GAAGsI,KAAU,IAAI0/C,EAAOhoD,GAAGsI,MACpD,IAAIyjC,cAAchyB,MAAM,KACvC,IAAI,IAAIouC,EAAG,EAAEA,EAAGF,EAAQvpD,OAAOypD,IAC3B,IAAI,IAAIC,EAAG,EAAEA,EAAGF,EAAMxpD,OAAO0pD,IAKzB,GAJiB,WAAbH,EAAQE,KAAgBF,EAAQE,GAAMjjB,UAAUyC,OACrC,WAAXugB,EAAMC,KAAgBD,EAAMC,GAAMjjB,UAAUyC,OAC/B,KAAbsgB,EAAQE,KAAUF,EAAQE,GAAM,GACrB,KAAXD,EAAMC,KAAUD,EAAMC,GAAM,GAC5BF,EAAQE,IAAOD,EAAME,GAAK,CAC1B,GAAIR,GAAkBI,EAAOhoD,GAAGu0B,OAA6B,OAApByzB,EAAOhoD,GAAGu0B,MAAgB,SACnE,OAAQ8yB,EAAgBW,EAAOhoD,GAAXA,CACvB,CAGZ,CAED,GAAI4nD,IAAmBC,EACnB,IAAS7nD,EAAI,EAAGqH,EAAI2gD,EAAOtpD,OAAQsB,EAAIqH,IAAKrH,EAAG,CAE3C,IACIkoD,EADAD,GAAW3/C,EAAK,IAAIyjC,cAAchyB,MAAM,KAE5CmuC,IADIA,EAAwB,KAAhBF,EAAOhoD,GAAGsI,MAA2B,KAAhB0/C,EAAOhoD,GAAGsI,KAAU,IAAI0/C,EAAOhoD,GAAGsI,MACpD,IAAIyjC,cAAchyB,MAAM,KACvC,IAAQouC,EAAG,EAAEA,EAAGF,EAAQvpD,OAAOypD,IAC3B,IAAQC,EAAG,EAAEA,EAAGF,EAAMxpD,OAAO0pD,IAGzB,GAFiB,KAAbH,EAAQE,KAAUF,EAAQE,GAAM,GACrB,KAAXD,EAAMC,KAAUD,EAAMC,GAAM,GAC5BF,EAAQE,IAAOD,EAAME,GACrB,OAAQf,EAAgBW,EAAOhoD,GAAXA,CAInC,CAEL,OAAQ,CAChB,EAUI0rC,WAAW5/B,UAAUu8C,cAAgB,SAASpnB,EAAMsZ,EAAa+N,EAAiBf,GAC1EA,EAASA,GAAU,GAAvB,IA8BY/W,EAzBRgX,EAAOnqD,OAAOsR,OAJJ,CAAE45C,mBAAmB,EAC9BC,gCAAgC,EAChCC,mBAAmB,GAESlB,GAKjC,OAJIhN,GAAeA,EAAY9yC,cAAgBihD,SAC3CnO,EAAc5yC,KAAK+pC,MAAMpT,YAAYic,KAErC/J,EAAc+J,EAAYoN,oBAAoBW,GAAiB,GAAO,KACvD,GAAqB,OAAhB9X,EAEb7oC,KAAKghD,QAAQ1nB,EAAMsZ,EAAa/J,GAGnCgX,EAAKe,mBAAqBD,GAAmBpjB,UAAUyC,MAGhDhgC,KAAKghD,QAAQ1nB,EAAMsZ,GAAc,GAGxCiN,EAAKiB,oBACDjY,EAAc+J,EAAYoN,oBAAoB,GAAG,GAAO,GAAM,KAE/C,GAKnBH,EAAKgB,iCAAsD,GAAnBF,GAA2C,KAAnBA,GAA6C,IAAnBA,KACtF9X,EAAc+J,EAAY+M,kBAAkB,CAACG,iBAAkB,CAACviB,UAAUyC,WAE3D,EAPRhgC,KAAKghD,QAAQ1nB,EAAMsZ,EAAa/J,GAexC,IAEd,EAUD9E,WAAW5/B,UAAU88C,oBAAsB,SAAS3nB,EAAM4nB,EAAaC,EAAiBvB,GAChFA,EAASA,GAAU,GAAvB,IAKIC,EAAOnqD,OAAOsR,OAJJ,CAAE45C,mBAAmB,EAC9BQ,+BAA+B,EAC/BN,mBAAmB,GAESlB,GAKjC,GAJIsB,GAAeA,EAAYphD,cAAgBihD,SAC3CG,EAAclhD,KAAK+pC,MAAMpT,YAAYuqB,KAErCG,EAAcH,EAAYd,qBAAqBe,GAAiB,GAAO,KACxD,GAAqB,OAAhBE,EAEpB,OAAOH,EAAYF,QAAQK,EAAarhD,KAAMs5B,GAI9C,GAAIumB,EAAKiB,oBACDO,EAAcH,EAAYd,qBAAqB,GAAG,GAAO,GAAM,KAChD,EACf,OAAOc,EAAYF,QAAQK,EAAarhD,KAAMs5B,GAItD,GAAIumB,EAAKe,mBAAqBO,GAAmB5jB,UAAUyC,OAEnDzC,UAAU4F,sBAAsB,CAChC,IAAIke,EAAcH,EAAYrF,sBAC9B,OAAOqF,EAAYF,QAAQK,EAAarhD,KAAMs5B,EACjD,CAGL,OAAIumB,EAAKuB,gCAAqD,GAAnBD,GAA2C,KAAnBA,GAA6C,IAAnBA,KACrFE,EAAcH,EAAYnB,mBAAmB,CAACD,iBAAkB,CAACviB,UAAUyC,WAC5D,EACRkhB,EAAYF,QAAQK,EAAarhD,KAAMs5B,GAQ/C,IAEd,EAUDyK,WAAW5/B,UAAU68C,QAAU,SAAS1nB,EAAMsZ,EAAa/J,GAGvD,GAFAA,EAAcA,GAAe,GAExB7oC,KAAK+pC,MAKN,OAAO,KAIX,GAAIzQ,EAAKx5B,cAAgBqM,QAErB,IAAa,IADbmtB,EAAOt5B,KAAK87C,eAAexiB,IAKvB,OAHIiE,UAAUiE,MAGP,UAER,IAAKxhC,KAAKk3B,SAAWoC,GAAQt5B,KAAKk3B,QAAQngC,OAI7C,OAHIwmC,UAAUiE,MAGP,KAMX,GAHIoR,GAAeA,EAAY9yC,cAAgBihD,SAC3CnO,EAAc5yC,KAAK+pC,MAAMpT,YAAYic,KAEpCA,EACD,KAAM,sBAIV,GAAIA,GAAe5yC,KACf,OAAO,KAIX,GAAI6oC,EAAY/oC,cAAgBqM,QAE5B,IAAoB,IADpB08B,EAAc+J,EAAYkI,cAAcjS,IAOpC,OALItL,UAAUiE,MAKP,UAER,GAAIqH,IAAgBtL,UAAUyC,MAAO,CAExC,IAAIzC,UAAU4F,sBAOV,OAAO,KAHPyP,EAAYqJ,WAAW1e,UAAUgD,YACjCsI,EAAc+J,EAAYkI,cAAc,YAIxD,MAAe,IACFlI,EAAY3b,QACb4R,GAAe+J,EAAY3b,OAAOlgC,OAKlC,OAHIwmC,UAAUiE,MAGP,KAGX,IAAI8f,GAAU,EAEVrnD,EAAQ24C,EAAY3b,OAAO4R,GAC3BoP,EAAY,KACZ9gB,EAASn3B,KAAKk3B,QAAQoC,GAE1B,IAAKt5B,KAAKk3B,QAAQoC,GAGd,OAAO,KAUX,GANIsZ,EAAY2O,uBAEZ1Y,EAAc+J,EAAY2O,qBAAqB1Y,KAIjC,IAAdA,GAAqC,OAAdA,IAAuBtL,UAAU+J,kBAAkBnQ,EAAOx2B,KAAM1G,EAAM0G,MAK7F,OAHAX,KAAKi0C,gBAAe,GAAO,GACxBqN,GACCthD,KAAK+pC,MAAMiO,iBAAiBh4C,KAAMi4C,GAC/B,KAMX,GAAIrF,EAAY4O,iBACsE,IAA7E5O,EAAY4O,eAAe3Y,EAAa1R,EAAOx2B,KAAMw2B,EAAQn3B,KAAMs5B,GACpE,OAAO,KAGf,GAAIt5B,KAAKyhD,kBAC4E,IAA5EzhD,KAAKyhD,gBAAgBnoB,EAAMr/B,EAAM0G,KAAM1G,EAAO24C,EAAa/J,GAC5D,OAAO,KAUf,GALI+J,EAAY3b,OAAO4R,IAAwD,MAAxC+J,EAAY3b,OAAO4R,GAAax1B,OACnErT,KAAK+pC,MAAM6K,eACXhC,EAAYiC,gBAAgBhM,EAAa,CAAC6Y,iBAAiB,IAC3DJ,GAAU,GAEO,OAAjBnqB,EAAOvK,OAAkBuK,EAAOvK,MAAM71B,QAC/BogC,EAAOx2B,OACL48B,UAAUyC,MACNzC,UAAU6F,gCACXpjC,KAAK+pC,MAAM6K,eACX50C,KAAK80C,iBAAiBxb,GAAM,EAAO,CAACooB,iBAAiB,IACrDJ,GAAU,GA4E1B,OA7DArJ,EAAY,IAAIxP,MANZlL,UAAUkG,UACDlG,UAAU8J,WAERrnC,KAAK+pC,MAAMhS,aAKtB99B,EAAM0G,MAAQw2B,EAAOx2B,KACrBX,KAAKuC,GACL+2B,EACAsZ,EAAYrwC,GACZsmC,GAIJ7oC,KAAK+pC,MAAMnd,MAAMqrB,EAAU11C,IAAM01C,EAGb,MAAhB9gB,EAAOvK,QACPuK,EAAOvK,MAAQ,IAEnBuK,EAAOvK,MAAMvxB,KAAK48C,EAAU11C,IAE5BqwC,EAAY3b,OAAO4R,GAAax1B,KAAO4kC,EAAU11C,GAC7CvC,KAAK+pC,OACL/pC,KAAK+pC,MAAMqF,WAEXpvC,KAAK85C,qBACL95C,KAAK85C,oBACDvc,UAAUwC,OACVzG,GACA,EACA2e,EACA9gB,GAGJyb,EAAYkH,qBACZlH,EAAYkH,oBACRvc,UAAUuC,MACV+I,GACA,EACAoP,EACAh+C,GAGJ+F,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,yBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUuC,MACV8S,EACA/J,EACA7oC,KACAs5B,GAEJt5B,KAAK+pC,MAAM4X,uBACPpkB,UAAUwC,OACV//B,KACAs5B,EACAsZ,EACA/J,IAIR7oC,KAAKi0C,gBAAe,GAAO,GAC3Bj0C,KAAK+pC,MAAMmL,cACXl1C,KAAK+pC,MAAMiO,iBAAiBh4C,KAAMi4C,GAE3BA,CACf,EASIlU,WAAW5/B,UAAU2wC,iBAAmB,SAASxb,EAAMsZ,GACnD,GAAItZ,EAAKx5B,cAAgBqM,QAErB,IAAa,IADbmtB,EAAOt5B,KAAK87C,eAAexiB,IAKvB,OAHIiE,UAAUiE,OAGP,OAER,IAAKxhC,KAAKk3B,SAAWoC,GAAQt5B,KAAKk3B,QAAQngC,OAI7C,OAHIwmC,UAAUiE,OAGP,EAIX,IAAIrK,EAASn3B,KAAKk3B,QAAQoC,GAC1B,IAAKnC,IAAWA,EAAOvK,OAAgC,GAAvBuK,EAAOvK,MAAM71B,OACzC,OAAO,EAIX,GAAI67C,EAAa,CAIb,GAHIA,EAAY9yC,cAAgBihD,SAC5BnO,EAAc5yC,KAAK+pC,MAAMpT,YAAYic,KAEpCA,EACD,KAAM,wBAGV,IAAK,IAAIv6C,EAAI,EAAGqH,EAAIy3B,EAAOvK,MAAM71B,OAAQsB,EAAIqH,EAAGrH,IAAK,CACjD,IAAIs6C,EAAUxb,EAAOvK,MAAMv0B,GAI3B,IAHI4/C,EAAYj4C,KAAK+pC,MAAMnd,MAAM+lB,IAGnB/J,WAAagK,EAAYrwC,GAAI,CACvC40B,EAAOvK,MAAM/rB,OAAOxI,EAAG,IACnB4B,EAAQ24C,EAAY3b,OAAOghB,EAAUpP,cACnCx1B,KAAO,YACNrT,KAAK+pC,MAAMnd,MAAM+lB,GACpB3yC,KAAK+pC,OACL/pC,KAAK+pC,MAAMqF,WAEXwD,EAAYkH,qBACZlH,EAAYkH,oBACRvc,UAAUuC,MACVmY,EAAUpP,aACV,EACAoP,EACAh+C,GAGJ+F,KAAK85C,qBACL95C,KAAK85C,oBACDvc,UAAUwC,OACVzG,GACA,EACA2e,EACA9gB,GAGJn3B,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,wBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUwC,OACV//B,KACAs5B,GAGJt5B,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,yBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUwC,OACV//B,KACAs5B,GAEJt5B,KAAK+pC,MAAM4X,uBACPpkB,UAAUuC,MACV8S,EACAqF,EAAUpP,cAGlB,KACH,CACJ,CACJ,KACI,CACD,IAASxwC,EAAI,EAAGqH,EAAIy3B,EAAOvK,MAAM71B,OAAQsB,EAAIqH,EAAGrH,IAAK,CACjD,IACI4/C,EADAtF,EAAUxb,EAAOvK,MAAMv0B,GAE3B,GADI4/C,EAAYj4C,KAAK+pC,MAAMnd,MAAM+lB,GACjC,CAKIC,EAAc5yC,KAAK+pC,MAAMpT,YAAYshB,EAAUrP,WAAnD,IACI3uC,EAAQ,KACR+F,KAAK+pC,OACL/pC,KAAK+pC,MAAMqF,WAEXwD,KACA34C,EAAQ24C,EAAY3b,OAAOghB,EAAUpP,cAC/Bx1B,KAAO,KACTu/B,EAAYkH,qBACZlH,EAAYkH,oBACRvc,UAAUuC,MACVmY,EAAUpP,aACV,EACAoP,EACAh+C,GAGJ+F,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,wBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUuC,MACV8S,EACAqF,EAAUpP,qBAIf7oC,KAAK+pC,MAAMnd,MAAM+lB,GACpB3yC,KAAK85C,qBACL95C,KAAK85C,oBACDvc,UAAUwC,OACVzG,GACA,EACA2e,EACA9gB,GAGJn3B,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,yBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUwC,OACV//B,KACAs5B,GAEJt5B,KAAK+pC,MAAM4X,uBACPpkB,UAAUuC,MACV8S,EACAqF,EAAUpP,aA9CjB,CAiDJ,CACD1R,EAAOvK,MAAQ,IAClB,CAID,OAFA5sB,KAAKi0C,gBAAe,GAAO,GAC3Bj0C,KAAK+pC,MAAMiO,iBAAiBh4C,OACrB,CACf,EAQI+jC,WAAW5/B,UAAU0wC,gBAAkB,SAASvb,GAE5C,GAAIA,EAAKx5B,cAAgBqM,QAErB,IAAa,IADbmtB,EAAOt5B,KAAK86C,cAAcxhB,IAKtB,OAHIiE,UAAUiE,OAGP,OAER,IAAKxhC,KAAKi3B,QAAUqC,GAAQt5B,KAAKi3B,OAAOlgC,OAI3C,OAHIwmC,UAAUiE,OAGP,EAGX,IAAIvnC,EAAQ+F,KAAKi3B,OAAOqC,GACxB,IAAKr/B,EACD,OAAO,EAGX,IAAI04C,EAAU3yC,KAAKi3B,OAAOqC,GAAMjmB,KAChC,GAAc,MAAXs/B,EACH,CACI3yC,KAAKi3B,OAAOqC,GAAMjmB,KAAO,KAGzB,IAAI4kC,EAAYj4C,KAAK+pC,MAAMnd,MAAM+lB,GACjC,GAAIsF,EAAW,CACX,IAAIrF,EAAc5yC,KAAK+pC,MAAMpT,YAAYshB,EAAUvP,WACnD,IAAKkK,EACD,OAAO,EAGX,IAAIzb,EAASyb,EAAY1b,QAAQ+gB,EAAUtP,aAC3C,IAAKxR,IAAWA,EAAOvK,OAAgC,GAAvBuK,EAAOvK,MAAM71B,OACzC,OAAO,EAIX,IAAK,IAAIsB,EAAI,EAAGqH,EAAIy3B,EAAOvK,MAAM71B,OAAQsB,EAAIqH,EAAGrH,IAC5C,GAAI8+B,EAAOvK,MAAMv0B,IAAMs6C,EAAS,CAC5Bxb,EAAOvK,MAAM/rB,OAAOxI,EAAG,GACvB,KACH,QAGE2H,KAAK+pC,MAAMnd,MAAM+lB,GACpB3yC,KAAK+pC,OACL/pC,KAAK+pC,MAAMqF,WAEXpvC,KAAK85C,qBACL95C,KAAK85C,oBACDvc,UAAUuC,MACVxG,GACA,EACA2e,EACAh+C,GAGJ24C,EAAYkH,qBACZlH,EAAYkH,oBACRvc,UAAUwC,OACV1nC,GACA,EACA4/C,EACA9gB,GAGJn3B,KAAK+pC,OAAS/pC,KAAK+pC,MAAM4X,yBACzB3hD,KAAK+pC,MAAM4X,uBACPpkB,UAAUwC,OACV6S,EACAv6C,GAEJ2H,KAAK+pC,MAAM4X,uBAAuBpkB,UAAUuC,MAAO9/B,KAAMs5B,GAEhE,CACJ,CAKD,OAHAt5B,KAAKi0C,gBAAe,GAAO,GACxBj0C,KAAK+pC,OACJ/pC,KAAK+pC,MAAMiO,iBAAiBh4C,OACzB,CACf,EAUI+jC,WAAW5/B,UAAUs7C,iBAAmB,SACpCmC,EACAC,EACAld,GAEAA,EAAMA,GAAO,IAAIqE,aAAa,GAC9B,IAAI8Y,EAAY,EACZF,GAAY5hD,KAAKi3B,SACjB6qB,EAAY9hD,KAAKi3B,OAAOlgC,SAEvB6qD,GAAY5hD,KAAKk3B,UAClB4qB,EAAY9hD,KAAKk3B,QAAQngC,QAG7B,IAAIsyC,EAAsC,GAA7B9L,UAAUK,iBAEvB,GAAI59B,KAAKomC,MAAM0Y,UAAW,CACtB,IAAIr0C,EAAIzK,KAAKo/C,kBAAoB7hB,UAAUU,qBAgB3C,OAfIj+B,KAAK+hD,YACLpd,EAAI,GAAK3kC,KAAK02B,IAAI,GAAS,GAAJjsB,EAEnBk6B,EAAI,GADJid,EACS5hD,KAAK02B,IAAI,GAAK6G,UAAUG,kBAExB19B,KAAK02B,IAAI,KAIlBiO,EAAI,GADJid,EACS5hD,KAAK02B,IAAI,GAET12B,KAAK02B,IAAI,GAAKjsB,EAE3Bk6B,EAAI,GAAK3kC,KAAK02B,IAAI,GAAmC,GAA9B6G,UAAUG,mBAE9BiH,CACV,CAGD,OAAIid,IAA4B,GAAhBC,GACZld,EAAI,GAAK3kC,KAAK02B,IAAI,GAAmC,GAA9B6G,UAAUG,kBACjCiH,EAAI,GAAK3kC,KAAK02B,IAAI,GAAmC,GAA9B6G,UAAUG,kBAC1BiH,GAKPid,GACAE,EAAYD,GACZ7hD,KAAKi3B,OAAO4qB,GAAanrB,KAEzBiO,EAAI,GAAK3kC,KAAK02B,IAAI,GAAK12B,KAAKi3B,OAAO4qB,GAAanrB,IAAI,GACpDiO,EAAI,GAAK3kC,KAAK02B,IAAI,GAAK12B,KAAKi3B,OAAO4qB,GAAanrB,IAAI,GAC7CiO,IAENid,GACDE,EAAYD,GACZ7hD,KAAKk3B,QAAQ2qB,GAAanrB,KAE1BiO,EAAI,GAAK3kC,KAAK02B,IAAI,GAAK12B,KAAKk3B,QAAQ2qB,GAAanrB,IAAI,GACrDiO,EAAI,GAAK3kC,KAAK02B,IAAI,GAAK12B,KAAKk3B,QAAQ2qB,GAAanrB,IAAI,GAC9CiO,GAIP3kC,KAAK+hD,YACLpd,EAAI,GACA3kC,KAAK02B,IAAI,IAAMmrB,EAAc,KAAQ7hD,KAAKqV,KAAK,GAAKysC,GAEpDnd,EAAI,GADJid,EACS5hD,KAAK02B,IAAI,GAAK6G,UAAUG,kBAExB19B,KAAK02B,IAAI,GAAK12B,KAAKqV,KAAK,GAE9BsvB,IAKPA,EAAI,GADJid,EACS5hD,KAAK02B,IAAI,GAAK2S,EAEdrpC,KAAK02B,IAAI,GAAK12B,KAAKqV,KAAK,GAAK,EAAIg0B,EAE9C1E,EAAI,GACA3kC,KAAK02B,IAAI,IACRmrB,EAAc,IAAOtkB,UAAUK,kBAC/B59B,KAAKF,YAAY29C,cAAgB,GAC/B9Y,EACf,EAGIZ,WAAW5/B,UAAUswC,YAAc,WAC/Bz0C,KAAK02B,IAAI,GACL6G,UAAUE,iBACVnxB,KAAK01C,MAAMhiD,KAAK02B,IAAI,GAAK6G,UAAUE,kBACvCz9B,KAAK02B,IAAI,GACL6G,UAAUE,iBACVnxB,KAAK01C,MAAMhiD,KAAK02B,IAAI,GAAK6G,UAAUE,iBAC/C,EAGIsG,WAAW5/B,UAAU89C,MAAQ,SAASvI,GAC7B15C,KAAK0N,UACN1N,KAAK0N,QAAU,IAGnB1N,KAAK0N,QAAQrS,KAAKq+C,GACd15C,KAAK0N,QAAQ3W,OAASgtC,WAAWme,aACjCliD,KAAK0N,QAAQglC,QAGd1yC,KAAK+pC,MAAM0P,aACVz5C,KAAK+pC,MAAM0P,YAAYz5C,KAAM05C,EACzC,EAGI3V,WAAW5/B,UAAU8vC,eAAiB,SAClCkO,EACAC,GAEKpiD,KAAK+pC,OAGV/pC,KAAK+pC,MAAM2G,mBAAmB,WAAY,CACtCyR,EACAC,GAEZ,EAEIre,WAAW5/B,UAAUk+C,UAAY,SAAS7rD,GACtC,IAAI+nB,EAAM,IAAIoM,MACdpM,EAAIpd,IAAMo8B,UAAUgE,iBAAmB/qC,EACvC+nB,EAAIlf,OAAQ,EAEZ,IAAImf,EAAOxe,KAKX,OAJAue,EAAIqM,OAAS,WACT5qB,KAAKX,OAAQ,EACbmf,EAAKy1B,gBAAe,EAChC,EACe11B,CACf,EA0CIwlB,WAAW5/B,UAAUm+C,aAAe,SAAS/3C,GACzC,GAAKvK,KAAK+pC,OAAU/pC,KAAK+pC,MAAMxB,oBAM/B,IAFA,IAAIjpB,EAAOtf,KAAK+pC,MAAMxB,oBAEblwC,EAAI,EAAGA,EAAIinB,EAAKvoB,SAAUsB,EAAG,CAClC,IAAIkF,EAAI+hB,EAAKjnB,IAERkS,GAAKhN,EAAEglD,sBAAwBviD,QAKpCzC,EAAEglD,qBAAuBh4C,EAAIvK,KAAO,KACvC,CACT,EAMI+jC,WAAW5/B,UAAUq+C,SAAW,SAASC,GACrCziD,KAAK+pC,MAAMqF,aAC0B,IAAjCpvC,KAAKF,YAAY4iD,aAA0BD,KAG1CziD,KAAKomC,MAAM0Y,UAGZ9+C,KAAKomC,MAAM0Y,WAAY,EAFvB9+C,KAAKomC,MAAM0Y,WAAY,EAI3B9+C,KAAKi0C,gBAAe,GAAM,GAClC,EAOIlQ,WAAW5/B,UAAUw+C,IAAM,SAASp4C,GAChCvK,KAAK+pC,MAAMqF,WAEPpvC,KAAKomC,MAAMwc,YADL14B,IAAN3f,GACqBvK,KAAKomC,MAAMwc,OAEZr4C,CAEhC,EAEIw5B,WAAW5/B,UAAU0+C,cAAgB,SAASv3C,EAAGE,EAAGmlC,GAChD,MAAO,EACFrlC,EAAItL,KAAK02B,IAAI,IAAMia,EAAYrH,MAAQqH,EAAYtH,OAAO,IAC1D79B,EAAIxL,KAAK02B,IAAI,IAAMia,EAAYrH,MAAQqH,EAAYtH,OAAO,GAEvE,EAMI/L,OAAO4L,YAAc3L,UAAU2L,YAAcA,YAE7CA,YAAY/kC,UAAU8kC,MAAQ,SAASzmC,GACnCxC,KAAKwC,MAAQA,GAAS,QACtBxC,KAAK4hB,UAAY,GACjB5hB,KAAK25C,MAAQ7P,aAAagZ,YAAYC,UAChCjZ,aAAagZ,YAAYC,UAAUC,WACnC,OACNhjD,KAAKijD,UAAY,IAAIja,aAAa,CAAC,GAAI,GAAI,IAAK,KAChDhpC,KAAK+oC,KAAO/oC,KAAKijD,UAAUC,SAAS,EAAG,GACvCljD,KAAKmjD,MAAQnjD,KAAKijD,UAAUC,SAAS,EAAG,GACxCljD,KAAKqvC,OAAS,GACdrvC,KAAK+pC,MAAQ,KAEbr0C,OAAOmO,eAAe7D,KAAM,MAAO,CAC/BgV,IAAK,SAASzK,IACLA,GAAKA,EAAExT,OAAS,IAGrBiJ,KAAK+oC,KAAK,GAAKx+B,EAAE,GACjBvK,KAAK+oC,KAAK,GAAKx+B,EAAE,GACpB,EACDvG,IAAK,WACD,OAAOhE,KAAK+oC,IACf,EACDhlC,YAAY,IAGhBrO,OAAOmO,eAAe7D,KAAM,OAAQ,CAChCgV,IAAK,SAASzK,IACLA,GAAKA,EAAExT,OAAS,IAGrBiJ,KAAKmjD,MAAM,GAAK72C,KAAKC,IAAI,IAAKhC,EAAE,IAChCvK,KAAKmjD,MAAM,GAAK72C,KAAKC,IAAI,GAAIhC,EAAE,IAClC,EACDvG,IAAK,WACD,OAAOhE,KAAKmjD,KACf,EACDp/C,YAAY,GAExB,EAEImlC,YAAY/kC,UAAUqkC,UAAY,SAAShlC,GACvCxD,KAAKwC,MAAQgB,EAAEhB,MACfxC,KAAKijD,UAAUjuC,IAAIxR,EAAE+yB,UACrBv2B,KAAK25C,MAAQn2C,EAAEm2C,MACXn2C,EAAEoe,YACF5hB,KAAK4hB,UAAYpe,EAAEoe,UAE/B,EAEIsnB,YAAY/kC,UAAU8xC,UAAY,WAC9B,IAAI9/C,EAAI6J,KAAKijD,UACb,MAAO,CACHzgD,MAAOxC,KAAKwC,MACZ+zB,SAAU,CACNjqB,KAAK01C,MAAM7rD,EAAE,IACbmW,KAAK01C,MAAM7rD,EAAE,IACbmW,KAAK01C,MAAM7rD,EAAE,IACbmW,KAAK01C,MAAM7rD,EAAE,KAEjBwjD,MAAO35C,KAAK25C,MACZ/3B,UAAW5hB,KAAK4hB,UAE5B,EAEIsnB,YAAY/kC,UAAUi/C,KAAO,SAASC,EAAQC,EAAQC,GAGlD,GAFAvjD,KAAK+oC,KAAK,IAAMsa,EAChBrjD,KAAK+oC,KAAK,IAAMua,GACZC,EAGJ,IAAK,IAAIlrD,EAAI,EAAGA,EAAI2H,KAAKqvC,OAAOt4C,SAAUsB,EAAG,CACzC,IAAIX,EAAOsI,KAAKqvC,OAAOh3C,GACvBX,EAAKg/B,IAAI,IAAM2sB,EACf3rD,EAAKg/B,IAAI,IAAM4sB,CAClB,CACT,EAEIpa,YAAY/kC,UAAUq/C,qBAAuB,WACzCxjD,KAAKqvC,OAAOt4C,OAAS,EAIrB,IAHA,IAAI0I,EAAQO,KAAK+pC,MAAMsF,OACnBoU,EAAgB,IAAIza,aAAa,GAE5B3wC,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAAG,CACnC,IAAIX,EAAO+H,EAAMpH,GACjBX,EAAKgnD,YAAY+E,GACZC,gBAAgB1jD,KAAKijD,UAAWQ,IAGrCzjD,KAAKqvC,OAAOh0C,KAAK3D,EACpB,CACT,EAEIwxC,YAAY/kC,UAAUyxC,cAAgB7R,WAAW5/B,UAAUyxC,cAC3D1M,YAAY/kC,UAAU8vC,eAAiBlQ,WAAW5/B,UAAU8vC,eAwB5D1W,UAAU4L,aAAeA,aAEzBA,aAAahlC,UAAU0lC,WAAa,SAAStxC,GACzCyH,KAAK2pC,WAAa,IAAIX,aAAa,GAEnChpC,KAAK2jD,uBAAyB3jD,KAAKotC,QAAQpiC,KAAKhL,MAEhDu9B,UAAUqmB,mBAAmBrrD,EAAQ,OAAQyH,KAAK2jD,wBAClDpmB,UAAUqmB,mBAAmBrrD,EAAQ,OAAQyH,KAAK2jD,wBAClDpmB,UAAUqmB,mBAAmBrrD,EAAQ,KAAMyH,KAAK2jD,wBAEhDprD,EAAQW,iBACJ,aACA8G,KAAK2jD,wBACL,GAEJprD,EAAQW,iBAAiB,QAAS8G,KAAK2jD,wBAAwB,EACvE,EAEIxa,aAAahlC,UAAU0/C,mBAAqB,SAAUxV,GAClD,GAAKruC,KAAKzH,QAAV,CAIA,IAAI6K,EAAQpD,KAAKzH,QAAQ6K,MACrBC,EAASrD,KAAKzH,QAAQ8K,OACtBygD,GAAU9jD,KAAKqpC,OAAO,GACtB0a,GAAU/jD,KAAKqpC,OAAO,GACtBgF,IAEAyV,GAAUzV,EAAS,GAAKruC,KAAKspC,MAC7Bya,GAAU1V,EAAS,GAAKruC,KAAKspC,MAC7BlmC,EAAQirC,EAAS,GACjBhrC,EAASgrC,EAAS,IAEtB,IAAI2V,EAAOF,EAAS1gD,EAAQpD,KAAKspC,MAC7B2a,EAAOF,EAAS1gD,EAASrD,KAAKspC,MAClCtpC,KAAK4pC,aAAa,GAAKka,EACvB9jD,KAAK4pC,aAAa,GAAKma,EACvB/jD,KAAK4pC,aAAa,GAAKoa,EAAOF,EAC9B9jD,KAAK4pC,aAAa,GAAKqa,EAAOF,CAjB7B,MAFG/jD,KAAK4pC,aAAa,GAAK5pC,KAAK4pC,aAAa,GAAK5pC,KAAK4pC,aAAa,GAAK5pC,KAAK4pC,aAAa,GAAK,CAoBxG,EAEIT,aAAahlC,UAAUipC,QAAU,SAAS3wC,GACtC,GAAKuD,KAAK0pC,QAAV,CAIA,IAAI7e,EAAS7qB,KAAKzH,QACdy0B,EAAOnC,EAAOoC,wBACd3hB,EAAI7O,EAAEynD,QAAUl3B,EAAKm3B,KACrB34C,EAAI/O,EAAE2nD,QAAUp3B,EAAKO,IACzB9wB,EAAE4nD,QAAU/4C,EACZ7O,EAAE6nD,QAAU94C,EACZ/O,EAAE8nD,SAAWvkD,KAAKukD,SAElB,IAAIC,GAAaxkD,KAAKquC,UAAcruC,KAAKquC,UAAY/iC,GAAKtL,KAAKquC,SAAS,IAAM/iC,EAAKtL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,IAAO7iC,GAAKxL,KAAKquC,SAAS,IAAM7iC,EAAKxL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,GAItLoW,GAAS,EAKb,GAJIzkD,KAAK0kD,UACLD,EAASzkD,KAAK0kD,QAAQjoD,IAGtBA,EAAEkE,MAAQ48B,UAAUgG,qBAAqB,QAAUihB,EACnDxkD,KAAKukD,UAAW,EAChBhnB,UAAUonB,sBAAsB95B,EAAO,OAAO7qB,KAAK2jD,wBACnDpmB,UAAUqmB,mBAAmBntD,SAAS,OAAOuJ,KAAK2jD,wBAClDpmB,UAAUqmB,mBAAmBntD,SAAS,KAAKuJ,KAAK2jD,6BAC7C,GAAIlnD,EAAEkE,MAAQ48B,UAAUgG,qBAAqB,QAChD,IAAKkhB,EAAQ,CACT,IAAIpB,EAAS/3C,EAAItL,KAAK2pC,WAAW,GAC7B2Z,EAAS93C,EAAIxL,KAAK2pC,WAAW,GAC7B3pC,KAAKukD,UACLvkD,KAAK4kD,UAAUvB,EAAQC,EAE9B,OACM7mD,EAAEkE,MAAQ48B,UAAUgG,qBAAqB,MAChDvjC,KAAKukD,UAAW,EAChBhnB,UAAUonB,sBAAsBluD,SAAS,OAAOuJ,KAAK2jD,wBACrDpmB,UAAUonB,sBAAsBluD,SAAS,KAAKuJ,KAAK2jD,wBACnDpmB,UAAUqmB,mBAAmB/4B,EAAO,OAAO7qB,KAAK2jD,0BACxCa,GACG,cAAV/nD,EAAEkE,MACW,SAAVlE,EAAEkE,MACQ,kBAAVlE,EAAEkE,OAENlE,EAAEooD,UAAY,aACA,SAAVpoD,EAAEkE,KACFlE,EAAEqoD,OAASroD,EAAEsoD,OAEbtoD,EAAEqoD,MACmB,MAAjBroD,EAAEuoD,YAAsBvoD,EAAEuoD,aAA0B,GAAZvoD,EAAE6yB,OAIlD7yB,EAAEwoD,MAAQxoD,EAAEyoD,WACNzoD,EAAEyoD,WAAa,GACfzoD,EAAEsoD,QACGtoD,EAAEsoD,OAAS,EACZ,EACV/kD,KAAKmlD,iBAAiB,EAAgB,IAAV1oD,EAAEwoD,QAMlC,OAHAjlD,KAAK2pC,WAAW,GAAKr+B,EACrBtL,KAAK2pC,WAAW,GAAKn+B,EAElBg5C,GAEC/nD,EAAE6V,iBACF7V,EAAE2oD,mBACK,QAJX,CA9DC,CAoET,EAEIjc,aAAahlC,UAAUkhD,gBAAkB,SAASloD,GAC9CA,EAAImsC,MAAMtpC,KAAKspC,MAAOtpC,KAAKspC,OAC3BnsC,EAAImoD,UAAUtlD,KAAKqpC,OAAO,GAAIrpC,KAAKqpC,OAAO,GAClD,EAEIF,aAAahlC,UAAUohD,sBAAwB,SAAS7uB,GAEpD,MAAO,EACFA,EAAI,GAAK12B,KAAKqpC,OAAO,IAAMrpC,KAAKspC,OAChC5S,EAAI,GAAK12B,KAAKqpC,OAAO,IAAMrpC,KAAKspC,MAE7C,EAEIH,aAAahlC,UAAUqhD,sBAAwB,SAAS9uB,EAAKiO,GAIzD,OAHAA,EAAMA,GAAO,CAAC,EAAG,IACb,GAAKjO,EAAI,GAAK12B,KAAKspC,MAAQtpC,KAAKqpC,OAAO,GAC3C1E,EAAI,GAAKjO,EAAI,GAAK12B,KAAKspC,MAAQtpC,KAAKqpC,OAAO,GACpC1E,CACf,EAEIwE,aAAahlC,UAAUygD,UAAY,SAASt5C,EAAGE,GAC3CxL,KAAKqpC,OAAO,IAAM/9B,EAAItL,KAAKspC,MAC3BtpC,KAAKqpC,OAAO,IAAM79B,EAAIxL,KAAKspC,MAEvBtpC,KAAKypC,UACLzpC,KAAKypC,SAASzpC,KAE1B,EAEImpC,aAAahlC,UAAUshD,YAAc,SAASnuD,EAAOouD,GAOjD,GANIpuD,EAAQ0I,KAAKwpC,UACblyC,EAAQ0I,KAAKwpC,UACNlyC,EAAQ0I,KAAKupC,YACpBjyC,EAAQ0I,KAAKupC,WAGbjyC,GAAS0I,KAAKspC,OAIbtpC,KAAKzH,QAAV,CAIA,IAAIy0B,EAAOhtB,KAAKzH,QAAQ00B,wBACxB,GAAKD,EAAL,CAIA04B,EAAiBA,GAAkB,CAClB,GAAb14B,EAAK5pB,MACS,GAAd4pB,EAAK3pB,QAET,IAAIsiD,EAAS3lD,KAAKwlD,sBAAsBE,GACxC1lD,KAAKspC,MAAQhyC,EACTgV,KAAKE,IAAIxM,KAAKspC,MAAQ,GAAK,MAC3BtpC,KAAKspC,MAAQ,GAGjB,IAAIsc,EAAa5lD,KAAKwlD,sBAAsBE,GACxCG,EAAe,CACfD,EAAW,GAAKD,EAAO,GACvBC,EAAW,GAAKD,EAAO,IAG3B3lD,KAAKqpC,OAAO,IAAMwc,EAAa,GAC/B7lD,KAAKqpC,OAAO,IAAMwc,EAAa,GAE3B7lD,KAAKypC,UACLzpC,KAAKypC,SAASzpC,KAtBjB,CALA,CA6BT,EAEImpC,aAAahlC,UAAUghD,iBAAmB,SAAS7tD,EAAOouD,GACtD1lD,KAAKylD,YAAYzlD,KAAKspC,MAAQhyC,EAAOouD,EAC7C,EAEIvc,aAAahlC,UAAU2hD,MAAQ,WAC3B9lD,KAAKspC,MAAQ,EACbtpC,KAAKqpC,OAAO,GAAK,EACjBrpC,KAAKqpC,OAAO,GAAK,CACzB,EA0II/L,OAAOwM,aAAevM,UAAUuM,aAAeA,aAE/CA,aAAaG,yBAA2B,6eAExCH,aAAaic,iBAAmB,CAC5B,KAAMxoB,UAAU4B,iBAChB6mB,OAAQ,OACRtuD,KAAM,QAEVoyC,aAAamc,UAAY,GAOzBnc,aAAa3lC,UAAUrH,MAAQ,WAC3BkD,KAAKkmD,MAAQ,EACblmD,KAAKmmD,eAAiB,EACtBnmD,KAAKomD,YAAc,EACnBpmD,KAAKqmD,IAAM,EAKXrmD,KAAKisC,mBAAqB,KAE1BjsC,KAAK+0C,eAAiB,GACtB/0C,KAAKsmD,eAAiB,KAEtBtmD,KAAKumD,cAAgB,GACrBvmD,KAAKg1C,aAAe,KACpBh1C,KAAKwmD,UAAY,KACjBxmD,KAAKuiD,qBAAuB,KAC5BviD,KAAKymD,gBAAkB,KACvBzmD,KAAK0mD,kBAAoB,GAEzB1mD,KAAK2mD,iBAAkB,EAEvB3mD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,EACtB7mD,KAAK8mD,WAAa,KAElB9mD,KAAK+mD,cAAgB,KACrB/mD,KAAKiuC,YAAc,KAEnBjuC,KAAK2pC,WAAa,CAAC,EAAG,GACtB3pC,KAAKgnD,gBAAkB,EACvBhnD,KAAKinD,iBAAkB,EACvBjnD,KAAKknD,mBAAoB,EACzBlnD,KAAK4pC,aAAa50B,IAAI,CAAC,EAAG,EAAG,EAAG,IAE5BhV,KAAKmnD,SACLnnD,KAAKmnD,SAEjB,EAQIrd,aAAa3lC,UAAUijD,SAAW,SAASrd,EAAOsd,GAC1CrnD,KAAK+pC,OAASA,IAIbsd,GACDrnD,KAAKlD,QAGJitC,IAAS/pC,KAAK+pC,OAKnBA,EAAMuE,aAAatuC,MAGfA,KAAKsnD,eACLtnD,KAAKsnD,aAAe,MAExBtnD,KAAKunD,UAAS,GAAM,IAVhBvnD,KAAK+pC,MAAM6G,aAAa5wC,MAWpC,EAQI8pC,aAAa3lC,UAAUqjD,YAAc,WAEjC,OAAGxnD,KAAKsnD,aAAavwD,OACViJ,KAAKsnD,aAAa,GACtBtnD,KAAK+pC,KACf,EAQDD,aAAa3lC,UAAUsjD,aAAe,SAAS1d,GAC3C,IAAKA,EACD,KAAM,uBAGV,GAAI/pC,KAAK+pC,OAASA,EACd,KAAM,2BAGV/pC,KAAKlD,QAEDkD,KAAK+pC,QACA/pC,KAAKsnD,eACNtnD,KAAKsnD,aAAe,IAExBtnD,KAAKsnD,aAAajsD,KAAK2E,KAAK+pC,QAGhCA,EAAMuE,aAAatuC,MACnBA,KAAK0nD,cACL1nD,KAAKunD,UAAS,GAAM,EAC5B,EAQIzd,aAAa3lC,UAAUwjD,cAAgB,WACnC,GAAK3nD,KAAKsnD,cAA4C,GAA5BtnD,KAAKsnD,aAAavwD,OAA5C,CAGA,IAAI6wD,EAAgB5nD,KAAK+pC,MAAM8d,eAC3B9d,EAAQ/pC,KAAKsnD,aAAa5qD,MAC9BsD,KAAK+0C,eAAiB,GACtB/0C,KAAK0mD,kBAAoB,GACzB3c,EAAMuE,aAAatuC,MACnBA,KAAKunD,UAAS,GAAM,GAChBK,IACA5nD,KAAK8nD,aAAaF,GAClB5nD,KAAK+nD,YAAY,CAACH,KAGtB5nD,KAAKkqC,GAAGb,OAAS,CAAC,EAAG,GACrBrpC,KAAKkqC,GAAGZ,MAAQ,CAbf,CAcT,EAOIQ,aAAa3lC,UAAU6jD,gBAAkB,WACrC,OAAOhoD,KAAK+pC,KACpB,EAQID,aAAa3lC,UAAUoqC,UAAY,SAAS1jB,EAAQue,GAGhD,GAAIve,GACIA,EAAO/qB,cAAgBqM,UACvB0e,EAASp0B,SAASwxD,eAAep9B,IAE7B,KAAM,oDAKlB,GAAIA,IAAW7qB,KAAK6qB,UAIfA,GAAU7qB,KAAK6qB,SAEXue,GACDppC,KAAKkoD,gBAIbloD,KAAK6qB,OAASA,EACd7qB,KAAKkqC,GAAG3xC,QAAUsyB,EAEbA,GAAL,CAiBA,GAZAA,EAAO/jB,WAAa,gBACpB+jB,EAAOnyB,KAAOsH,KACd6qB,EAAOs9B,SAAW,IAGlBnoD,KAAKooD,SAAW,KACXpoD,KAAKooD,WACNpoD,KAAKooD,SAAW3xD,SAASC,cAAc,UACvCsJ,KAAKooD,SAAShlD,MAAQpD,KAAK6qB,OAAOznB,MAClCpD,KAAKooD,SAAS/kD,OAASrD,KAAK6qB,OAAOxnB,QAGd,MAArBwnB,EAAOC,WAAoB,CAC3B,GAAwB,UAApBD,EAAOw9B,UACP,KAAM,8EACNx9B,EAAOw9B,UAEX,KAAM,qCACT,CAGU,OADAroD,KAAK7C,IAAM0tB,EAAOC,WAAW,SAE/BD,EAAOy9B,cAKZtoD,KAAKuoD,eAOJnf,GACDppC,KAAK6pC,YAtCR,CAwCT,EAGIC,aAAa3lC,UAAUqkD,WAAa,SAAmB/rD,GAGnD,OADAA,EAAE6V,kBACK,CACf,EACIw3B,aAAa3lC,UAAUskD,cAAgB,SAAmBhsD,GAEtD,OADAA,EAAE6V,kBACK,CACf,EAMIw3B,aAAa3lC,UAAU0lC,WAAa,WAChC,IAAI7pC,KAAK0oD,eAAT,CAOA,IAAI79B,EAAS7qB,KAAK6qB,OAGdp0B,EADauJ,KAAK2oD,kBACIlyD,SAE1BuJ,KAAK4oD,oBAAsB5oD,KAAK6oD,iBAAiB79C,KAAKhL,MACtDA,KAAK8oD,qBAAuB9oD,KAAK+oD,kBAAkB/9C,KAAKhL,MAExDA,KAAKgpD,oBAAsBhpD,KAAKipD,iBAAiBj+C,KAAKhL,MACtDA,KAAKkpD,kBAAoBlpD,KAAKmpD,eAAen+C,KAAKhL,MAKlDu9B,UAAUqmB,mBAAmB/4B,EAAO,OAAQ7qB,KAAK4oD,qBAAqB,GACtE/9B,EAAO3xB,iBAAiB,aAAc8G,KAAK8oD,sBAAsB,GAEjEvrB,UAAUqmB,mBAAmB/4B,EAAO,KAAM7qB,KAAKkpD,mBAAmB,GAClE3rB,UAAUqmB,mBAAmB/4B,EAAO,OAAQ7qB,KAAKgpD,qBAEjDn+B,EAAO3xB,iBAAiB,cAAe8G,KAAKwoD,YAC5C39B,EAAO3xB,iBACH,iBACA8G,KAAK8oD,sBACL,GAaJ9oD,KAAKopD,cAAgBppD,KAAKqpD,WAAWr+C,KAAKhL,MAE1C6qB,EAAO3xB,iBAAiB,UAAW8G,KAAKopD,eAAe,GACvD3yD,EAASyC,iBAAiB,QAAS8G,KAAKopD,eAAe,GAGvDppD,KAAKspD,iBAAmBtpD,KAAKupD,YAAYv+C,KAAKhL,MAE9C6qB,EAAO3xB,iBAAiB,WAAY8G,KAAKwoD,YAAY,GACrD39B,EAAO3xB,iBAAiB,UAAW8G,KAAKwoD,YAAY,GACpD39B,EAAO3xB,iBAAiB,OAAQ8G,KAAKspD,kBAAkB,GACvDz+B,EAAO3xB,iBAAiB,YAAa8G,KAAKyoD,eAAe,GAEzDzoD,KAAK0oD,gBAAiB,CAtDrB,CAuDT,EAMI5e,aAAa3lC,UAAU+jD,aAAe,WAClC,GAAKloD,KAAK0oD,eAAV,CAOA,IACIjyD,EADauJ,KAAK2oD,kBACIlyD,SAE1B8mC,UAAUonB,sBAAsB3kD,KAAK6qB,OAAO,OAAQ7qB,KAAK4oD,qBACzDrrB,UAAUonB,sBAAsB3kD,KAAK6qB,OAAO,KAAM7qB,KAAK4oD,qBACvDrrB,UAAUonB,sBAAsB3kD,KAAK6qB,OAAO,OAAQ7qB,KAAK4oD,qBACzD5oD,KAAK6qB,OAAO1xB,oBACR,aACA6G,KAAK8oD,sBAET9oD,KAAK6qB,OAAO1xB,oBACR,iBACA6G,KAAK8oD,sBAET9oD,KAAK6qB,OAAO1xB,oBAAoB,UAAW6G,KAAKopD,eAChD3yD,EAAS0C,oBAAoB,QAAS6G,KAAKopD,eAC3CppD,KAAK6qB,OAAO1xB,oBAAoB,cAAe6G,KAAKwoD,YACpDxoD,KAAK6qB,OAAO1xB,oBAAoB,OAAQ6G,KAAKspD,kBAC7CtpD,KAAK6qB,OAAO1xB,oBAAoB,YAAa6G,KAAKyoD,eAQlDzoD,KAAK4oD,oBAAsB,KAC3B5oD,KAAK8oD,qBAAuB,KAC5B9oD,KAAKopD,cAAgB,KACrBppD,KAAKspD,iBAAmB,KAExBtpD,KAAK0oD,gBAAiB,CAnCrB,CAoCT,EAEI5e,aAAa0f,iBAAmB,SAAShzD,GACrC,IAAIizD,EAAWjzD,EAAIgH,QAAQ,MACV,GAAbisD,IACAjzD,EAAMA,EAAI8f,OAAO,EAAGmzC,IAExB,IAAIC,EAAQlzD,EAAIqtC,YAAY,KAC5B,OAAc,GAAV6lB,EACO,GAEJlzD,EAAI8f,OAAOozC,EAAQ,GAAGtlB,aACrC,EAOI0F,aAAa3lC,UAAUokD,YAAc,WACjC,GAAkB,oBAAPoB,GACP,KAAM,mDAEV,GAAiC,oBAAtBC,kBACP,KAAM,sDAGV5pD,KAAK6pD,GAAK7pD,KAAK7C,IAAMysD,kBAAkB5pD,KAAK6qB,QAC5C7qB,KAAK7C,IAAI2sD,OAAQ,EACjB9pD,KAAKooD,SAAWpoD,KAAK6qB,OACrB7qB,KAAK+pD,MAAQ/pD,KAAK6pD,GAClB7pD,KAAK6qB,OAAOy9B,eAAgB,CAOpC,EAUIxe,aAAa3lC,UAAUojD,SAAW,SAASyC,EAAU5B,GAC7C4B,IACAhqD,KAAK4mD,cAAe,GAEpBwB,IACApoD,KAAK6mD,gBAAiB,EAElC,EAQI/c,aAAa3lC,UAAUwkD,gBAAkB,WACrC,IAAK3oD,KAAK6qB,OACN,OAAO1hB,OAEX,IAAI4Z,EAAM/iB,KAAK6qB,OAAOo/B,cACtB,OAAOlnC,EAAImnC,aAAennC,EAAIonC,YACtC,EAOIrgB,aAAa3lC,UAAUsqC,eAAiB,WAChCzuC,KAAKoqD,eAITpqD,KAAKoqD,cAAe,EAGpB,SAASC,IACArqD,KAAKkrC,iBACNlrC,KAAKsqD,OAGT,IAAInhD,EAASnJ,KAAK2oD,kBACd3oD,KAAKoqD,cACLjhD,EAAO6nC,sBAAsBqZ,EAAYr/C,KAAKhL,MAErD,EAXW4D,KAAK5D,MAYzB,EAOI8pC,aAAa3lC,UAAUomD,cAAgB,WACnCvqD,KAAKoqD,cAAe,CAQ5B,EAKItgB,aAAa3lC,UAAUqmD,WAAa,WAEhCxqD,KAAKyqD,aAAc,EACnBzqD,KAAKgnD,gBAAkB,CAC1B,EAEDld,aAAa3lC,UAAU0kD,iBAAmB,SAASpsD,GAK/C,GAHIuD,KAAKksC,kCACLlsC,KAAK4mD,cAAe,GAEnB5mD,KAAK+pC,MAAV,CAIA/pC,KAAK0qD,iBAAiBjuD,GAEtB,IAAIkuD,EAAa3qD,KAAK2oD,kBACPgC,EAAWl0D,SAC1BqzC,aAAa8gB,cAAgB5qD,KAC7B,IAAIwe,EAAOxe,KAEPsL,EAAI7O,EAAEynD,QACN14C,EAAI/O,EAAE2nD,QAIVpkD,KAAKkqC,GAAGmE,SAAWruC,KAAKquC,SACxB,IAAImW,GAAaxkD,KAAKquC,UAAcruC,KAAKquC,UAAY/iC,GAAKtL,KAAKquC,SAAS,IAAM/iC,EAAKtL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,IAAO7iC,GAAKxL,KAAKquC,SAAS,IAAM7iC,EAAKxL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,GAU1L,GAPIruC,KAAK/G,QAAQmwC,cAEb7L,UAAUonB,sBAAsB3kD,KAAK6qB,OAAO,OAAQ7qB,KAAKgpD,qBACzDzrB,UAAUqmB,mBAAmB+G,EAAWl0D,SAAS,OAAQuJ,KAAKgpD,qBAAoB,GAClFzrB,UAAUqmB,mBAAmB+G,EAAWl0D,SAAS,KAAMuJ,KAAKkpD,mBAAkB,IAG9E1E,EAAJ,CAIA,IAAI9sD,EAAOsI,KAAK+pC,MAAMyL,aAAc/4C,EAAEshD,QAASthD,EAAEuhD,QAASh+C,KAAKumD,cAAe,GAE1EsE,GAAc,EACdhc,EAAMtR,UAAUqR,UAChBkc,OAA8B5gC,IAAhBztB,EAAEsuD,YAA4BtuD,EAAEsuD,UAC9CC,EAAmBnc,EAAM7uC,KAAKgnD,gBAAkB,IAoBpD,GAnBAhnD,KAAK+sC,MAAM,GAAKtwC,EAAEynD,QAClBlkD,KAAK+sC,MAAM,GAAKtwC,EAAE2nD,QAClBpkD,KAAKgtC,YAAY,GAAKvwC,EAAEshD,QACxB/9C,KAAKgtC,YAAY,GAAKvwC,EAAEuhD,QACxBh+C,KAAKirD,oBAAsB,CAACjrD,KAAK+sC,MAAM,GAAG/sC,KAAK+sC,MAAM,IAEjD/sC,KAAKinD,iBAAmB6D,EACxB9qD,KAAKknD,mBAAoB,EAGzBlnD,KAAKknD,mBAAoB,EAE7BlnD,KAAKinD,iBAAkB,EAGvBjnD,KAAK6qB,OAAOxY,QAEZkrB,UAAU2tB,qBAAqBP,IAE3B3qD,KAAKotC,SAEkB,GAAnBptC,KAAKotC,QAAQ3wC,GAFrB,CAOA,GAAe,GAAXA,EAAE0uD,OAAenrD,KAAKknD,kBAqSnB,GAAe,GAAXzqD,EAAE0uD,MAAY,CAGrB,GAAI5tB,UAAU8F,oCACN3rC,GAAQsI,KAAK2rC,oBAAsBkf,IAAgB7qD,KAAKqrC,YAGnDrrC,KAAKymD,kBACL/uD,EAAK0uC,MAAM0Y,YACX9+C,KAAKurC,UACR,CACE,IAAI6f,GAAY,EACZC,GAAkB,EAClBC,GAAkB,EAEtB,GAAI5zD,EAAKw/B,QACL,IAAU7+B,EAAI,EAAGqH,EAAIhI,EAAKw/B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAAI,CAC/C8+B,EAASz/B,EAAKw/B,QAAQ7+B,GACtBmnD,EAAW9nD,EAAK+nD,kBAAiB,EAAOpnD,GAC5C,GAAI6lD,kBAAkBzhD,EAAEshD,QAAQthD,EAAEuhD,QAAQwB,EAAS,GAAK,GAAGA,EAAS,GAAK,GAAG,GAAG,IAAK,CAChF4L,EAAYj0B,EACZk0B,EAAkBhzD,EAClBizD,GAAkB,EAClB,KACH,CACJ,CAIL,GAAI5zD,EAAKu/B,OACL,IAAU5+B,EAAI,EAAGqH,EAAIhI,EAAKu/B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAI,CAC9C4B,EAAQvC,EAAKu/B,OAAO5+B,GACpBmnD,EAAW9nD,EAAK+nD,kBAAiB,EAAMpnD,GAC3C,GAAI6lD,kBAAkBzhD,EAAEshD,QAAQthD,EAAEuhD,QAAQwB,EAAS,GAAK,GAAGA,EAAS,GAAK,GAAG,GAAG,IAAK,CAChF4L,EAAYnxD,EACZoxD,EAAkBhzD,EAClBizD,GAAkB,EAClB,KACH,CACJ,CAGL,GAAIF,IAA+B,IAAlBC,EAAwB,CAErC,IAAIE,EAAY,IAAMF,EAAgB,IAAKC,EAAgB5zD,EAAKw/B,QAAQngC,OAAOW,EAAKu/B,OAAOlgC,QACvF0sD,EAAgB/rD,EAAKgnD,cAErB8M,EAAS,CAAIF,EAAiC7H,EAAc,GAAGA,EAAc,GAAhDA,EAAc,GAC1ChnD,EAAEuhD,QAAQ,IAEGh+C,KAAKyrD,yBAAyB,CAAKC,SAAWJ,EAAqB5zD,EAAL,KAC3Ei0D,SAAWL,EAAqBD,EAAL,KAC3BO,OAASN,EAAqB,KAAL5zD,EACzBm0D,OAASP,EAAgC,KAAhBD,EACzBx7B,SAAU27B,EACVM,SAAU,OACVC,OAAO,CAAET,EAAoB,IAAH,GAAkB,KAAVC,GAClCS,WAAW,CAAEV,EAAmB,GAAF,EAAK,KAExCT,GAAc,CACjB,CACJ,EAIJA,GAAe7qD,KAAKyrC,mBAErBzrC,KAAK2mD,iBAAkB,EAI9B,MAAqB,GAAXlqD,EAAE0uD,OAAcnrD,KAAKknD,sBAGxBlnD,KAAK2rC,mBAAsBkf,GAAgB7qD,KAAKqrC,YAG5C3zC,IACGhC,OAAOoB,KAAKkJ,KAAK+0C,gBAAgBh+C,SAC5BiJ,KAAK+0C,eAAer9C,EAAK6K,KAAO9F,EAAE8V,UAAY9V,EAAEwvD,SAAWxvD,EAAEyvD,SAG5DlsD,KAAK+0C,eAAer9C,EAAK6K,KAAKvC,KAAK+nD,YAAY,CAACrwD,IAAM,GAG3DsI,KAAK+nD,YAAY,CAACrwD,KAK1BsI,KAAKmsD,mBAAmBz0D,EAAM+E,SA9XtC,CACQA,EAAEwvD,UAEFjsD,KAAKisC,mBAAqB,IAAIjD,aAAa,GAC3ChpC,KAAKisC,mBAAmB,GAAKxvC,EAAEshD,QAC/B/9C,KAAKisC,mBAAmB,GAAKxvC,EAAEuhD,QAC/Bh+C,KAAKisC,mBAAmB,GAAK,EAC7BjsC,KAAKisC,mBAAmB,GAAK,EAC7B4e,GAAc,GAIdttB,UAAU2F,yBAA2BzmC,EAAE2vD,QAAU10D,GAAQsI,KAAK2rC,oBAAsBkf,IAAgB7qD,KAAKqrC,YAErGghB,OAAS30D,EAAK0iD,WACdiS,OAAO31B,IAAI,IAAM,EACjB21B,OAAO31B,IAAI,IAAM,EACjB12B,KAAK+pC,MAAMltC,IAAIwvD,QAAO,EAAM,CAACC,YAAY,IACzC50D,EAAO20D,OACPxB,GAAc,EACT0B,IACGvsD,KAAK0rC,kBACL1rC,KAAK+pC,MAAM6K,eACX50C,KAAKg1C,aAAet9C,GAEnBsI,KAAK+0C,eAAer9C,EAAK6K,KAC1BvC,KAAKwsD,oBAAoB90D,EAAM+E,KAM/C,IAAIgwD,GAAqB,EAIzB,IAAI/0D,IAASsI,KAAK2rC,oBAAqBj0C,EAAK0uC,MAAMuF,mBAAuBkf,GAAgB7qD,KAAKqrC,WA4M1F,IAAKwf,EAAY,CAEb,IAAI7qD,KAAKqrC,UACL,IAAK,IAAIhzC,EAAI,EAAGA,EAAI2H,KAAKouC,cAAcr3C,SAAUsB,EAAG,CAChD,IAAIgb,EAAOrT,KAAKouC,cAAc/1C,GAC1BstD,EAAStyC,EAAK01B,KAClB,MACK4c,GACDlpD,EAAEshD,QAAU4H,EAAO,GAAK,GACxBlpD,EAAEshD,QAAU4H,EAAO,GAAK,GACxBlpD,EAAEuhD,QAAU2H,EAAO,GAAK,GACxBlpD,EAAEuhD,QAAU2H,EAAO,GAAK,GAL5B,CAUA3lD,KAAK0sD,aAAar5C,EAAM5W,GACxBuD,KAAKkuC,iBAAmB,KACxB,KAJC,CAKJ,CAKL,GAFAluC,KAAKsmD,eAAiBtmD,KAAK+pC,MAAM8L,cAAep5C,EAAEshD,QAASthD,EAAEuhD,SAC7Dh+C,KAAK2sD,yBAA0B,EAC3B3sD,KAAKsmD,iBAAmBtmD,KAAKqrC,UACzB5uC,EAAEwvD,UACFjsD,KAAKisC,mBAAqB,MAGnB2gB,SAAU,CAACnwD,EAAEshD,QAASthD,EAAEuhD,SAAU,CAAEh+C,KAAKsmD,eAAe5vB,IAAI,GAAK12B,KAAKsmD,eAAejxC,KAAK,GAAIrV,KAAKsmD,eAAe5vB,IAAI,GAAK12B,KAAKsmD,eAAejxC,KAAK,KACpJrV,KAAKkqC,GAAGZ,MAAQ,GACvBtpC,KAAK2sD,yBAA0B,EAE/B3sD,KAAKsmD,eAAe9C,uBAIxBwH,IAAoBhrD,KAAKqrC,WAAarrC,KAAK6rC,kBAC3C7rC,KAAK6sD,cAAcpwD,GACnBA,EAAE6V,iBACF7V,EAAE2oD,mBAGNqH,GAAqB,CACxB,MAxPoG,CAMrG,GALKzsD,KAAKurC,WAAc7zC,EAAK0uC,MAAMwc,QAC/B5iD,KAAK8sD,aAAap1D,GAIjBsI,KAAK2rC,oBAAsB3rC,KAAKymD,kBAAoB/uD,EAAK0uC,MAAM0Y,YAAc9+C,KAAKurC,UAEnF,IAAMsf,IACiB,IAAnBnzD,EAAKq1D,WAAuBr1D,EAAKomD,eAAerhD,EAAEshD,QAASthD,EAAEuhD,SAE7Dh+C,KAAK+pC,MAAM6K,eACX50C,KAAKgtD,cAAgBt1D,EACrBsI,KAAK6qB,OAAOxwB,MAAM4yD,OAAS,YAC3BpC,GAAc,MACX,CAEH,GAAInzD,EAAKw/B,QACL,IAAM,IAAI7+B,EAAI,EAAGqH,EAAIhI,EAAKw/B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAAI,CACnD,IAAI8+B,EAASz/B,EAAKw/B,QAAQ7+B,GACtBmnD,EAAW9nD,EAAK+nD,kBAAiB,EAAOpnD,GAC5C,GACI6lD,kBACIzhD,EAAEshD,QACFthD,EAAEuhD,QACFwB,EAAS,GAAK,GACdA,EAAS,GAAK,GACd,GACA,IAEN,CACEx/C,KAAKymD,gBAAkB/uD,EACvBsI,KAAKktD,kBAAoB/1B,EACzBn3B,KAAKktD,kBAAkBC,WAAa90D,EACpC2H,KAAKotD,eAAiB11D,EAAK+nD,kBAAkB,EAAOpnD,GACpD2H,KAAKqtD,gBAAkBh1D,EAEnBklC,UAAU+E,gCACN7lC,EAAE8V,UACF7a,EAAKo9C,iBAAiBz8C,GAI1B2yD,EACItzD,EAAK41D,kBACL51D,EAAK41D,iBAAiBj1D,EAAGoE,GAGzB/E,EAAK61D,eACL71D,EAAK61D,cAAcl1D,EAAGoE,GAI9BouD,GAAc,EACd,KACH,CACJ,CAIL,GAAInzD,EAAKu/B,OACL,IAAM,IAAI5+B,EAAI,EAAGqH,EAAIhI,EAAKu/B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAI,CAClD,IAAI4B,EAAQvC,EAAKu/B,OAAO5+B,GACpBmnD,EAAW9nD,EAAK+nD,kBAAiB,EAAMpnD,GAC3C,GACI6lD,kBACIzhD,EAAEshD,QACFthD,EAAEuhD,QACFwB,EAAS,GAAK,GACdA,EAAS,GAAK,GACd,GACA,IAEN,CAWE,GAVIwL,EACItzD,EAAK81D,iBACL91D,EAAK81D,gBAAgBn1D,EAAGoE,GAGxB/E,EAAK+1D,cACL/1D,EAAK+1D,aAAap1D,EAAGoE,GAIV,OAAfxC,EAAMoZ,KAAe,CACrB,IAAI4kC,EAAYj4C,KAAK+pC,MAAMnd,MACvB3yB,EAAMoZ,MAENkqB,UAAUgF,yBACV7qC,EAAKm9C,gBAAgBx8C,GACrB2H,KAAK6mD,gBAAiB,EACtBgE,GAAc,IAMd7qD,KAAK8rC,uBAELrvC,EAAE8V,YAEGgrB,UAAUgF,wBACX7qC,EAAKm9C,gBAAgBx8C,GAEzB2H,KAAKymD,gBAAkBzmD,KAAK+pC,MAAMwF,aAC9B0I,EAAUvP,WAEd1oC,KAAKqtD,gBACDpV,EAAUtP,YACd3oC,KAAKktD,kBAAoBltD,KAAKymD,gBAAgBvvB,QAC1Cl3B,KAAKqtD,iBAETrtD,KAAKotD,eAAiBptD,KAAKymD,gBAAgBhH,kBAAkB,EAAOz/C,KAAKqtD,iBAEzErtD,KAAK6mD,gBAAiB,EACtBgE,GAAc,EAMrB,CAEIA,IAED7qD,KAAKymD,gBAAkB/uD,EACvBsI,KAAK0tD,iBAAmBzzD,EACxB+F,KAAK0tD,iBAAiBP,WAAa90D,EACnC2H,KAAKotD,eAAiB11D,EAAK+nD,kBAAkB,EAAMpnD,GACnD2H,KAAKqtD,gBAAkBh1D,EAEvB2H,KAAK6mD,gBAAiB,EACtBgE,GAAc,EAErB,CACJ,CAER,CAIL,IAAKA,EAAa,CACd,IAAI0B,GAAkB,EACnB70D,GAAQA,EAAK0uC,OAAS1uC,EAAK0uC,MAAMwc,SAChC2J,GAAkB,GAEtB,IAAI71B,EAAM,CAACj6B,EAAEshD,QAAUrmD,EAAKg/B,IAAI,GAAIj6B,EAAEuhD,QAAUtmD,EAAKg/B,IAAI,IAGrDqF,EAAS/7B,KAAK2tD,mBAAoBj2D,EAAMsI,KAAKgtC,YAAavwC,GAiB9D,GAhBIs/B,IACAwwB,GAAkB,EAClBvsD,KAAKiuC,YAAc,CAACv2C,EAAMqkC,IAI1B/7B,KAAK2rC,mBAAqBqf,GAAmBhrD,KAAK+0C,eAAer9C,EAAK6K,MAElE7K,EAAKk2D,YACLl2D,EAAKk2D,WAAYnxD,EAAGi6B,EAAK12B,MAE7BA,KAAK6tD,sBAAsBn2D,GAC3B60D,GAAkB,GAIjB70D,EAAKo2D,aAAep2D,EAAKo2D,YAAarxD,EAAGi6B,EAAK12B,MAC/CusD,GAAkB,MACf,CAEH,GAAG70D,EAAKq2D,WAAar2D,EAAKs2D,uBAEhBt2D,EAAK0uC,MAAM0Y,WAAapoB,EAAI,GAAKh/B,EAAK2d,KAAK,GAAKkoB,UAAUG,mBAAqBhH,EAAI,GAAK,EAAI,CAC1FlY,EAAOxe,KACXsN,YAAW,WACPkR,EAAKipC,aAAa/vD,EAAKq2D,SAC1B,GAAE,GACN,CAGD/tD,KAAKurC,YACLkhB,GAAqB,EACrBF,GAAkB,EAEzB,CAEIA,EAWI70D,EAAKu2D,aAAajuD,KAAKwsD,oBAAoB90D,EAAM+E,IAVlDuD,KAAK0rC,kBACL1rC,KAAK+pC,MAAM6K,eACX50C,KAAKg1C,aAAet9C,GAExBsI,KAAKwsD,oBAAoB90D,EAAM+E,IASnCuD,KAAK4mD,cAAe,CACvB,CACJ,EAiDIiE,GAAe4B,GAAsBzsD,KAAKyrC,mBAE3CzrC,KAAK2mD,iBAAkB,EAGvC,CA+HQ,OA5BA3mD,KAAK2pC,WAAW,GAAKltC,EAAEynD,QACvBlkD,KAAK2pC,WAAW,GAAKltC,EAAE2nD,QACvBpkD,KAAKgnD,gBAAkBzpB,UAAUqR,UACjC5uC,KAAKkuD,qBAAsB,EAO3BluD,KAAK+pC,MAAM0G,WAINka,EAAWl0D,SAAS03D,eAEjB,SADHxD,EAAWl0D,SAAS03D,cAAcC,SAAShqB,eAGxC,YADAumB,EAAWl0D,SAAS03D,cAAcC,SAAShqB,gBAG/C3nC,EAAE6V,iBAEN7V,EAAE2oD,kBAEEplD,KAAK8tD,aACL9tD,KAAK8tD,YAAYrxD,IAGd,CAvaN,CA/BA,CA3BA,CAkeT,EAMIqtC,aAAa3lC,UAAU8kD,iBAAmB,SAASxsD,GAQ/C,GAPIuD,KAAK0uC,YACL1uC,KAAKquD,SAGLruD,KAAKksC,kCACLlsC,KAAK4mD,cAAe,GAEnB5mD,KAAK+pC,MAAV,CAIAD,aAAa8gB,cAAgB5qD,KAC7BA,KAAK0qD,iBAAiBjuD,GACtB,IAAIswC,EAAQ,CAACtwC,EAAEynD,QAASznD,EAAE2nD,SAC1BpkD,KAAK+sC,MAAM,GAAKA,EAAM,GACtB/sC,KAAK+sC,MAAM,GAAKA,EAAM,GACtB,IAAIkY,EAAQ,CACRlY,EAAM,GAAK/sC,KAAK2pC,WAAW,GAC3BoD,EAAM,GAAK/sC,KAAK2pC,WAAW,IAQ/B,GANA3pC,KAAK2pC,WAAaoD,EAClB/sC,KAAKgtC,YAAY,GAAKvwC,EAAEshD,QACxB/9C,KAAKgtC,YAAY,GAAKvwC,EAAEuhD,QAIrBh+C,KAAKyqD,YAIJ,OADAhuD,EAAE6V,kBACK,EAGX7V,EAAE8nD,SAAWvkD,KAAKkuD,oBAEdluD,KAAKiuC,cACLjuC,KAAK2tD,mBACD3tD,KAAKiuC,YAAY,GACjBjuC,KAAKgtC,YACLvwC,EACAuD,KAAKiuC,YAAY,IAErBjuC,KAAK4mD,cAAe,GAIxB,IAAIlvD,EAAOsI,KAAK+pC,MAAMyL,aAAa/4C,EAAEshD,QAAQthD,EAAEuhD,QAAQh+C,KAAKumD,eAE5D,GAAIvmD,KAAKisC,mBAELjsC,KAAKisC,mBAAmB,GAAKxvC,EAAEshD,QAAU/9C,KAAKisC,mBAAmB,GACjEjsC,KAAKisC,mBAAmB,GAAKxvC,EAAEuhD,QAAUh+C,KAAKisC,mBAAmB,GACjEjsC,KAAK4mD,cAAe,OAEnB,GAAI5mD,KAAKsmD,iBAAmBtmD,KAAKqrC,UACtC,CAEI,GAAIrrC,KAAK2sD,wBACL3sD,KAAKsmD,eAAejxC,KAAO,CACvB5Y,EAAEshD,QAAU/9C,KAAKsmD,eAAe5vB,IAAI,GACpCj6B,EAAEuhD,QAAUh+C,KAAKsmD,eAAe5vB,IAAI,QAErC,CACH,IAAI2sB,EAAS4B,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MAC5Bga,EAAS2B,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MAChCtpC,KAAKsmD,eAAelD,KAAKC,EAAQC,EAAQ7mD,EAAEwvD,SACvCjsD,KAAKsmD,eAAejX,OAAOt4C,SAC3BiJ,KAAK4mD,cAAe,EAE3B,CACD5mD,KAAK6mD,gBAAiB,CAClC,MAAe,GAAI7mD,KAAK2mD,gBAEZ3mD,KAAKkqC,GAAGb,OAAO,IAAM4b,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MACxCtpC,KAAKkqC,GAAGb,OAAO,IAAM4b,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MACxCtpC,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,OACnB,IAAK7mD,KAAK2rC,mBAAsBj0C,GAAQA,EAAK0uC,MAAMuF,qBAAwB3rC,KAAKqrC,UAAW,CAC1FrrC,KAAKymD,kBACLzmD,KAAK4mD,cAAe,GAIxB,IAAK,IAAIvuD,EAAI,EAAGqH,EAAIM,KAAK+pC,MAAMsF,OAAOt4C,OAAQsB,EAAIqH,IAAKrH,EAC/C2H,KAAK+pC,MAAMsF,OAAOh3C,GAAGi2D,WAAa52D,GAAQsI,KAAK+pC,MAAMsF,OAAOh3C,KAE5D2H,KAAK+pC,MAAMsF,OAAOh3C,GAAGi2D,WAAY,EAC7BtuD,KAAKwmD,WAAaxmD,KAAKwmD,UAAU+H,cACjCvuD,KAAKwmD,UAAU+H,aAAa9xD,GAEhCuD,KAAKwmD,UAAY,KACjBxmD,KAAK4mD,cAAe,GAK5B,GAAIlvD,EAAM,CAuBN,GArBGA,EAAK82D,kBACJxuD,KAAK4mD,cAAe,GAGnBlvD,EAAK42D,YAEN52D,EAAK42D,WAAY,EACjBtuD,KAAKwmD,UAAY9uD,EACjBsI,KAAK4mD,cAAe,EAEhBlvD,EAAK+2D,cACL/2D,EAAK+2D,aAAahyD,IAKtB/E,EAAKg3D,aACLh3D,EAAKg3D,YAAajyD,EAAG,CAACA,EAAEshD,QAAUrmD,EAAKg/B,IAAI,GAAIj6B,EAAEuhD,QAAUtmD,EAAKg/B,IAAI,IAAK12B,MAIzEA,KAAKymD,gBAEL,GAAIzmD,KAAKktD,kBAAkB,CAEvB,IAAIx2B,EAAM12B,KAAK2uD,kBAAoB,CAAC,EAAG,GAGvC,GAAI3uD,KAAK4uD,cAAcl3D,EAAM+E,EAAEshD,QAASthD,EAAEuhD,eAKtC,IAAa,IADT1kB,EAAOt5B,KAAK6uD,gBAAiBn3D,EAAM+E,EAAEshD,QAASthD,EAAEuhD,QAAStnB,KAC3Ch/B,EAAKu/B,OAAOqC,GAAO,CACjC,IAAIoL,EAAYhtC,EAAKu/B,OAAOqC,GAAM34B,KAC7B48B,UAAU+J,kBAAmBtnC,KAAKktD,kBAAkBvsD,KAAM+jC,KAC3D1kC,KAAK2uD,iBAAmBj4B,EACxB12B,KAAK8uD,sBAAwBp3D,EAAKu/B,OAAOqC,GAE7E,MACgCt5B,KAAK2uD,iBAAmB,KACxB3uD,KAAK8uD,sBAAwB,IAI7D,MAA0B,GAAG9uD,KAAK0tD,iBAAiB,CAE3B,IAOQp0B,EAPJ5C,EAAM12B,KAAK+uD,mBAAqB,CAAC,EAAG,GAGxC,GAAI/uD,KAAK4uD,cAAcl3D,EAAM+E,EAAEshD,QAASthD,EAAEuhD,eAKtC,IAAa,IADT1kB,EAAOt5B,KAAKgvD,iBAAkBt3D,EAAM+E,EAAEshD,QAASthD,EAAEuhD,QAAStnB,KAC5Ch/B,EAAKw/B,QAAQoC,GAAO,CAC9BoL,EAAYhtC,EAAKw/B,QAAQoC,GAAM34B,KAC9B48B,UAAU+J,kBAAmBtnC,KAAK0tD,iBAAiB/sD,KAAM+jC,KAC1D1kC,KAAK+uD,kBAAoBr4B,EAE7D,MACgC12B,KAAK+uD,kBAAoB,IAGpC,CAID/uD,KAAK6qB,SACDnzB,EAAKomD,eAAerhD,EAAEshD,QAASthD,EAAEuhD,SACjCh+C,KAAK6qB,OAAOxwB,MAAM4yD,OAAS,YAE3BjtD,KAAK6qB,OAAOxwB,MAAM4yD,OAAS,YAGnD,KAAmB,CAGH,IAAIgC,EAAY,KAChB,IAAS52D,EAAI,EAAGA,EAAI2H,KAAKouC,cAAcr3C,SAAUsB,EAAG,CAChD,IAAIgb,EAAOrT,KAAKouC,cAAc/1C,GAC1BstD,EAAStyC,EAAK01B,KAClB,MACK4c,GACDlpD,EAAEshD,QAAU4H,EAAO,GAAK,GACxBlpD,EAAEshD,QAAU4H,EAAO,GAAK,GACxBlpD,EAAEuhD,QAAU2H,EAAO,GAAK,GACxBlpD,EAAEuhD,QAAU2H,EAAO,GAAK,GAL5B,CASAsJ,EAAY57C,EACZ,KAFC,CAGJ,CACG47C,GAAajvD,KAAKkuC,mBAElBluC,KAAKkuC,iBAAmB+gB,EACxBjvD,KAAK4mD,cAAe,GAGpB5mD,KAAK6qB,SACL7qB,KAAK6qB,OAAOxwB,MAAM4yD,OAAS,GAElC,CAQD,GALKjtD,KAAKuiD,sBAAwBviD,KAAKuiD,sBAAwB7qD,GAAQsI,KAAKuiD,qBAAqBmM,aAC7F1uD,KAAKuiD,qBAAqBmM,YAAYjyD,EAAE,CAACA,EAAEshD,QAAU/9C,KAAKuiD,qBAAqB7rB,IAAI,GAAGj6B,EAAEuhD,QAAUh+C,KAAKuiD,qBAAqB7rB,IAAI,IAAK12B,MAIrIA,KAAKg1C,eAAiBh1C,KAAKurC,UAAW,CAEtC,IAAK,IAAIlzC,KAAK2H,KAAK+0C,eAAgB,CAC/B,IAAItxC,EAAIzD,KAAK+0C,eAAe18C,GAC5BoL,EAAEizB,IAAI,IAAMuuB,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MAC/B7lC,EAAEizB,IAAI,IAAMuuB,EAAM,GAAKjlD,KAAKkqC,GAAGZ,MAC1B7lC,EAAEwqD,aAAajuD,KAAKwsD,oBAAoB/oD,EAAGhH,EAInD,CAEDuD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,CACzB,CAED,GAAI7mD,KAAKgtD,gBAAkBhtD,KAAKurC,UAAW,CAEvC,IAAI2jB,EAAe,CAAEzyD,EAAEshD,QAAU/9C,KAAKgtD,cAAct2B,IAAI,GAAIj6B,EAAEuhD,QAAUh+C,KAAKgtD,cAAct2B,IAAI,IAC3Fy4B,EAAWnvD,KAAKgtD,cAAc3mB,cAClC6oB,EAAa,GAAK5iD,KAAKC,IAAK4iD,EAAS,GAAID,EAAa,IACtDA,EAAa,GAAK5iD,KAAKC,IAAK4iD,EAAS,GAAID,EAAa,IACtDlvD,KAAKgtD,cAAcrQ,QAASuS,GAE5BlvD,KAAK6qB,OAAOxwB,MAAM4yD,OAAS,YAC3BjtD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,CACzB,CACJ,CAGD,OADApqD,EAAE6V,kBACK,CAvON,CAwOT,EAMIw3B,aAAa3lC,UAAUglD,eAAiB,SAAS1sD,GAE7C,IAAIquD,OAA+B5gC,IAAhBztB,EAAEsuD,WAA2BtuD,EAAEsuD,UAGlD,IAAID,EAIA,OAAO,EAQX,GAHI9qD,KAAKksC,kCACLlsC,KAAK4mD,cAAe,GAEnB5mD,KAAK+pC,MAAV,CAGA,IACItzC,EADSuJ,KAAK2oD,kBACIlyD,SACtBqzC,aAAa8gB,cAAgB5qD,KAGzBA,KAAK/G,QAAQmwC,cAGb7L,UAAUonB,sBAAsBluD,EAAS,OAAQuJ,KAAKgpD,qBAAoB,GAC1EzrB,UAAUqmB,mBAAmB5jD,KAAK6qB,OAAO,OAAQ7qB,KAAKgpD,qBAAoB,GAC1EzrB,UAAUonB,sBAAsBluD,EAAS,KAAMuJ,KAAKkpD,mBAAkB,IAG1ElpD,KAAK0qD,iBAAiBjuD,GACtB,IAAIoyC,EAAMtR,UAAUqR,UAapB,GAZAnyC,EAAE2yD,WAAavgB,EAAM7uC,KAAKgnD,gBAC1BhnD,KAAKkuD,qBAAsB,EAC3BluD,KAAKirD,oBAAsB,KAExBjrD,KAAKyqD,cAGJzqD,KAAKyqD,aAAc,GAKR,GAAXhuD,EAAE0uD,MAAY,CAUd,GARInrD,KAAKiuC,aAELjuC,KAAK2tD,mBAAoB3tD,KAAKiuC,YAAY,GAAIjuC,KAAKgtC,YAAavwC,GAIpEuD,KAAKiuC,YAAc,KAEfjuC,KAAKsmD,eAAgB,CACrB,IAAI+I,EACArvD,KAAKsmD,eAAe5vB,IAAI,GACxBpqB,KAAK01C,MAAMhiD,KAAKsmD,eAAe5vB,IAAI,IACnC44B,EACAtvD,KAAKsmD,eAAe5vB,IAAI,GACxBpqB,KAAK01C,MAAMhiD,KAAKsmD,eAAe5vB,IAAI,IACvC12B,KAAKsmD,eAAelD,KAAKiM,EAAOC,EAAO7yD,EAAEwvD,SACzCjsD,KAAKsmD,eAAe5vB,IAAI,GAAKpqB,KAAK01C,MAC9BhiD,KAAKsmD,eAAe5vB,IAAI,IAE5B12B,KAAKsmD,eAAe5vB,IAAI,GAAKpqB,KAAK01C,MAC9BhiD,KAAKsmD,eAAe5vB,IAAI,IAExB12B,KAAKsmD,eAAejX,OAAOt4C,SAC3BiJ,KAAK4mD,cAAe,GAExB5mD,KAAKsmD,eAAiB,IACzB,CACDtmD,KAAK2sD,yBAA0B,EAE/B,IAAIj1D,EAAOsI,KAAK+pC,MAAMyL,aAClB/4C,EAAEshD,QACFthD,EAAEuhD,QACFh+C,KAAKumD,eAGT,GAAIvmD,KAAKisC,mBAAoB,CACzB,GAAIjsC,KAAK+pC,MAAO,CACZ,IAAItqC,EAAQO,KAAK+pC,MAAMsF,OACnBoU,EAAgB,IAAIza,aAAa,GAGjCv+B,EAAI6B,KAAKE,IAAIxM,KAAKisC,mBAAmB,IACrCnhC,EAAIwB,KAAKE,IAAIxM,KAAKisC,mBAAmB,IACrC6X,EACA9jD,KAAKisC,mBAAmB,GAAK,EACvBjsC,KAAKisC,mBAAmB,GAAKxhC,EAC7BzK,KAAKisC,mBAAmB,GAC9B8X,EACA/jD,KAAKisC,mBAAmB,GAAK,EACvBjsC,KAAKisC,mBAAmB,GAAKnhC,EAC7B9K,KAAKisC,mBAAmB,GAOlC,GANAjsC,KAAKisC,mBAAmB,GAAK6X,EAC7B9jD,KAAKisC,mBAAmB,GAAK8X,EAC7B/jD,KAAKisC,mBAAmB,GAAKxhC,EAC7BzK,KAAKisC,mBAAmB,GAAKnhC,GAGxBpT,GAAS+S,EAAI,IAAMK,EAAI,GAAK,CAG7B,IADA,IAAIykD,EAAY,GACPl3D,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAAG,CACnC,IAAIm3D,EAAQ/vD,EAAMpH,GAClBm3D,EAAM9Q,YAAY+E,GAEbC,gBACG1jD,KAAKisC,mBACLwX,IAKR8L,EAAUl0D,KAAKm0D,EAClB,CACGD,EAAUx4D,QACViJ,KAAK+nD,YAAYwH,EAAU9yD,EAAE8V,SAEzD,MAEwBvS,KAAK+nD,YAAY,CAACrwD,GAAM+E,EAAE8V,UAAU9V,EAAEwvD,QAG7C,CACDjsD,KAAKisC,mBAAqB,IAC1C,MAAmB,GAAIjsC,KAAKymD,gBAAiB,CAE7BzmD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,EAEtB,IACI4I,GADczvD,KAAKktD,mBAAqBltD,KAAK0tD,kBACtB/sD,KAG3B,GAAIjJ,GAkBA,GAAIsI,KAAKktD,mBAOQ,IALT5zB,EAAOt5B,KAAK6uD,gBACZn3D,EACA+E,EAAEshD,QACFthD,EAAEuhD,UAGFh+C,KAAKymD,gBAAgBzF,QAAQhhD,KAAKqtD,gBAAiB31D,EAAM4hC,GAIzDt5B,KAAKymD,gBAAgB/F,cAAc1gD,KAAKqtD,gBAAgB31D,EAAK+3D,QAG/D,GAAIzvD,KAAK0tD,iBAAiB,CAE5B,IAAIp0B,GAMS,IANTA,EAAOt5B,KAAKgvD,iBACZt3D,EACA+E,EAAEshD,QACFthD,EAAEuhD,UAIFtmD,EAAKspD,QAAQ1nB,EAAMt5B,KAAKymD,gBAAiBzmD,KAAKqtD,iBAI9CrtD,KAAKymD,gBAAgBxF,oBAAoBjhD,KAAKqtD,gBAAgB31D,EAAK+3D,EAG1E,OAQGlyB,UAAU+F,mCACN7mC,EAAE8V,UAAYvS,KAAK6rC,gBAChB7rC,KAAKktD,kBACJltD,KAAK6sD,cAAcpwD,EAAE,CAACizD,UAAW1vD,KAAKymD,gBAAiBkJ,UAAW3vD,KAAKktD,kBAAmB0C,eAAgB5vD,KAAKktD,kBAAkBvsD,OAC5HX,KAAK0tD,kBACV1tD,KAAK6sD,cAAcpwD,EAAE,CAACozD,QAAS7vD,KAAKymD,gBAAiBkJ,UAAW3vD,KAAK0tD,iBAAkBoC,gBAAiB9vD,KAAK0tD,iBAAiB/sD,OAG/HX,KAAKktD,kBACJltD,KAAK+vD,mBAAmB,CAACrE,SAAU1rD,KAAKymD,gBAAiBkF,SAAU3rD,KAAKktD,kBAAmBzwD,EAAGA,IACzFuD,KAAK0tD,kBACV1tD,KAAK+vD,mBAAmB,CAACnE,OAAQ5rD,KAAKymD,gBAAiBoF,OAAQ7rD,KAAK0tD,iBAAkBjxD,EAAGA,KAMzGuD,KAAKktD,kBAAoB,KACzBltD,KAAK0tD,iBAAmB,KACxB1tD,KAAKotD,eAAiB,KACtBptD,KAAKymD,gBAAkB,KACvBzmD,KAAKqtD,iBAAmB,CAC3B,MACI,GAAIrtD,KAAKgtD,cACVhtD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,EACtB7mD,KAAK+pC,MAAMmL,YAAYl1C,KAAKgtD,eAC5BhtD,KAAKgtD,cAAgB,UAClB,GAAIhtD,KAAKg1C,aAAc,EAEtBt9C,EAAOsI,KAAKg1C,eAGZv4C,EAAE2yD,WAAa,KACflR,kBAAmBzhD,EAAEshD,QAASthD,EAAEuhD,QAAStmD,EAAKg/B,IAAI,GAAIh/B,EAAKg/B,IAAI,GAAK6G,UAAUG,kBAAmBH,UAAUG,kBAAmBH,UAAUG,oBAExIhmC,EAAK8qD,WAGTxiD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,EACtB7mD,KAAKg1C,aAAate,IAAI,GAAKpqB,KAAK01C,MAAMhiD,KAAKg1C,aAAate,IAAI,IAC5D12B,KAAKg1C,aAAate,IAAI,GAAKpqB,KAAK01C,MAAMhiD,KAAKg1C,aAAate,IAAI,KACxD12B,KAAK+pC,MAAM6F,OAAO7D,eAAiB/rC,KAAK+rC,gBACxC/rC,KAAKg1C,aAAaP,cAElBz0C,KAAKytC,aACLztC,KAAKytC,YAAaztC,KAAKg1C,cAC3Bh1C,KAAK+pC,MAAMmL,YAAYl1C,KAAKg1C,cAC5Bh1C,KAAKg1C,aAAe,IACvB,KACI,GAEGt9C,EAAOsI,KAAK+pC,MAAMyL,aAClB/4C,EAAEshD,QACFthD,EAAEuhD,QACFh+C,KAAKumD,iBAGI9pD,EAAE2yD,WAAa,KACxBpvD,KAAKgwD,mBAGThwD,KAAK4mD,cAAe,EACpB5mD,KAAK2mD,iBAAkB,EAEnB3mD,KAAKwmD,WAAaxmD,KAAKwmD,UAAUyJ,WACjCjwD,KAAKwmD,UAAUyJ,UAAWxzD,EAAG,CAAEA,EAAEshD,QAAU/9C,KAAKwmD,UAAU9vB,IAAI,GAAIj6B,EAAEuhD,QAAUh+C,KAAKwmD,UAAU9vB,IAAI,IAAM12B,MAGvGA,KAAKuiD,sBACLviD,KAAKuiD,qBAAqB0N,WAE1BjwD,KAAKuiD,qBAAqB0N,UAAUxzD,EAAG,CACnCA,EAAEshD,QAAU/9C,KAAKuiD,qBAAqB7rB,IAAI,GAC1Cj6B,EAAEuhD,QAAUh+C,KAAKuiD,qBAAqB7rB,IAAI,IAGrD,CACb,MAA8B,GAAXj6B,EAAE0uD,OAKS,GAAX1uD,EAAE0uD,SAFTnrD,KAAK4mD,cAAe,EACpB5mD,KAAK2mD,iBAAkB,GAwB3B,OAXImE,IAEA9qD,KAAKinD,iBAAkB,EACvBjnD,KAAKknD,mBAAoB,GAG7BlnD,KAAK+pC,MAAM0G,SAGXh0C,EAAE2oD,kBACF3oD,EAAE6V,kBACK,CA/RI,CAgSnB,EAMIw3B,aAAa3lC,UAAU4kD,kBAAoB,SAAStsD,GAChD,GAAKuD,KAAK+pC,OAAU/pC,KAAKyrC,iBAAzB,CAIA,IAAIwZ,EAAyB,MAAjBxoD,EAAEuoD,YAAsBvoD,EAAEuoD,aAA0B,GAAZvoD,EAAE6yB,OAEtDtvB,KAAK0qD,iBAAiBjuD,GAEtB,IAAI6O,EAAI7O,EAAEynD,QACN14C,EAAI/O,EAAE2nD,QAEV,IADiBpkD,KAAKquC,UAAcruC,KAAKquC,UAAY/iC,GAAKtL,KAAKquC,SAAS,IAAM/iC,EAAKtL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,IAAO7iC,GAAKxL,KAAKquC,SAAS,IAAM7iC,EAAKxL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,GAC1L,CAGA,IAAI/E,EAAQtpC,KAAKkqC,GAAGZ,MAcpB,OAZI2b,EAAQ,EACR3b,GAAS,IACF2b,EAAQ,IACf3b,GAAS,EAAI,KAIjBtpC,KAAKkqC,GAAGub,YAAYnc,EAAO,CAAC7sC,EAAEynD,QAASznD,EAAE2nD,UAEzCpkD,KAAK+pC,MAAM0G,SAEXh0C,EAAE6V,kBACK,CAhBI,CAVV,CA2BT,EAMIw3B,aAAa3lC,UAAUyqD,cAAgB,SAASl3D,EAAM2sD,EAASC,GAC3D,IAAI4L,EAAe3yB,UAAUG,kBAC7B,QACIwgB,kBACImG,EACAC,EACA5sD,EAAKg/B,IAAI,GAAK,EACdh/B,EAAKg/B,IAAI,GAAK,EAAIw5B,EAClBA,EAAe,EACfA,EAAe,EAM/B,EAMIpmB,aAAa3lC,UAAU0qD,gBAAkB,SACrCn3D,EACA2sD,EACAC,EACA6L,GAEA,GAAIz4D,EAAKu/B,OACL,IAAK,IAAI5+B,EAAI,EAAGqH,EAAIhI,EAAKu/B,OAAOlgC,OAAQsB,EAAIqH,IAAKrH,EAAG,CACpCX,EAAKu/B,OAAO5+B,GACxB,IAAImnD,EAAW9nD,EAAK+nD,kBAAiB,EAAMpnD,GAqB3C,GAnBIX,EAAKqqD,WACO7D,kBACRmG,EACAC,EACA9E,EAAS,GAAK,EACdA,EAAS,GAAK,GACd,GACA,IAGQtB,kBACRmG,EACAC,EACA9E,EAAS,GAAK,GACdA,EAAS,GAAK,EACd,GACA,IAQJ,OAJI2Q,IACAA,EAAS,GAAK3Q,EAAS,GACvB2Q,EAAS,GAAK3Q,EAAS,IAEpBnnD,CAEd,CAEL,OAAQ,CAChB,EAMIyxC,aAAa3lC,UAAU6qD,iBAAmB,SACtCt3D,EACA2sD,EACAC,EACA6L,GAEA,GAAIz4D,EAAKw/B,QACL,IAAK,IAAI7+B,EAAI,EAAGqH,EAAIhI,EAAKw/B,QAAQngC,OAAQsB,EAAIqH,IAAKrH,EAAG,CACpCX,EAAKw/B,QAAQ7+B,GAC1B,IAAImnD,EAAW9nD,EAAK+nD,kBAAiB,EAAOpnD,GAqB5C,GAnBIX,EAAKqqD,WACO7D,kBACRmG,EACAC,EACA9E,EAAS,GAAK,EACdA,EAAS,GAAK,GACd,GACA,IAGQtB,kBACRmG,EACAC,EACA9E,EAAS,GAAK,GACdA,EAAS,GAAK,EACd,GACA,IAQJ,OAJI2Q,IACAA,EAAS,GAAK3Q,EAAS,GACvB2Q,EAAS,GAAK3Q,EAAS,IAEpBnnD,CAEd,CAEL,OAAQ,CAChB,EAMIyxC,aAAa3lC,UAAUklD,WAAa,SAAS5sD,GACzC,GAAKuD,KAAK+pC,MAAV,CAIA,IAAIqmB,GAAgB,EAGpB,GAA0B,SAAtB3zD,EAAEhF,OAAO4wD,UAAb,CAIA,GAAc,WAAV5rD,EAAEkE,MAgDF,GA/CiB,IAAblE,EAAE4zD,UAEFrwD,KAAK2mD,iBAAkB,EACvByJ,GAAgB,GAGH,IAAb3zD,EAAE4zD,UAECrwD,KAAKswD,YAAYtwD,KAAKswD,WAAWniD,QACjCnO,KAAKuwD,eAAevwD,KAAKuwD,cAAcpiD,QAC1CiiD,GAAgB,GAIH,IAAb3zD,EAAE4zD,SAAiB5zD,EAAEwvD,UACrBjsD,KAAK+nD,cACLqI,GAAgB,GAGD,KAAd3zD,EAAE4zD,UAAoB5zD,EAAEyvD,UAAWzvD,EAAEwvD,SAAaxvD,EAAE8V,UAEjDvS,KAAK+0C,iBACL/0C,KAAKwwD,kBACLJ,GAAgB,GAIL,KAAd3zD,EAAE4zD,UAAoB5zD,EAAEyvD,SAAWzvD,EAAEwvD,UAEtCjsD,KAAKywD,mBAAmBh0D,EAAE8V,UAIb,IAAb9V,EAAE4zD,SAA8B,GAAb5zD,EAAE4zD,SAEK,SAAtB5zD,EAAEhF,OAAO4wD,WACa,YAAtB5rD,EAAEhF,OAAO4wD,YAETroD,KAAK0wD,sBACLN,GAAgB,GAQpBpwD,KAAK+0C,eACL,IAAK,IAAI18C,KAAK2H,KAAK+0C,eACX/0C,KAAK+0C,eAAe18C,GAAGs4D,WACvB3wD,KAAK+0C,eAAe18C,GAAGs4D,UAAUl0D,QAI1C,GAAc,SAAVA,EAAEkE,OACQ,IAAblE,EAAE4zD,UAEFrwD,KAAK2mD,iBAAkB,GAGvB3mD,KAAK+0C,gBACL,IAAK,IAAI18C,KAAK2H,KAAK+0C,eACX/0C,KAAK+0C,eAAe18C,GAAGu4D,SACvB5wD,KAAK+0C,eAAe18C,GAAGu4D,QAAQn0D,GAQ/C,OAFAuD,KAAK+pC,MAAM0G,SAEP2f,GACA3zD,EAAE6V,iBACF7V,EAAEo0D,4BACK,QAHX,CA1EC,CAPA,CAsFT,EAEI/mB,aAAa3lC,UAAUqsD,gBAAkB,SAAS/wD,GAC9C,IAAIqxD,EAAiB,CACjBrxD,MAAO,GACPmtB,MAAO,IAEPhsB,EAAQ,EACRmwD,EAAuB,GAE3B,IAAK,IAAI14D,KADJoH,IAAOA,EAAQO,KAAK+0C,gBACXt1C,EAAO,EAEK,KADlB/H,EAAO+H,EAAMpH,IACR24D,WAETt5D,EAAKu5D,aAAerwD,EACpBmwD,EAAqB11D,KAAK3D,GAC1BkJ,GAAS,EACZ,CAED,IAASvI,EAAI,EAAGA,EAAI04D,EAAqBh6D,SAAUsB,EAAG,CAClD,IAAIX,EACA20D,GADA30D,EAAOq5D,EAAqB14D,IACd+hD,QAClB,GAAIiS,IAKJyE,EAAerxD,MAAMpE,KAAKgxD,EAAOpW,aAC7Bv+C,EAAKu/B,QAAUv/B,EAAKu/B,OAAOlgC,QAC3B,IAAK,IAAI4wC,EAAI,EAAGA,EAAIjwC,EAAKu/B,OAAOlgC,SAAU4wC,EAAG,CACzC,IAAI1tC,EAAQvC,EAAKu/B,OAAO0Q,GACxB,GAAK1tC,GAAuB,MAAdA,EAAMoZ,KAApB,CAGA,IAAI4kC,EAAYj4C,KAAK+pC,MAAMnd,MAAM3yB,EAAMoZ,MACvC,GAAK4kC,EAAL,CAGA,IAAIrF,EAAc5yC,KAAK+pC,MAAMpT,YACzBshB,EAAUvP,WAETkK,GAGLke,EAAelkC,MAAMvxB,KAAK,CACtBu3C,EAAYqe,aACZhZ,EAAUtP,YACVjxC,EAAKu5D,aACLhZ,EAAUpP,YACV+J,EAAYrwC,IAZf,CAJA,CAkBJ,CAER,CACD2vB,aAAaC,QACT,4BACApoB,KAAKC,UAAU8mD,GAE3B,EAEIhnB,aAAa3lC,UAAUssD,mBAAqB,SAASS,GAAsB,GAEvE,GAAK3zB,UAAUiG,gDAAiD0tB,EAAhE,CAGA,IAAIx4D,EAAOw5B,aAAaG,QAAQ,6BAChC,GAAK35B,EAAL,CAIAsH,KAAK+pC,MAAM6K,eAOX,IAJA,IAAIkc,EAAiB/mD,KAAK0W,MAAM/nB,GAE5By4D,GAAS,EACTC,GAAgB,EACX/4D,EAAI,EAAGA,EAAIy4D,EAAerxD,MAAM1I,SAAUsB,EAC3C84D,GACGA,EAAO,GAAGL,EAAerxD,MAAMpH,GAAGq+B,IAAI,KACrCy6B,EAAO,GAAKL,EAAerxD,MAAMpH,GAAGq+B,IAAI,GACxC06B,EAAc,GAAK/4D,GAEpB84D,EAAO,GAAGL,EAAerxD,MAAMpH,GAAGq+B,IAAI,KACrCy6B,EAAO,GAAKL,EAAerxD,MAAMpH,GAAGq+B,IAAI,GACxC06B,EAAc,GAAK/4D,KAIvB84D,EAAS,CAACL,EAAerxD,MAAMpH,GAAGq+B,IAAI,GAAIo6B,EAAerxD,MAAMpH,GAAGq+B,IAAI,IACtE06B,EAAgB,CAAC/4D,EAAGA,IAG5B,IAAIoH,EAAQ,GACZ,IAASpH,EAAI,EAAGA,EAAIy4D,EAAerxD,MAAM1I,SAAUsB,EAAG,CAClD,IAAIg5D,EAAYP,EAAerxD,MAAMpH,GACjCX,EAAO6lC,UAAU0I,WAAWorB,EAAU1wD,MACtCjJ,IACAA,EAAK8wC,UAAU6oB,GAGf35D,EAAKg/B,IAAI,IAAM12B,KAAKgtC,YAAY,GAAKmkB,EAAO,GAC5Cz5D,EAAKg/B,IAAI,IAAM12B,KAAKgtC,YAAY,GAAKmkB,EAAO,GAE5CnxD,KAAK+pC,MAAMltC,IAAInF,EAAK,CAACgqD,iBAAgB,IAErCjiD,EAAMpE,KAAK3D,GAElB,CAGD,IAASW,EAAI,EAAGA,EAAIy4D,EAAelkC,MAAM71B,SAAUsB,EAAG,CAClD,IACIi5D,EADArZ,EAAY6Y,EAAelkC,MAAMv0B,GAEjCk5D,EAA0BtZ,EAAU,GACxC,GAA+B,MAA3BsZ,EACAD,EAAc7xD,EAAM8xD,QACjB,GAAIh0B,UAAUiG,+CAAiD0tB,EAAqB,CACvF,IAAIM,EAAiBvZ,EAAU,GAC3BuZ,IACAF,EAActxD,KAAK+pC,MAAMpT,YAAY66B,GAE5C,CACD,IAAI5e,EAAcnzC,EAAMw4C,EAAU,IAC9BqZ,GAAe1e,GACf0e,EAAYtQ,QAAQ/I,EAAU,GAAIrF,EAAaqF,EAAU,GAGhE,CAEDj4C,KAAK+nD,YAAYtoD,GAEjBO,KAAK+pC,MAAMmL,aAhEV,CAJA,CAqET,EAMIpL,aAAa3lC,UAAUolD,YAAc,SAAS9sD,GAC1CA,EAAE6V,iBACFtS,KAAK0qD,iBAAiBjuD,GACtB,IAAI6O,EAAI7O,EAAEynD,QACN14C,EAAI/O,EAAE2nD,QAEV,IADiBpkD,KAAKquC,UAAcruC,KAAKquC,UAAY/iC,GAAKtL,KAAKquC,SAAS,IAAM/iC,EAAKtL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,IAAO7iC,GAAKxL,KAAKquC,SAAS,IAAM7iC,EAAKxL,KAAKquC,SAAS,GAAKruC,KAAKquC,SAAS,GAC1L,CAKA,IAAI3X,EAAM,CAACj6B,EAAEshD,QAASthD,EAAEuhD,SAGpBtmD,EAAOsI,KAAK+pC,MAAQ/pC,KAAK+pC,MAAMyL,aAAa9e,EAAI,GAAIA,EAAI,IAAM,KAElE,IAAKh/B,EAAM,CACP,IAAIiM,EAAI,KAOR,OANI3D,KAAKyxD,aACL9tD,EAAI3D,KAAKyxD,WAAW14D,aAEnB4K,GACD3D,KAAK0xD,cAAcj1D,GAG1B,CAED,GAAI/E,EAAKi6D,YAAcj6D,EAAKk6D,WAAY,CACpC,IAAI5hC,EAAQvzB,EAAEo1D,aAAa7hC,MAC3B,GAAIA,GAASA,EAAMj5B,OACf,IAAK,IAAIsB,EAAI,EAAGA,EAAI23B,EAAMj5B,OAAQsB,IAAK,CACnC,IAAIyK,EAAOrG,EAAEo1D,aAAa7hC,MAAM,GAC5B8hC,EAAWhvD,EAAKtK,KAQpB,GAPUsxC,aAAa0f,iBAAiBsI,GAGpCp6D,EAAKi6D,YACLj6D,EAAKi6D,WAAW7uD,GAGhBpL,EAAKk6D,WAAY,CAEjB,IAAI1hC,EAAS,IAAIC,WACjBD,EAAOtF,OAAS,SAAS7xB,GAErB,IAAIL,EAAOK,EAAMtB,OAAOoD,OACxBnD,EAAKk6D,WAAWl5D,EAAMo5D,EAAUhvD,EAC5D,EAGwB,IAAInC,EAAOmC,EAAKnC,KAAKyR,MAAM,KAAK,GACpB,QAARzR,GAA0B,IAARA,EAClBuvB,EAAOkY,WAAWtlC,GACH,SAARnC,EACPuvB,EAAOG,cAAcvtB,GAErBotB,EAAOiY,kBAAkBrlC,EAEhC,CACJ,CAER,CAED,SAAIpL,EAAK+5D,aACD/5D,EAAK+5D,WAAW14D,WAKpBiH,KAAKyxD,YACEzxD,KAAKyxD,WAAW14D,MA7D1B,CAiET,EAGI+wC,aAAa3lC,UAAUutD,cAAgB,SAASj1D,GAC5C,GAAIA,EAAEo1D,aAAa7hC,MAAMj5B,OAAQ,CAC7B,IAAI+L,EAAOrG,EAAEo1D,aAAa7hC,MAAM,GAC5BmU,EAAM2F,aAAa0f,iBAAiB1mD,EAAKtK,MAAM4rC,cAC/C2tB,EAAWx0B,UAAUsE,6BAA6BsC,GACtD,GAAI4tB,EAAU,CACV/xD,KAAK+pC,MAAM6K,eACX,IAAIl9C,EAAO6lC,UAAU0I,WAAW8rB,EAASpxD,MACzCjJ,EAAKg/B,IAAM,CAACj6B,EAAEshD,QAASthD,EAAEuhD,SACzBh+C,KAAK+pC,MAAMltC,IAAInF,GACXA,EAAKi6D,YACLj6D,EAAKi6D,WAAW7uD,GAEpB9C,KAAK+pC,MAAMmL,aACd,CACJ,CACT,EAEIpL,aAAa3lC,UAAU0pD,sBAAwB,SAASpqD,GAChDzD,KAAKgyD,iBACLhyD,KAAKgyD,gBAAgBvuD,GAGrBzD,KAAKiyD,kBACLjyD,KAAKiyD,iBAAiBxuD,GAG1BzD,KAAKunD,UAAS,EACtB,EAEIzd,aAAa3lC,UAAUqoD,oBAAsB,SAAS90D,EAAM+E,GACxDuD,KAAKkyD,WAAWx6D,EAAM+E,IAAMA,EAAE8V,UAAY9V,EAAEwvD,SAAWjsD,KAAK4rC,eACxD5rC,KAAKmyD,gBACLnyD,KAAKmyD,eAAez6D,EAEhC,EAMIoyC,aAAa3lC,UAAU+tD,WAAa,SAChCx6D,EACA06D,GAEY,MAAR16D,EACAsI,KAAKgwD,mBAELhwD,KAAK+nD,YAAY,CAACrwD,GAAO06D,EAErC,EAMItoB,aAAa3lC,UAAU4jD,YAAc,SAAUtoD,EAAO2yD,GAQlD,IAAK,IAAI/5D,KANJ+5D,GACDpyD,KAAKgwD,mBAIW,iBADpBvwD,EAAQA,GAASO,KAAK+pC,MAAMsF,UACE5vC,EAAQ,CAACA,IACzBA,EAAO,CACjB,IAAI/H,EAAO+H,EAAMpH,GACjB,GAAIX,EAAKu2D,YACLjuD,KAAKqyD,aAAa36D,OADtB,CAWA,IANKA,EAAKu2D,aAAev2D,EAAK46D,YAC1B56D,EAAK46D,aAET56D,EAAKu2D,aAAc,EACnBjuD,KAAK+0C,eAAer9C,EAAK6K,IAAM7K,EAE3BA,EAAKu/B,OACL,IAAK,IAAI0Q,EAAI,EAAGA,EAAIjwC,EAAKu/B,OAAOlgC,SAAU4wC,EACtC3nC,KAAK0mD,kBAAkBhvD,EAAKu/B,OAAO0Q,GAAGt0B,OAAQ,EAGtD,GAAI3b,EAAKw/B,QACL,IAASyQ,EAAI,EAAGA,EAAIjwC,EAAKw/B,QAAQngC,SAAU4wC,EAAG,CAC1C,IAAIhD,EAAMjtC,EAAKw/B,QAAQyQ,GACvB,GAAIhD,EAAI/X,MACJ,IAAK,IAAIna,EAAI,EAAGA,EAAIkyB,EAAI/X,MAAM71B,SAAU0b,EACpCzS,KAAK0mD,kBAAkB/hB,EAAI/X,MAAMna,KAAM,CAGlD,CArBJ,CAuBJ,CAEGzS,KAAK0tC,mBACL1tC,KAAK0tC,kBAAmB1tC,KAAK+0C,gBAEjC/0C,KAAKunD,UAAS,EACtB,EAMIzd,aAAa3lC,UAAUkuD,aAAe,SAAS36D,GAC3C,GAAKA,EAAKu2D,YAAV,CAaA,GAVIv2D,EAAK66D,cACL76D,EAAK66D,eAET76D,EAAKu2D,aAAc,EAEfjuD,KAAKwyD,kBACLxyD,KAAKwyD,iBAAiB96D,GAItBA,EAAKu/B,OACL,IAAK,IAAI5+B,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,SAAUsB,SAC/B2H,KAAK0mD,kBAAkBhvD,EAAKu/B,OAAO5+B,GAAGgb,MAGrD,GAAI3b,EAAKw/B,QACL,IAAS7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,SAAUsB,EAAG,CAC1C,IAAIssC,EAAMjtC,EAAKw/B,QAAQ7+B,GACvB,GAAIssC,EAAI/X,MACJ,IAAK,IAAI+a,EAAI,EAAGA,EAAIhD,EAAI/X,MAAM71B,SAAU4wC,SAC7B3nC,KAAK0mD,kBAAkB/hB,EAAI/X,MAAM+a,GAGnD,CAxBJ,CA0BT,EAMImC,aAAa3lC,UAAU6rD,iBAAmB,WACtC,GAAKhwD,KAAK+pC,MAAV,CAIA,IADA,IAAItqC,EAAQO,KAAK+pC,MAAMsF,OACdh3C,EAAI,EAAGqH,EAAID,EAAM1I,OAAQsB,EAAIqH,IAAKrH,EAAG,CAC1C,IAAIX,EAAO+H,EAAMpH,GACZX,EAAKu2D,cAGNv2D,EAAK66D,cACL76D,EAAK66D,eAET76D,EAAKu2D,aAAc,EACfjuD,KAAKwyD,kBACLxyD,KAAKwyD,iBAAiB96D,GAE7B,CACDsI,KAAK+0C,eAAiB,GACtB/0C,KAAKguC,aAAe,KACpBhuC,KAAK0mD,kBAAoB,GACrB1mD,KAAK0tC,mBACL1tC,KAAK0tC,kBAAmB1tC,KAAK+0C,gBACjC/0C,KAAKunD,UAAS,EApBb,CAqBT,EAMIzd,aAAa3lC,UAAUusD,oBAAsB,WAIzC,IAAK,IAAIr4D,KAFT2H,KAAK+pC,MAAM6K,eAEG50C,KAAK+0C,eAAgB,CAC/B,IAAIr9C,EAAOsI,KAAK+0C,eAAe18C,GAE/B,IAAGX,EAAK+6D,aAAR,CAIA,GAAG/6D,EAAKu/B,QAAUv/B,EAAKu/B,OAAOlgC,QAAUW,EAAKw/B,SAAWx/B,EAAKw/B,QAAQngC,QAAUwmC,UAAU+J,kBAAmB5vC,EAAKu/B,OAAO,GAAGt2B,KAAMjJ,EAAKw/B,QAAQ,GAAGv2B,OAAUjJ,EAAKu/B,OAAO,GAAG5jB,MAAQ3b,EAAKw/B,QAAQ,GAAGtK,OAASl1B,EAAKw/B,QAAQ,GAAGtK,MAAM71B,OACjO,CACI,IAAI27D,EAAah7D,EAAKqyC,MAAMnd,MAAOl1B,EAAKu/B,OAAO,GAAG5jB,MAC9Cs/C,EAAcj7D,EAAKqyC,MAAMnd,MAAOl1B,EAAKw/B,QAAQ,GAAGtK,MAAM,IACtDgmC,EAAal7D,EAAK67C,aAAa,GAC/Bsf,EAAcn7D,EAAK8jD,eAAe,GAAG,GACtCoX,GAAcC,GACbD,EAAW5R,QAAS0R,EAAW/pB,YAAakqB,EAAaF,EAAY9pB,YAC5E,CACD7oC,KAAK+pC,MAAMnhC,OAAOlR,GACdsI,KAAKwyD,kBACLxyD,KAAKwyD,iBAAiB96D,EAdb,CAgBhB,CACDsI,KAAK+0C,eAAiB,GACtB/0C,KAAKguC,aAAe,KACpBhuC,KAAK0mD,kBAAoB,GACzB1mD,KAAKunD,UAAS,GACdvnD,KAAK+pC,MAAMmL,aACnB,EAMIpL,aAAa3lC,UAAU2jD,aAAe,SAASpwD,GAC3CsI,KAAKkqC,GAAGb,OAAO,IACV3xC,EAAKg/B,IAAI,GACK,GAAfh/B,EAAK2d,KAAK,GACW,GAApBrV,KAAK6qB,OAAOznB,MAAepD,KAAKkqC,GAAGZ,MACxCtpC,KAAKkqC,GAAGb,OAAO,IACV3xC,EAAKg/B,IAAI,GACK,GAAfh/B,EAAK2d,KAAK,GACY,GAArBrV,KAAK6qB,OAAOxnB,OAAgBrD,KAAKkqC,GAAGZ,MACzCtpC,KAAKunD,UAAS,GAAM,EAC5B,EAMIzd,aAAa3lC,UAAUumD,iBAAmB,SAASjuD,GAC/C,IAAIq2D,EAAc,EACdC,EAAc,EAElB,GAAI/yD,KAAK6qB,OAAQ,CACb,IAAI10B,EAAI6J,KAAK6qB,OAAOoC,wBACpB6lC,EAAcr2D,EAAEynD,QAAU/tD,EAAEguD,KAC5B4O,EAAct2D,EAAE2nD,QAAUjuD,EAAEo3B,GACxC,MACYulC,EAAcr2D,EAAEynD,QAChB6O,EAAct2D,EAAE2nD,QAGpB3nD,EAAEu2D,OAASF,EAAc9yD,KAAKmuC,oBAAoB,GAClD1xC,EAAEsoD,OAASgO,EAAa/yD,KAAKmuC,oBAAoB,GAEjDnuC,KAAKmuC,oBAAoB,GAAK2kB,EAC9B9yD,KAAKmuC,oBAAoB,GAAK4kB,EAE9Bt2D,EAAEshD,QAAU+U,EAAc9yD,KAAKkqC,GAAGZ,MAAQtpC,KAAKkqC,GAAGb,OAAO,GACzD5sC,EAAEuhD,QAAU+U,EAAc/yD,KAAKkqC,GAAGZ,MAAQtpC,KAAKkqC,GAAGb,OAAO,EAGjE,EAMIS,aAAa3lC,UAAU8uD,QAAU,SAAS37D,EAAOouD,GAC7C1lD,KAAKkqC,GAAGub,YAAYnuD,EAAOouD,GAqB3B1lD,KAAK4mD,cAAe,EACpB5mD,KAAK6mD,gBAAiB,CAC9B,EAMI/c,aAAa3lC,UAAUohD,sBAAwB,SAAS7uB,EAAKiO,GACzD,OAAO3kC,KAAKkqC,GAAGqb,sBAAsB7uB,EAAKiO,EAClD,EAMImF,aAAa3lC,UAAUqhD,sBAAwB,SAAS9uB,EAAKiO,GACzD,OAAO3kC,KAAKkqC,GAAGsb,sBAAsB9uB,EAAKiO,EAClD,EAGImF,aAAa3lC,UAAU+uD,2BAA6B,SAASz2D,GACzD,IAAIuwB,EAAOhtB,KAAK6qB,OAAOoC,wBACvB,OAAOjtB,KAAKwlD,sBAAsB,CAC9B/oD,EAAEynD,QAAUl3B,EAAKm3B,KACjB1nD,EAAE2nD,QAAUp3B,EAAKO,KAE7B,EAMIuc,aAAa3lC,UAAU2oD,aAAe,SAASp1D,GAC3C,IAAIW,EAAI2H,KAAK+pC,MAAMsF,OAAO7xC,QAAQ9F,IACxB,GAANW,IAIJ2H,KAAK+pC,MAAMsF,OAAOxuC,OAAOxI,EAAG,GAC5B2H,KAAK+pC,MAAMsF,OAAOh0C,KAAK3D,GAC/B,EAMIoyC,aAAa3lC,UAAUgvD,WAAa,SAASz7D,GACzC,IAAIW,EAAI2H,KAAK+pC,MAAMsF,OAAO7xC,QAAQ9F,IACxB,GAANW,IAIJ2H,KAAK+pC,MAAMsF,OAAOxuC,OAAOxI,EAAG,GAC5B2H,KAAK+pC,MAAMsF,OAAO+jB,QAAQ17D,GAClC,EAKI,IAAI27D,KAAO,IAAIrqB,aAAa,GAM5Bc,aAAa3lC,UAAUmvD,oBAAsB,SAAS7zD,EAAOklC,GACzD,IAAI4hB,EAAgB5hB,GAAO,GAC3B4hB,EAAcxvD,OAAS,EAEvB,IAAK,IAAIsB,EAAI,EAAGqH,GADhBD,EAAQA,GAASO,KAAK+pC,MAAMsF,QACFt4C,OAAQsB,EAAIqH,IAAKrH,EAAG,CAC1C,IAAIoL,EAAIhE,EAAMpH,KAGV2H,KAAKurC,WAAc9nC,EAAE4pC,kBAAqB5pC,EAAE6pC,oBAI3CoW,gBAAgB1jD,KAAK4pC,aAAcnmC,EAAEi7C,YAAY2U,MAAM,KAI5D9M,EAAclrD,KAAKoI,GACtB,CACD,OAAO8iD,CACf,EAMIzc,aAAa3lC,UAAUmmD,KAAO,SAASiJ,EAAcC,GACjD,GAAKxzD,KAAK6qB,QAA+B,GAArB7qB,KAAK6qB,OAAOznB,OAAoC,GAAtBpD,KAAK6qB,OAAOxnB,OAA1D,CAKA,IAAIwrC,EAAMtR,UAAUqR,UACpB5uC,KAAKomD,YAA4C,MAA7BvX,EAAM7uC,KAAKmmD,gBAC/BnmD,KAAKmmD,eAAiBtX,EAElB7uC,KAAK+pC,OACL/pC,KAAKkqC,GAAG2Z,mBAAmB7jD,KAAKquC,WAIhCruC,KAAK6mD,gBACL2M,GACAxzD,KAAKmsC,0BACJnsC,KAAK+pC,OACF/pC,KAAK+pC,MAAMyS,oBACX3N,EAAM7uC,KAAK+pC,MAAMyS,mBAAqB,MAE1Cx8C,KAAKyzD,kBAGLzzD,KAAK4mD,cAAgB2M,IACrBvzD,KAAK0zD,kBAGT1zD,KAAKqmD,IAAMrmD,KAAKomD,YAAc,EAAMpmD,KAAKomD,YAAc,EACvDpmD,KAAKkmD,OAAS,CA3Bb,CA4BT,EAMIpc,aAAa3lC,UAAUuvD,gBAAkB,WACrC1zD,KAAK4mD,cAAe,EAEf5mD,KAAK7C,MACN6C,KAAK7C,IAAM6C,KAAKooD,SAASt9B,WAAW,OAExC,IAAI3tB,EAAM6C,KAAK7C,IACf,GAAKA,EAAL,CAKA,IAAI0tB,EAAS7qB,KAAK6qB,OACb1tB,EAAIw2D,UAAY3zD,KAAKquC,WACtBlxC,EAAIw2D,UACJx2D,EAAIy2D,UACJz2D,EAAI02D,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,IAIpC,IAAIC,EAAO9zD,KAAKquC,UAAYruC,KAAK8mD,WAkCjC,GAjCIgN,IACA32D,EAAIq1B,OACJr1B,EAAI42D,YACJ52D,EAAI6vB,KAAM8mC,EAAK,GAAGA,EAAK,GAAGA,EAAK,GAAGA,EAAK,IACvC32D,EAAIggB,QAKJnd,KAAKmrC,mBACF2oB,EACC32D,EAAI62D,UAAWF,EAAK,GAAGA,EAAK,GAAGA,EAAK,GAAGA,EAAK,IAE5C32D,EAAI62D,UAAU,EAAG,EAAGnpC,EAAOznB,MAAOynB,EAAOxnB,SAI7CrD,KAAKooD,UAAYpoD,KAAK6qB,OACtB7qB,KAAKyzD,iBAELt2D,EAAI4tB,UAAW/qB,KAAKooD,SAAU,EAAG,GAIjCpoD,KAAKi0D,UACLj0D,KAAKi0D,SAASppC,EAAQ1tB,GAItB6C,KAAKwrC,WACLxrC,KAAKk0D,WAAW/2D,EAAK22D,EAAOA,EAAK,GAAK,EAAGA,EAAOA,EAAK,GAAK,GAG1D9zD,KAAK+pC,MAAO,CAEZ5sC,EAAIq1B,OACJxyB,KAAKkqC,GAAGmb,gBAAgBloD,GASxB,IALA,IAAIopD,EAAgBvmD,KAAKszD,oBACrB,KACAtzD,KAAKumD,eAGAluD,EAAI,EAAGA,EAAIkuD,EAAcxvD,SAAUsB,EAAG,CAC3C,IAAIX,EAAO6uD,EAAcluD,GAGzB8E,EAAIq1B,OACJr1B,EAAImoD,UAAU5tD,EAAKg/B,IAAI,GAAIh/B,EAAKg/B,IAAI,IAGpC12B,KAAKm0D,SAASz8D,EAAMyF,GAIpBA,EAAIy2D,SACP,CAeD,GAZI5zD,KAAK2sC,wBACL3sC,KAAKo0D,mBAAmBj3D,GAIxB6C,KAAK+pC,MAAM6F,OAAOykB,cACbr0D,KAAKurC,WACNvrC,KAAKs0D,gBAAgBn3D,IAKF,MAAvB6C,KAAKotD,eAAwB,CAC7BjwD,EAAIo3D,UAAYv0D,KAAK8tC,kBACrB,IAAI0mB,EAAa,KAEbC,EAAcz0D,KAAKktD,mBAAqBltD,KAAK0tD,iBAE7C+B,EAAWgF,EAAY9zD,KACvB+zD,EAAUD,EAAYE,IACZ,MAAXD,IAGKA,EADA10D,KAAKktD,kBACKltD,KAAKymD,gBAAgB1E,WAAaxkB,UAAUkD,KAAOlD,UAAUoD,MAE7D3gC,KAAKymD,gBAAgB1E,WAAaxkB,UAAUiD,GAAKjD,UAAUmD,MAE7E,IAAIk0B,EAAYH,EAAYta,MAE5B,GAAQsV,IACClyB,UAAUyC,MACXw0B,EAAaj3B,UAAU4B,sBAGvBq1B,EAAaj3B,UAAU6B,sBA8D/B,GA1DAp/B,KAAK60D,WACD13D,EACA6C,KAAKotD,eACL,CAACptD,KAAKgtC,YAAY,GAAIhtC,KAAKgtC,YAAY,IACvC,MACA,EACA,KACAwnB,EACAE,EACAn3B,UAAUqD,QAGdzjC,EAAI42D,YAEAtE,IAAalyB,UAAUyC,OACvB40B,IAAcr3B,UAAUiC,WAExBriC,EAAI6vB,KACAhtB,KAAKotD,eAAe,GAAK,EAAI,GAC7BptD,KAAKotD,eAAe,GAAK,EAAI,GAC7B,GACA,IAEJjwD,EAAIoB,OACJpB,EAAI42D,YACJ52D,EAAI6vB,KACAhtB,KAAKgtC,YAAY,GAAK,EAAI,GAC1BhtC,KAAKgtC,YAAY,GAAK,EAAI,GAC1B,GACA,KAEG4nB,IAAcr3B,UAAUqC,aAC/BziC,EAAI23D,OAAO90D,KAAKotD,eAAe,GAAK,EAAGptD,KAAKotD,eAAe,GAAK,IAChEjwD,EAAI43D,OAAO/0D,KAAKotD,eAAe,GAAK,EAAGptD,KAAKotD,eAAe,GAAK,EAAI,IACpEjwD,EAAI43D,OAAO/0D,KAAKotD,eAAe,GAAK,EAAGptD,KAAKotD,eAAe,GAAK,EAAI,IACpEjwD,EAAI63D,cAGJ73D,EAAI83D,IACAj1D,KAAKotD,eAAe,GACpBptD,KAAKotD,eAAe,GACpB,EACA,EACU,EAAV9gD,KAAK4oD,IAET/3D,EAAIoB,OACJpB,EAAI42D,YACJ52D,EAAI83D,IACAj1D,KAAKgtC,YAAY,GACjBhtC,KAAKgtC,YAAY,GACjB,EACA,EACU,EAAV1gC,KAAK4oD,KAGb/3D,EAAIoB,OAEJpB,EAAIg4D,UAAY,UACZn1D,KAAK2uD,iBAAkB,CACvBxxD,EAAI42D,YACJ,IAAI5Z,EAAQn6C,KAAK8uD,sBAAsB3U,MACnCA,IAAU5c,UAAUqC,aACpBziC,EAAI23D,OAAO90D,KAAK2uD,iBAAiB,GAAK,EAAG3uD,KAAK2uD,iBAAiB,GAAK,IACpExxD,EAAI43D,OAAO/0D,KAAK2uD,iBAAiB,GAAK,EAAG3uD,KAAK2uD,iBAAiB,GAAK,EAAI,IACxExxD,EAAI43D,OAAO/0D,KAAK2uD,iBAAiB,GAAK,EAAG3uD,KAAK2uD,iBAAiB,GAAK,EAAI,IACxExxD,EAAI63D,aAEJ73D,EAAI83D,IACAj1D,KAAK2uD,iBAAiB,GACtB3uD,KAAK2uD,iBAAiB,GACtB,EACA,EACU,EAAVriD,KAAK4oD,IAGb/3D,EAAIoB,MACP,CACGyB,KAAK+uD,oBACL5xD,EAAI42D,YACA5Z,IAAU5c,UAAUqC,aACpBziC,EAAI23D,OAAO90D,KAAK+uD,kBAAkB,GAAK,EAAG/uD,KAAK+uD,kBAAkB,GAAK,IACtE5xD,EAAI43D,OAAO/0D,KAAK+uD,kBAAkB,GAAK,EAAG/uD,KAAK+uD,kBAAkB,GAAK,EAAI,IAC1E5xD,EAAI43D,OAAO/0D,KAAK+uD,kBAAkB,GAAK,EAAG/uD,KAAK+uD,kBAAkB,GAAK,EAAI,IAC1E5xD,EAAI63D,aAEJ73D,EAAI83D,IACAj1D,KAAK+uD,kBAAkB,GACvB/uD,KAAK+uD,kBAAkB,GACvB,EACA,EACU,EAAVziD,KAAK4oD,IAGb/3D,EAAIoB,OAEX,CAGGyB,KAAKisC,qBACL9uC,EAAIi4D,YAAc,OAClBj4D,EAAIk4D,WACAr1D,KAAKisC,mBAAmB,GACxBjsC,KAAKisC,mBAAmB,GACxBjsC,KAAKisC,mBAAmB,GACxBjsC,KAAKisC,mBAAmB,KAK7BjsC,KAAKkuC,kBAAoBluC,KAAK6sC,oBAC7B7sC,KAAKs1D,gBAAiBn4D,EAAK6C,KAAKkuC,kBAEjCluC,KAAKwtC,mBACJxtC,KAAKwtC,kBAAkBrwC,EAAI,MAG3B6C,KAAKstC,kBACLttC,KAAKstC,iBAAiBnwC,EAAK6C,KAAKu1D,cAGpCp4D,EAAIy2D,SACP,CAGG5zD,KAAKsnD,cAAgBtnD,KAAKsnD,aAAavwD,QACvCiJ,KAAKw1D,kBAAmBr4D,GAIxB6C,KAAKutC,eACLvtC,KAAKutC,cAAcpwC,GAGnB22D,GACA32D,EAAIy2D,UAGJz2D,EAAIs4D,UAEJt4D,EAAIs4D,UAzPP,CA2PT,EAMI3rB,aAAa3lC,UAAUqxD,kBAAoB,SAAUr4D,GACjD,IAAI4wD,EAAW/tD,KAAK+pC,MAChB2rB,EAAU3H,EAASlG,eAClB6N,IAIL11D,KAAK21D,sBAAsB5H,EAAU2H,EAASv4D,GAC9C6C,KAAK41D,uBAAuB7H,EAAU2H,EAASv4D,GAClD,EAED2sC,aAAa3lC,UAAUwxD,sBAAwB,SAAU5H,EAAU2H,EAASv4D,GACxE,IAAIye,EAAM85C,EAAQz+B,OAASy+B,EAAQz+B,OAAOlgC,OAAS,EAC/C0T,EAAI,IACJK,EAAIwB,KAAKoL,MAAmC,IAA7B6lB,UAAUK,kBAe7B,GAbAzgC,EAAIg4D,UAAY,OAChBh4D,EAAI04D,YAAc,GAClB14D,EAAI42D,YACJ52D,EAAI24D,UAAU,GAAI,GAAIrrD,GAAImR,EAAM,GAAK9Q,EAAI,GAAI,CAAC,IAC9C3N,EAAIoB,OACJpB,EAAI04D,YAAc,EAElB14D,EAAIg4D,UAAY,OAChBh4D,EAAI2kB,KAAO,aACX3kB,EAAI44D,UAAY,OAChB54D,EAAI64D,SAAS,eAAgB,GAAI,IAG7Bh2D,KAAKi2D,WAAWxrD,IAAQ,GAAI,GAAI,GAAI,IAAK,WACzCzK,KAAK2nD,oBADT,CAKA,IAAIn8C,EAAI,GAER,GADArO,EAAI2kB,KAAO,aACP4zC,EAAQz+B,OACR,IAAK,IAAI5+B,EAAI,EAAGA,EAAIq9D,EAAQz+B,OAAOlgC,SAAUsB,EAAG,CAC5C,IAAI4B,EAAQy7D,EAAQz+B,OAAO5+B,GAC3B,IAAI4B,EAAMi8D,mBAAV,CAIA,GAAIl2D,KAAKi2D,WAAW,GAAIzqD,EAAI,EAAGf,IAAQK,EAAI,GAAI,CAC3C,IAAInK,EAAO+0D,EAAQ51D,YAAYq2D,iBAAmB,cAClDn2D,KAAK+pC,MAAM6K,eACX,IAAIoB,EAAUzY,UAAU0I,WAAWtlC,GAC/Bq1C,IACA+X,EAASlxD,IAAIm5C,GACbh2C,KAAKyqD,aAAc,EACnBzqD,KAAKirD,oBAAsB,KAC3BjrD,KAAK+nD,YAAY,CAAC/R,IAClBh2C,KAAKg1C,aAAegB,EACpBh2C,KAAK2mD,iBAAkB,EACvB3Q,EAAQz7C,YAAY,OAAQN,EAAMzB,MAClCw9C,EAAQz7C,YAAY,OAAQN,EAAM0G,MAClCX,KAAKg1C,aAAate,IAAI,GAAK12B,KAAKgtC,YAAY,GAAK,EACjDhtC,KAAKg1C,aAAate,IAAI,GAAK12B,KAAKgtC,YAAY,GAAK,EACjDhtC,KAAK+pC,MAAMmL,cAIlB,CACD/3C,EAAIg4D,UAAY,OAChBh4D,EAAI42D,YACJ52D,EAAI83D,IAAIxqD,IAAQe,EAAQ,GAAJV,EAAS,EAAG,EAAG,EAAIwB,KAAK4oD,IAC5C/3D,EAAIoB,OACJpB,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SAAS/7D,EAAMzB,KAAM,GAAIgT,EAAQ,IAAJV,GAEjC3N,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SAAS/7D,EAAM0G,KAAM,IAAK6K,EAAQ,IAAJV,GAClCU,GAAKV,CAhCQ,CAiChB,CAED9K,KAAKi2D,WAAW,GAAIzqD,EAAI,EAAGf,IAAQK,EAAI,EAAG,IAAK,UAAW,SAC1D9K,KAAKo2D,6BAA6BV,EA5CrC,CA8CJ,EACD5rB,aAAa3lC,UAAUyxD,uBAAyB,SAAU7H,EAAU2H,EAASv4D,GACzE,IAAIye,EAAM85C,EAAQx+B,QAAUw+B,EAAQx+B,QAAQngC,OAAS,EACjDs/D,EAAWr2D,KAAKooD,SAAShlD,MACzBqH,EAAI,IACJK,EAAIwB,KAAKoL,MAAmC,IAA7B6lB,UAAUK,kBAE7BzgC,EAAIg4D,UAAY,OAChBh4D,EAAI04D,YAAc,GAClB14D,EAAI42D,YACJ52D,EAAI24D,UAAUO,EAAW5rD,EAAI,GAAI,GAAIA,GAAImR,EAAM,GAAK9Q,EAAI,GAAI,CAAC,IAC7D3N,EAAIoB,OACJpB,EAAI04D,YAAc,EAElB14D,EAAIg4D,UAAY,OAChBh4D,EAAI2kB,KAAO,aACX3kB,EAAI44D,UAAY,OAChB,IAAIO,EAAa,gBACbC,EAAKp5D,EAAIq5D,YAAYF,GAAYlzD,MAGrC,GAFAjG,EAAI64D,SAASM,EAAaD,EAAWE,EAAM,GAAI,IAE3Cv2D,KAAKi2D,WAAWI,EAAW5rD,EAAG,GAAI,GAAI,GAAI,IAAK,WAC/CzK,KAAK2nD,oBADT,CAKA,IAAIn8C,EAAI,GAER,GADArO,EAAI2kB,KAAO,aACP4zC,EAAQx+B,QACR,IAAK,IAAI7+B,EAAI,EAAGA,EAAIq9D,EAAQx+B,QAAQngC,SAAUsB,EAAG,CAC7C,IAAI8+B,EAASu+B,EAAQx+B,QAAQ7+B,GAC7B,IAAI8+B,EAAO++B,mBAAX,CAIA,GAAIl2D,KAAKi2D,WAAWI,EAAW5rD,EAAGe,EAAI,EAAGf,IAAQK,EAAI,GAAI,CACrD,IAAInK,EAAO+0D,EAAQ51D,YAAY22D,kBAAoB,eACnDz2D,KAAK+pC,MAAM6K,eACX,IAAIoB,EAAUzY,UAAU0I,WAAWtlC,GAC/Bq1C,IACA+X,EAASlxD,IAAIm5C,GACbh2C,KAAKyqD,aAAc,EACnBzqD,KAAKirD,oBAAsB,KAC3BjrD,KAAK+nD,YAAY,CAAC/R,IAClBh2C,KAAKg1C,aAAegB,EACpBh2C,KAAK2mD,iBAAkB,EACvB3Q,EAAQz7C,YAAY,OAAQ48B,EAAO3+B,MACnCw9C,EAAQz7C,YAAY,OAAQ48B,EAAOx2B,MACnCX,KAAKg1C,aAAate,IAAI,GAAK12B,KAAKgtC,YAAY,GAAK,EACjDhtC,KAAKg1C,aAAate,IAAI,GAAK12B,KAAKgtC,YAAY,GAAK,EACjDhtC,KAAK+pC,MAAMmL,cAIlB,CACD/3C,EAAIg4D,UAAY,OAChBh4D,EAAI42D,YACJ52D,EAAI83D,IAAIoB,EAAW5rD,EAAI,GAAIe,EAAQ,GAAJV,EAAS,EAAG,EAAG,EAAIwB,KAAK4oD,IACvD/3D,EAAIoB,OACJpB,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SAAS7+B,EAAO3+B,KAAM69D,EAAW5rD,EAAI,GAAIe,EAAQ,IAAJV,GAEjD3N,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SAAS7+B,EAAOx2B,KAAM01D,EAAW5rD,EAAI,IAAKe,EAAQ,IAAJV,GAClDU,GAAKV,CAhCQ,CAiChB,CAED9K,KAAKi2D,WAAWI,EAAW5rD,EAAGe,EAAI,EAAGf,IAAQK,EAAI,EAAG,IAAK,UAAW,SACpE9K,KAAK02D,kCAAkChB,EA5C1C,CA8CJ,EAED5rB,aAAa3lC,UAAU8xD,WAAa,SAAU3qD,EAAEE,EAAEf,EAAEK,EAAGrS,EAAMwhD,EAAS0c,EAAYC,GAE9E,IAAIz5D,EAAM6C,KAAK7C,IACf88C,EAAUA,GAAW1c,UAAUgB,mBAC/Bo4B,EAAaA,GAAc,OAC3BC,EAAYA,GAAar5B,UAAUc,gBACnC,IAAI3H,EAAM12B,KAAKkqC,GAAGqb,sBAAsBvlD,KAAKgtC,aACzC6pB,EAAQt5B,UAAU2gB,kBAAmBxnB,EAAI,GAAIA,EAAI,GAAIprB,EAAEE,EAAEf,EAAEK,GAE/D,GADA4rB,EAAM12B,KAAKirD,oBAAsB,CAACjrD,KAAKirD,oBAAoB,GAAIjrD,KAAKirD,oBAAoB,IAAM,KACtF,CACJ,IAAIj+B,EAAOhtB,KAAK6qB,OAAOoC,wBACvByJ,EAAI,IAAM1J,EAAKm3B,KACfztB,EAAI,IAAM1J,EAAKO,GAClB,CACD,IAAIupC,EAAUpgC,GAAO6G,UAAU2gB,kBAAmBxnB,EAAI,GAAIA,EAAI,GAAIprB,EAAEE,EAAEf,EAAEK,GAExE3N,EAAIg4D,UAAY0B,EAAQF,EAAa1c,EAClC6c,IACC35D,EAAIg4D,UAAY,QACpBh4D,EAAI42D,YACJ52D,EAAI24D,UAAUxqD,EAAEE,EAAEf,EAAEK,EAAE,CAAC,IACvB3N,EAAIoB,OAEO,MAAR9F,GAEIA,EAAKqH,aAAeqM,SAEnBhP,EAAIg4D,UAAYyB,EAChBz5D,EAAI44D,UAAY,SAChB54D,EAAI2kB,MAAa,IAAJhX,EAAU,GAAK,WAC5B3N,EAAI64D,SAAUv9D,EAAM6S,EAAQ,GAAJb,EAAQe,EAAQ,IAAJV,GACpC3N,EAAI44D,UAAY,QAIxB,IAAIgB,EAAcD,IAAY92D,KAAKyqD,YAGnC,OAFGqM,GACC92D,KAAKwqD,aACFuM,CACV,EAEDjtB,aAAa3lC,UAAU6yD,cAAgB,SAAU1rD,EAAEE,EAAEf,EAAEK,EAAGmsD,GAEtD,IAAIvgC,EAAM12B,KAAK+sC,MACHxP,UAAU2gB,kBAAmBxnB,EAAI,GAAIA,EAAI,GAAIprB,EAAEE,EAAEf,EAAEK,GAE/D,IAAIgsD,GADJpgC,EAAM12B,KAAKirD,sBACU1tB,UAAU2gB,kBAAmBxnB,EAAI,GAAIA,EAAI,GAAIprB,EAAEE,EAAEf,EAAEK,GACpEisD,EAAcD,IAAY92D,KAAKyqD,YAGnC,OAFGqM,GAAWG,GACVj3D,KAAKwqD,aACFuM,CACV,EAMDjtB,aAAa3lC,UAAU+vD,WAAa,SAAS/2D,EAAKmO,EAAGE,GACjDF,EAAIA,GAAK,GACTE,EAAIA,GAAKxL,KAAK6qB,OAAO3Y,aAAe,GAEpC/U,EAAIq1B,OACJr1B,EAAImoD,UAAUh6C,EAAGE,GAEjBrO,EAAI2kB,KAAO,aACX3kB,EAAIg4D,UAAY,OAChBh4D,EAAI44D,UAAY,OACZ/1D,KAAK+pC,OACL5sC,EAAI64D,SAAU,MAAQh2D,KAAK+pC,MAAM+F,WAAWonB,QAAQ,GAAK,IAAK,EAAG,IACjE/5D,EAAI64D,SAAS,MAAQh2D,KAAK+pC,MAAM4F,UAAW,EAAG,IAC9CxyC,EAAI64D,SAAS,MAAQh2D,KAAK+pC,MAAMsF,OAAOt4C,OAAS,KAAOiJ,KAAKumD,cAAcxvD,OAAS,IAAK,EAAG,IAC3FoG,EAAI64D,SAAS,MAAQh2D,KAAK+pC,MAAMqF,SAAU,EAAG,IAC7CjyC,EAAI64D,SAAS,OAASh2D,KAAKqmD,IAAI6Q,QAAQ,GAAI,EAAG,KAE9C/5D,EAAI64D,SAAS,oBAAqB,EAAG,IAEzC74D,EAAIy2D,SACZ,EAMI9pB,aAAa3lC,UAAUsvD,eAAiB,WACpC,IAAI5oC,EAAS7qB,KAAKooD,SAEdv9B,EAAOznB,OAASpD,KAAK6qB,OAAOznB,OAC5BynB,EAAOxnB,QAAUrD,KAAK6qB,OAAOxnB,SAE7BwnB,EAAOznB,MAAQpD,KAAK6qB,OAAOznB,MAC3BynB,EAAOxnB,OAASrD,KAAK6qB,OAAOxnB,QAG3BrD,KAAK+pD,QACN/pD,KAAK+pD,MAAQ/pD,KAAKooD,SAASt9B,WAAW,OAE1C,IAAI3tB,EAAM6C,KAAK+pD,MACX5sD,EAAI0X,OACJ1X,EAAI0X,QAGR,IAAIw5B,EAAWruC,KAAKquC,UAAY,CAAC,EAAE,EAAElxC,EAAI0tB,OAAOznB,MAAMjG,EAAI0tB,OAAOxnB,QAQjE,GALIrD,KAAKmrC,kBACLhuC,EAAI62D,UAAW3lB,EAAS,GAAIA,EAAS,GAAIA,EAAS,GAAIA,EAAS,IAI/DruC,KAAKsnD,cAAgBtnD,KAAKsnD,aAAavwD,OAAQ,CAC/CoG,EAAIq1B,OACexyB,KAAKsnD,aAAatnD,KAAKsnD,aAAavwD,OAAS,GAChE,IAAI6wD,EAAgB5nD,KAAK+pC,MAAM8d,eAC/B1qD,EAAIi4D,YAAcxN,EAAc3N,QAChC98C,EAAIo3D,UAAY,GAChBp3D,EAAIk4D,WAAW,EAAG,EAAGxqC,EAAOznB,MAAQ,EAAGynB,EAAOxnB,OAAS,GACvDlG,EAAIo3D,UAAY,EAChBp3D,EAAI2kB,KAAO,aACX3kB,EAAI44D,UAAY,SAChB54D,EAAIg4D,UAAYvN,EAAc3N,SAAW,OAEzC,IADA,IAAIz3C,EAAQ,GACHnK,EAAI,EAAGA,EAAI2H,KAAKsnD,aAAavwD,SAAUsB,EAC5CmK,GACIxC,KAAKsnD,aAAajvD,GAAGwvD,eAAexN,WAAa,OAEzDl9C,EAAI64D,SACAxzD,EAAQolD,EAAcvN,WACP,GAAfxvB,EAAOznB,MACP,IAEJjG,EAAIy2D,SACP,CAED,IAAIuD,GAAqB,EAazB,GAZIn3D,KAAKo3D,qBACLD,EAAqBn3D,KAAKo3D,mBAAmBvsC,EAAQ1tB,IAInD6C,KAAKquC,WAEPlxC,EAAIy2D,UACJz2D,EAAI02D,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,IAEpC7zD,KAAKouC,cAAcr3C,OAAS,EAExBiJ,KAAK+pC,MAAO,CAiBZ,GAfA5sC,EAAIq1B,OACJxyB,KAAKkqC,GAAGmb,gBAAgBloD,GAGnB6C,KAAKkqC,GAAGZ,MAAQ,MAAQ6tB,GAAsBn3D,KAAKorC,yBAEpDjuC,EAAIg4D,UAAYn1D,KAAKorC,uBACrBjuC,EAAIk6D,SACAr3D,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,KAKtB5pC,KAAKgqC,kBACLhqC,KAAKkqC,GAAGZ,MAAQ,KACf6tB,EACH,CAQE,GAPIn3D,KAAKmqC,kBACLhtC,EAAI04D,aACC,EAAM,GAAM71D,KAAKkqC,GAAGZ,OAAStpC,KAAKirC,aAEvC9tC,EAAI04D,YAAc71D,KAAKirC,aAE3B9tC,EAAIm6D,sBAAwBn6D,EAAIm6D,uBAAwB,GAEnDt3D,KAAKu3D,SACNv3D,KAAKu3D,QAAQ/+D,MAAQwH,KAAKgqC,iBAC5B,CACEhqC,KAAKu3D,QAAU,IAAI5sC,MACnB3qB,KAAKu3D,QAAQ/+D,KAAOwH,KAAKgqC,iBACzBhqC,KAAKu3D,QAAQp2D,IAAMnB,KAAKgqC,iBACxB,IAAIxrB,EAAOxe,KACXA,KAAKu3D,QAAQ3sC,OAAS,WAClBpM,EAAK8rC,MAAK,GAAM,EACxC,CACiB,CAED,IAAIkN,EAAU,KACO,MAAjBx3D,KAAKy3D,UAAoBz3D,KAAKu3D,QAAQn0D,MAAQ,GAC9Co0D,EAAUr6D,EAAIu6D,cAAc13D,KAAKu3D,QAAS,UAC1Cv3D,KAAK23D,aAAe33D,KAAKu3D,QACzBv3D,KAAKy3D,SAAWD,GAEhBA,EAAUx3D,KAAKy3D,SAEfD,IACAr6D,EAAIg4D,UAAYqC,EAChBr6D,EAAIk6D,SACAr3D,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,GAClB5pC,KAAK4pC,aAAa,IAEtBzsC,EAAIg4D,UAAY,eAGpBh4D,EAAI04D,YAAc,EAClB14D,EAAIm6D,sBAAwBn6D,EAAIm6D,uBAAwB,CAC3D,CAGGt3D,KAAK+pC,MAAM2F,QAAQ34C,SAAWiJ,KAAKurC,WACnCvrC,KAAK43D,WAAW/sC,EAAQ1tB,GAGxB6C,KAAKqtC,kBACLrtC,KAAKqtC,iBAAiBlwC,EAAK6C,KAAK4pC,cAEhC5pC,KAAK63D,qBAKL73D,KAAK63D,mBAAqB,MAQ1B73D,KAAKqsC,uBACLlvC,EAAIi4D,YAAc,OAClBj4D,EAAIk4D,WAAW,EAAG,EAAGxqC,EAAOznB,MAAOynB,EAAOxnB,SAG1CrD,KAAKssC,4BACLnvC,EAAI26D,YAAc,OAClB36D,EAAI46D,cAAgB,EACpB56D,EAAI66D,cAAgB,EACpB76D,EAAI86D,WAAa,GAEjB96D,EAAI26D,YAAc,gBAIjB93D,KAAKurC,WACNvrC,KAAKs0D,gBAAgBn3D,GAGzBA,EAAI26D,YAAc,gBAGlB36D,EAAIy2D,SACP,CAEGz2D,EAAI+6D,QACJ/6D,EAAI+6D,SAGRl4D,KAAK6mD,gBAAiB,EACtB7mD,KAAK4mD,cAAe,CAC5B,EAEI,IAAIuR,UAAY,IAAInvB,aAAa,GAMjCc,aAAa3lC,UAAUgwD,SAAW,SAASz8D,EAAMyF,GAE7C6C,KAAKguC,aAAet2C,EAEpB,IAAIiiD,EAAQjiD,EAAKiiD,OAASjiD,EAAKoI,YAAY65C,OAASpc,UAAUgB,mBAC1D0b,EAAUviD,EAAKuiD,SAAWviD,EAAKoI,YAAYm6C,SAAW1c,UAAUiB,qBAGhE9mC,EAAK42D,UAIT,IAAI8J,EAAcp4D,KAAKkqC,GAAGZ,MAAQ,GAGlC,GAAItpC,KAAKurC,UACA7zC,EAAK0uC,MAAM0Y,YACZ3hD,EAAI26D,YAAc,cACdpgE,EAAK41C,kBACL51C,EAAK41C,iBAAiBnwC,EAAK6C,KAAMA,KAAK6qB,aAJlD,CAUA,IAAIogB,EAAejrC,KAAKirC,aAaxB,GAZA9tC,EAAI04D,YAAc5qB,EAEdjrC,KAAKosC,iBAAmBgsB,GACxBj7D,EAAI26D,YAAcv6B,UAAUqB,qBAC5BzhC,EAAI46D,cAAgB,EAAI/3D,KAAKkqC,GAAGZ,MAChCnsC,EAAI66D,cAAgB,EAAIh4D,KAAKkqC,GAAGZ,MAChCnsC,EAAI86D,WAAa,EAAIj4D,KAAKkqC,GAAGZ,OAE7BnsC,EAAI26D,YAAc,eAKlBpgE,EAAK0uC,MAAM0Y,YACXpnD,EAAK2gE,iBAC8B,GAAnC3gE,EAAK2gE,gBAAgBl7D,EAAK6C,MAH9B,CASA,IAAIm6C,EAAQziD,EAAKusC,QAAU1G,UAAUiC,UACjCnqB,EAAO8iD,UACXA,UAAUnjD,IAAItd,EAAK2d,MACnB,IAAI0sC,EAAarqD,EAAKqqD,WAEtB,GAAIrqD,EAAK0uC,MAAM0Y,UAAW,CACtB3hD,EAAI2kB,KAAO9hB,KAAKqqC,gBAChB,IAAI7nC,EAAQ9K,EAAK2iD,SAAW3iD,EAAK2iD,WAAa3iD,EAAK8K,MACtC,MAATA,IACA9K,EAAK0nD,iBAAmB9yC,KAAKgsD,IACzB5gE,EAAK2d,KAAK,GACVlY,EAAIq5D,YAAYh0D,GAAOY,MACO,EAA9Bm6B,UAAUG,mBAEdroB,EAAK,GAAK3d,EAAK0nD,iBACf/pC,EAAK,GAAK,EAEjB,CAEG3d,EAAK6gE,YAELp7D,EAAIq1B,OACJr1B,EAAI42D,YACA5Z,GAAS5c,UAAUiC,UACnBriC,EAAI6vB,KAAK,EAAG,EAAG3X,EAAK,GAAIA,EAAK,IACtB8kC,GAAS5c,UAAUkC,YAC1BtiC,EAAI24D,UAAU,EAAG,EAAGzgD,EAAK,GAAIA,EAAK,GAAI,CAAC,KAChC8kC,GAAS5c,UAAUmC,cAC1BviC,EAAI83D,IACU,GAAV5/C,EAAK,GACK,GAAVA,EAAK,GACK,GAAVA,EAAK,GACL,EACU,EAAV/I,KAAK4oD,IAGb/3D,EAAIggB,QAIJzlB,EAAKwhD,aACLe,EAAU,OAEdj6C,KAAKw4D,cACD9gE,EACAyF,EACAkY,EACAskC,EACAM,EACAviD,EAAKu2D,YACLv2D,EAAK42D,WAETnxD,EAAI26D,YAAc,cAGdpgE,EAAK41C,kBACL51C,EAAK41C,iBAAiBnwC,EAAK6C,KAAMA,KAAK6qB,QAI1C1tB,EAAI44D,UAAYhU,EAAa,SAAW,OACxC5kD,EAAI2kB,KAAO9hB,KAAKqqC,gBAEhB,IAAIouB,GAAeL,EAEfM,EAAW14D,KAAKktD,kBAChByL,EAAU34D,KAAK0tD,iBACnBvwD,EAAIo3D,UAAY,EAEhB,IAAIqE,EAAQ,EACRzI,EAAW,IAAInnB,aAAa,GAGhC,GAAKtxC,EAAK0uC,MAAM0Y,WAgOT,GAAI9+C,KAAK0sC,uBAAwB,CAEpC,IAAImsB,EAAa,KACbC,EAAc,KAGlB,GAAIphE,EAAKu/B,OACL,IAAS5+B,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,OAAQsB,IAAK,CAEzC,GAAiB,OADbihC,EAAO5hC,EAAKu/B,OAAO5+B,IACdgb,KAAT,CAGAwlD,EAAav/B,EACb,KAFC,CAGJ,CAEL,GAAI5hC,EAAKw/B,QACL,IAAS7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,OAAQsB,IAAK,EACtCihC,EAAO5hC,EAAKw/B,QAAQ7+B,IACdu0B,OAAU0M,EAAK1M,MAAM71B,SAG/B+hE,EAAcx/B,EACjB,CAGL,GAAIu/B,EAAY,CACZ,IAAIvtD,EAAI,EACJE,GAAmC,GAA/B+xB,UAAUG,kBACdqkB,IACAz2C,EAA4B,GAAxB5T,EAAK0nD,iBACT5zC,GAAK+xB,UAAUG,mBAEnBvgC,EAAIg4D,UAAY,OAChBh4D,EAAI42D,YAEAz6B,EAAK34B,OAAS48B,UAAUyC,OACxB1G,EAAK6gB,QAAU5c,UAAUiC,UAEzBriC,EAAI6vB,KAAK1hB,EAAI,EAAI,GAAKE,EAAI,EAAG,GAAI,GAC1B8tB,EAAK6gB,QAAU5c,UAAUqC,aAChCziC,EAAI23D,OAAOxpD,EAAI,EAAGE,GAClBrO,EAAI43D,OAAOzpD,GAAK,EAAGE,EAAI,GACvBrO,EAAI43D,OAAOzpD,GAAK,EAAGE,EAAI,GACvBrO,EAAI63D,aAEJ73D,EAAI83D,IAAI3pD,EAAGE,EAAG,EAAG,EAAa,EAAVc,KAAK4oD,IAE7B/3D,EAAIoB,MACP,CAED,GAAIu6D,EAAa,CACTxtD,EAAI5T,EAAK0nD,iBACT5zC,GAAmC,GAA/B+xB,UAAUG,kBACdqkB,IACAz2C,EAA4B,GAAxB5T,EAAK0nD,iBACT5zC,EAAI,GAERrO,EAAIg4D,UAAY,OAChBh4D,EAAIi4D,YAAc,QAClBj4D,EAAI42D,YAEAz6B,EAAK34B,OAAS48B,UAAUyC,OACxB1G,EAAK6gB,QAAU5c,UAAUiC,UAEzBriC,EAAI6vB,KAAK1hB,EAAI,EAAI,GAAKE,EAAI,EAAG,GAAI,GAC1B8tB,EAAK6gB,QAAU5c,UAAUqC,aAChCziC,EAAI23D,OAAOxpD,EAAI,EAAGE,GAClBrO,EAAI43D,OAAOzpD,EAAI,EAAGE,EAAI,GACtBrO,EAAI43D,OAAOzpD,EAAI,EAAGE,EAAI,GACtBrO,EAAI63D,aAEJ73D,EAAI83D,IAAI3pD,EAAGE,EAAG,EAAG,EAAa,EAAVc,KAAK4oD,IAE7B/3D,EAAIoB,MAEP,CACJ,MA7S0B,CAEvB,GAAI7G,EAAKu/B,OACL,IAAK,IAAI5+B,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,OAAQsB,IAAK,CACzC,IAEIqsC,GAFApL,EAAO5hC,EAAKu/B,OAAO5+B,IAEFsI,KACjBo4D,EAAaz/B,EAAK6gB,MAEtBh9C,EAAI04D,YAAc5qB,EAEbjrC,KAAKktD,oBAAsB3vB,UAAU+J,kBAAmBhO,EAAK34B,KAAO+3D,EAAS/3D,QAC9ExD,EAAI04D,YAAc,GAAM5qB,GAG5B9tC,EAAIg4D,UACa,MAAb77B,EAAKjmB,KACCimB,EAAK0/B,UACPh5D,KAAK6qC,gCAAgCnG,IACrC1kC,KAAKwqC,yBAAyBE,SAC5BpR,EAAK2/B,WACPj5D,KAAK8qC,mCAAmCpG,IACxC1kC,KAAK6qC,gCAAgCnG,IACrC1kC,KAAKwqC,yBAAyBC,WAElC/T,EAAMh/B,EAAK+nD,kBAAiB,EAAMpnD,EAAG83D,IACrC,IAAMz4D,EAAKg/B,IAAI,GACnBA,EAAI,IAAMh/B,EAAKg/B,IAAI,GACfkiC,EAAQliC,EAAI,GAAkC,GAA7B6G,UAAUK,mBAC3Bg7B,EAAQliC,EAAI,GAAkC,GAA7B6G,UAAUK,kBAG/BzgC,EAAI42D,YAEa,SAAbrvB,IACAq0B,EAAax7B,UAAUsC,YAG3B,IAAIq5B,GAAW,EA8Cf,GA3CI5/B,EAAK34B,OAAS48B,UAAUyC,OACxB1G,EAAK6gB,QAAU5c,UAAUiC,UAErBuiB,EACA5kD,EAAI6vB,KACA0J,EAAI,GAAK,EAAI,GACbA,EAAI,GAAK,EAAI,GACb,GACA,IAGJv5B,EAAI6vB,KACA0J,EAAI,GAAK,EAAI,GACbA,EAAI,GAAK,EAAI,GACb,GACA,IAGDqiC,IAAex7B,UAAUqC,aAChCziC,EAAI23D,OAAOp+B,EAAI,GAAK,EAAGA,EAAI,GAAK,IAChCv5B,EAAI43D,OAAOr+B,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAI,IACpCv5B,EAAI43D,OAAOr+B,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAI,IACpCv5B,EAAI63D,aACG+D,IAAex7B,UAAUsC,YAChC1iC,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCwiC,GAAW,GAERd,EACCj7D,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GAEpCv5B,EAAI83D,IAAIv+B,EAAI,GAAIA,EAAI,GAAI,EAAG,EAAa,EAAVpqB,KAAK4oD,IAE3C/3D,EAAIoB,OAGAk6D,GACIhgE,EAAqB,MAAd6gC,EAAKrU,MAAgBqU,EAAKrU,MAAQqU,EAAK9gC,QAE9C2E,EAAIg4D,UAAY53B,UAAUc,gBACtB0jB,GAAczoB,EAAKq7B,KAAOp3B,UAAUiD,GACpCrjC,EAAI64D,SAASv9D,EAAMi+B,EAAI,GAAIA,EAAI,GAAK,IAEpCv5B,EAAI64D,SAASv9D,EAAMi+B,EAAI,GAAK,GAAIA,EAAI,GAAK,GAIxD,CAOL,GAFAv5B,EAAI44D,UAAYhU,EAAa,SAAW,QACxC5kD,EAAIi4D,YAAc,QACd19D,EAAKw/B,QACL,IAAK,IAAI7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,OAAQsB,IAAK,CAC1C,IAAIihC,EAUA5C,EARAgO,GAFApL,EAAO5hC,EAAKw/B,QAAQ7+B,IAEHsI,KACjBo4D,EAAaz/B,EAAK6gB,MAGlBn6C,KAAK0tD,mBAAqBnwB,UAAU+J,kBAAmB5C,EAAYi0B,EAAQh4D,QAC3ExD,EAAI04D,YAAc,GAAM5qB,IAGxBvU,EAAMh/B,EAAK+nD,kBAAiB,EAAOpnD,EAAG83D,IACtC,IAAMz4D,EAAKg/B,IAAI,GACnBA,EAAI,IAAMh/B,EAAKg/B,IAAI,GACfkiC,EAAQliC,EAAI,GAAkC,GAA7B6G,UAAUK,mBAC3Bg7B,EAAQliC,EAAI,GAAkC,GAA7B6G,UAAUK,kBAG/BzgC,EAAIg4D,UACA77B,EAAK1M,OAAS0M,EAAK1M,MAAM71B,OACnBuiC,EAAK0/B,UACPh5D,KAAK6qC,gCAAgCnG,IACrC1kC,KAAKwqC,yBAAyBI,UAC5BtR,EAAK2/B,WACPj5D,KAAK8qC,mCAAmCpG,IACxC1kC,KAAK6qC,gCAAgCnG,IACrC1kC,KAAKwqC,yBAAyBG,WACtCxtC,EAAI42D,YAGa,SAAbrvB,IACAq0B,EAAax7B,UAAUsC,YAG3B,IAuDQpnC,EAvDJygE,GAAW,EAsDf,GAnDIx0B,IAAcnH,UAAUyC,OACxB+4B,IAAex7B,UAAUiC,UAErBuiB,EACA5kD,EAAI6vB,KACA0J,EAAI,GAAK,EAAI,GACbA,EAAI,GAAK,EAAI,GACb,GACA,IAGJv5B,EAAI6vB,KACA0J,EAAI,GAAK,EAAI,GACbA,EAAI,GAAK,EAAI,GACb,GACA,IAGDqiC,IAAex7B,UAAUqC,aAChCziC,EAAI23D,OAAOp+B,EAAI,GAAK,EAAGA,EAAI,GAAK,IAChCv5B,EAAI43D,OAAOr+B,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAI,IACpCv5B,EAAI43D,OAAOr+B,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAI,IACpCv5B,EAAI63D,aACI+D,IAAex7B,UAAUsC,YACjC1iC,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCv5B,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GACpCwiC,GAAW,GAERd,EACCj7D,EAAI6vB,KAAK0J,EAAI,GAAK,EAAGA,EAAI,GAAK,EAAG,EAAG,GAEpCv5B,EAAI83D,IAAIv+B,EAAI,GAAIA,EAAI,GAAI,EAAG,EAAa,EAAVpqB,KAAK4oD,IAQ3C/3D,EAAIoB,QACA65D,GAAec,GACf/7D,EAAIg8D,SAGJV,GACIhgE,EAAqB,MAAd6gC,EAAKrU,MAAgBqU,EAAKrU,MAAQqU,EAAK9gC,QAE9C2E,EAAIg4D,UAAY53B,UAAUc,gBACtB0jB,GAAczoB,EAAKq7B,KAAOp3B,UAAUkD,KACpCtjC,EAAI64D,SAASv9D,EAAMi+B,EAAI,GAAIA,EAAI,GAAK,GAEpCv5B,EAAI64D,SAASv9D,EAAMi+B,EAAI,GAAK,GAAIA,EAAI,GAAK,GAIxD,CAML,GAHAv5B,EAAI44D,UAAY,OAChB54D,EAAI04D,YAAc,EAEdn+D,EAAKqjC,QAAS,CACd,IAAIq+B,EAAYR,GACZ7W,GAAcrqD,EAAKimD,cACnByb,EAAY,GAEY,MAAxB1hE,EAAKkmD,kBACLwb,EAAY1hE,EAAKkmD,iBACrB59C,KAAKq5D,gBACD3hE,EACA0hE,EACAj8D,EACA6C,KAAKiuC,aAAejuC,KAAKiuC,YAAY,IAAMv2C,EACrCsI,KAAKiuC,YAAY,GACjB,KAEb,CACb,CA+EYv2C,EAAK6gE,WACLp7D,EAAIy2D,UAGRz2D,EAAI04D,YAAc,CA/XjB,CArBA,CAqZT,EAGI/rB,aAAa3lC,UAAUmxD,gBAAkB,SAAUn4D,EAAKkW,GAEpD,IAAIqjB,EAAMrjB,EAAK01B,KAMf,GALA5rC,EAAIg4D,UAAY,QAChBh4D,EAAI42D,YACJ52D,EAAI83D,IAAKv+B,EAAI,GAAIA,EAAI,GAAI,EAAG,EAAa,EAAVpqB,KAAK4oD,IACpC/3D,EAAIoB,OAEY,MAAb8U,EAAK3a,QAGLsH,KAAKwtC,mBACyC,GAAzCxtC,KAAKwtC,kBAAkBrwC,EAAIkW,EAAKrT,OADxC,CAIA,IAAItH,EAAO2a,EAAK3a,KACZD,EAAO,KAaX,GAAW,OAVPA,EADAC,EAAKoH,cAAgBihD,OACdroD,EAAKw+D,QAAQ,GACfx+D,EAAKoH,cAAgBqM,OACnB,IAAOzT,EAAO,IAChBA,EAAKoH,cAAgBgM,QACnBK,OAAOzT,GACTA,EAAK4gE,UACH5gE,EAAK4gE,YAEL,IAAM5gE,EAAKoH,YAAYtH,KAAO,KAEzC,CAEAC,EAAOA,EAAK6d,OAAO,EAAE,IAErBnZ,EAAI2kB,KAAO,mBACX,IACIrX,EADOtN,EAAIq5D,YAAY/9D,GACd2K,MAAQ,GAErBjG,EAAI26D,YAAc,QAClB36D,EAAI46D,cAAgB,EACpB56D,EAAI66D,cAAgB,EACpB76D,EAAI86D,WAAa,EACjB96D,EAAIg4D,UAAY,OAChBh4D,EAAI42D,YACJ52D,EAAI24D,UAAWp/B,EAAI,GAAO,GAAFjsB,EAAOisB,EAAI,GAAK,GAPhC,GAOwCjsB,EAPxC,GAO8C,CAAC,IACvDtN,EAAI23D,OAAQp+B,EAAI,GAAK,GAAIA,EAAI,GAAK,IAClCv5B,EAAI43D,OAAQr+B,EAAI,GAAK,GAAIA,EAAI,GAAK,IAClCv5B,EAAI43D,OAAQr+B,EAAI,GAAIA,EAAI,GAAK,GAC7Bv5B,EAAIoB,OACJpB,EAAI26D,YAAc,cAClB36D,EAAI44D,UAAY,SAChB54D,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SAASv9D,EAAMi+B,EAAI,GAAIA,EAAI,GAAK,GAf5B,GAeqC,GArBlC,CAjBI,CAuClB,EAMD,IAAI6iC,SAAW,IAAIvwB,aAAa,GAEhCc,aAAa3lC,UAAUq0D,cAAgB,SACnC9gE,EACAyF,EACAkY,EACAmkD,EACAvf,EACA92C,EACAs2D,GAGAt8D,EAAIi4D,YAAcoE,EAClBr8D,EAAIg4D,UAAYlb,EAEhB,IAAIiW,EAAe3yB,UAAUG,kBACzB06B,EAAcp4D,KAAKkqC,GAAGZ,MAAQ,GAG9B6Q,EACAziD,EAAKusC,QAAUvsC,EAAKoI,YAAYq6C,OAAS5c,UAAUkC,YAEnDkW,EAAaj+C,EAAKoI,YAAY61C,WAE9B+jB,GAAe,EACf/jB,GAAcpY,UAAU4D,mBAAqBwU,GAAcpY,UAAU2D,SACrEw4B,GAAe,EACR/jB,GAAcpY,UAAU6D,gBAAkBq4B,IACjDC,GAAe,GAGnB,IAAI5F,EAAOyF,SACXzF,EAAK,GAAK,EACVA,EAAK,GAAK4F,GAAgBxJ,EAAe,EACzC4D,EAAK,GAAKz+C,EAAK,GAAK,EACpBy+C,EAAK,GAAK4F,EAAerkD,EAAK,GAAK66C,EAAe76C,EAAK,GAEvD,IAAIskD,EAAYx8D,EAAI04D,YA6CpB,GAxCI14D,EAAI42D,YACA5Z,GAAS5c,UAAUiC,WAAa44B,EAChCj7D,EAAIk6D,SAASvD,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE7C3Z,GAAS5c,UAAUkC,aACnB0a,GAAS5c,UAAUoC,WAEnBxiC,EAAI24D,UACAhC,EAAK,GACLA,EAAK,GACLA,EAAK,GACLA,EAAK,GACL3Z,GAAS5c,UAAUoC,WAAa,CAAC3/B,KAAK+tC,aAAa/tC,KAAK+tC,aAAa,EAAE,GAAK,CAAC/tC,KAAK+tC,eAE/EoM,GAAS5c,UAAUmC,cAC1BviC,EAAI83D,IACU,GAAV5/C,EAAK,GACK,GAAVA,EAAK,GACK,GAAVA,EAAK,GACL,EACU,EAAV/I,KAAK4oD,IAGb/3D,EAAIoB,QAGA7G,EAAK0uC,MAAM0Y,WAAa4a,IAExBv8D,EAAI26D,YAAc,cAClB36D,EAAIg4D,UAAY,kBAChBh4D,EAAIk6D,SAAS,GAAI,EAAGvD,EAAK,GAAI,IAGrC32D,EAAI26D,YAAc,cAEdpgE,EAAK21C,kBACL31C,EAAK21C,iBAAiBlwC,EAAK6C,KAAMA,KAAK6qB,OAAQ7qB,KAAKgtC,aAInD0sB,GAAgB/jB,GAAcpY,UAAU4D,kBAAmB,CAE3D,GAAIzpC,EAAKkiE,eACLliE,EAAKkiE,eAAgBz8D,EAAK+yD,EAAc76C,EAAMrV,KAAKkqC,GAAGZ,MAAOkwB,QAC1D,GACH7jB,GAAcpY,UAAU4D,oBACvBzpC,EAAKoI,YAAY+5D,aAAe75D,KAAK4sC,sBACxC,CACE,IAAIitB,EAAcniE,EAAKoI,YAAY+5D,aAAeL,EAOlD,GALI9hE,EAAK0uC,MAAM0Y,YACX3hD,EAAI26D,YAAcv6B,UAAUqB,sBAI5B5+B,KAAKgrC,cAAe,CACpB,IAAI8uB,EAAOhwB,aAAamc,UAAU4T,GAC7BC,KACDA,EAAOhwB,aAAamc,UAAW4T,GAAgB18D,EAAI48D,qBAAqB,EAAG,EAAG,IAAK,IAC9EC,aAAa,EAAGH,GACrBC,EAAKE,aAAa,EAAG,SAEzB78D,EAAIg4D,UAAY2E,CACpC,MACoB38D,EAAIg4D,UAAY0E,EAIpB18D,EAAI42D,YACA5Z,GAAS5c,UAAUiC,WAAa44B,EAChCj7D,EAAI6vB,KAAK,GAAIkjC,EAAc76C,EAAK,GAAK,EAAG66C,GAC/B/V,GAAS5c,UAAUkC,aAAe0a,GAAS5c,UAAUoC,YAC9DxiC,EAAI24D,UACA,GACC5F,EACD76C,EAAK,GAAK,EACV66C,EACAx4D,EAAK0uC,MAAM0Y,UAAY,CAAC9+C,KAAK+tC,cAAgB,CAAC/tC,KAAK+tC,aAAa/tC,KAAK+tC,aAAa,EAAE,IAG5F5wC,EAAIoB,OACJpB,EAAI26D,YAAc,aACrB,CAED,IAAImC,GAAW,EACX18B,UAAU4E,2BACP5E,UAAU4C,kBAAkBzoC,EAAKwI,QAChC+5D,EAAW18B,UAAU4C,kBAAkBzoC,EAAKwI,OAGhDq9B,UAAU2E,4BACV+3B,EAAWviE,EAAK6kD,iBAAmB,OAAU7kD,EAAK4kD,kBAAoB,OAAS2d,GAInF,IAAIC,EAAW,GAmEf,GAlEIxiE,EAAKyiE,eACLziE,EAAKyiE,eAAeh9D,EAAK+yD,EAAc76C,EAAMrV,KAAKkqC,GAAGZ,OAErD6Q,GAAS5c,UAAUkC,aACnB0a,GAAS5c,UAAUmC,cACnBya,GAAS5c,UAAUoC,YAEfy4B,IACAj7D,EAAIg4D,UAAY,QAChBh4D,EAAI42D,YACJ52D,EAAI83D,IACe,GAAf/E,GACgB,GAAhBA,EACAgK,EACA,EACU,EAAV5tD,KAAK4oD,IAET/3D,EAAIoB,QAGRpB,EAAIg4D,UAAYz9D,EAAKwiD,UAAY+f,GAAY18B,UAAUkB,sBACpD25B,EACCj7D,EAAIk6D,SAAyB,GAAfnH,EAAqBgK,GAA+B,GAAhBhK,EAAsBgK,EAAeA,EAAWA,IAGlG/8D,EAAI42D,YACJ52D,EAAI83D,IACe,GAAf/E,GACgB,GAAhBA,EACAgK,EACA,EACU,EAAV5tD,KAAK4oD,IAET/3D,EAAIoB,UAGJ65D,IACAj7D,EAAIg4D,UAAY,QAChBh4D,EAAIk6D,SAC4B,IAA3BnH,EAAegK,GAAkB,GACL,IAA5BhK,EAAegK,GAAmB,EACnCA,GACAA,KAGR/8D,EAAIg4D,UAAYz9D,EAAKwiD,UAAY+f,GAAY18B,UAAUkB,sBACvDthC,EAAIk6D,SAC4B,IAA3BnH,EAAegK,IACa,IAA5BhK,EAAegK,GAChBA,EACAA,IAGR/8D,EAAI04D,YAAc8D,EAGdjiE,EAAK0iE,iBACL1iE,EAAK0iE,gBACDj9D,EACA+yD,EACA76C,EACArV,KAAKkqC,GAAGZ,MACRtpC,KAAKoqC,gBACLjnC,IAGHi1D,EAAa,CACdj7D,EAAI2kB,KAAO9hB,KAAKoqC,gBAChB,IAAI5nC,EAAQ2J,OAAOzU,EAAK2iD,YACpB73C,IAEIrF,EAAIg4D,UADJhyD,EACgBo6B,UAAUY,0BAGtBzmC,EAAKoI,YAAYu6D,kBACjBr6D,KAAKsqC,iBAET5yC,EAAK0uC,MAAM0Y,WACX3hD,EAAI44D,UAAY,OACF54D,EAAIq5D,YAAYh0D,GAC9BrF,EAAI64D,SACAxzD,EAAM8T,OAAO,EAAE,IACf45C,EACA3yB,UAAUI,kBAAoBuyB,GAElC/yD,EAAI44D,UAAY,SAEhB54D,EAAI44D,UAAY,OAChB54D,EAAI64D,SACAxzD,EACA0tD,EACA3yB,UAAUI,kBAAoBuyB,IAI7C,CAGD,IAAKx4D,EAAK0uC,MAAM0Y,WAAapnD,EAAKq2D,WAAar2D,EAAKs2D,qBAAsB,CACtE,IAAIvjD,EAAI8yB,UAAUG,kBACdpyB,EAAI5T,EAAK2d,KAAK,GAAK5K,EACnB6vD,EAAO/8B,UAAU2gB,kBAAmBl+C,KAAKgtC,YAAY,GAAKt1C,EAAKg/B,IAAI,GAAI12B,KAAKgtC,YAAY,GAAKt1C,EAAKg/B,IAAI,GAAIprB,EAAE,EAAM,EAAFb,EAAKA,EAAE,EAAGA,EAAE,GAChItN,EAAIg4D,UAAYmF,EAAO,OAAS,OAC5BngB,GAAS5c,UAAUiC,WAAa44B,EAChCj7D,EAAIk6D,SAAS/rD,EAAE,EAAM,EAAFb,EAAKA,EAAE,EAAGA,EAAE,IAG/BtN,EAAI42D,YACJ52D,EAAI24D,UAAUxqD,EAAE,EAAM,EAAFb,EAAKA,EAAE,EAAGA,EAAE,EAAE,CAAC,IACnCtN,EAAIoB,QAERpB,EAAIg4D,UAAY,OAChBh4D,EAAI42D,YACJ52D,EAAI23D,OAAOxpD,EAAQ,GAAJb,EAAc,IAAJA,GACzBtN,EAAI43D,OAAOzpD,EAAQ,GAAJb,EAAc,IAAJA,GACzBtN,EAAI43D,OAAOzpD,EAAQ,GAAJb,EAAc,IAAJA,GACzBtN,EAAIoB,MACP,CAGG7G,EAAK6iE,aACL7iE,EAAK6iE,YAAYp9D,EAExB,CAGGgG,IACIzL,EAAK2nD,YACL3nD,EAAK2nD,WAAWyU,GAGhBne,GAAcpY,UAAU4D,oBACxB2yB,EAAK,IAAM5D,EACX4D,EAAK,IAAM5D,GAEf/yD,EAAIo3D,UAAY,EAChBp3D,EAAI04D,YAAc,GAClB14D,EAAI42D,YACA5Z,GAAS5c,UAAUiC,UACnBriC,EAAI6vB,MACC,EAAI8mC,EAAK,IACT,EAAIA,EAAK,GACV,GAAKA,EAAK,GACV,GAAKA,EAAK,IAGd3Z,GAAS5c,UAAUkC,aAClB0a,GAAS5c,UAAUoC,YAAcjoC,EAAK0uC,MAAM0Y,UAE7C3hD,EAAI24D,WACC,EAAIhC,EAAK,IACT,EAAIA,EAAK,GACV,GAAKA,EAAK,GACV,GAAKA,EAAK,GACV,CAAqB,EAApB9zD,KAAK+tC,eAEHoM,GAAS5c,UAAUoC,WAC1BxiC,EAAI24D,WACC,EAAIhC,EAAK,IACT,EAAIA,EAAK,GACV,GAAKA,EAAK,GACV,GAAKA,EAAK,GACV,CAAqB,EAApB9zD,KAAK+tC,aAAiB,EAAsB,EAApB/tC,KAAK+tC,aAAiB,IAE5CoM,GAAS5c,UAAUmC,cAC1BviC,EAAI83D,IACU,GAAV5/C,EAAK,GACK,GAAVA,EAAK,GACK,GAAVA,EAAK,GAAW,EAChB,EACU,EAAV/I,KAAK4oD,IAGb/3D,EAAIi4D,YAAc73B,UAAUoB,uBAC5BxhC,EAAIg8D,SACJh8D,EAAIi4D,YAAcoE,EAClBr8D,EAAI04D,YAAc,GAIlBn+D,EAAK4kD,kBAAkB,GAAG5kD,EAAK4kD,oBAC/B5kD,EAAK6kD,iBAAiB,GAAG7kD,EAAK6kD,kBAC1C,EAEI,IAAIie,YAAc,IAAIxxB,aAAa,GAC/ByxB,cAAgB,IAAIzxB,aAAa,GACjC0xB,MAAQ,IAAI1xB,aAAa,GACzB2xB,MAAQ,IAAI3xB,aAAa,GAuqI7B,SAAS4xB,eAAe1kE,EAAGC,GACvB,IAAK,IAAIkC,KAAKnC,EACV,GAAIA,EAAEmC,IAAMlC,EAAEkC,GACV,OAAO,EAGf,OAAO,CACV,CAGD,SAASu0D,SAAS12D,EAAGC,GACjB,OAAOmW,KAAKuuD,MACP1kE,EAAE,GAAKD,EAAE,KAAOC,EAAE,GAAKD,EAAE,KAAOC,EAAE,GAAKD,EAAE,KAAOC,EAAE,GAAKD,EAAE,IAEjE,CAGD,SAAS4kE,cAAcv9D,GACnB,MACI,QACA+O,KAAK01C,MAAa,IAAPzkD,EAAE,IAAU25D,UACvB,IACA5qD,KAAK01C,MAAa,IAAPzkD,EAAE,IAAU25D,UACvB,IACA5qD,KAAK01C,MAAa,IAAPzkD,EAAE,IAAU25D,UACvB,KACa,GAAZ35D,EAAExG,OAAcwG,EAAE,GAAG25D,QAAQ,GAAK,OACnC,GAEP,CAGD,SAAShZ,kBAAkB5yC,EAAGE,EAAG24C,EAAM52B,EAAKnqB,EAAOC,GAC/C,OAAI8gD,EAAO74C,GAAK64C,EAAO/gD,EAAQkI,GAAKiiB,EAAM/hB,GAAK+hB,EAAMlqB,EAASmI,CAIjE,CAID,SAASuvD,aAAaxkC,EAAUjrB,EAAGE,GAC3BF,EAAIirB,EAAS,GACbA,EAAS,GAAKjrB,EACPA,EAAIirB,EAAS,KACpBA,EAAS,GAAKjrB,GAGdE,EAAI+qB,EAAS,GACbA,EAAS,GAAK/qB,EACPA,EAAI+qB,EAAS,KACpBA,EAAS,GAAK/qB,EAErB,CAID,SAASwvD,iBAAiB99D,EAAG+9D,GACzB,QACI/9D,EAAE,GAAK+9D,EAAG,GAAG,IACb/9D,EAAE,GAAK+9D,EAAG,GAAG,IACb/9D,EAAE,GAAK+9D,EAAG,GAAG,IACb/9D,EAAE,GAAK+9D,EAAG,GAAG,GAKpB,CAID,SAASvX,gBAAgBxtD,EAAGC,GACxB,IAAI+kE,EAAUhlE,EAAE,GAAKA,EAAE,GACnBilE,EAAUjlE,EAAE,GAAKA,EAAE,GACnBklE,EAAUjlE,EAAE,GAAKA,EAAE,GACnBklE,EAAUllE,EAAE,GAAKA,EAAE,GAEvB,QACID,EAAE,GAAKklE,GACPllE,EAAE,GAAKmlE,GACPH,EAAU/kE,EAAE,IACZglE,EAAUhlE,EAAE,GAKnB,CAMD,SAASmlE,QAAQC,GACQ,KAAjBA,EAAIn0D,OAAO,KACXm0D,EAAMA,EAAIj0D,MAAM,IAEpBi0D,EAAMA,EAAIl0D,cAKV,IAJA,IAGIm0D,EAAMC,EAHNC,EAAgB,mBAChBpkE,EAAQ,IAAIsC,MAAM,GAClB6Y,EAAI,EAECpa,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxBmjE,EAAOE,EAAcl+D,QAAQ+9D,EAAIn0D,OAAO/O,IACxCojE,EAAOC,EAAcl+D,QAAQ+9D,EAAIn0D,OAAO/O,EAAI,IAC5Cf,EAAMmb,GAAY,GAAP+oD,EAAYC,EACvBhpD,IAEJ,OAAOnb,CACV,CAMD,SAASqkE,QAAQC,GAIb,IAHA,IAEIJ,EAAMC,EAFNC,EAAgB,mBAChBH,EAAM,IAEDljE,EAAI,EAAGA,EAAI,EAAGA,IACnBmjE,EAAOI,EAAQvjE,GAAK,GACpBojE,EAAOG,EAAQvjE,GAAK,GAEpBkjE,GAAOG,EAAct0D,OAAOo0D,GAAQE,EAAct0D,OAAOq0D,GAE7D,OAAOF,CACV,CAkBD,SAASM,YAAYtd,EAAQtlD,GACzBA,EAAUA,GAAW,GACrB+G,KAAK/G,QAAUA,EACf,IAAIulB,EAAOxe,KAGP/G,EAAQ6iE,aACJ7iE,EAAQ6iE,WAAWh8D,cAAgBE,KAAKF,YAIxC7G,EAAQ6iE,WAAa,MAErB97D,KAAK87D,WAAa7iE,EAAQ6iE,WAC1B97D,KAAK87D,WAAWC,MAAO,EACvB/7D,KAAK87D,WAAWE,gBAAkBh8D,OAI1C,IAAIi8D,EAAa,KACdhjE,EAAQF,QACPkjE,EAAahjE,EAAQF,MAAM+G,YAAYtH,MACvB,eAAfyjE,GACc,gBAAfA,GACe,iBAAfA,IAKAhjE,EAAQF,MAAQ,MAGpB,IAAIqG,EAAO3I,SAASC,cAAc,OA8ClC,SAASwlE,EAAez/D,GACpB,IAAIi6B,EAAMrb,SAASjc,EAAK/E,MAAMkzB,KAI9B,OAHAnuB,EAAK/E,MAAMkzB,KACNmJ,EAAMj6B,EAAEsoD,OAAS9rD,EAAQkjE,cAAcjF,UAAY,KACxDz6D,EAAE6V,kBACK,CACV,CAYD,GA/DAlT,EAAK0H,UAAY,8CACb7N,EAAQ6N,YACR1H,EAAK0H,WAAa,IAAM7N,EAAQ6N,WAEpC1H,EAAK/E,MAAM+hE,SAAW,IACtBh9D,EAAK/E,MAAMgiE,UAAY,IACvBj9D,EAAK/E,MAAMiiE,cAAgB,OAC3BhvD,YAAW,WACPlO,EAAK/E,MAAMiiE,cAAgB,MAC9B,GAAE,KAGH/+B,UAAUqmB,mBAAmBxkD,EAAK,MAC9B,SAAS3C,GAGL,OADAA,EAAE6V,kBACK,CACV,IACD,GAEJlT,EAAKlG,iBACD,eACA,SAASuD,GACL,OAAgB,GAAZA,EAAEoW,QAINpW,EAAE6V,kBAFS,CAId,IACD,GAGJirB,UAAUqmB,mBAAmBxkD,EAAK,QAC9B,SAAS3C,GAEL,GAAgB,GAAZA,EAAEoW,OAGF,OAFA2L,EAAKrQ,QACL1R,EAAE6V,kBACK,CAEd,IACD,GAWCrZ,EAAQkjE,eACTljE,EAAQkjE,aAAe,IAG3B/8D,EAAKlG,iBAAiB,QAASgjE,GAAgB,GAC/C98D,EAAKlG,iBAAiB,aAAcgjE,GAAgB,GAEpDl8D,KAAKZ,KAAOA,EAGRnG,EAAQuJ,MAAO,CACf,IAAIjK,EAAU9B,SAASC,cAAc,OACrC6B,EAAQuO,UAAY,iBACpBvO,EAAQmN,UAAYzM,EAAQuJ,MAC5BpD,EAAKzH,YAAYY,EACpB,CAID,IAAK,IAAIF,EAAE,EAAGA,EAAIkmD,EAAOxnD,OAAQsB,IAAK,CAClC,IAAIG,EAAO+lD,EAAOz+C,aAAelG,MAAQ2kD,EAAOlmD,GAAKA,EACzC,MAARG,GAAgBA,EAAKsH,cAAgBqM,SACrC3T,OAAwB0xB,IAAjB1xB,EAAKwP,QAAwBmE,OAAO3T,GAAQA,EAAKwP,SAE5D,IAAI1Q,EAAQinD,EAAOlmD,GACnB2H,KAAKu8D,QAAQ/jE,EAAMlB,EAAO2B,EAE7B,CAeDskC,UAAUqmB,mBAAmBxkD,EAAK,SAAS,SAAS3C,GAE5C2C,EAAKo9D,eACLxuD,aAAa5O,EAAKo9D,cAElC,IAGQ,IAAIC,EAAgBhmE,SAChBwC,EAAQF,QACR0jE,EAAgBxjE,EAAQF,MAAMtB,OAAOwyD,eAGpCwS,IACDA,EAAgBhmE,UAGhBgmE,EAAcC,kBACdD,EAAcC,kBAAkB/kE,YAAYyH,GAE5Cq9D,EAAcnrD,KAAK3Z,YAAYyH,GAGnC,IAAI+kD,EAAOlrD,EAAQkrD,MAAQ,EACvB52B,EAAMt0B,EAAQs0B,KAAO,EACzB,GAAIt0B,EAAQF,MAAO,CAOf,GANAorD,EAAOlrD,EAAQF,MAAMmrD,QAAU,GAC/B32B,EAAMt0B,EAAQF,MAAMqrD,QAAU,GAC1BnrD,EAAQuJ,QACR+qB,GAAO,IAGPt0B,EAAQ6iE,WAAY,CACpB,IAAI9uC,EAAO/zB,EAAQ6iE,WAAW18D,KAAK6tB,wBACnCk3B,EAAOn3B,EAAKm3B,KAAOn3B,EAAK5pB,KAC3B,CAED,IAAIu5D,EAAYlmE,SAAS6a,KAAK2b,wBAC1B2vC,EAAYx9D,EAAK6tB,wBAClB0vC,EAAUt5D,OAGTs5D,EAAUv5D,OAAS+gD,EAAOwY,EAAUv5D,MAAQw5D,EAAUx5D,MAAQ,KAC9D+gD,EAAOwY,EAAUv5D,MAAQw5D,EAAUx5D,MAAQ,IAE3Cu5D,EAAUt5D,QAAUkqB,EAAMovC,EAAUt5D,OAASu5D,EAAUv5D,OAAS,KAChEkqB,EAAMovC,EAAUt5D,OAASu5D,EAAUv5D,OAAS,GAEnD,CAEDjE,EAAK/E,MAAM8pD,KAAOA,EAAO,KACzB/kD,EAAK/E,MAAMkzB,IAAMA,EAAM,KAEnBt0B,EAAQqwC,QACRlqC,EAAK/E,MAAMuQ,UAAY,SAAW3R,EAAQqwC,MAAQ,IAEzD,CA+QD,SAASuzB,YAAahkD,GAElB7Y,KAAK6Y,OAASA,EACd7Y,KAAKmD,UAAY,EACjBnD,KAAK88D,SAAW,EAChB98D,KAAKqV,KAAO,KACZrV,KAAK+8D,aAAc,EACnB/8D,KAAKyzC,OAAS,CACjB,CAkRD,SAASupB,MAAMzyD,EAAGrU,EAAGC,GACjB,OAAOD,EAAIqU,EAAIrU,EAAIC,EAAIoU,EAAIpU,EAAIoU,CACvC,CAlhKIu/B,aAAa3lC,UAAUmwD,gBAAkB,SAASn3D,GAC9C,IAAI0xC,EAAMtR,UAAUqR,UAChBhF,EAAe5pC,KAAK4pC,aACxB4wB,YAAY,GAAK5wB,EAAa,GAAK,GACnC4wB,YAAY,GAAK5wB,EAAa,GAAK,GACnC4wB,YAAY,GAAK5wB,EAAa,GAAK,GACnC4wB,YAAY,GAAK5wB,EAAa,GAAK,GAGnCzsC,EAAIo3D,UAAYv0D,KAAK8tC,kBAErB3wC,EAAIg4D,UAAY,OAChBh4D,EAAIi4D,YAAc,OAClBj4D,EAAI04D,YAAc71D,KAAKirC,aAGvB,IADA,IAAIxrC,EAAQO,KAAK+pC,MAAMsF,OACd5rC,EAAI,EAAG/D,EAAID,EAAM1I,OAAQ0M,EAAI/D,IAAK+D,EAAG,CAC1C,IAAI/L,EAAO+H,EAAMgE,GAEjB,GAAK/L,EAAKu/B,QAAWv/B,EAAKu/B,OAAOlgC,OAIjC,IAAK,IAAIsB,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,SAAUsB,EAAG,CACzC,IAAI4B,EAAQvC,EAAKu/B,OAAO5+B,GACxB,GAAK4B,GAAuB,MAAdA,EAAMoZ,KAApB,CAGA,IAAIs/B,EAAU14C,EAAMoZ,KAChBA,EAAOrT,KAAK+pC,MAAMnd,MAAM+lB,GAC5B,GAAKt/B,EAAL,CAKA,IAAI4pD,EAAaj9D,KAAK+pC,MAAMpT,YAAYtjB,EAAKq1B,WAC7C,GAAkB,MAAdu0B,EAAJ,CAGA,IAAIC,EAAkB7pD,EAAKs1B,YACvBw0B,EAAqB,KAErBA,GADoB,GAApBD,EACqB,CACjBD,EAAWvmC,IAAI,GAAK,GACpBumC,EAAWvmC,IAAI,GAAK,IAGHumC,EAAWxd,kBAC5B,EACAyd,EACAxC,OAGR,IAAI0C,EAAmB1lE,EAAK+nD,kBAAiB,EAAMpnD,EAAGsiE,OAiBtD,GAdAF,cAAc,GAAK0C,EAAmB,GACtC1C,cAAc,GAAK0C,EAAmB,GACtC1C,cAAc,GAAK2C,EAAiB,GAAKD,EAAmB,GAC5D1C,cAAc,GAAK2C,EAAiB,GAAKD,EAAmB,GACxD1C,cAAc,GAAK,IACnBA,cAAc,IAAMA,cAAc,GAClCA,cAAc,GAAKnuD,KAAKE,IAAIiuD,cAAc,KAE1CA,cAAc,GAAK,IACnBA,cAAc,IAAMA,cAAc,GAClCA,cAAc,GAAKnuD,KAAKE,IAAIiuD,cAAc,KAIzC/W,gBAAgB+W,cAAeD,aAApC,CAIA,IAAI6C,EAAaJ,EAAW/lC,QAAQgmC,GAChCI,EAAW5lE,EAAKu/B,OAAO5+B,GAC3B,GAAKglE,GAAeC,EAApB,CAGA,IAAIC,EACAF,EAAW1I,MACVsI,EAAWlb,WAAaxkB,UAAUkD,KAAOlD,UAAUoD,OACpD68B,EACAF,EAAS3I,MACRj9D,EAAKqqD,WAAaxkB,UAAUiD,GAAKjD,UAAUmD,MAehD,GAbA1gC,KAAK60D,WACD13D,EACAggE,EACAC,EACA/pD,GACA,EACA,EACA,KACAkqD,EACAC,GAIAnqD,GAAQA,EAAKglC,YAAcxJ,EAAMx7B,EAAKglC,WAAa,IAAM,CACzD,IAAI3wC,EAAI,EAAgC,MAAzBmnC,EAAMx7B,EAAKglC,YACtBtR,EAAM5pC,EAAI04D,YACd14D,EAAI04D,YAAc9uB,EAAMr/B,EACxB1H,KAAK60D,WACD13D,EACAggE,EACAC,EACA/pD,GACA,EACA3L,EACA,QACA61D,EACAC,GAEJrgE,EAAI04D,YAAc9uB,CACrB,CArCA,CANA,CAlCA,CANA,CALA,CAyFJ,CACJ,CACD5pC,EAAI04D,YAAc,CAC1B,EAeI/rB,aAAa3lC,UAAU0wD,WAAa,SAChC13D,EACAjH,EACAC,EACAkd,EACAoqD,EACAC,EACA/jB,EACA4jB,EACAC,EACAG,GAEItqD,GACArT,KAAKouC,cAAc/yC,KAAKgY,IAIvBsmC,GAAStmC,IACVsmC,EAAQtmC,EAAKsmC,OAAS7P,aAAaic,iBAAiB1yC,EAAK1S,OAExDg5C,IACDA,EAAQ35C,KAAKuqC,oBAEL,MAARl3B,GAAgBrT,KAAK0mD,kBAAkBrzC,EAAK9Q,MAC5Co3C,EAAQ,QAGZ4jB,EAAYA,GAAahgC,UAAUoD,MACnC68B,EAAUA,GAAWjgC,UAAUmD,KAE/B,IAAIk9B,EAAOhR,SAAS12D,EAAGC,GAEnB6J,KAAKusC,2BAA6BvsC,KAAKkqC,GAAGZ,MAAQ,KAClDnsC,EAAIo3D,UAAYv0D,KAAK8tC,kBAAoB,GAE7C3wC,EAAI0gE,SAAW,SACfF,EAAeA,GAAgB,GACZ,IACfxgE,EAAIo3D,UAAY,IAIpBp3D,EAAI42D,YACJ,IAAK,IAAI17D,EAAI,EAAGA,EAAIslE,EAActlE,GAAK,EAAG,CACtC,IAAIylE,EAA2C,GAAhCzlE,EAAyB,IAApBslE,EAAe,IAEnC,GAAI39D,KAAK8sC,mBAAqBvP,UAAUyD,YAAa,CACjD7jC,EAAI23D,OAAO5+D,EAAE,GAAIA,EAAE,GAAK4nE,GACxB,IAAIC,EAAiB,EACjBC,EAAiB,EACjBC,EAAe,EACfC,EAAe,EACnB,OAAQX,GACJ,KAAKhgC,UAAUmD,KACXq9B,GAAyB,IAARH,EACjB,MACJ,KAAKrgC,UAAUoD,MACXo9B,EAAwB,IAAPH,EACjB,MACJ,KAAKrgC,UAAUiD,GACXw9B,GAAyB,IAARJ,EACjB,MACJ,KAAKrgC,UAAUkD,KACXu9B,EAAwB,IAAPJ,EAGzB,OAAQJ,GACJ,KAAKjgC,UAAUmD,KACXu9B,GAAuB,IAARL,EACf,MACJ,KAAKrgC,UAAUoD,MACXs9B,EAAsB,IAAPL,EACf,MACJ,KAAKrgC,UAAUiD,GACX09B,GAAuB,IAARN,EACf,MACJ,KAAKrgC,UAAUkD,KACXy9B,EAAsB,IAAPN,EAGvBzgE,EAAIghE,cACAjoE,EAAE,GAAK6nE,EACP7nE,EAAE,GAAK8nE,EAAiBF,EACxB3nE,EAAE,GAAK8nE,EACP9nE,EAAE,GAAK+nE,EAAeJ,EACtB3nE,EAAE,GACFA,EAAE,GAAK2nE,EAEd,MAAM,GAAI99D,KAAK8sC,mBAAqBvP,UAAUwD,YAAa,CACxD5jC,EAAI23D,OAAO5+D,EAAE,GAAIA,EAAE,GAAK4nE,GACpBC,EAAiB,EACjBC,EAAiB,EACjBC,EAAe,EACfC,EAAe,EACnB,OAAQX,GACJ,KAAKhgC,UAAUmD,KACXq9B,GAAkB,EAClB,MACJ,KAAKxgC,UAAUoD,MACXo9B,EAAiB,EACjB,MACJ,KAAKxgC,UAAUiD,GACXw9B,GAAkB,EAClB,MACJ,KAAKzgC,UAAUkD,KACXu9B,EAAiB,EAGzB,OAAQR,GACJ,KAAKjgC,UAAUmD,KACXu9B,GAAgB,EAChB,MACJ,KAAK1gC,UAAUoD,MACXs9B,EAAe,EACf,MACJ,KAAK1gC,UAAUiD,GACX09B,GAAgB,EAChB,MACJ,KAAK3gC,UAAUkD,KACXy9B,EAAe,EAIvB/gE,EAAI43D,OACA7+D,EAAE,GAFE,GAEG6nE,EACP7nE,EAAE,GAHE,GAGG8nE,EAAqBF,GAEhC3gE,EAAI43D,OACA5+D,EAAE,GANE,GAMG8nE,EACP9nE,EAAE,GAPE,GAOG+nE,EAAmBJ,GAE9B3gE,EAAI43D,OAAO5+D,EAAE,GAAIA,EAAE,GAAK2nE,EAC3B,KAAM,IAAI99D,KAAK8sC,mBAAqBvP,UAAUuD,cAsB3C,OArBA3jC,EAAI23D,OAAO5+D,EAAE,GAAIA,EAAE,IACnB,IAAIkoE,EAAUloE,EAAE,GACZmoE,EAAUnoE,EAAE,GACZooE,EAAQnoE,EAAE,GACVooE,EAAQpoE,EAAE,GACVonE,GAAahgC,UAAUoD,MACvBy9B,GAAW,GAEXC,GAAW,GAEXb,GAAWjgC,UAAUmD,KACrB49B,GAAS,GAETC,GAAS,GAEbphE,EAAI43D,OAAOqJ,EAASC,GACpBlhE,EAAI43D,OAA2B,IAAnBqJ,EAAUE,GAAcD,GACpClhE,EAAI43D,OAA2B,IAAnBqJ,EAAUE,GAAcC,GACpCphE,EAAI43D,OAAOuJ,EAAOC,GAClBphE,EAAI43D,OAAO5+D,EAAE,GAAIA,EAAE,GAGtB,CACJ,CAIG6J,KAAKusC,2BACLvsC,KAAKkqC,GAAGZ,MAAQ,KACfm0B,IAEDtgE,EAAIi4D,YAAc,kBAClBj4D,EAAIg8D,UAGRh8D,EAAIo3D,UAAYv0D,KAAK8tC,kBACrB3wC,EAAIg4D,UAAYh4D,EAAIi4D,YAAczb,EAClCx8C,EAAIg8D,SAGJ,IAAIziC,EAAM12B,KAAKw+D,uBAAuBtoE,EAAGC,EAAG,GAAKonE,EAAWC,GAO5D,GANInqD,GAAQA,EAAK01B,OACb11B,EAAK01B,KAAK,GAAKrS,EAAI,GACnBrjB,EAAK01B,KAAK,GAAKrS,EAAI,IAKnB12B,KAAKkqC,GAAGZ,OAAS,IACjBtpC,KAAK+qC,oBACLyyB,GAAWjgC,UAAUqD,OACvB,CAEE,GAAI5gC,KAAKysC,yBAA0B,CAE/B,IAAIgyB,EAAOz+D,KAAKw+D,uBACZtoE,EACAC,EACA,IACAonE,EACAC,GAEAkB,EAAO1+D,KAAKw+D,uBACZtoE,EACAC,EACA,IACAonE,EACAC,GAEAmB,EAAO3+D,KAAKw+D,uBACZtoE,EACAC,EACA,IACAonE,EACAC,GAEAoB,EAAO5+D,KAAKw+D,uBACZtoE,EACAC,EACA,IACAonE,EACAC,GAIAqB,EAAS,EACTC,EAAS,EACT9+D,KAAKwsC,2BACLqyB,GAAUvyD,KAAKyyD,MAAML,EAAK,GAAKD,EAAK,GAAIC,EAAK,GAAKD,EAAK,IACvDK,GAAUxyD,KAAKyyD,MAAMH,EAAK,GAAKD,EAAK,GAAIC,EAAK,GAAKD,EAAK,KAEvDG,EAASD,EAAS1oE,EAAE,GAAKD,EAAE,GAAK,EAAIoW,KAAK4oD,GAI7C/3D,EAAIq1B,OACJr1B,EAAImoD,UAAUmZ,EAAK,GAAIA,EAAK,IAC5BthE,EAAI6hE,OAAOH,GACX1hE,EAAI42D,YACJ52D,EAAI23D,QAAQ,GAAI,GAChB33D,EAAI43D,OAAO,EAAG,GACd53D,EAAI43D,OAAO,GAAK,GAChB53D,EAAIoB,OACJpB,EAAIy2D,UACJz2D,EAAIq1B,OACJr1B,EAAImoD,UAAUqZ,EAAK,GAAIA,EAAK,IAC5BxhE,EAAI6hE,OAAOF,GACX3hE,EAAI42D,YACJ52D,EAAI23D,QAAQ,GAAI,GAChB33D,EAAI43D,OAAO,EAAG,GACd53D,EAAI43D,OAAO,GAAK,GAChB53D,EAAIoB,OACJpB,EAAIy2D,SACP,CAGDz2D,EAAI42D,YACJ52D,EAAI83D,IAAIv+B,EAAI,GAAIA,EAAI,GAAI,EAAG,EAAa,EAAVpqB,KAAK4oD,IACnC/3D,EAAIoB,MACP,CAGD,GAAIm/D,EAAM,CACNvgE,EAAIg4D,UAAYxb,EAChB,IAASthD,EAAI,EAAGA,EAAI,IAAKA,EAAG,CACxB,IAAIqP,GAA2B,KAAtB61B,UAAUqR,UAAwB,GAAJv2C,GAAW,EAC9Cq+B,EAAM12B,KAAKw+D,uBACXtoE,EACAC,EACAuR,EACA61D,EACAC,GAEJrgE,EAAI42D,YACJ52D,EAAI83D,IAAIv+B,EAAI,GAAIA,EAAI,GAAI,EAAG,EAAG,EAAIpqB,KAAK4oD,IACvC/3D,EAAIoB,MACP,CACJ,CACT,EAGIurC,aAAa3lC,UAAUq6D,uBAAyB,SAC5CtoE,EACAC,EACAoN,EACAg6D,EACAC,GAEAD,EAAYA,GAAahgC,UAAUoD,MACnC68B,EAAUA,GAAWjgC,UAAUmD,KAE/B,IAAIk9B,EAAOhR,SAAS12D,EAAGC,GACnB8oE,EAAK/oE,EACLgpE,EAAK,CAAChpE,EAAE,GAAIA,EAAE,IACdipE,EAAK,CAAChpE,EAAE,GAAIA,EAAE,IACdipE,EAAKjpE,EAET,OAAQonE,GACJ,KAAKhgC,UAAUmD,KACXw+B,EAAG,KAAc,IAARtB,EACT,MACJ,KAAKrgC,UAAUoD,MACXu+B,EAAG,IAAa,IAAPtB,EACT,MACJ,KAAKrgC,UAAUiD,GACX0+B,EAAG,KAAc,IAARtB,EACT,MACJ,KAAKrgC,UAAUkD,KACXy+B,EAAG,IAAa,IAAPtB,EAGjB,OAAQJ,GACJ,KAAKjgC,UAAUmD,KACXy+B,EAAG,KAAc,IAARvB,EACT,MACJ,KAAKrgC,UAAUoD,MACXw+B,EAAG,IAAa,IAAPvB,EACT,MACJ,KAAKrgC,UAAUiD,GACX2+B,EAAG,KAAc,IAARvB,EACT,MACJ,KAAKrgC,UAAUkD,KACX0+B,EAAG,IAAa,IAAPvB,EAIjB,IAAIyB,GAAM,EAAI97D,IAAM,EAAIA,IAAM,EAAIA,GAC9B+7D,GAAW,EAAI/7D,IAAM,EAAIA,GAApB,EAA0BA,EAC/Bg8D,EAAK,GAAK,EAAIh8D,IAAMA,EAAIA,GACxBi8D,EAAKj8D,EAAIA,EAAIA,EAIjB,MAAO,CAFC87D,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAC/CC,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAAKK,EAAKJ,EAAG,GAE/D,EAEIt1B,aAAa3lC,UAAUiwD,mBAAqB,SAASj3D,GACjDA,EAAI26D,YAAc,cAClB36D,EAAI04D,YAAc,IAElB14D,EAAI44D,UAAY,SAChB54D,EAAIi4D,YAAc,QAClBj4D,EAAI04D,YAAc,IAGlB,IADA,IAAItP,EAAgBvmD,KAAKumD,cAChBluD,EAAI,EAAGA,EAAIkuD,EAAcxvD,SAAUsB,EAAG,CAC3C,IAAIX,EAAO6uD,EAAcluD,GACzB8E,EAAIg4D,UAAY,QAChBh4D,EAAIk6D,SACA3/D,EAAKg/B,IAAI,GAAK6G,UAAUG,kBACxBhmC,EAAKg/B,IAAI,GAAK6G,UAAUG,kBACxBH,UAAUG,kBACVH,UAAUG,mBAEI,GAAdhmC,EAAKm7C,OACL11C,EAAIk4D,WACA39D,EAAKg/B,IAAI,GAAK6G,UAAUG,kBAAoB,GAC5ChmC,EAAKg/B,IAAI,GAAK6G,UAAUG,kBAAoB,GAC5CH,UAAUG,kBACVH,UAAUG,mBAGlBvgC,EAAIg4D,UAAY,OAChBh4D,EAAI64D,SACAt+D,EAAKm7C,MACLn7C,EAAKg/B,IAAI,IAAoC,GAA/B6G,UAAUG,kBACxBhmC,EAAKg/B,IAAI,GAAK,EAErB,CACDv5B,EAAI04D,YAAc,CAC1B,EAMI/rB,aAAa3lC,UAAUk1D,gBAAkB,SACrC3hE,EACA+nE,EACAtiE,EACAuiE,GAEA,IAAKhoE,EAAKqjC,UAAYrjC,EAAKqjC,QAAQhkC,OAC/B,OAAO,EAEX,IAAIqM,EAAQ1L,EAAK2d,KAAK,GAClB0lB,EAAUrjC,EAAKqjC,QACnB0kC,GAAQ,EACR,IAAIE,EAAIpiC,UAAUM,mBACd+hC,EAAY5/D,KAAKkqC,GAAGZ,MAAQ,GAChCnsC,EAAIq1B,OACJr1B,EAAI04D,YAAc71D,KAAKirC,aAOvB,IANA,IAAI40B,EAAgBtiC,UAAUwB,qBAC1B+gC,EAAmBviC,UAAUuB,eAC7BihC,EAAaxiC,UAAUyB,kBACvBghC,EAAuBziC,UAAU0B,4BACjCwU,EAAS,GAEJp7C,EAAI,EAAGA,EAAI0iC,EAAQhkC,SAAUsB,EAAG,CACrC,IAAIoS,EAAIswB,EAAQ1iC,GACZmT,EAAIi0D,EACJh1D,EAAEe,IACFA,EAAIf,EAAEe,GAEVf,EAAEw1D,OAASz0D,EACXrO,EAAIi4D,YAAcyK,EAClB1iE,EAAIg4D,UAAY,OAChBh4D,EAAI44D,UAAY,OAEbtrD,EAAEy1D,WACD/iE,EAAI04D,aAAe,IACvB,IAAIsK,EAAe11D,EAAErH,OAASA,EAE9B,OAAQqH,EAAE9J,MACN,IAAK,SACDxD,EAAIg4D,UAAY2K,EACZr1D,EAAEqsD,UACF35D,EAAIg4D,UAAY,OAChB1qD,EAAEqsD,SAAU,EACZ92D,KAAK4mD,cAAe,GAExBzpD,EAAIk6D,SAAS5jB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GAChDC,IAAcn1D,EAAEy1D,UACf/iE,EAAIk4D,WAAY5hB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACtDC,IACAziE,EAAI44D,UAAY,SAChB54D,EAAIg4D,UAAY4K,EAChB5iE,EAAI64D,SAASvrD,EAAEwa,OAASxa,EAAEjS,KAAqB,GAAf2nE,EAAoB30D,EAAQ,GAAJm0D,IAE5D,MACJ,IAAK,SAgBD,GAfAxiE,EAAI44D,UAAY,OAChB54D,EAAIi4D,YAAcyK,EAClB1iE,EAAIg4D,UAAY2K,EAChB3iE,EAAI42D,YACA6L,EACAziE,EAAI24D,UAAUriB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,EAAG,CAAK,GAAJA,IAExDxiE,EAAI6vB,KAAKymB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACnDxiE,EAAIoB,OACDqhE,IAAcn1D,EAAEy1D,UACf/iE,EAAIg8D,SACRh8D,EAAIg4D,UAAY1qD,EAAEnT,MAAQ,OAAS,OACnC6F,EAAI42D,YACJ52D,EAAI83D,IAAKkL,EAAe1sB,GAAYjoC,EAAQ,GAAJm0D,EAAa,IAAJA,EAAU,EAAa,EAAVrzD,KAAK4oD,IACnE/3D,EAAIoB,OACAqhE,EAAW,CACXziE,EAAIg4D,UAAY6K,EAChB,MAAM/6C,EAAQxa,EAAEwa,OAASxa,EAAEjS,KACd,MAATysB,GACA9nB,EAAI64D,SAAS/wC,EAAOwuB,GAAYjoC,EAAQ,GAAJm0D,GAExCxiE,EAAIg4D,UAAY1qD,EAAEnT,MAAQyoE,EAAaC,EACvC7iE,EAAI44D,UAAY,QAChB54D,EAAI64D,SACAvrD,EAAEnT,MACImT,EAAExR,QAAQmX,IAAM,OAChB3F,EAAExR,QAAQsX,KAAO,QACvB4vD,EAAe,GACf30D,EAAQ,GAAJm0D,EAEX,CACD,MACJ,IAAK,SACDxiE,EAAIg4D,UAAY2K,EAChB3iE,EAAIk6D,SAAS5jB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACnD,IAAIS,EAAQ31D,EAAExR,QAAQsT,IAAM9B,EAAExR,QAAQq/D,IAClC+H,GAAU51D,EAAEnT,MAAQmT,EAAExR,QAAQq/D,KAAO8H,EAOzC,GANGC,EAAS,IAAKA,EAAS,GACvBA,EAAS,IAAKA,EAAS,GAC1BljE,EAAIg4D,UAAY1qD,EAAExR,QAAQmL,eAAe,gBAAkBqG,EAAExR,QAAQqnE,aAAgBZ,GAAiBj1D,EAAI,OAAS,OACnHtN,EAAIk6D,SAAS5jB,EAAQjoC,EAAG60D,GAAUF,EAAe1sB,IAAaksB,GAC3DC,IAAcn1D,EAAEy1D,UACf/iE,EAAIk4D,WAAW5hB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACrDl1D,EAAE81D,OAAQ,CACV,IAAIC,GAAiB/1D,EAAE81D,OAAS91D,EAAExR,QAAQq/D,KAAO8H,EAC9CI,EAAgB,IAAKA,EAAgB,GACrCA,EAAgB,IAAKA,EAAgB,GACxCrjE,EAAIg4D,UAAY1qD,EAAExR,QAAQmL,eAAe,gBAAkBqG,EAAExR,QAAQwnE,aAAe,OACpFtjE,EAAIk6D,SAAU5jB,EAAS+sB,GAAiBL,EAAe1sB,IAAajoC,EAAG,EAAGm0D,EAC7E,CACGC,IACAziE,EAAI44D,UAAY,SAChB54D,EAAIg4D,UAAY4K,EAChB5iE,EAAI64D,SACAvrD,EAAEwa,OAASxa,EAAEjS,KAAO,KAAOuoD,OAAOt2C,EAAEnT,OAAO4/D,QAChB,MAAvBzsD,EAAExR,QAAQynE,UACJj2D,EAAExR,QAAQynE,UACV,GAEK,GAAfP,EACA30D,EAAQ,GAAJm0D,IAGZ,MACJ,IAAK,SACL,IAAK,QAUD,GATAxiE,EAAI44D,UAAY,OAChB54D,EAAIi4D,YAAcyK,EAClB1iE,EAAIg4D,UAAY2K,EAChB3iE,EAAI42D,YACD6L,EACCziE,EAAI24D,UAAUriB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,EAAG,CAAK,GAAJA,IAExDxiE,EAAI6vB,KAAKymB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACnDxiE,EAAIoB,OACAqhE,EAqBA,GApBIn1D,EAAEy1D,UACF/iE,EAAIg8D,SACRh8D,EAAIg4D,UAAY4K,EACZt1D,EAAEy1D,WAEF/iE,EAAI42D,YACJ52D,EAAI23D,OAAOrhB,GAAajoC,EAAI,GAC5BrO,EAAI43D,OAAOthB,GAAYjoC,EAAQ,GAAJm0D,GAC3BxiE,EAAI43D,OAAOthB,GAAajoC,EAAIm0D,EAAI,GAChCxiE,EAAIoB,OACJpB,EAAI42D,YACJ52D,EAAI23D,OAAOqL,EAAe1sB,EAAS,GAAIjoC,EAAI,GAC3CrO,EAAI43D,OAAOoL,EAAe1sB,EAAS,EAAGjoC,EAAQ,GAAJm0D,GAC1CxiE,EAAI43D,OAAOoL,EAAe1sB,EAAS,GAAIjoC,EAAIm0D,EAAI,GAC/CxiE,EAAIoB,QAERpB,EAAIg4D,UAAY6K,EAChB7iE,EAAI64D,SAASvrD,EAAEwa,OAASxa,EAAEjS,KAAMi7C,GAAgBjoC,EAAQ,GAAJm0D,GACpDxiE,EAAIg4D,UAAY4K,EAChB5iE,EAAI44D,UAAY,QACF,UAAVtrD,EAAE9J,KACFxD,EAAI64D,SACAjV,OAAOt2C,EAAEnT,OAAO4/D,aACYhtC,IAAxBzf,EAAExR,QAAQynE,UACJj2D,EAAExR,QAAQynE,UACV,GAEVP,EAAe1sB,GAAa,GAC5BjoC,EAAQ,GAAJm0D,OAEL,CACH,IAAIp1D,EAAIE,EAAEnT,MACV,GAAImT,EAAExR,QAAQslD,OACd,CACI,IAAIA,EAAS9zC,EAAExR,QAAQslD,OACnBA,EAAOz+C,cAAgBmJ,WACvBs1C,EAASA,KACVA,GAAUA,EAAOz+C,cAAgBlG,QAChC2Q,EAAIg0C,EAAQ9zC,EAAEnT,OACrB,CACD6F,EAAI64D,SACAzrD,EACA41D,EAAe1sB,GAAa,GAC5BjoC,EAAQ,GAAJm0D,EAEX,CAEL,MACJ,IAAK,SACL,IAAK,OAUD,GATAxiE,EAAI44D,UAAY,OAChB54D,EAAIi4D,YAAcyK,EAClB1iE,EAAIg4D,UAAY2K,EAChB3iE,EAAI42D,YACA6L,EACAziE,EAAI24D,UAAUriB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,EAAG,CAAK,GAAJA,IAExDxiE,EAAI6vB,KAAMymB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GACpDxiE,EAAIoB,OACAqhE,EAAW,CACPn1D,EAAEy1D,UACF/iE,EAAIg8D,SACRh8D,EAAIq1B,OACJr1B,EAAI42D,YACJ52D,EAAI6vB,KAAKymB,EAAQjoC,EAAG20D,EAAe1sB,GAAYksB,GAC/CxiE,EAAIggB,OAGJhgB,EAAIg4D,UAAY6K,EAChB,MAAM/6C,EAAQxa,EAAEwa,OAASxa,EAAEjS,KACd,MAATysB,GACA9nB,EAAI64D,SAAS/wC,EAAOwuB,GAAYjoC,EAAQ,GAAJm0D,GAExCxiE,EAAIg4D,UAAY4K,EAChB5iE,EAAI44D,UAAY,QAChB54D,EAAI64D,SAAS7pD,OAAO1B,EAAEnT,OAAOgf,OAAO,EAAE,IAAK6pD,EAAe1sB,GAAYjoC,EAAQ,GAAJm0D,GAC1ExiE,EAAIy2D,SACP,CACD,MACJ,QACQnpD,EAAE6/C,MACF7/C,EAAE6/C,KAAKntD,EAAKzF,EAAMyoE,EAAc30D,EAAGm0D,GAI/CF,IAASh1D,EAAE47B,YAAc57B,EAAE47B,YAAY85B,GAAc,GAAKR,GAAK,EAC/DxiE,EAAI04D,YAAc71D,KAAKirC,YAE1B,CACD9tC,EAAIy2D,UACJz2D,EAAI44D,UAAY,MACxB,EAMIjsB,aAAa3lC,UAAUwpD,mBAAqB,SACxCj2D,KACAg/B,IACA39B,MACA2mE,eAEA,IAAKhoE,KAAKqjC,UAAYrjC,KAAKqjC,QAAQhkC,SAAYiJ,KAAK2rC,oBAAsBj0C,KAAK0uC,MAAMuF,kBACjF,OAAO,KASX,IANA,IAAIrgC,EAAIorB,IAAI,GAAKh/B,KAAKg/B,IAAI,GACtBlrB,EAAIkrB,IAAI,GAAKh/B,KAAKg/B,IAAI,GACtBtzB,MAAQ1L,KAAK2d,KAAK,GAClBmJ,KAAOxe,KACP2qD,WAAa3qD,KAAK2oD,kBAEbtwD,EAAI,EAAGA,EAAIX,KAAKqjC,QAAQhkC,SAAUsB,EAAG,CAC1C,IAAIoS,EAAI/S,KAAKqjC,QAAQ1iC,GACrB,GAAIoS,IAAKA,EAAEy1D,SAAX,CAEA,IAAIS,cAAgBl2D,EAAE47B,YAAc57B,EAAE47B,YAAYjjC,OAAO,GAAKm6B,UAAUM,mBACpEsiC,aAAe11D,EAAErH,OAASA,MAE9B,GAAKqH,GAAKi1D,iBACLp0D,EAAI,GAAKA,EAAI60D,aAAe,IAAM30D,EAAIf,EAAEw1D,QAAUz0D,EAAIf,EAAEw1D,OAASU,oBAA8Bz2C,IAAbzf,EAAEw1D,QADzF,CAIA,IAAIW,UAAYn2D,EAAEnT,MAIlB,OAAQmT,EAAE9J,MACN,IAAK,SACG5H,MAAM4H,OAAS48B,UAAUgG,qBAAqB,SAC1C94B,EAAE9N,UACF2Q,YAAW,WACP7C,EAAE9N,SAAS8N,EAAG+T,KAAM9mB,KAAMg/B,IAAK39B,MAClC,GAAE,IAEP0R,EAAEqsD,SAAU,EACZ92D,KAAK4mD,cAAe,GAExB,MACJ,IAAK,SACD,IAAIga,UAAYn2D,EAAEnT,MACd+oE,OAASrD,OAAO1xD,EAAI,KAAO60D,aAAe,IAAK,EAAG,GACtD,GAAG11D,EAAExR,QAAQoyC,UAAW,MACxB5gC,EAAEnT,MAAQmT,EAAExR,QAAQq/D,KAAO7tD,EAAExR,QAAQsT,IAAM9B,EAAExR,QAAQq/D,KAAO+H,OACxDO,WAAan2D,EAAEnT,OACfgW,YAAW,WACPuzD,mBAAmBp2D,EAAGA,EAAEnT,MAC3B,GAAE,IAEP0I,KAAK4mD,cAAe,EACpB,MACJ,IAAK,SACL,IAAK,QACD,IAAIga,UAAYn2D,EAAEnT,MACd2tD,MAAQ35C,EAAI,IAAM,EAAIA,EAAI60D,aAAe,GAAK,EAAI,EAClDW,cAAe,EAMnB,GALI7b,OACI35C,GAAK,GAAKA,EAAI60D,aAAe,IAC7BW,cAAe,GAGnBA,cAAgB/nE,MAAM4H,MAAQ48B,UAAUgG,qBAAqB,QAAoB,UAAV94B,EAAE9J,KACtE5H,MAAMi6D,SACLvoD,EAAEnT,OAAwB,GAAfyB,MAAMi6D,QAAgBvoD,EAAExR,QAAQq7B,MAAQ,IACjC,MAAjB7pB,EAAExR,QAAQq/D,KAAe7tD,EAAEnT,MAAQmT,EAAExR,QAAQq/D,MAC9C7tD,EAAEnT,MAAQmT,EAAExR,QAAQq/D,KAEF,MAAjB7tD,EAAExR,QAAQsT,KAAe9B,EAAEnT,MAAQmT,EAAExR,QAAQsT,MAC9C9B,EAAEnT,MAAQmT,EAAExR,QAAQsT,UAErB,GAAIxT,MAAM4H,MAAQ48B,UAAUgG,qBAAqB,OAAQ,CAC5D,IAAIgb,OAAS9zC,EAAExR,QAAQslD,OACnBA,QAAUA,OAAOz+C,cAAgBmJ,WACjCs1C,OAAS9zC,EAAExR,QAAQslD,OAAO9zC,EAAG/S,OAEjC,IAAIqpE,YAAc,KAEJ,UAAVt2D,EAAE9J,OACFogE,YAAcxiB,OAAOz+C,cAAgBlG,MAAQ2kD,OAAS7oD,OAAOoB,KAAKynD,SAEtE,IAAI0G,MAAQ35C,EAAI,IAAM,EAAIA,EAAI60D,aAAe,GAAK,EAAI,EACtD,GAAc,UAAV11D,EAAE9J,KACF8J,EAAEnT,OAAiB,GAAR2tD,OAAex6C,EAAExR,QAAQq7B,MAAQ,GACtB,MAAjB7pB,EAAExR,QAAQq/D,KAAe7tD,EAAEnT,MAAQmT,EAAExR,QAAQq/D,MAC9C7tD,EAAEnT,MAAQmT,EAAExR,QAAQq/D,KAEF,MAAjB7tD,EAAExR,QAAQsT,KAAe9B,EAAEnT,MAAQmT,EAAExR,QAAQsT,MAC9C9B,EAAEnT,MAAQmT,EAAExR,QAAQsT,UAErB,GAAI04C,MAAO,CACd,IAAIrkD,OAAS,EACbZ,KAAKgnD,gBAAkB,EAEnBpmD,MADD29C,OAAOz+C,cAAgBpK,OACdqrE,YAAYvjE,QAAS2O,OAAQ1B,EAAEnT,QAAY2tD,MAE3C8b,YAAYvjE,QAASiN,EAAEnT,OAAU2tD,MACzCrkD,OAASmgE,YAAYhqE,SACrB6J,MAAQmgE,YAAYhqE,OAAS,GAE7B6J,MAAQ,IACRA,MAAQ,GAER29C,OAAOz+C,cAAgBlG,MACvB6Q,EAAEnT,MAAQinD,OAAO39C,OAEjB6J,EAAEnT,MAAQsJ,KAC1C,KAA+B,CACH,IAAIogE,YAAcziB,QAAUwiB,YAAcrrE,OAAO6oD,OAAOA,QAAUA,OAQlE,SAAS0iB,EAAc12D,EAAGyf,EAAQjxB,GAM9B,OALGwlD,QAAUwiB,cACTx2D,EAAIy2D,YAAYxjE,QAAQ+M,IAC5BvK,KAAK1I,MAAQiT,EACbs2D,mBAAmB7gE,KAAMuK,GACzBiU,KAAKooC,cAAe,GACb,CACV,CAdU,IAAIrpB,UAAUs+B,YAAYmF,YAAa,CAC1C13B,MAAOh9B,KAAKC,IAAI,EAAGvM,KAAKkqC,GAAGZ,OAC3BvwC,MAAOA,MACP+N,UAAW,OACXnK,SAAUskE,EAAcj2D,KAAKP,IAEjCkgD,WASP,CACJ,MACI,GAAG5xD,MAAM4H,MAAQ48B,UAAUgG,qBAAqB,MAAkB,UAAV94B,EAAE9J,KAC/D,CACI,IAAIskD,MAAQ35C,EAAI,IAAM,EAAIA,EAAI60D,aAAe,GAAK,EAAI,EAClDpnE,MAAMq2D,WAAa,KAAgB,GAATnK,OAC1BjlD,KAAK2V,OAAO,QAAQlL,EAAEnT,MAAM,SAASiT,GAE7B,GAAI,6BAA6B2B,KAAK3B,GAClC,IACIA,EAAIrB,KAAKqB,EACrD,CAA0C,MAAO9N,GAAM,CAEnBuD,KAAK1I,MAAQypD,OAAOx2C,GACpBs2D,mBAAmB7gE,KAAMA,KAAK1I,MAClE,EAAkC0T,KAAKP,GACP1R,MAEX,CAEG6nE,WAAan2D,EAAEnT,OACfgW,WACI,WACIuzD,mBAAmB7gE,KAAMA,KAAK1I,MAC9D,EAA8B0T,KAAKP,GACP,IAERzK,KAAK4mD,cAAe,EACpB,MACJ,IAAK,SACG7tD,MAAM4H,MAAQ48B,UAAUgG,qBAAqB,SAC7C94B,EAAEnT,OAASmT,EAAEnT,MACbgW,YAAW,WACPuzD,mBAAmBp2D,EAAGA,EAAEnT,MAC3B,GAAE,KAEP,MACJ,IAAK,SACL,IAAK,OACGyB,MAAM4H,MAAQ48B,UAAUgG,qBAAqB,QAC7CvjC,KAAK2V,OAAO,QAAQlL,EAAEnT,MAAM,SAASiT,GAC7Bs2D,mBAAmB7gE,KAAMuK,EACzD,EAA8BS,KAAKP,GACP1R,QAAM0R,EAAExR,SAAUwR,EAAExR,QAAQioE,WAEpC,MACJ,QACQz2D,EAAEsiC,QACF/sC,KAAK4mD,aAAen8C,EAAEsiC,MAAMh0C,MAAO,CAACuS,EAAGE,GAAI9T,OAavD,OAPIkpE,WAAan2D,EAAEnT,QAEZI,KAAKypE,iBACJzpE,KAAKypE,gBAAiB12D,EAAEjS,KAAKiS,EAAEnT,MAAMspE,UAAUn2D,GACnD/S,KAAKqyC,MAAMqF,YAGR3kC,CAnKM,CANA,CA0KhB,CAED,SAASo2D,mBAAmB9kC,EAAQzkC,GACd,UAAfykC,EAAOp7B,OACNrJ,EAAQypD,OAAOzpD,IAEnBykC,EAAOzkC,MAAQA,EACVykC,EAAO9iC,SAAW8iC,EAAO9iC,QAAQ8gD,eAAyD7vB,IAA7CxyB,KAAK2tC,WAAWtJ,EAAO9iC,QAAQ8gD,WAC7EriD,KAAK6C,YAAawhC,EAAO9iC,QAAQ8gD,SAAUziD,GAE3CykC,EAAOp/B,UACPo/B,EAAOp/B,SAASo/B,EAAOzkC,MAAOknB,KAAM9mB,KAAMg/B,IAAK39B,MAEtD,CAED,OAAO,IACf,EAMI+wC,aAAa3lC,UAAUyzD,WAAa,SAAS/sC,EAAQ1tB,GACjD,GAAK6C,KAAK+pC,MAAV,CAIA,IAAI9T,EAASj2B,KAAK+pC,MAAM2F,QAExBvyC,EAAIq1B,OACJr1B,EAAI04D,YAAc,GAAM71D,KAAKirC,aAE7B,IAAK,IAAI5yC,EAAI,EAAGA,EAAI49B,EAAOl/B,SAAUsB,EAAG,CACpC,IAAI69B,EAAQD,EAAO59B,GAEnB,GAAKqrD,gBAAgB1jD,KAAK4pC,aAAc1T,EAAM+sB,WAA9C,CAIA9lD,EAAIg4D,UAAYj/B,EAAMyjB,OAAS,OAC/Bx8C,EAAIi4D,YAAcl/B,EAAMyjB,OAAS,OACjC,IAAIjjB,EAAMR,EAAM6S,KACZ1zB,EAAO6gB,EAAMitB,MACjBhmD,EAAI04D,YAAc,IAAO71D,KAAKirC,aAC9B9tC,EAAI42D,YACJ52D,EAAI6vB,KAAK0J,EAAI,GAAK,GAAKA,EAAI,GAAK,GAAKrhB,EAAK,GAAIA,EAAK,IACnDlY,EAAIoB,OACJpB,EAAI04D,YAAc71D,KAAKirC,aACvB9tC,EAAIg8D,SAEJh8D,EAAI42D,YACJ52D,EAAI23D,OAAOp+B,EAAI,GAAKrhB,EAAK,GAAIqhB,EAAI,GAAKrhB,EAAK,IAC3ClY,EAAI43D,OAAOr+B,EAAI,GAAKrhB,EAAK,GAAK,GAAIqhB,EAAI,GAAKrhB,EAAK,IAChDlY,EAAI43D,OAAOr+B,EAAI,GAAKrhB,EAAK,GAAIqhB,EAAI,GAAKrhB,EAAK,GAAK,IAChDlY,EAAIoB,OAEJ,IAAIqjB,EACAsU,EAAMtU,WAAa2b,UAAU6jC,wBACjCjkE,EAAI2kB,KAAOF,EAAY,WACvBzkB,EAAI44D,UAAY,OAChB54D,EAAI64D,SAAS9/B,EAAM1zB,MAAOk0B,EAAI,GAAK,EAAGA,EAAI,GAAK9U,EAvB9C,CAwBJ,CAEDzkB,EAAIy2D,SAtCH,CAuCT,EAEI9pB,aAAa3lC,UAAUk9D,gBAAkB,WAErC,IADA,IAAI5hE,EAAQO,KAAK+pC,MAAMsF,OACdh3C,EAAI,EAAGA,EAAIoH,EAAM1I,SAAUsB,EAChCoH,EAAMpH,GAAGgd,KAAO5V,EAAMpH,GAAGguC,cAE7BrmC,KAAKunD,UAAS,GAAM,EAC5B,EAMIzd,aAAa3lC,UAAUkqD,OAAS,SAASjrD,EAAOC,GAC5C,IAAKD,IAAUC,EAAQ,CACnB,IAAIi+D,EAASthE,KAAK6qB,OAAO7yB,WACzBoL,EAAQk+D,EAAOC,YACfl+D,EAASi+D,EAAOpvD,YACnB,CAEGlS,KAAK6qB,OAAOznB,OAASA,GAASpD,KAAK6qB,OAAOxnB,QAAUA,IAIxDrD,KAAK6qB,OAAOznB,MAAQA,EACpBpD,KAAK6qB,OAAOxnB,OAASA,EACrBrD,KAAKooD,SAAShlD,MAAQpD,KAAK6qB,OAAOznB,MAClCpD,KAAKooD,SAAS/kD,OAASrD,KAAK6qB,OAAOxnB,OACnCrD,KAAKunD,UAAS,GAAM,GAC5B,EAOIzd,aAAa3lC,UAAUq9D,eAAiB,SAASC,GAC7C,IAAKA,EAID,OAHAzhE,KAAKurC,WAAavrC,KAAKurC,UACvBvrC,KAAK4mD,cAAe,OACpB5mD,KAAK6mD,gBAAiB,GAI1B,IAAIj3C,EAAO5P,KACPilD,EAAQjlD,KAAKurC,UAAY,IAAM,GAC/BvrC,KAAKurC,YACLvrC,KAAKurC,WAAY,EACjBvrC,KAAKirC,aAAe,IAGxB,IAAI1nC,EAAI0K,aAAY,WAChB2B,EAAKq7B,cAAgBga,EACrBr1C,EAAKg3C,cAAe,EACpBh3C,EAAKi3C,gBAAiB,EAElB5B,EAAQ,GAAKr1C,EAAKq7B,aAAe,MACjC/8B,cAAc3K,GACV0hD,EAAQ,IACRr1C,EAAK27B,WAAY,IAGrB0Z,EAAQ,GAAKr1C,EAAKq7B,aAAe,MACjC/8B,cAAc3K,GACdqM,EAAKq7B,aAAe,EAE3B,GAAE,EACX,EAEInB,aAAa3lC,UAAUu9D,sBAAwB,SAAShqE,GAE5D,EA6DIoyC,aAAa63B,WAAa,SAAS5pB,EAAM7oB,EAAO0yC,GAC5C,IAAI/2C,EAASif,aAAa8gB,cACT//B,EAAO89B,kBAExB,IAAIzyB,EAAQ,IAAIqH,UAAU2L,YAC1BhT,EAAMQ,IAAM7L,EAAOqoC,2BAA2B0O,GAC9C/2C,EAAOkf,MAAMltC,IAAIq5B,EACzB,EAOI4T,aAAa+3B,iBAAmB,SAASpiE,GACrC,IAAI8tB,EAAM,KACNF,EAAQ,KACRy0C,EAAS,KACT3d,EAAO,KACX,IAAK,MAAM4d,KAAOtiE,EAAO,CACrB,MAAM/H,EAAO+H,EAAMsiE,IACZz2D,EAAGE,GAAK9T,EAAKg/B,KACbtzB,EAAOC,GAAU3L,EAAK2d,MAEjB,OAARkY,GAAgB/hB,EAAI+hB,EAAImJ,IAAI,MAC5BnJ,EAAM71B,IAEI,OAAV21B,GAAkB/hB,EAAIlI,EAAQiqB,EAAMqJ,IAAI,GAAKrJ,EAAMhY,KAAK,MACxDgY,EAAQ31B,IAEG,OAAXoqE,GAAmBt2D,EAAInI,EAASy+D,EAAOprC,IAAI,GAAKorC,EAAOzsD,KAAK,MAC5DysD,EAASpqE,IAEA,OAATysD,GAAiB74C,EAAI64C,EAAKztB,IAAI,MAC9BytB,EAAOzsD,EAEd,CAED,MAAO,CACH61B,IAAOA,EACPF,MAASA,EACTy0C,OAAUA,EACV3d,KAAQA,EAEf,EAKDra,aAAa3lC,UAAU69D,0BAA4B,WAC/C,OAAOl4B,aAAa+3B,iBAAiBnsE,OAAO6oD,OAAOv+C,KAAK+0C,gBAC3D,EAQDjL,aAAam4B,WAAa,SAAUxiE,EAAOia,EAAWwoD,GAClD,IAAKziE,EACD,OAGJ,MAAMorB,EAASif,aAAa8gB,cAC5B,IAAIuX,EAAgB,GAEhBA,OADaj4C,IAAbg4C,EACgBp4B,aAAa+3B,iBAAiBpiE,GAE9B,CACZ8tB,IAAO20C,EACP70C,MAAS60C,EACTJ,OAAUI,EACV/d,KAAQ+d,GAIhB,IAAK,MAAO3qE,EAAGG,KAAShC,OAAO+M,QAAQooB,EAAOkqB,gBAC1C,OAAQr7B,GACJ,IAAK,QACDhiB,EAAKg/B,IAAI,GAAKyrC,EAAqB,MAAEzrC,IAAI,GAAKyrC,EAAqB,MAAE9sD,KAAK,GAAK3d,EAAK2d,KAAK,GACzF,MACJ,IAAK,OACD3d,EAAKg/B,IAAI,GAAKyrC,EAAoB,KAAEzrC,IAAI,GACxC,MACJ,IAAK,MACDh/B,EAAKg/B,IAAI,GAAKyrC,EAAmB,IAAEzrC,IAAI,GACvC,MACJ,IAAK,SACDh/B,EAAKg/B,IAAI,GAAKyrC,EAAsB,OAAEzrC,IAAI,GAAKyrC,EAAsB,OAAE9sD,KAAK,GAAK3d,EAAK2d,KAAK,GAKvGwV,EAAO+7B,cAAe,EACtB/7B,EAAOg8B,gBAAiB,CAChC,EAEI/c,aAAas4B,YAAc,SAAS9qE,EAAO2B,EAASF,EAAOspE,EAAW3qE,GAClE,IAAI6lC,UAAUs+B,YAAY,CAAC,MAAO,SAAU,OAAQ,SAAU,CAC1D9iE,MAAOA,EACP4D,SAIJ,SAAuBrF,GACnBwyC,aAAam4B,WAAWn4B,aAAa8gB,cAAc7V,eAAgBz9C,EAAM8sC,cAAe1sC,EAC3F,EALGokE,WAAYuG,GAMnB,EAEDv4B,aAAaw4B,aAAe,SAAShrE,EAAO2B,EAASF,EAAOspE,GACxD,IAAI9kC,UAAUs+B,YAAY,CAAC,MAAO,SAAU,OAAQ,SAAU,CAC1D9iE,MAAOA,EACP4D,SAIJ,SAAuBrF,GACnBwyC,aAAam4B,WAAWn4B,aAAa8gB,cAAc7V,eAAgBz9C,EAAM8sC,cAC5E,EALG03B,WAAYuG,GAMnB,EAEDv4B,aAAay4B,UAAY,SAAU7qE,EAAMuB,EAASwD,EAAG4lE,EAAW1lE,GAE5D,IAAIkuB,EAASif,aAAa8gB,cACtBD,EAAa9/B,EAAO89B,kBACpB5e,EAAQlf,EAAOkf,MACnB,GAAKA,EA6DL,OA1DA,SAASy4B,EAAkBC,EAAeJ,GAEtC,IAAI17B,EAAcpJ,UAAUmJ,uBAAuB7b,EAAO1sB,QAAU4rC,EAAM5rC,QAAQA,QAAO,SAAS2lC,GAAU,OAAOA,EAAS7T,WAAWwyC,EAAc,IACjJhgE,EAAU,GAEdkkC,EAAWzoC,KAAI,SAAS4lC,GAEpB,GAAKA,EAAL,CAGA,IAAI4+B,EAAsB,IAAIC,OAAO,KAAOF,EAAgB,KACxDG,EAAgB9+B,EAASliC,QAAQ8gE,EAAoB,IAAItwD,MAAM,KAAK,GACpEywD,EAAmC,KAAnBJ,EAAwBG,EAAgB,IAAMH,EAAgBG,EAAgB,IAE9FpqE,EAAOoqE,GACe,GAAvBpqE,EAAKgF,QAAQ,QACZhF,EAAOA,EAAK4Z,MAAM,MAAM,KAGb,IADH3P,EAAQy1B,WAAU,SAAShJ,GAAO,OAAOA,EAAM53B,QAAUurE,CAAa,KAE9EpgE,EAAQpH,KAAK,CAAE/D,MAAOurE,EAAe76D,QAASxP,EAAMsqE,aAAa,EAAMnmE,SAAW,SAASrF,EAAOyB,EAAOgqE,EAAYC,GAC7GR,EAAkBlrE,EAAMA,MAAO0rE,EAClC,GAdE,CAiB3B,IAEwBzlC,UAAUiJ,uBAAuBi8B,EAAcn7D,MAAM,GAAI,GAAIujB,EAAO1sB,QAAU4rC,EAAM5rC,QAC1FD,KAAI,SAASxG,GAEf,IAAIA,EAAKkvC,UAAT,CAGA,IAAI1X,EAAQ,CAAE53B,MAAOI,EAAKiJ,KAAMqH,QAAStQ,EAAK8K,MAAOsgE,aAAa,EAAQnmE,SAAW,SAASrF,EAAOyB,EAAOgqE,EAAYC,GAEhH,IAAIC,EAAcD,EAAYE,gBAC9Br4C,EAAOkf,MAAM6K,eACb,IAAIl9C,EAAO6lC,UAAU0I,WAAW3uC,EAAMA,OAClCI,IACAA,EAAKg/B,IAAM7L,EAAOqoC,2BAA2B+P,GAC7Cp4C,EAAOkf,MAAMltC,IAAInF,IAElBiF,GACCA,EAASjF,GACbmzB,EAAOkf,MAAMmL,aAEhB,GAGLzyC,EAAQpH,KAAK6zB,EAlBF,CAoB3B,IAEY,IAAIqO,UAAUs+B,YAAap5D,EAAS,CAAE1J,MAAO0D,EAAGq/D,WAAYuG,GAAa1X,EAE5E,CAED6X,CAAkB,GAAGH,IACd,CAEf,EAEIv4B,aAAaq5B,kBAAoB,aAEjCr5B,aAAas5B,eAAiB,aAE9Bt5B,aAAau5B,2BAA6B,SACtC94D,EACAtR,EACAwD,EACA4lE,EACA3qE,GAEA,GAAKA,EAAL,CAIA,IAAI8mB,EAAOxe,KAEP2qD,EADS7gB,aAAa8gB,cACFjC,kBAEpB1vD,EAAUvB,EAAK4rE,gBACf5rE,EAAK6rE,cACLtqE,EAAUvB,EAAK6rE,eAGnB,IAAI9gE,EAAU,GACd,GAAIxJ,EACA,IAAK,IAAIZ,EAAE,EAAGA,EAAIY,EAAQlC,OAAQsB,IAAK,CACnC,IAAI62B,EAAQj2B,EAAQZ,GACpB,GAAK62B,EAAL,CAIA,IAAIjK,EAAQiK,EAAM,GACdA,EAAM,KACNA,EAAM,GAAK,IAEXA,EAAM,GAAGjK,QACTA,EAAQiK,EAAM,GAAGjK,OAGrBiK,EAAM,GAAGs0C,WAAY,EACrB,IAAI9qE,EAAO,CAAEsP,QAASid,EAAO3tB,MAAO43B,GAChCA,EAAM,IAAMqO,UAAU0C,SACtBvnC,EAAKoO,UAAY,SAErBrE,EAAQpH,KAAK3C,EAdZ,MAFG+J,EAAQpH,KAAK,KAiBpB,CAGL,GAAI3D,EAAK+rE,iBAAkB,CACvB,IAAIC,EAAahsE,EAAK+rE,iBAAiBhhE,GACpCihE,IAAYjhE,EAAUihE,EAC5B,CAED,GAAKjhE,EAAQ1L,OAqCb,OAhCW,IAAIwmC,UAAUs+B,YACrBp5D,EACA,CACI1J,MAAO0D,EACPE,SAOR,SAAuB4N,EAAG9N,EAAGunC,GACzB,IAAKtsC,EACD,OAGA6S,EAAE5N,UACF4N,EAAE5N,SAASiH,KAAK4a,EAAM9mB,EAAM6S,EAAG9N,EAAGunC,GAGlCz5B,EAAEjT,QACFI,EAAKqyC,MAAM6K,eACXl9C,EAAK8+C,SAASjsC,EAAEjT,MAAM,GAAIiT,EAAEjT,MAAM,GAAIiT,EAAEjT,MAAM,IAE1CI,EAAKisE,gBACLjsE,EAAKisE,eAAep5D,EAAEjT,OAE1BI,EAAKu8C,gBAAe,GAAM,GAC1Bv8C,EAAKqyC,MAAMmL,cAElB,EAzBO4mB,WAAYuG,EACZ3qE,KAAMA,GAEVizD,IAwBG,CA9EN,CA+ET,EAEI7gB,aAAa85B,4BAA8B,SACvCr5D,EACAtR,EACAwD,EACA4lE,EACA3qE,GAEA,GAAKA,EAAL,CAIA,IAAI8mB,EAAOxe,KAEP2qD,EADS7gB,aAAa8gB,cACFjC,kBAEpB1vD,EAAUvB,EAAKmsE,iBACfnsE,EAAKosE,eACL7qE,EAAUvB,EAAKosE,gBAGnB,IAAIrhE,EAAU,GACd,GAAIxJ,EACA,IAAK,IAAIZ,EAAE,EAAGA,EAAIY,EAAQlC,OAAQsB,IAAK,CACnC,IAAI62B,EAAQj2B,EAAQZ,GACpB,GAAK62B,GAML,IACIx3B,EAAK0uC,QACL1uC,EAAK0uC,MAAM29B,wBACuB,GAAlCrsE,EAAKokD,eAAe5sB,EAAM,IAH9B,CAOA,IAAIjK,EAAQiK,EAAM,GACdA,EAAM,KACNA,EAAM,GAAK,IACXA,EAAM,GAAGjK,QACTA,EAAQiK,EAAM,GAAGjK,OAErBiK,EAAM,GAAGs0C,WAAY,EACrB,IAAI9qE,EAAO,CAAEsP,QAASid,EAAO3tB,MAAO43B,GAChCA,EAAM,IAAMqO,UAAUyC,QACtBtnC,EAAKoO,UAAY,SAErBrE,EAAQpH,KAAK3C,EAZZ,OAVG+J,EAAQpH,KAAK,KAuBpB,CAYL,GATI2E,KAAKgkE,oBACLvhE,EAAUzC,KAAKgkE,kBAAkBvhE,IAEjC86B,UAAU4F,wBACgC,GAAtCzrC,EAAKokD,eAAe,eACpBr5C,EAAQpH,KAAK,CAAC2M,QAAS,cAAe1Q,MAAO,CAAC,aAAcimC,UAAUyC,MAAO,CAAC4b,YAAY,IAAQ90C,UAAW,UAIjHpP,EAAKssE,kBAAmB,CACxB,IAAIN,EAAahsE,EAAKssE,kBAAkBvhE,GACrCihE,IAAYjhE,EAAUihE,EAC5B,CAED,GAAKjhE,EAAQ1L,OA0Db,OAtDW,IAAIwmC,UAAUs+B,YACrBp5D,EACA,CACI1J,MAAO0D,EACPE,SAOR,SAASskE,EAAc12D,EAAG9N,EAAGunC,GACzB,IAAKtsC,EACD,OAGA6S,EAAE5N,UACF4N,EAAE5N,SAASiH,KAAK4a,EAAM9mB,EAAM6S,EAAG9N,EAAGunC,GAGtC,IAAKz5B,EAAEjT,MACH,OAGJ,IAAIA,EAAQiT,EAAEjT,MAAM,GAEpB,GACIA,IACCA,EAAMwI,cAAgBpK,QAAU4B,EAAMwI,cAAgBlG,OACzD,CAEE,IAAI6I,EAAU,GACd,IAAK,IAAIpK,KAAKf,EACVmL,EAAQpH,KAAK,CAAE2M,QAAS3P,EAAGf,MAAOA,EAAMe,KAQ5C,OANA,IAAIklC,UAAUs+B,YAAYp5D,EAAS,CAC/B1J,MAAO0D,EACPE,SAAUskE,EACVnF,WAAYuG,EACZ3qE,KAAMA,KAEH,CACvB,CACgBA,EAAKqyC,MAAM6K,eACXl9C,EAAKy/C,UAAU5sC,EAAEjT,MAAM,GAAIiT,EAAEjT,MAAM,GAAIiT,EAAEjT,MAAM,IAE3CI,EAAKusE,iBACLvsE,EAAKusE,gBAAgB15D,EAAEjT,OAE3BI,EAAKu8C,gBAAe,GAAM,GAC1Bv8C,EAAKqyC,MAAMmL,aAElB,EA/CO4mB,WAAYuG,EACZ3qE,KAAMA,GAEVizD,IA8CG,CAnHN,CAoHT,EAEI7gB,aAAao6B,yBAA2B,SACpC5sE,EACA2B,EACAwD,EACA4lE,EACA3qE,GAEA,GAAKA,GAASA,EAAK2tC,WAAnB,CAKA,IAAIxa,EAASif,aAAa8gB,cACtBD,EAAa9/B,EAAO89B,kBAEpBlmD,EAAU,GACd,IAAK,IAAIpK,KAAKX,EAAK2tC,WAAY,CAEP,iBADhB/tC,OAA+B4yB,IAAvBxyB,EAAK2tC,WAAWhtC,GAAmBX,EAAK2tC,WAAWhtC,GAAK,OAEhEf,EAAQyS,KAAKC,UAAU1S,IAC3B,IAAIygD,EAAOrgD,EAAKymD,gBAAgB9lD,GAChB,QAAb0/C,EAAKp3C,MAA+B,SAAbo3C,EAAKp3C,OAC3BrJ,EAAQwyC,aAAaq6B,0BAA2B7sE,EAAOygD,EAAKwG,SAGhEjnD,EAAQwyC,aAAas6B,WAAW9sE,GAChCmL,EAAQpH,KAAK,CACT2M,QACI,gCACC+vC,EAAK9yB,MAAQ8yB,EAAK9yB,MAAQ5sB,GAD3B,uCAIAf,EACA,UACJA,MAAOe,GAEd,CACD,GAAKoK,EAAQ1L,OA0Bb,OAtBW,IAAIwmC,UAAUs+B,YACrBp5D,EACA,CACI1J,MAAO0D,EACPE,SAQR,SAAuB4N,EAAGtR,EAASwD,EAAGunC,GAClC,IAAKtsC,EACD,OAEJ,IAAIs1B,EAAOhtB,KAAKitB,wBAChBpC,EAAOw5C,sBAAsB3sE,EAAM6S,EAAEjT,MAAO,CACxCu4B,SAAU,CAAC7C,EAAKm3B,KAAMn3B,EAAKO,MAElC,EAfOuuC,WAAYuG,EACZiC,YAAY,EACZ5sE,KAAMA,GAEVizD,IAaG,CAtDN,CAuDT,EAEI7gB,aAAas6B,WAAa,SAAS/tD,GAC/B,IAAI5Z,EAAIhG,SAASC,cAAc,OAE/B,OADA+F,EAAE8nE,UAAYluD,EACP5Z,EAAEiJ,SACjB,EAEIokC,aAAa06B,iBAAmB,SAASltE,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAC9D,GAAKA,EAAL,CAIA,IAAIgtE,EAAkB,SAAShtE,GAC3BA,EAAK2d,KAAO3d,EAAK2uC,cACb3uC,EAAKklD,UACLllD,EAAKklD,SAASllD,EAAK2d,KAC1B,EAEGs7B,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,IAInDX,EAAKu8C,gBAAe,GAAM,EAjBzB,CAkBT,EAEInK,aAAa3lC,UAAUuoD,aAAe,SAASr5C,EAAM5W,GACjD,IAAI+hB,EAAOxe,KAEP2kE,EAAYnmD,EAAKurB,MAAMpT,YAAatjB,EAAKq1B,WACzCk8B,EAAapmD,EAAKurB,MAAMpT,YAAatjB,EAAKu1B,WAC1Ci8B,GAAW,EACXF,GAAaA,EAAUztC,SAAWytC,EAAUztC,QAAQ7jB,EAAKs1B,eAAck8B,EAAWF,EAAUztC,QAAQ7jB,EAAKs1B,aAAahoC,MAC1H,IAAImkE,GAAW,EACXF,GAAcA,EAAW1tC,SAAW0tC,EAAW1tC,QAAQ7jB,EAAKw1B,eAAci8B,EAAWF,EAAW3tC,OAAO5jB,EAAKw1B,aAAaloC,MAE7H,IAGI8jE,EAAO,IAAIlnC,UAAUs+B,YAHX,CAAC,WAAW,KAAK,SAAS,MAGM,CAC1C9iE,MAAO0D,EACP+F,MAAoB,MAAb6Q,EAAK3a,KAAe2a,EAAK3a,KAAKoH,YAAYtH,KAAO,KACxDmE,SAGJ,SAAuB4N,EAAEtR,EAAQwD,GAC7B,OAAQ8N,GACJ,IAAK,WACDu/B,aAAay4B,UAAU,KAAM,KAAM9lE,EAAGgoE,GAAM,SAAS/sE,GAE7CA,EAAKu/B,QAAWv/B,EAAKu/B,OAAOlgC,QAAWW,EAAKw/B,SAAYx/B,EAAKw/B,QAAQngC,QAIrE4tE,EAAUjkB,cAAertC,EAAKs1B,YAAajxC,EAAMmtE,KACjDntE,EAAKgpD,cAAertC,EAAKw1B,YAAa+7B,EAAYE,GAClDptE,EAAKg/B,IAAI,IAAqB,GAAfh/B,EAAK2d,KAAK,GAErD,IACoB,MAEJ,IAAK,SACDmJ,EAAKurB,MAAM0O,WAAWplC,EAAK9Q,IAYtC,IAED,OAAO,CACf,EAEIunC,aAAa3lC,UAAUsnD,yBAA2B,SAASsZ,GACnDA,EAAUA,GAAW,GAAzB,IACIllB,EAAOnqD,OAAOsR,OAAO,CAAI0kD,SAAU,KAC9BC,SAAU,KACVC,OAAQ,KACRC,OAAQ,KACRh8B,SAAU,GACVi8B,SAAU,KACVC,OAAO,CAAC,EAAE,GACVC,WAAW,CAAC,EAAE,IAElB+Y,GAIDC,EAASnlB,EAAK6L,UAA4B,OAAhB7L,EAAK8L,SAC/BsZ,GAAQD,GAAUnlB,EAAK+L,QAAwB,OAAd/L,EAAKgM,OAE1C,IAAKmZ,IAAWC,EAEZ,OAAO,EAEX,IAAKplB,EAAKiM,SAEN,OAAO,EAGX,IAAI0D,EAAQwV,EAASnlB,EAAK6L,SAAW7L,EAAK+L,OACtCsZ,EAAQF,EAASnlB,EAAK8L,SAAW9L,EAAKgM,OAEtCsZ,GAAY,EAChB,cAAeD,GACX,IAAK,SACDC,EAAYH,EAASxV,EAAM1T,eAAeopB,GAAM,GAAS1V,EAAM1U,cAAcoqB,GAAM,GACnFA,EAAQF,EAASxV,EAAMt4B,QAAQguC,GAAS1V,EAAMv4B,OAAOiuC,GACrD,MACJ,IAAK,SAEDC,EAAYH,EAASxV,EAAM1T,eAAeopB,EAAM1sE,MAAQg3D,EAAM1U,cAAcoqB,EAAM1sE,MAClF,MACJ,IAAK,SACD2sE,EAAYD,EACZA,EAAQF,EAASxV,EAAMt4B,QAAQguC,GAAS1V,EAAMv4B,OAAOiuC,GACrD,MAEJ,QAII,OAAO,EAQf,IAAIE,EAAeF,EAAMvkE,MAAM48B,UAAUyC,MAAM,UAAUklC,EAAMvkE,KAC3D0kE,EAAmBL,EAASznC,UAAU0F,uBAAyB1F,UAAUyF,sBAC7E,GAAGqiC,GAAoBA,EAAiBD,GAAc,CAOlD,GANIF,EAAM7xD,KAKViyD,aAAc,EAC8B,iBAAlCD,EAAiBD,IAAsE,gBAAlCC,EAAiBD,IAC5E,IAAI,IAAIG,KAASF,EAAiBD,GAC9B,GAAIvlB,EAAKiM,UAAYuZ,EAAiBD,GAAcG,IAA2B,QAAjB1lB,EAAKiM,SAAmB,CAClFwZ,YAAcD,EAAiBD,GAAcG,GAE7C,KACH,OAGD1lB,EAAKiM,UAAYuZ,EAAiBD,IAAkC,QAAjBvlB,EAAKiM,WAAoBwZ,YAAcD,EAAiBD,IAEnH,GAAIE,YAAa,CACb,IAAIE,GAAc,EACQ,iBAAfF,aAA2BA,YAAY5tE,OAC9C8tE,EAAcF,YACdA,YAAcA,YAAY5tE,MAK9B,IAAIsiC,EAAUuD,UAAU0I,WAAWq/B,aACnC,GAAGtrC,EAAQ,CAEP,GAAIwrC,EAAY,CACZ,GAAIA,EAAYngC,WACZ,IAAK,IAAIhtC,KAAKmtE,EAAYngC,WACtBrL,EAAQ6iB,YAAaxkD,EAAGmtE,EAAYngC,WAAWhtC,IAGvD,GAAImtE,EAAYvuC,OAEZ,IAAK,IAAI5+B,KADT2hC,EAAQ/C,OAAS,GACHuuC,EAAYvuC,OACtB+C,EAAQmd,UACJquB,EAAYvuC,OAAO5+B,GAAG,GACtBmtE,EAAYvuC,OAAO5+B,GAAG,IAIlC,GAAImtE,EAAYtuC,QAEZ,IAAK,IAAI7+B,KADT2hC,EAAQ9C,QAAU,GACJsuC,EAAYtuC,QACtB8C,EAAQmd,UACJquB,EAAYtuC,QAAQ7+B,GAAG,GACvBmtE,EAAYtuC,QAAQ7+B,GAAG,IAI/BmtE,EAAYhjE,QACZw3B,EAAQx3B,MAAQgjE,EAAYhjE,OAE5BgjE,EAAYtjE,MACZ83B,EAAQwO,UAAUg9B,EAAYtjE,KAGrC,CAqBD,OAhIDlC,KA8GM+pC,MAAMltC,IAAIm9B,GACfA,EAAQtD,IAAM,CAAEmpB,EAAKhwB,SAAS,GAAGgwB,EAAKkM,OAAO,IAAIlM,EAAKmM,WAAW,GAAGnM,EAAKmM,WAAW,GAAGhyB,EAAQ3kB,KAAK,GAAG,GAClGwqC,EAAKhwB,SAAS,GAAGgwB,EAAKkM,OAAO,IAAIlM,EAAKmM,WAAW,GAAGnM,EAAKmM,WAAW,GAAGhyB,EAAQ3kB,KAAK,GAAG,IAKxF2vD,EACAnlB,EAAK6L,SAAShL,cAAeykB,EAAWnrC,EAASorC,GAEjDvlB,EAAK+L,OAAO3K,oBAAqBkkB,EAAWnrC,EAASorC,IAQlD,CAE3B,CAGa,CACJ,CACD,OAAO,CACV,EAEDt7B,aAAa3lC,UAAU4rD,mBAAqB,SAASgV,GAC7CA,EAAUA,GAAW,GAAzB,IACIllB,EAAOnqD,OAAOsR,OAAO,CAAI0kD,SAAU,KAC9BC,SAAU,KACVC,OAAQ,KACRC,OAAQ,KACRpvD,EAAG,MAEPsoE,GAEDvmD,EAAOxe,KAEPglE,EAASnlB,EAAK6L,UAAY7L,EAAK8L,SAC/BsZ,GAAQD,GAAUnlB,EAAK+L,QAAU/L,EAAKgM,OAE1C,IAAKmZ,IAAWC,EAEZ,OAAO,EAGX,IAAIzV,EAAQwV,EAASnlB,EAAK6L,SAAW7L,EAAK+L,OACtCsZ,EAAQF,EAASnlB,EAAK8L,SAAW9L,EAAKgM,OAEtCsZ,GAAY,EAChB,cAAeD,GACX,IAAK,SACDC,EAAYH,EAASxV,EAAM1T,eAAeopB,GAAM,GAAS1V,EAAM1U,cAAcoqB,GAAM,GACnFA,EAAQF,EAASxV,EAAMt4B,QAAQguC,GAAS1V,EAAMv4B,OAAOiuC,GACrD,MACJ,IAAK,SAEDC,EAAYH,EAASxV,EAAM1T,eAAeopB,EAAM1sE,MAAQg3D,EAAM1U,cAAcoqB,EAAM1sE,MAClF,MACJ,IAAK,SACD2sE,EAAYD,EACZA,EAAQF,EAASxV,EAAMt4B,QAAQguC,GAAS1V,EAAMv4B,OAAOiuC,GACrD,MACJ,QAII,OAAO,EAGf,IAAIjsE,EAAU,CAAC,WAAW,MAEtBulB,EAAKqtB,kBACL5yC,EAAQoC,KAAK,UACbpC,EAAQoC,KAAK,OAIjB,IAAI+pE,EAAeF,EAAMvkE,MAAM48B,UAAUyC,MAAM,UAAUklC,EAAMvkE,KAC3D0kE,EAAmBL,EAASznC,UAAU0F,uBAAyB1F,UAAUyF,sBAC7E,GAAGqiC,GAAoBA,EAAiBD,GACpC,GAA4C,iBAAlCC,EAAiBD,IAAsE,gBAAlCC,EAAiBD,GAC5E,IAAI,IAAIG,KAASF,EAAiBD,GAC9BnsE,EAAQoC,KAAKgqE,EAAiBD,GAAcG,SAGhDtsE,EAAQoC,KAAKgqE,EAAiBD,IAKtC,IAAIX,EAAO,IAAIlnC,UAAUs+B,YAAY5iE,EAAS,CAC1CF,MAAO8mD,EAAKpjD,EACZ+F,OAAQ0iE,GAAqB,IAAZA,EAAM1sE,KAAY0sE,EAAM1sE,MAAQ4sE,EAAa,MAAM,IAAO,KAAKF,GAASE,EAAeA,EAAe,IACvHzoE,SAIJ,SAAuB4N,EAAEtR,EAAQwD,GAE7B,OAAQ8N,GACJ,IAAK,WACDu/B,aAAay4B,UAAU,KAAM,KAAM9lE,EAAGgoE,GAAM,SAAS/sE,GAC7CstE,EACAnlB,EAAK6L,SAAShL,cAAeykB,EAAWztE,EAAM0tE,GAE9CvlB,EAAK+L,OAAO3K,oBAAqBkkB,EAAWztE,EAAM0tE,EAE9E,IACoB,MACJ,IAAK,SACEJ,EACCxmD,EAAKquC,cAAcpwD,EAAE,CAACizD,UAAW7P,EAAK6L,SAAUiE,UAAWuV,EAAOtV,eAAgBwV,IAElF5mD,EAAKquC,cAAcpwD,EAAE,CAACozD,QAAShQ,EAAK+L,OAAQ+D,UAAWuV,EAAOpV,gBAAiBsV,IAEnF,MACJ,QAEsB5mD,EAAKitC,yBAAyB/1D,OAAOsR,OAAO64C,EAAK,CAAEhwB,SAAU,CAACgwB,EAAKpjD,EAAEshD,QAAS8B,EAAKpjD,EAAEuhD,SAClG8N,SAAUvhD,KAU1B,IAED,OAAO,CACf,EAGIu/B,aAAa27B,qBAAuB,SAAS3vD,EAAM7c,EAASwD,EAAGgoE,EAAM/sE,GAEjE,IAAIqiD,EAAWjkC,EAAKikC,UAAY,QAC5BziD,EAAQI,EAAKqiD,GAIb2rB,EAASjvE,SAASC,cAAc,OACpCgvE,EAAOC,aAAc,EACrBD,EAAO5+D,UAAY,cACnB4+D,EAAOhgE,UACH,4FACJggE,EAAOv3D,MAAQ,WACPu3D,EAAO1tE,YACP0tE,EAAO1tE,WAAWC,YAAYytE,EAE9C,EACoBA,EAAOlgE,cAAc,SAC3B++D,UAAYxqB,EAClB,IAAI9/C,EAAQyrE,EAAOlgE,cAAc,UAC7BvL,IACAA,EAAM3C,MAAQA,EACd2C,EAAMf,iBAAiB,QAAQ,SAASuD,GACpCuD,KAAKqS,OACrB,IACYpY,EAAMf,iBAAiB,WAAW,SAASuD,GAEvC,GADAipE,EAAOC,aAAc,EACJ,IAAblpE,EAAE4zD,QAEFqV,EAAOv3D,aACJ,GAAiB,IAAb1R,EAAE4zD,QACTuV,SACG,GAAiB,IAAbnpE,EAAE4zD,SAAuC,YAAtB5zD,EAAEhF,OAAO4wD,UACnC,OAEJ5rD,EAAE6V,iBACF7V,EAAE2oD,iBAClB,KAGQ,IACIv6B,EADcif,aAAa8gB,cACN//B,OAErBmC,EAAOnC,EAAOoC,wBACd44C,GAAW,GACX/H,GAAW,GACX9wC,IACA64C,GAAW74C,EAAKm3B,KAChB2Z,GAAW9wC,EAAKO,KAGhBx0B,OACA2sE,EAAOrrE,MAAM8pD,KAAOprD,MAAMmrD,QAAU2hB,EAAU,KAC9CH,EAAOrrE,MAAMkzB,IAAMx0B,MAAMqrD,QAAU0Z,EAAU,OAE7C4H,EAAOrrE,MAAM8pD,KAAsB,GAAft5B,EAAOznB,MAAcyiE,EAAU,KACnDH,EAAOrrE,MAAMkzB,IAAsB,GAAhB1C,EAAOxnB,OAAey6D,EAAU,MAG1C4H,EAAOlgE,cAAc,UAC3BtM,iBAAiB,QAAS0sE,GACjC/6C,EAAO7yB,WAAWL,YAAY+tE,GAE3BzrE,GAAOA,EAAMoY,QAEhB,IAAIyzD,EAAmB,KAWvB,SAASF,IACF3rE,GAGP,SAAkB3C,GACG,UAAbwe,EAAKnV,KACLrJ,EAAQypD,OAAOzpD,GACK,WAAbwe,EAAKnV,OACZrJ,EAAQwU,QAAQxU,IAEpBI,EAAKqiD,GAAYziD,EACbouE,EAAO1tE,YACP0tE,EAAO1tE,WAAWC,YAAYytE,GAElChuE,EAAKu8C,gBAAe,GAAM,EAC7B,CAdatf,CAAS16B,EAAM3C,MAC5B,CAZDouE,EAAOxsE,iBAAiB,cAAc,SAASuD,GACxC8gC,UAAU6E,8BACJsjC,EAAOC,aAAepoC,UAAU6E,8BACjC0jC,EAAmBx4D,WAAWo4D,EAAOv3D,MAAOovB,UAAU8E,mCAC1E,IACQqjC,EAAOxsE,iBAAiB,cAAc,SAASuD,GACxC8gC,UAAU6E,6BACN0jC,GAAkB93D,aAAa83D,EAClD,GAkBA,EAGIh8B,aAAa3lC,UAAUwR,OAAS,SAASnT,EAAOlL,EAAOqF,EAAU5D,EAAOmoE,GACpE,IAAI1iD,EAAOxe,KAEXwC,EAAQA,GAAS,GAEjB,IAAIkjE,EAASjvE,SAASC,cAAc,OACpCgvE,EAAOC,aAAc,EACrBD,EAAO5+D,UAAY,sBAEf4+D,EAAOhgE,UADRw7D,EACoB,8GAEA,6GACvBwE,EAAOv3D,MAAQ,WACXqQ,EAAKunD,WAAa,KACdL,EAAO1tE,YACP0tE,EAAO1tE,WAAWC,YAAYytE,EAE9C,EAEQ,IACI76C,EADcif,aAAa8gB,cACN//B,OACzBA,EAAO7yB,WAAWL,YAAY+tE,GAE1B1lE,KAAKkqC,GAAGZ,MAAQ,IAChBo8B,EAAOrrE,MAAMuQ,UAAY,SAAW5K,KAAKkqC,GAAGZ,MAAQ,KAGxD,IAAIw8B,EAAmB,KACnBE,GAAkB,EACtBzoC,UAAUqmB,mBAAmB8hB,EAAO,SAAS,SAASjpE,GAC9CupE,GAEDzoC,UAAU6E,8BACJsjC,EAAOC,aAAepoC,UAAU6E,8BACjC0jC,EAAmBx4D,WAAWo4D,EAAOv3D,MAAOovB,UAAU8E,mCAC1E,IACQ9E,UAAUqmB,mBAAmB8hB,EAAO,SAAS,SAASjpE,GAC/C8gC,UAAU6E,6BACN0jC,GAAkB93D,aAAa83D,EAClD,IACQ,IAAIG,EAAWP,EAAO18D,iBAAiB,UACnCi9D,GAEAA,EAASnwE,SAAQ,SAASowE,GACtBA,EAAMhtE,iBAAiB,SAAS,SAASuD,GACrCupE,GACpB,IACgBE,EAAMhtE,iBAAiB,QAAQ,SAASuD,GACpCupE,EAAkB,CACtC,IACgBE,EAAMhtE,iBAAiB,UAAU,SAASuD,GACtCupE,GAAmB,CACvC,GACA,IAGYxnD,EAAKunD,YACLvnD,EAAKunD,WAAW53D,QAEpBqQ,EAAKunD,WAAaL,EAMCA,EAAOlgE,cAAc,SAC3B++D,UAAY/hE,EACzB,IAAI2jE,EAAgBT,EAAOlgE,cAAc,UACzC2gE,EAAc7uE,MAAQA,EACtB6uE,EAAcp8C,SAEd,IAAI9vB,EAAQksE,EACZlsE,EAAMf,iBAAiB,WAAW,SAASuD,GAEvC,GADAipE,EAAOC,aAAc,EACJ,IAAblpE,EAAE4zD,QAEFqV,EAAOv3D,YACJ,IAAiB,IAAb1R,EAAE4zD,SAAuC,YAAtB5zD,EAAEhF,OAAO4wD,UAMnC,OALI1rD,GACAA,EAASqD,KAAK1I,OAElBouE,EAAOv3D,OAGV,CACD1R,EAAE6V,iBACF7V,EAAE2oD,iBACd,IAEqBsgB,EAAOlgE,cAAc,UAC3BtM,iBAAiB,SAAS,SAASuD,GAClCE,GACAA,EAAS1C,EAAM3C,OAEnBknB,EAAK+oC,UAAS,GACdme,EAAOv3D,OACnB,IAEQ,IAAI6e,EAAOnC,EAAOoC,wBACd44C,GAAW,GACX/H,GAAW,GAkBf,OAjBI9wC,IACA64C,GAAW74C,EAAKm3B,KAChB2Z,GAAW9wC,EAAKO,KAGhBx0B,GACA2sE,EAAOrrE,MAAM8pD,KAAOprD,EAAMmrD,QAAU2hB,EAAU,KAC9CH,EAAOrrE,MAAMkzB,IAAMx0B,EAAMqrD,QAAU0Z,EAAU,OAE7C4H,EAAOrrE,MAAM8pD,KAAsB,GAAft5B,EAAOznB,MAAcyiE,EAAU,KACnDH,EAAOrrE,MAAMkzB,IAAsB,GAAhB1C,EAAOxnB,OAAey6D,EAAU,MAGvDxwD,YAAW,WACPrT,EAAMoY,OACT,GAAE,IAEIqzD,CACf,EAEI57B,aAAas8B,cAAgB,EAC7Bt8B,aAAa3lC,UAAU0oD,cAAgB,SAAS9zD,EAAOE,GAEnD,IAAIotE,EAAc,CAAE1W,UAAW,KAC1BD,UAAW,KACXG,QAAS,KACTyW,eAAgB/oC,UAAUkF,sBAC1BmtB,gBAAgB,EAChBE,iBAAiB,EACjByW,oCAAoC,EACpCC,iCAAiC,EACjCC,oBAAqBlpC,UAAUiF,2BAC/BkkC,mBAAmB,EACnBC,iBAAkBppC,UAAUmF,yBAEjCzpC,EAAUvD,OAAOsR,OAAOq/D,EAAaptE,GAAW,CAAE,GAIlD,IAAIulB,EAAOxe,KAEP2wC,EAAc7G,aAAa8gB,cAC3B//B,EAAS8lB,EAAY9lB,OACrB4xC,EAAgB5xC,EAAOo/B,eAAiBxzD,SAExCivE,EAASjvE,SAASC,cAAc,OAkBpC,GAjBAgvE,EAAO5+D,UAAY,8CACnB4+D,EAAOhgE,UAAY,wFACfzM,EAAQqtE,iBACRZ,EAAOhgE,WAAa,0EACpBggE,EAAOhgE,WAAa,4EAExBggE,EAAOhgE,WAAa,6BAEhB+2D,EAAcC,kBACdD,EAAcC,kBAAkB/kE,YAAY+tE,IAG5CjJ,EAAcnrD,KAAK3Z,YAAY+tE,GAC/BjJ,EAAcnrD,KAAKjX,MAAMusE,SAAW,UAIpC3tE,EAAQqtE,eACR,IAAIJ,EAAQR,EAAOlgE,cAAc,wBAC7BqhE,EAASnB,EAAOlgE,cAAc,yBAsBtC,GAnBAkgE,EAAOv3D,MAAQ,WACXqQ,EAAKsoD,WAAa,KAClB9mE,KAAKwZ,OACLqR,EAAOxY,QACPoqD,EAAcnrD,KAAKjX,MAAMusE,SAAW,GAEpCt5D,YAAW,WACPkR,EAAKqM,OAAOxY,OACf,GAAE,IACCqzD,EAAO1tE,YACP0tE,EAAO1tE,WAAWC,YAAYytE,EAE9C,EAEY1lE,KAAKkqC,GAAGZ,MAAQ,IAChBo8B,EAAOrrE,MAAMuQ,UAAY,SAAW5K,KAAKkqC,GAAGZ,MAAQ,KAIrDrwC,EAAQwtE,oBAAoB,CAC3B,IAAIT,GAAkB,EAClBe,EAAgB,KACpBxpC,UAAUqmB,mBAAmB8hB,EAAO,SAAS,SAASjpE,GAC9CsqE,IACA/4D,aAAa+4D,GACbA,EAAgB,KAEpC,IACYxpC,UAAUqmB,mBAAmB8hB,EAAO,SAAS,SAASjpE,GAC9CupE,IAGJe,EAAgBz5D,YAAW,WACvBo4D,EAAOv3D,OAC3B,GAA0D,iBAAhClV,EAAQwtE,oBAAmCxtE,EAAQwtE,oBAAsB,KACnG,IAEgBxtE,EAAQqtE,iBACRJ,EAAMhtE,iBAAiB,SAAS,SAASuD,GACrCupE,GACpB,IACgBE,EAAMhtE,iBAAiB,QAAQ,SAASuD,GACpCupE,EAAkB,CACtC,IACgBE,EAAMhtE,iBAAiB,UAAU,SAASuD,GACtCupE,GAAmB,CACvC,IACgBa,EAAO3tE,iBAAiB,SAAS,SAASuD,GACtCupE,GACpB,IACgBa,EAAO3tE,iBAAiB,QAAQ,SAASuD,GACrCupE,EAAkB,CACtC,IACgBa,EAAO3tE,iBAAiB,UAAU,SAASuD,GACvCupE,GAAmB,CACvC,IAES,CAEGxnD,EAAKsoD,YACLtoD,EAAKsoD,WAAW34D,QAEpBqQ,EAAKsoD,WAAapB,EAElB,IAAIsB,EAAStB,EAAOlgE,cAAc,WAE9ByhE,EAAQ,KACRC,EAAU,KACV/jE,EAAW,KAEXlJ,EAAQyrE,EAAOlgE,cAAc,SAsCjC,GArCIvL,IACAA,EAAMf,iBAAiB,QAAQ,SAASuD,GACpCuD,KAAKqS,OACrB,IACYpY,EAAMf,iBAAiB,WAAW,SAASuD,GACvC,GAAiB,IAAbA,EAAE4zD,QAEF8W,GAAgB,QACb,GAAiB,IAAb1qE,EAAE4zD,QAET8W,GAAgB,QACb,GAAiB,IAAb1qE,EAAE4zD,QAETqV,EAAOv3D,YACJ,IAAiB,IAAb1R,EAAE4zD,QAaT,OAJI6W,GACAh5D,cAAcg5D,QAElBA,EAAU55D,WAAW85D,EAAe,KAXhCjkE,EACA4mB,EAAOlgB,SAAS1G,EAASkkE,QAAc,OAChCJ,EACPl9C,EAAOk9C,GAEPvB,EAAOv3D,OAQd,CAID,OAHA1R,EAAE6V,iBACF7V,EAAE2oD,kBACF3oD,EAAEo0D,4BACK,CACvB,KAIY53D,EAAQqtE,eAAe,CACvB,GAAIJ,EAAM,CACN,IACIoB,GADAjnB,EAAS9iB,UAAUuF,eACH/rC,OAEhBkC,EAAQ22D,gBAAkBryB,UAAUyC,OAAS/mC,EAAQ22D,gBAAkBryB,UAAU0C,SACjFhnC,EAAQ22D,eAAiB,WAK7B,IAAK,IAAI2X,EAAG,EAAGA,EAAGD,EAAQC,IAAK,EACvBC,EAAM/wE,SAASC,cAAc,WAC7BY,MAAQ+oD,EAAOknB,GACnBC,EAAI9hE,UAAY26C,EAAOknB,GACvBrB,EAAMvuE,YAAY6vE,IACW,IAA1BvuE,EAAQ22D,iBAA4B32D,EAAQ22D,eAAe,IAAIxrB,gBAAkBic,EAAOknB,GAAI,IAAInjC,gBAE/FojC,EAAIrkE,UAAW,EAKtB,CACD+iE,EAAMhtE,iBAAiB,UAAS,WAC5BkuE,GACpB,GACa,CACD,GAAIP,EAAO,CACP,IAAIxmB,EACAinB,GADAjnB,EAAS9iB,UAAUwF,gBACHhsC,OAEhBkC,EAAQ62D,iBAAmBvyB,UAAUyC,OAAS/mC,EAAQ62D,iBAAmBvyB,UAAU0C,SACnFhnC,EAAQ62D,gBAAkB,WAK9B,IAASyX,EAAG,EAAGA,EAAGD,EAAQC,IAAK,CAC3B,IAAIC,KAAM/wE,SAASC,cAAc,WAC7BY,MAAQ+oD,EAAOknB,GACnBC,EAAI9hE,UAAY26C,EAAOknB,GACvBV,EAAOlvE,YAAY6vE,IACW,IAA3BvuE,EAAQ62D,kBAA6B72D,EAAQ62D,gBAAgB,IAAI1rB,gBAAkBic,EAAOknB,GAAI,IAAInjC,gBAEjGojC,EAAIrkE,UAAW,EAEtB,CACD0jE,EAAO3tE,iBAAiB,UAAS,WAC7BkuE,GACpB,GACa,CACJ,CAGD,IAAIp6C,EAAOnC,EAAOoC,wBAEdk3B,GAASprD,EAAQA,EAAMmrD,QAAWl3B,EAAKm3B,KAAoB,GAAbn3B,EAAK5pB,OAAiB,GACpEmqB,GAAQx0B,EAAQA,EAAMqrD,QAAWp3B,EAAKO,IAAoB,GAAdP,EAAK3pB,QAAkB,GA6BvE,SAAS0mB,EAAOvxB,GACZ,GAAIA,EACA,GAAIgmB,EAAK2uB,qBACL3uB,EAAK2uB,qBAAqB30C,EAAMO,EAAO43C,OACpC,CACH,IAAIxW,EAAQoD,UAAUyE,iBAAiBxpC,EAAK4rC,eACxCjK,IACA3hC,EAAO2hC,EAAMx5B,MAGjBgwC,EAAY5G,MAAM6K,eAClB,IAAIl9C,EAAO6lC,UAAU0I,WAAWztC,GAQhC,GAPId,IACAA,EAAKg/B,IAAMia,EAAYuiB,2BACnBn6D,GAEJ43C,EAAY5G,MAAMltC,IAAInF,GAAM,IAG5ByiC,GAASA,EAAMzhC,KAAM,CACrB,GAAIyhC,EAAMzhC,KAAK2sC,WACX,IAAK,IAAIhtC,KAAK8hC,EAAMzhC,KAAK2sC,WACrB3tC,EAAKmlD,YAAaxkD,EAAG8hC,EAAMzhC,KAAK2sC,WAAWhtC,IAGnD,GAAI8hC,EAAMzhC,KAAKu+B,OAEX,IAAK,IAAI5+B,KADTX,EAAKu/B,OAAS,GACAkD,EAAMzhC,KAAKu+B,OACrBv/B,EAAKy/C,UACDhd,EAAMzhC,KAAKu+B,OAAO5+B,GAAG,GACrB8hC,EAAMzhC,KAAKu+B,OAAO5+B,GAAG,IAIjC,GAAI8hC,EAAMzhC,KAAKw+B,QAEX,IAAK,IAAI7+B,KADTX,EAAKw/B,QAAU,GACDiD,EAAMzhC,KAAKw+B,QACrBx/B,EAAKy/C,UACDhd,EAAMzhC,KAAKw+B,QAAQ7+B,GAAG,GACtB8hC,EAAMzhC,KAAKw+B,QAAQ7+B,GAAG,IAI9B8hC,EAAMzhC,KAAK8J,QACX9K,EAAK8K,MAAQ23B,EAAMzhC,KAAK8J,OAExB23B,EAAMzhC,KAAKwJ,MACXxK,EAAK8wC,UAAUrO,EAAMzhC,KAAKwJ,KAGjC,CAGD,GAAIjJ,EAAQy2D,UAAU,CAClB,IAAI+X,GAAK,EACT,cAAexuE,EAAQ02D,WACnB,IAAK,SACD8X,EAAKxuE,EAAQy2D,UAAU5T,eAAe7iD,EAAQ02D,WAC9C,MACJ,IAAK,UAMQ,IAJL8X,EADAxuE,EAAQ02D,UAAUn3D,KACbS,EAAQy2D,UAAU5T,eAAe7iD,EAAQ02D,UAAUn3D,OAElD,SAE4C,IAAjCS,EAAQ02D,UAAUxC,aAA4Bsa,EAAKxuE,EAAQ02D,UAAUxC,YAC1F,MACJ,IAAK,SACDsa,EAAKxuE,EAAQ02D,UACb,MACJ,QACI8X,EAAK,OAEgC,IAAlCxuE,EAAQy2D,UAAUx4B,QAAQuwC,KACxB,IAALA,GAAcA,GAAI,GAClBxuE,EAAQy2D,UAAUhP,cAAe+mB,EAAI/vE,EAAMuB,EAAQy2D,UAAUx4B,QAAQuwC,GAAI9mE,KAKpF,CACD,GAAI1H,EAAQ42D,QAAQ,CACZ4X,GAAK,EACT,cAAexuE,EAAQ02D,WACnB,IAAK,SACD8X,EAAKxuE,EAAQ42D,QAAQ/U,cAAc7hD,EAAQ02D,WAC3C,MACJ,IAAK,UAMQ,IAJL8X,EADAxuE,EAAQ02D,UAAUn3D,KACbS,EAAQ42D,QAAQ/U,cAAc7hD,EAAQ02D,UAAUn3D,OAE/C,SAE4C,IAAjCS,EAAQ02D,UAAUxC,aAA4Bsa,EAAKxuE,EAAQ02D,UAAUxC,YAC1F,MACJ,IAAK,SACDsa,EAAKxuE,EAAQ02D,UACb,MACJ,QACI8X,EAAK,OAE6B,IAA/BxuE,EAAQ42D,QAAQ54B,OAAOwwC,KACrB,IAALA,GAAcA,GAAI,GAElBxuE,EAAQ42D,QAAQ5O,oBAAoBwmB,EAAG/vE,EAAKuB,EAAQ42D,QAAQ54B,OAAOwwC,GAAI9mE,KAKlF,CAEDgwC,EAAY5G,MAAMmL,aACrB,CAGLwwB,EAAOv3D,OACV,CAED,SAASg5D,EAAgBO,GACrB,IAAI1jC,EAAO7gC,EACPA,GACAA,EAASzI,UAAUkO,OAAO,YAEzBzF,GAKDA,EAAWukE,EACLvkE,EAAS2C,YACT3C,EAASwkE,mBAEXxkE,EAAW6gC,GARf7gC,EAAWukE,EACLV,EAAOltE,WAAW,GAClBktE,EAAOltE,WAAWktE,EAAOltE,WAAW/C,QASzCoM,IAGLA,EAASzI,UAAUmC,IAAI,YACvBsG,EAASykE,eAAe,CAACjqE,MAAO,MAAOkqE,SAAU,WACpD,CAED,SAAST,IACLF,EAAU,KACV,IAAI7wD,EAAMpc,EAAM3C,MAGhB,GAFA2vE,EAAQ,KACRD,EAAOthE,UAAY,GACd2Q,GAAQpd,EAAQytE,kBAIrB,GAAIloD,EAAK0uB,YAAa,CAClB,IAAI5tB,EAAOd,EAAK0uB,YAAY85B,EAAQ3wD,EAAKs6B,GACzC,GAAIrxB,EACA,IAAK,IAAIjnB,EAAI,EAAGA,EAAIinB,EAAKvoB,SAAUsB,EAC/ByvE,EAAUxoD,EAAKjnB,GAGvC,KAAmB,CACH,IAAIkF,EAAI,EACR8Y,EAAMA,EAAI+tB,cACV,IAAIjmC,EAASwyC,EAAYxyC,QAAUwyC,EAAY5G,MAAM5rC,OAGrD,GAAGlF,EAAQqtE,gBAAkB9nD,EAAKsoD,WAC9B,IAAIiB,EAAMvpD,EAAKsoD,WAAWthE,cAAc,wBACpCwiE,EAAOxpD,EAAKsoD,WAAWthE,cAAc,8BAErCuiE,GAAM,EACNC,GAAO,EAIf,IAAK,IAAI3vE,KAAKklC,UAAUyE,iBAAkB,CACtC,IAAI7H,EAAQoD,UAAUyE,iBAAiB3pC,GACvC,GAAMY,EAAQytE,oBAAqBrwD,IAAmD,IAA3C8jB,EAAMwL,KAAKvB,cAAc5mC,QAAQ6Y,GAA5E,CAGA,IAAI0/B,EAAOxY,UAAUqE,sBAAuBzH,EAAMx5B,MAClD,KAAIo1C,GAAQA,EAAK53C,QAAUA,IAErB8pE,EAAkB9tC,EAAMx5B,QAE9BmnE,EAAW3tC,EAAMwL,KAAM,oBACa,IAA/BmE,aAAas8B,cAAuB7oE,IAAMusC,aAAas8B,cACxD,KARH,CAUJ,CAED,IAAI/oE,EAAW,KACf,GAAIzD,MAAMuK,UAAUhG,OAEZd,EADO3H,OAAOoB,KAAMymC,UAAUqE,uBACdzjC,OAAQ8pE,QAG5B,IAAK,IAAI5vE,KADTgF,EAAW,GACGkgC,UAAUqE,sBAChBqmC,EAAkB5vE,IAClBgF,EAAShC,KAAKhD,GAI1B,IAASA,EAAI,EAAGA,EAAIgF,EAAStG,SACzB+wE,EAAUzqE,EAAShF,OACiB,IAA/ByxC,aAAas8B,cAAuB7oE,IAAMusC,aAAas8B,eAF3B/tE,KAQrC,GAAIY,EAAQutE,kCACJuB,EAAIzwE,OAAS0wE,EAAK1wE,OACzB,CAEG,IAAK,IAAIe,KADT6vE,eAAiB,GACH3qC,UAAUqE,sBAChBqmC,EAAkB5vE,EAAG,CAAC8vE,kBAAgBJ,IAAKA,EAAIzwE,QAAM,IAAW8wE,mBAAiBJ,IAAMA,EAAK1wE,QAAM,OAClG4wE,eAAe7sE,KAAKhD,GAE5B,IAASA,EAAI,EAAGA,EAAI6vE,eAAenxE,SAC/B+wE,EAAUI,eAAe7vE,GAAI,mBACO,IAA/ByxC,aAAas8B,cAAuB7oE,IAAMusC,aAAas8B,eAFrB/tE,KAM9C,CAGD,IAAK0vE,EAAIzwE,OAAS0wE,EAAK1wE,QACY,GAA5B0vE,EAAOltE,WAAW/C,QAAekC,EAAQstE,mCAC/C,CAEG,IAAK,IAAIluE,KADT6vE,eAAiB,GACH3qC,UAAUqE,sBAChBqmC,EAAkB5vE,EAAG,CAACgwE,YAAY,KAClCH,eAAe7sE,KAAKhD,GAE5B,IAASA,EAAI,EAAGA,EAAI6vE,eAAenxE,SAC/B+wE,EAAUI,eAAe7vE,GAAI,oBACO,IAA/ByxC,aAAas8B,cAAuB7oE,IAAMusC,aAAas8B,eAFrB/tE,KAM9C,CAED,SAAS4vE,EAAmBtnE,EAAMi/C,GAE1BA,EAASA,GAAU,GAAvB,IAKIC,EAAOnqD,OAAOsR,OAJJ,CAAEqhE,YAAY,EACvBF,gBAAgB,EAChBC,iBAAiB,GAEWxoB,GAC7B7J,EAAOxY,UAAUqE,sBAAuBjhC,GAC5C,GAAGxC,GAAU43C,EAAK53C,QAAUA,EACxB,OAAO,EACX,KAAMlF,EAAQytE,mBAAqBrwD,KAA6C,IAArC1V,EAAKyjC,cAAc5mC,QAAQ6Y,MAAiB0/B,EAAKvzC,QAAoD,IAA3CuzC,EAAKvzC,MAAM4hC,cAAc5mC,QAAQ6Y,IAClI,OAAO,EAGX,GAAGpd,EAAQqtE,iBAAmBzmB,EAAKwoB,WAAW,CAC1C,IAAIC,EAAQ3nE,EAER4nE,EAAKR,EAAIzwE,MAIb,IAH0B,IAAtBuoD,EAAKsoB,iBAAwBI,EAAK1oB,EAAKsoB,gBAGxCJ,GAAOQ,EAEN,GAAIhrC,UAAUqF,yBAAyB2lC,IAAOhrC,UAAUqF,yBAAyB2lC,GAAI9oE,MAGjF,IAAc,IADA89B,UAAUqF,yBAAyB2lC,GAAI9oE,MAAM2M,SAASk8D,GAMhE,OAAO,EAKfC,EAAKP,EAAK1wE,MAId,IAH2B,IAAvBuoD,EAAKuoB,kBAAyBG,EAAK1oB,EAAKuoB,iBAGzCJ,GAAQO,EAEP,GAAIhrC,UAAUsF,0BAA0B0lC,IAAOhrC,UAAUsF,0BAA0B0lC,GAAI9oE,MAGnF,IAAc,IADA89B,UAAUsF,0BAA0B0lC,GAAI9oE,MAAM2M,SAASk8D,GAMjE,OAAO,CAItB,CACD,OAAO,CACV,CACJ,CAED,SAASR,EAAUnnE,EAAMmG,GACrB,IAAI0hE,EAAO/xE,SAASC,cAAc,OAC7BuwE,IACDA,EAAQtmE,GAGZ,MAAMmrD,EAAWvuB,UAAUqE,sBAAsBjhC,GACjD,GAAImrD,GAAUtpD,MAAO,CACjBgmE,EAAKjE,UAAYzY,GAAUtpD,MAC3B,MAAMimE,EAAShyE,SAASC,cAAc,QACtC+xE,EAAO3hE,UAAY,kCACnB2hE,EAAO7gE,YAAcjH,EACrB6nE,EAAKhxE,OAAOixE,EAChC,MACoBD,EAAKjE,UAAY5jE,EAGrB6nE,EAAKnB,QAAc,KAAIqB,OAAO/nE,GAC9B6nE,EAAK1hE,UAAY,6BACbA,IACA0hE,EAAK1hE,WAAa,IAAMA,GAE5B0hE,EAAKtvE,iBAAiB,SAAS,SAASuD,GACpCstB,EAAOlgB,SAAS7J,KAAKqnE,QAAc,MACvD,IACgBL,EAAOrvE,YAAY6wE,EACtB,CACJ,CAED,OAvWA9C,EAAOrrE,MAAM8pD,KAAOA,EAAO,KAC3BuhB,EAAOrrE,MAAMkzB,IAAMA,EAAM,KAGtBx0B,EAAM4vE,OAAU37C,EAAK3pB,OAAS,MAC7B2jE,EAAO3sE,MAAMuuE,UAAa57C,EAAK3pB,OAAStK,EAAM4vE,OAAS,GAAM,MAoBjE1uE,EAAMoY,QACFpZ,EAAQ0tE,kBAAkBS,IA6UvB1B,CACf,EAEI57B,aAAa3lC,UAAUkgE,sBAAwB,SAAU3sE,EAAMqiD,EAAU9gD,GACrE,GAAKvB,QAAsCwyB,IAA9BxyB,EAAK2tC,WAAW0U,GAA7B,CAIA9gD,EAAUA,GAAW,GAGrB,IAAI8+C,EAAOrgD,EAAKymD,gBAAgBpE,GAC5Bp5C,EAAOo3C,EAAKp3C,KAEZkoE,EAAa,GAEjB,GAAY,UAARloE,GAA4B,UAARA,GAA4B,SAARA,GAA2B,UAARA,EAC3DkoE,EAAa,oDACV,GAAc,QAARloE,GAA0B,SAARA,IAAoBo3C,EAAKwG,OAiBjD,IAAY,WAAR59C,GAA6B,UAARA,EAO5B,OANAkoE,EACI,mDACCnxE,EAAK2tC,WAAW0U,GAAY,UAAY,IACzC,IAIP,KAzB+D,CAE5D,IAAK,IAAI1hD,KADTwwE,EAAa,+CACC9wB,EAAKwG,OAAQ,CACvB,IAAIh0C,EAAIlS,EACJ0/C,EAAKwG,OAAOz+C,cAAgBlG,QAC5B2Q,EAAIwtC,EAAKwG,OAAOlmD,IAEpBwwE,GACI,kBACAt+D,EACA,MACCA,GAAK7S,EAAK2tC,WAAW0U,GAAY,WAAa,IAC/C,IACAhC,EAAKwG,OAAOlmD,GACZ,WACP,CACDwwE,GAAc,WACjB,CAUD,IAAInD,EAAS1lE,KAAK8oE,aACd,uBACC/wB,EAAK9yB,MAAQ8yB,EAAK9yB,MAAQ80B,GAC3B,UACA8uB,EACA,sBACA5vE,GAGAgB,GAAQ,EACZ,GAAa,QAAR0G,GAA0B,SAARA,IAAoBo3C,EAAKwG,QAQzC,GAAY,WAAR59C,GAA6B,UAARA,GAC5B1G,EAAQyrE,EAAOlgE,cAAc,WAEzBvL,EAAMf,iBAAiB,SAAS,SAASuD,GACrCipE,EAAOqD,WACPp0C,IAAW16B,EAAM+uE,QACrC,SAIY,GADA/uE,EAAQyrE,EAAOlgE,cAAc,SAClB,CACPvL,EAAMf,iBAAiB,QAAQ,SAASuD,GACpCuD,KAAKqS,OACzB,IAEoB9H,OAAkC2f,IAA9BxyB,EAAK2tC,WAAW0U,GAA0BriD,EAAK2tC,WAAW0U,GAAY,GACjE,WAATp5C,IACA4J,EAAIR,KAAKC,UAAUO,IAGvBtQ,EAAM3C,MAAQiT,EACdtQ,EAAMf,iBAAiB,WAAW,SAASuD,GACvC,GAAiB,IAAbA,EAAE4zD,QAEFqV,EAAOv3D,aACJ,GAAiB,IAAb1R,EAAE4zD,QAETuV,SACG,GAAiB,IAAbnpE,EAAE4zD,QAET,YADAqV,EAAOqD,WAGXtsE,EAAE6V,iBACF7V,EAAE2oD,iBACtB,GACa,OA1CDnrD,EAAQyrE,EAAOlgE,cAAc,WACvBtM,iBAAiB,UAAU,SAASuD,GACtCipE,EAAOqD,WACPp0C,EAASl4B,EAAEhF,OAAOH,MAGlC,IAuEQ,OAjCI2C,GAAOA,EAAMoY,QAEJqzD,EAAOlgE,cAAc,UAC3BtM,iBAAiB,QAAS0sE,GA8B1BF,CA/HN,CAmGD,SAASE,IACLjxC,EAAS16B,EAAM3C,MAClB,CAED,SAASq9B,EAASr9B,GAEXygD,GAAQA,EAAKwG,QAAUxG,EAAKwG,OAAOz+C,cAAgBpK,QAAgCw0B,MAAtB6tB,EAAKwG,OAAOjnD,KACxEA,EAAQygD,EAAKwG,OAAOjnD,IAEgB,iBAA7BI,EAAK2tC,WAAW0U,KACvBziD,EAAQypD,OAAOzpD,IAEP,SAARqJ,GAA2B,UAARA,IACnBrJ,EAAQyS,KAAK0W,MAAMnpB,IAEvBI,EAAK2tC,WAAW0U,GAAYziD,EACxBI,EAAKqyC,OACLryC,EAAKqyC,MAAMqF,WAEX13C,EAAKmiD,mBACLniD,EAAKmiD,kBAAkBE,EAAUziD,GAElC2B,EAAQgwE,SACPhwE,EAAQgwE,UACZvD,EAAOv3D,QACPzW,EAAKu8C,gBAAe,GAAM,EAC7B,CAGT,EAGInK,aAAa3lC,UAAU2kE,aAAe,SAASz0D,EAAMpb,GAEjDA,EAAUvD,OAAOsR,OADC,CAAEkiE,eAAe,EAAOC,cAAc,EAAMC,4BAA4B,GACrDnwE,GAAW,CAAE,GAElD,IAAIysE,EAASjvE,SAASC,cAAc,OACpCgvE,EAAO5+D,UAAY,cACnB4+D,EAAOhgE,UAAY2O,EACnBqxD,EAAOC,aAAc,EAErB,IAAI34C,EAAOhtB,KAAK6qB,OAAOoC,wBACnB44C,GAAW,GACX/H,GAAW,GAwBf,GAvBI9wC,IACA64C,GAAW74C,EAAKm3B,KAChB2Z,GAAW9wC,EAAKO,KAGhBt0B,EAAQ42B,UACRg2C,GAAW5sE,EAAQ42B,SAAS,GAC5BiuC,GAAW7kE,EAAQ42B,SAAS,IACrB52B,EAAQF,OACf8sE,GAAW5sE,EAAQF,MAAMmrD,QACzB4Z,GAAW7kE,EAAQF,MAAMqrD,UAGzByhB,GAA+B,GAApB7lE,KAAK6qB,OAAOznB,MACvB06D,GAAgC,GAArB99D,KAAK6qB,OAAOxnB,QAG3BqiE,EAAOrrE,MAAM8pD,KAAO0hB,EAAU,KAC9BH,EAAOrrE,MAAMkzB,IAAMuwC,EAAU,KAE7B99D,KAAK6qB,OAAO7yB,WAAWL,YAAY+tE,GAG/BzsE,EAAQiwE,cAAc,CACtB,IAAIG,EAAK,IAELA,EAAK3D,EAAO18D,iBAAiB,WAC7BqgE,EAAGvzE,SAAQ,SAASwzE,GAChBA,EAAGpwE,iBAAiB,WAAU,SAASuD,GAEnC,GADAipE,EAAOqD,WACU,IAAbtsE,EAAE4zD,QACFqV,EAAOv3D,aACJ,GAAiB,IAAb1R,EAAE4zD,QACT,OAGJ5zD,EAAE6V,iBACF7V,EAAE2oD,iBAC1B,IACkCkkB,EAAGj3D,OACrC,GAES,CAEDqzD,EAAOqD,SAAW,WACdrD,EAAOC,aAAc,CACxB,EACDD,EAAOv3D,MAAQ,WACPu3D,EAAO1tE,YACP0tE,EAAO1tE,WAAWC,YAAYytE,EAE9C,EAEQ,IAAII,EAAmB,KACnBE,GAAkB,EACtBN,EAAOxsE,iBAAiB,cAAc,SAASuD,GACvCupE,IAED/sE,EAAQkwE,cAAgB5rC,UAAU6E,+BAC5BsjC,EAAOC,aAAepoC,UAAU6E,8BACjC0jC,EAAmBx4D,WAAWo4D,EAAOv3D,MAAOovB,UAAU8E,mCAC1E,IACQqjC,EAAOxsE,iBAAiB,cAAc,SAASuD,IACxCxD,EAAQkwE,cAAgB5rC,UAAU6E,8BAC9B0jC,GAAkB93D,aAAa83D,EAClD,IACQ,IAAIG,EAAWP,EAAO18D,iBAAiB,UAgBvC,OAfIi9D,GAEAA,EAASnwE,SAAQ,SAASowE,GACtBA,EAAMhtE,iBAAiB,SAAS,SAASuD,GACrCupE,GACpB,IACgBE,EAAMhtE,iBAAiB,QAAQ,SAASuD,GACpCupE,EAAkB,CACtC,IACgBE,EAAMhtE,iBAAiB,UAAU,SAASuD,GACtCupE,GAAmB,CACvC,GACA,IAGeN,CACf,EAEI57B,aAAa3lC,UAAUolE,YAAc,SAAS/mE,EAAOvJ,GAGjD,IAAI0xD,GAFJ1xD,EAAUA,GAAW,IAEIkQ,QAAUA,OAC/B/J,EAAO3I,SAASC,cAAc,OASlC,GARA0I,EAAK0H,UAAY,mBACjB1H,EAAKsG,UAAY,qMACjBtG,EAAKoqE,OAASpqE,EAAKoG,cAAc,kBAE9BvM,EAAQmK,QACPhE,EAAK/E,MAAM+I,MAAQnK,EAAQmK,OAASnK,EAAQmK,MAAMtD,cAAgBihD,OAAS,KAAO,KACnF9nD,EAAQoK,SACPjE,EAAK/E,MAAMgJ,OAASpK,EAAQoK,QAAUpK,EAAQoK,OAAOvD,cAAgBihD,OAAS,KAAO,KACtF9nD,EAAQwwE,SACX,CACI,IAAIt7D,EAAQ1X,SAASC,cAAc,QACnCyX,EAAMzI,UAAY,WAClByI,EAAMzT,UAAUmC,IAAI,SACpBsR,EAAMjV,iBAAiB,SAAQ,WAC3BkG,EAAK+O,OACrB,IACY/O,EAAKoqE,OAAO7xE,YAAYwW,EAC3B,CA+KD,OA9KA/O,EAAKsqE,cAAgBtqE,EAAKoG,cAAc,iBACxCpG,EAAKsqE,cAAcnF,UAAY/hE,EAC/BpD,EAAK4I,QAAU5I,EAAKoG,cAAc,mBAClCpG,EAAKuqE,YAAcvqE,EAAKoG,cAAc,uBACtCpG,EAAKwqE,OAASxqE,EAAKoG,cAAc,kBAEjCpG,EAAK+O,MAAQ,WAEL/O,EAAKyqE,SAAkC,mBAAhBzqE,EAAKyqE,SAC5BzqE,EAAKyqE,UAENzqE,EAAKpH,YACJoH,EAAKpH,WAAWC,YAAYmH,GAE7BY,KAAKhI,YACJgI,KAAKhI,WAAWC,YAAY+H,KAGnC,EAGDZ,EAAK0qE,iBAAmB,SAASrnB,GAC7B,QAAoB,IAATA,EACP,IAAIsnB,EAAMtnB,EAAQ,QAAU,OACxBunB,EAAOvnB,EAAQ,OAAS,aAExBsnB,EAAwC,SAAlC3qE,EAAKuqE,YAAYtvE,MAAM4X,QAAqB,QAAU,OAC5D+3D,EAAyC,SAAlC5qE,EAAKuqE,YAAYtvE,MAAM4X,QAAqB,OAAS,QAEpE7S,EAAKuqE,YAAYtvE,MAAM4X,QAAU83D,EACjC3qE,EAAK4I,QAAQ3N,MAAM4X,QAAU+3D,CAChC,EAED5qE,EAAK6qE,uBAAyB,SAASxnB,GACnC,QAAoB,IAATA,EACP,IAAIsnB,EAAMtnB,EAAQ,QAAU,YAExBsnB,EAAmC,SAA7B3qE,EAAKwqE,OAAOvvE,MAAM4X,QAAqB,QAAU,OAE/D7S,EAAKwqE,OAAOvvE,MAAM4X,QAAU83D,CAC/B,EAED3qE,EAAKtC,MAAQ,WAETkD,KAAKgI,QAAQtC,UAAY,EAC5B,EAEDtG,EAAK8qE,QAAU,SAAS3kC,EAAM3B,EAAWumC,GAErC,IAAIC,EAAO3zE,SAASC,cAAc,OAQlC,OAPGktC,IACCwmC,EAAKtjE,UAAY88B,GACrBwmC,EAAK1kE,UAAY6/B,EACd4kC,EACC/qE,EAAKwqE,OAAOjyE,YAAYyyE,GAExBhrE,EAAK4I,QAAQrQ,YAAYyyE,GACtBA,CACV,EAEDhrE,EAAKirE,UAAY,SAAU7xE,EAAMmE,EAAU1D,GAEvC,IAAImxE,EAAO3zE,SAASC,cAAc,UAMlC,OALA0zE,EAAK7F,UAAY/rE,EACjB4xE,EAAKnxE,QAAUA,EACfmxE,EAAK1vE,UAAUmC,IAAI,OACnButE,EAAKlxE,iBAAiB,QAAQyD,GAC9ByC,EAAKwqE,OAAOjyE,YAAYyyE,GACjBA,CACV,EAEDhrE,EAAKkrE,aAAe,WAEhB,IAAIF,EAAO3zE,SAASC,cAAc,OAClC0zE,EAAKtjE,UAAY,YACjB1H,EAAK4I,QAAQrQ,YAAYyyE,EAC5B,EAEDhrE,EAAKk/C,UAAY,SAAU39C,EAAMnI,EAAMlB,EAAO2B,EAAS0D,GAEnD1D,EAAUA,GAAW,GACrB,IAAIsxE,EAAYp+D,OAAO7U,GAEZ,WADXqJ,EAAOA,EAAKyjC,iBAERmmC,EAAYjzE,EAAM4/D,QAAQ,IAE9B,IAAIkT,EAAO3zE,SAASC,cAAc,OAClC0zE,EAAKtjE,UAAY,WACjBsjE,EAAK1kE,UAAY,0EACjB0kE,EAAK5kE,cAAc,kBAAkB++D,UAAYtrE,EAAQgsB,OAASzsB,EAClE,IAAI2tE,EAAgBiE,EAAK5kE,cAAc,mBAOvC,GANA2gE,EAAc5B,UAAYgG,EAC1BH,EAAK/C,QAAkB,SAAI7uE,EAC3B4xE,EAAK/C,QAAc,KAAIpuE,EAAQ0H,MAAQA,EACvCypE,EAAKnxE,QAAUA,EACfmxE,EAAK9yE,MAAQA,EAED,QAARqJ,EACAypE,EAAKlxE,iBAAiB,SAAS,SAASuD,GAAI2C,EAAKorE,kBAAmBxqE,KAAKqnE,QAAkB,SAAM,SAChG,GAAY,WAAR1mE,EAELypE,EAAK1vE,UAAUmC,IAAI,WAChBvF,GACC8yE,EAAK1vE,UAAUmC,IAAI,WACvButE,EAAKlxE,iBAAiB,SAAS,WAG3B,IAAIuxE,EAAWzqE,KAAKqnE,QAAkB,SACtCrnE,KAAK1I,OAAS0I,KAAK1I,MACnB0I,KAAKtF,UAAUD,OAAO,WACtBuF,KAAKwF,cAAc,mBAAmB++D,UAAYvkE,KAAK1I,MAAQ,OAAS,QACxEozE,EAAYD,EAAUzqE,KAAK1I,MAC/C,SAEiB,GAAY,UAARqJ,GAA4B,UAARA,EAEzBwlE,EAAc3sE,aAAa,mBAAkB,GAC7C2sE,EAAcjtE,iBAAiB,WAAW,SAASuD,GAClC,SAAVA,EAAE8oC,MAA4B,UAAR5kC,GAAqBlE,EAAE8V,WAE5C9V,EAAE6V,iBACFtS,KAAKwZ,OAE7B,IACgB2sD,EAAcjtE,iBAAiB,QAAQ,WACnC,IAAIqR,EAAIvK,KAAKukE,UACTkG,EAAWzqE,KAAKhI,WAAWqvE,QAAkB,SAEjC,UADDrnE,KAAKhI,WAAWqvE,QAAc,OAEzC98D,EAAIw2C,OAAOx2C,IACfmgE,EAAYD,EAAUlgE,EAC1C,SAEiB,GAAY,QAAR5J,GAA0B,SAARA,EAAiB,CACpC4pE,EAAYzgC,aAAaq6B,0BAA2B7sE,EAAO2B,EAAQslD,QACvE4nB,EAAc5B,UAAYgG,EAE1BpE,EAAcjtE,iBAAiB,SAAS,SAASH,GAC7C,IAAIwlD,EAAStlD,EAAQslD,QAAU,GAC3BksB,EAAWzqE,KAAKhI,WAAWqvE,QAAkB,SAC7CsD,EAAY3qE,KACL,IAAIu9B,UAAUs+B,YAAYtd,EAAO,CACpCxlD,MAAOA,EACP+N,UAAW,OACXnK,SAGR,SAAuB4N,EAAGyf,EAAQjxB,GAK9B,OAFA4xE,EAAUpG,UAAYh6D,EACtBmgE,EAAYD,EAASlgE,IACd,CACV,GAPGogD,EAQxB,GACa,CAID,SAAS+f,EAAYlyE,EAAMlB,GAIpB2B,EAAQ0D,UACP1D,EAAQ0D,SAASnE,EAAKlB,EAAM2B,GAC7B0D,GACCA,EAASnE,EAAKlB,EAAM2B,EAC3B,CAED,OAZAmG,EAAK4I,QAAQrQ,YAAYyyE,GAYlBA,CACV,EAEGhrE,EAAKwrE,QAAgC,mBAAfxrE,EAAKwrE,QAAsBxrE,EAAKwrE,SAEnDxrE,CACf,EAEI0qC,aAAaq6B,0BAA4B,SAAS7sE,EAAOinD,GAErD,IAAIA,EACA,OAAOpyC,OAAO7U,GAElB,GAAGinD,EAAOz+C,cAAgBlG,MAEtB,OAAOuS,OAAO7U,GAGlB,GAAGinD,EAAOz+C,cAAgBpK,OAC1B,CACI,IAAIm1E,EAAa,GACjB,IAAI,IAAIp4D,KAAK8rC,EAET,GAAGA,EAAO9rC,IAAMnb,EAAhB,CAEAuzE,EAAap4D,EACb,KAFa,CAIjB,OAAOtG,OAAO7U,GAAS,KAAKuzE,EAAW,GAC1C,CACJ,EAED/gC,aAAa3lC,UAAU2mE,YAAc,WACjC,IAGIC,GAHAA,EAAQt0E,SAAS+O,cAAc,iBAE/BulE,EAAM58D,SACN48D,EAAQt0E,SAAS+O,cAAc,mBAE/BulE,EAAM58D,OACb,EAED27B,aAAa3lC,UAAU6mE,0BAA4B,SAASC,EAASC,EAAMC,EAASC,GAChF,GAAGprE,KAAKF,aAAwC,kBAAzBE,KAAKF,YAAYtH,KAAyB,CAE7D,KAAK0yE,GAASA,EAAKnyE,OAAUmyE,EAAKnyE,MAAMtB,QAAWyzE,EAAKnyE,MAAMtB,OAAO4zE,cAIjE,OAEJ,IAAI16B,EAAcu6B,EAAKnyE,MAAMtB,OAAO4zE,YAChD,MAEgB16B,EAAc3wC,KAEtB2wC,EAAYm6B,cACZ,IAAIngB,EAAaha,EAAYgY,kBAC7BoiB,MAAQp6B,EAAY44B,YAAY,UAAU,CACtCE,UAAU,EACTtgE,OAAQwhD,EACRigB,OAAQ,WACLj6B,EAAY26B,qBAAsB,CACrC,EACAzB,QAAS,WACNl5B,EAAY26B,qBAAsB,EAClC36B,EAAY4f,cAAgB,IAC/B,IAEL5f,EAAY4f,cAAgBwa,MAC5BA,MAAMxoE,GAAK,eACXwoE,MAAMrwE,UAAUmC,IAAI,YAEpB,WAEIkuE,MAAM/iE,QAAQtC,UAAY,GAE1B,IAAI6lE,EAAU,SAAS/yE,EAAMlB,EAAO2B,GAkBpBA,GAAWA,EAAQkB,MACnB3B,EAAOS,EAAQkB,KAEflB,EAAQslD,SACRjnD,EAAQ5B,OAAO6oD,OAAOtlD,EAAQslD,QAAQ/gD,QAAQlG,IAGlDq5C,EAAYn4C,GAAQlB,CAG5C,EAIgBk0E,EAASjuC,UAAUkuC,uBAEvB,IAAI,IAAIC,KADRF,EAAOxmC,OACOwmC,EAAO,CACjB,IAAIG,EAAKH,EAAOE,GAChBX,MAAMzsB,UAAW,UAAWqtB,EAAIh7B,EAAYg7B,GAAK,CAACxxE,IAAKwxE,EAAIv7D,GAAI,OAAQG,IAAK,SAAUg7D,EACzF,CAEc56B,EAAY7D,kBAC3Bi+B,MAAMzsB,UAAW,QAAS,cAAe/gB,UAAUsD,kBAAkB8P,EAAY7D,mBAAoB,CAAC3yC,IAAK,oBAAqBokD,OAAQhhB,UAAUsD,mBAAoB0qC,GAEtKR,MAAMT,eAENS,MAAMnB,OAAOlkE,UAAY,EAE5B,CACDkmE,GAEAj7B,EAAY9lB,OAAO7yB,WAAWL,YAAaozE,MAC9C,EAEDjhC,aAAa3lC,UAAU0nE,kBAAoB,SAAUn0E,GAEjDsI,KAAK8rE,cAAgBp0E,EACrBsI,KAAK8qE,cACL,IAAIngB,EAAa3qD,KAAK2oD,kBAElBhY,EAAc3wC,KACd+qE,EAAQ/qE,KAAKupE,YAAY7xE,EAAK8K,OAAS,GAAG,CAC1CinE,UAAU,EACTtgE,OAAQwhD,EACRigB,OAAQ,WACLj6B,EAAYo7B,mBAAoB,CACnC,EACAlC,QAAS,WACNl5B,EAAYo7B,mBAAoB,EAChCp7B,EAAY2f,WAAa,IAC5B,IAOL,SAASsb,IAELb,EAAM/iE,QAAQtC,UAAY,GAC1BqlE,EAAMb,QAAQ,2BAA2BxyE,EAAKiJ,KAAK,mCAAmCjJ,EAAKoI,YAAY6lC,MAAQ,IAAI,0CAEnHolC,EAAMb,QAAQ,uBAEd,IAAIqB,EAAU,SAAS/yE,EAAKlB,GAExB,OADAq5C,EAAY5G,MAAM6K,aAAal9C,GACxBc,GACH,IAAK,QACDd,EAAK8K,MAAQlL,EACb,MACJ,IAAK,OACD,IAAI00E,EAAKt2E,OAAO6oD,OAAOhhB,UAAU2C,YAAY1iC,QAAQlG,GACjD00E,GAAI,GAAKzuC,UAAU2C,WAAW8rC,IAC9Bt0E,EAAKukD,WAAW+vB,GAIpB,MACJ,IAAK,QACGliC,aAAagZ,YAAYxrD,KACzBI,EAAKiiD,MAAQ7P,aAAagZ,YAAYxrD,GAAOqiD,MAC7CjiD,EAAKuiD,QAAUnQ,aAAagZ,YAAYxrD,GAAO2iD,SAInD,MACJ,QACIviD,EAAK6C,YAAY/B,EAAKlB,GAG9Bq5C,EAAY5G,MAAMmL,cAClBvE,EAAYiW,cAAe,CAC3C,EAEYmkB,EAAMzsB,UAAW,SAAU,QAAS5mD,EAAK8K,MAAO,CAAA,EAAI+oE,GAEpDR,EAAMzsB,UAAW,QAAS,OAAQ/gB,UAAU2C,WAAWxoC,EAAKwI,MAAO,CAACq+C,OAAQhhB,UAAU2C,YAAaqrC,GAEnG,IAAIU,EAAU,GAOd,IAAI,IAAIC,UANWhiD,IAAfxyB,EAAKiiD,QACLsyB,EAAUv2E,OAAOoB,KAAKgzC,aAAagZ,aAAa3kD,QAAO,SAASguE,GAAK,OAAOriC,aAAagZ,YAAYqpB,GAAIxyB,OAASjiD,EAAKiiD,KAAM,KAGjIoxB,EAAMzsB,UAAW,QAAS,QAAS2tB,EAAS,CAAC1tB,OAAQ7oD,OAAOoB,KAAKgzC,aAAagZ,cAAeyoB,GAE5E7zE,EAAK2tC,WACtB,CACI,IAAI/tC,EAAQI,EAAK2tC,WAAW6mC,GACxBn0B,EAAOrgD,EAAKymD,gBAAgB+tB,GACrBn0B,EAAKp3C,KAGZjJ,EAAK00E,sBAAwB10E,EAAK00E,qBAAqBF,EAAMnB,IAGjEA,EAAMzsB,UAAWvG,EAAKhc,QAAUgc,EAAKp3C,KAAMurE,EAAO50E,EAAOygD,EAAMwzB,EAClE,CAEDR,EAAMT,eAEH5yE,EAAK20E,uBACJ30E,EAAK20E,sBAAsBtB,GAE/BA,EAAMnB,OAAOlkE,UAAY,GACzBqlE,EAAMV,UAAU,UAAS,WAClB3yE,EAAK+6D,eAER/6D,EAAKqyC,MAAMnhC,OAAOlR,GAClBqzE,EAAM58D,QACT,IAAEzT,UAAUmC,IAAI,SACpB,CA9ED8zC,EAAY2f,WAAaya,EACzBA,EAAMxoE,GAAK,aACXwoE,EAAMrzE,KAAOA,EACbqzE,EAAMrwE,UAAUmC,IAAI,YA6EpBkuE,EAAMP,kBAAoB,SAAUC,GAEhCM,EAAMrwE,UAAUkO,OAAO,YACvBmiE,EAAMrwE,UAAUmC,IAAI,YAcpBkuE,EAAMpB,YAAYjkE,UAAY,qCAC9B,IAAIqhB,EAAWgkD,EAAMpB,YAAYnkE,cAAc,YAC3C8mE,EAAY,WACZvB,EAAMjB,kBAAiB,GACvBiB,EAAMd,wBAAuB,GAC7BljD,EAAS/uB,WAAWC,YAAY8uB,GAChCgkD,EAAMrwE,UAAUmC,IAAI,YACpBkuE,EAAMrwE,UAAUkO,OAAO,YACvBgjE,GACH,EACD7kD,EAASzvB,MAAQI,EAAK2tC,WAAWolC,GACjC1jD,EAAS7tB,iBAAiB,WAAW,SAASuD,GAC7B,SAAVA,EAAE8oC,MAAmB9oC,EAAEwvD,UAEtBv0D,EAAK6C,YAAYkwE,EAAU1jD,EAASzvB,OACpCg1E,IAEpB,IACYvB,EAAMjB,kBAAiB,GACvBiB,EAAMd,wBAAuB,GAC7BljD,EAAS1sB,MAAMgJ,OAAS,oBAExB,IAAI2D,EAAS+jE,EAAMV,UAAW,UAAU,WACpC3yE,EAAK6C,YAAYkwE,EAAU1jD,EAASzvB,OACpCg1E,GAChB,IACYvB,EAAMpB,YAAYhyE,YAAYqP,GAC9B,IAAI6L,EAASk4D,EAAMV,UAAW,QAASiC,GACvCz5D,EAAOxY,MAAMkyE,MAAQ,QACrBxB,EAAMpB,YAAYhyE,YAAYkb,EACjC,EAED+4D,IAEA5rE,KAAK6qB,OAAO7yB,WAAWL,YAAaozE,EACvC,EAEDjhC,aAAa3lC,UAAUiyD,6BAA+B,SAAS1+D,GAI3D,IAAI80E,EAAYxsE,KAAK6qB,OAAO7yB,WAAWwN,cAAc,oBAClDgnE,GACCA,EAAUr+D,QAEd,IAAI48D,EAAQ/qE,KAAKupE,YAAY,kBAAkB,CAACE,UAAS,EAAMrmE,MAAO,MAItE,SAASwoE,IAKL,GAHAb,EAAMjuE,QAGHpF,EAAKu/B,OACJ,IAAI,IAAI5+B,EAAI,EAAGA,EAAIX,EAAKu/B,OAAOlgC,SAAUsB,EACzC,CACI,IAAI4B,EAAQvC,EAAKu/B,OAAO5+B,GACxB,IAAG4B,EAAMi8D,mBAAT,CAEA,IACIkU,EAAOW,EAAMb,QADN,kHACmB,qBAC9BE,EAAK/C,QAAc,KAAIptE,EAAMzB,KAC7B4xE,EAAK/C,QAAc,KAAIhvE,EACvB+xE,EAAK5kE,cAAc,SAAS++D,UAAYtqE,EAAMzB,KAC9C4xE,EAAK5kE,cAAc,SAAS++D,UAAYtqE,EAAM0G,KAC9CypE,EAAK5kE,cAAc,UAAUtM,iBAAiB,SAAQ,SAASuD,GAC3D/E,EAAKu/C,YAAa8J,OAAQ/gD,KAAKhI,WAAWqvE,QAAc,OACxDuE,GACxB,GAViC,CAWhB,CACR,CAzBDb,EAAMrzE,KAAOA,EACbqzE,EAAMrwE,UAAUmC,IAAI,mBA2CpB,OAfWkuE,EAAMb,QADN,uIACmB,2BAA2B,GACpD1kE,cAAc,UAAUtM,iBAAiB,SAAS,SAASuD,GAC5D,IAAI2tE,EAAOpqE,KAAKhI,WACZQ,EAAO4xE,EAAK5kE,cAAc,SAASlO,MACnCqJ,EAAOypE,EAAK5kE,cAAc,SAASlO,MACnCkB,IAAqC,GAA7Bd,EAAKojD,cAActiD,KAE/Bd,EAAK8+C,SAASh+C,EAAKmI,GACnBypE,EAAK5kE,cAAc,SAASlO,MAAQ,GACpC8yE,EAAK5kE,cAAc,SAASlO,MAAQ,GACpCs0E,IACZ,IAEQA,IACA5rE,KAAK6qB,OAAO7yB,WAAWL,YAAYozE,GAC5BA,CACV,EACDjhC,aAAa3lC,UAAUuyD,kCAAoC,SAAUh/D,GAKjE,IAAI80E,EAAYxsE,KAAK6qB,OAAO7yB,WAAWwN,cAAc,oBACjDgnE,GACAA,EAAUr+D,QAEd,IAAI48D,EAAQ/qE,KAAKupE,YAAY,mBAAoB,CAAEE,UAAU,EAAMrmE,MAAO,MAI1E,SAASwoE,IAGL,GAFAb,EAAMjuE,QAEFpF,EAAKw/B,QACL,IAAK,IAAI7+B,EAAI,EAAGA,EAAIX,EAAKw/B,QAAQngC,SAAUsB,EAAG,CAC1C,IAAI4B,EAAQvC,EAAKw/B,QAAQ7+B,GACzB,IAAI4B,EAAMwyE,oBAAV,CAEA,IACIrC,EAAOW,EAAMb,QADN,kHACoB,qBAC/BE,EAAK/C,QAAc,KAAIptE,EAAMzB,KAC7B4xE,EAAK/C,QAAc,KAAIhvE,EACvB+xE,EAAK5kE,cAAc,SAAS++D,UAAYtqE,EAAMzB,KAC9C4xE,EAAK5kE,cAAc,SAAS++D,UAAYtqE,EAAM0G,KAC9CypE,EAAK5kE,cAAc,UAAUtM,iBAAiB,SAAS,SAAUuD,GAC7D/E,EAAKggD,aAAaqJ,OAAO/gD,KAAKhI,WAAWqvE,QAAc,OACvDuE,GACxB,GAViC,CAWhB,CACR,CAtBDb,EAAMrzE,KAAOA,EACbqzE,EAAMrwE,UAAUmC,IAAI,mBAwBpB,IACIutE,EAAOW,EAAMb,QADN,uIACoB,2BAA2B,GAS1D,SAAS/yB,IACL,IAAIizB,EAAOpqE,KAAKhI,WACZQ,EAAO4xE,EAAK5kE,cAAc,SAASlO,MACnCqJ,EAAOypE,EAAK5kE,cAAc,SAASlO,MAClCkB,IAAsC,GAA9Bd,EAAKokD,eAAetjD,KAEjCd,EAAKy/C,UAAU3+C,EAAMmI,GACrBypE,EAAK5kE,cAAc,SAASlO,MAAQ,GACpC8yE,EAAK5kE,cAAc,SAASlO,MAAQ,GACpCs0E,IACH,CAID,OAtBAxB,EAAK5kE,cAAc,SAAStM,iBAAiB,WAAW,SAAUuD,GAC7C,IAAbA,EAAE4zD,SACFlZ,EAAU1rC,MAAMzL,KAEhC,IACQoqE,EAAK5kE,cAAc,UAAUtM,iBAAiB,SAAS,SAAUuD,GAC7D06C,EAAU1rC,MAAMzL,KAC5B,IAaQ4rE,IACA5rE,KAAK6qB,OAAO7yB,WAAWL,YAAYozE,GAC5BA,CACV,EACDjhC,aAAa3lC,UAAUujD,YAAc,WAEjC,GAAI1nD,KAAK6qB,OAGT,IADA,IAAI6hD,EAAS1sE,KAAK6qB,OAAO7yB,WAAWgR,iBAAiB,qBAC7C3Q,EAAI,EAAGA,EAAIq0E,EAAO31E,SAAUsB,EACpC,CACI,IAAI0yE,EAAQ2B,EAAOr0E,GACd0yE,EAAMrzE,OAENqzE,EAAMrzE,KAAKqyC,OAASghC,EAAMhhC,OAAS/pC,KAAK+pC,OACzCghC,EAAM58D,QACb,CACJ,EAED27B,aAAa6iC,mBAAqB,SAASr1E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAChEA,EAAKqyC,MAAM6K,eAEX,IAAI8vB,EAAkB,SAAShtE,GAC3BA,EAAK8qD,UACR,EAEG7R,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,IAInDX,EAAKqyC,MAAMmL,aACnB,EAEIpL,aAAa8iC,cAAgB,SAASt1E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAC3DA,EAAKirD,KACb,EAEI7Y,aAAa+iC,eAAiB,SAASv1E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GA8B5D,OA7BA,IAAI6lC,UAAUs+B,YACVt+B,UAAU2C,WACV,CAAEnnC,MAAO0D,EAAGE,SAGhB,SAAuB4N,GACnB,IAAK7S,EACD,OAEJ,IAAIs0E,EAAKt2E,OAAO6oD,OAAOhhB,UAAU2C,YAAY1iC,QAAQ+M,GACjDm6D,EAAkB,SAAShtE,GACvBs0E,GAAI,GAAKzuC,UAAU2C,WAAW8rC,GAC9Bt0E,EAAKukD,WAAW+vB,GAGhBt0E,EAAKukD,WAAW1e,UAAU6C,OAEjC,EAEGuQ,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,GAGtD,EAzBwCyjE,WAAY2I,EAAM/sE,KAAMA,KA2B1D,CACf,EAEIoyC,aAAagjC,iBAAmB,SAASx1E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAC9D,IAAKA,EACD,KAAM,oBAGV,IAAI6mD,EAAS,GAOb,IAAK,IAAIlmD,KANTkmD,EAAOljD,KAAK,CACR/D,MAAO,KACP0Q,QACI,qEAGM8hC,aAAagZ,YAAa,CACpC,IAAInJ,EAAQ7P,aAAagZ,YAAYzqD,GACjCf,EAAQ,CACRA,MAAOe,EACP2P,QACI,uFACA2xC,EAAMA,MACN,sBACAA,EAAMM,QACN,KACA5hD,EACA,WAERkmD,EAAOljD,KAAK/D,EACf,CAwCD,OAvCA,IAAIimC,UAAUs+B,YAAYtd,EAAQ,CAC9BxlD,MAAO0D,EACPE,SAKJ,SAAuB4N,GACnB,IAAK7S,EACD,OAGJ,IAAIiiD,EAAQpvC,EAAEjT,MAAQwyC,aAAagZ,YAAYv4C,EAAEjT,OAAS,KAEtDy1E,EAAc,SAASr1E,GACnBiiD,EACIjiD,EAAKoI,cAAgBy9B,UAAU2L,YAC/BxxC,EAAKiiD,MAAQA,EAAMqJ,YAEnBtrD,EAAKiiD,MAAQA,EAAMA,MACnBjiD,EAAKuiD,QAAUN,EAAMM,iBAGlBviD,EAAKiiD,aACLjiD,EAAKuiD,QAEnB,EAEGtJ,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjFg2E,EAAYr1E,QAEZ,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtBg4B,EAAYp8B,EAAYoE,eAAe18C,IAG/CX,EAAKu8C,gBAAe,GAAM,EAC7B,EAlCG6nB,WAAY2I,EACZ/sE,KAAMA,KAmCH,CACf,EAEIoyC,aAAakjC,iBAAmB,SAAS11E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAC9D,IAAKA,EACD,KAAM,iBAiCV,OA9BA,IAAI6lC,UAAUs+B,YAAYt+B,UAAUgC,aAAc,CAC9CxmC,MAAO0D,EACPE,SAKJ,SAAuB4N,GACnB,IAAK7S,EACD,OAEJA,EAAKqyC,MAAM6K,eAEX,IAAI8vB,EAAkB,SAAShtE,GAC3BA,EAAKyiD,MAAQ5vC,CAChB,EAEGomC,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,IAInDX,EAAKqyC,MAAMmL,cACXx9C,EAAKu8C,gBAAe,EACvB,EAzBG6nB,WAAY2I,EACZ/sE,KAAMA,KA0BH,CACf,EAEIoyC,aAAamjC,iBAAmB,SAAS31E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAC9D,IAAKA,EACD,KAAM,iBAGV,IAAIqyC,EAAQryC,EAAKqyC,MACjBA,EAAM6K,eAGN,IAAI8vB,EAAkB,SAAShtE,IACJ,IAAnBA,EAAK8rE,WAGTz5B,EAAMnhC,OAAOlR,EAChB,EAEGi5C,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,IAInD0xC,EAAMmL,cACNx9C,EAAKu8C,gBAAe,GAAM,EAClC,EAEInK,aAAaojC,qBAAuB,SAAS51E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAClE,IAAIqyC,EAAQryC,EAAKqyC,MACb4G,EAAc7G,aAAa8gB,cAC/B,GAAIja,EAAJ,CAGA,IAAI8E,EAAa//C,OAAO6oD,OAAQ5N,EAAYoE,gBAAkB,CAAA,GACzDU,EAAW1+C,SACZ0+C,EAAa,CAAE/9C,IAEnB,IAAIkwD,EAAgBrqB,UAAU0I,WAAW,kBACzC2hB,EAAclxB,IAAMh/B,EAAKg/B,IAAIjtB,SAC7BsgC,EAAMltC,IAAI+qD,GAEVA,EAAculB,eAAgB13B,GAE9B9E,EAAYqf,mBACZt4D,EAAKu8C,gBAAe,GAAM,EAbf,CAcnB,EAEInK,aAAasjC,gBAAkB,SAAS91E,EAAO2B,EAASwD,EAAGgoE,EAAM/sE,GAE7DA,EAAKqyC,MAAM6K,eAEX,IAAIy4B,EAAc,CAAA,EAEd3I,EAAkB,SAAShtE,GAC3B,IAAsB,IAAlBA,EAAKs5D,SAAT,CAGA,IAAIhb,EAAUt+C,EAAK0iD,QACdpE,IAGLA,EAAQtf,IAAM,CAACh/B,EAAKg/B,IAAI,GAAK,EAAGh/B,EAAKg/B,IAAI,GAAK,GAC9Ch/B,EAAKqyC,MAAMltC,IAAIm5C,GACfq3B,EAAYr3B,EAAQzzC,IAAMyzC,EAPzB,CAQJ,EAEGrF,EAAc7G,aAAa8gB,cAC/B,IAAKja,EAAYoE,gBAAkBr/C,OAAOoB,KAAK65C,EAAYoE,gBAAgBh+C,QAAU,EACjF2tE,EAAgBhtE,QAEhB,IAAK,IAAIW,KAAKs4C,EAAYoE,eACtB2vB,EAAgB/zB,EAAYoE,eAAe18C,IAIhD3C,OAAOoB,KAAKu2E,GAAat2E,QACxB45C,EAAYoX,YAAYslB,GAG5B31E,EAAKqyC,MAAMmL,cAEXx9C,EAAKu8C,gBAAe,GAAM,EAClC,EAEInK,aAAagZ,YAAc,CACvBwqB,IAAK,CAAE3zB,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,QACnDuqB,MAAO,CAAE5zB,MAAO,UAAWM,QAAS,UAAW+I,WAAY,WAC3DwqB,MAAO,CAAE7zB,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,QACrDyqB,KAAM,CAAE9zB,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,QACpDD,UAAW,CACPpJ,MAAO,UACPM,QAAS,UACT+I,WAAY,WAEhB0qB,KAAM,CAAE/zB,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,QACpD2qB,OAAQ,CAAEh0B,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,WACtD4qB,OAAQ,CAAEj0B,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,WACtD6qB,MAAO,CAAEl0B,MAAO,OAAQM,QAAS,OAAQ+I,WAAY,SAGzDlZ,aAAa3lC,UAAU2pE,qBAAuB,WAC1C,IAAI70E,EAAU,KAmCd,GAjCI+G,KAAK+tE,eACL90E,EAAU+G,KAAK+tE,kBAEf90E,EAAU,CACN,CACI+O,QAAS,WACT86D,aAAa,EACbnmE,SAAUmtC,aAAay4B,WAE3B,CAAEv6D,QAAS,YAAarL,SAAUmtC,aAAa63B,aAQ/CjsE,OAAOoB,KAAKkJ,KAAK+0C,gBAAgBh+C,OAAS,GAC1CkC,EAAQoC,KAAK,CACT2M,QAAS,QACT86D,aAAa,EACbnmE,SAAUmtC,aAAaw4B,eAI3BtiE,KAAKsnD,cAAgBtnD,KAAKsnD,aAAavwD,OAAS,GAChDkC,EAAQoC,KAAK,KAAM,CACf2M,QAAS,iBACTrL,SAAUqD,KAAK2nD,cAAc38C,KAAKhL,SAK1CA,KAAKguE,oBAAqB,CAC1B,IAAI7zC,EAAQn6B,KAAKguE,oBAAoBhuE,KAAM/G,GACvCkhC,IACAlhC,EAAUA,EAAQwQ,OAAO0wB,GAEhC,CAED,OAAOlhC,CACf,EAGI6wC,aAAa3lC,UAAU8pE,mBAAqB,SAASv2E,GACjD,IAAIuB,EAAU,KA+Dd,GA7DIvB,EAAKq2E,eACL90E,EAAUvB,EAAKq2E,eAAe/tE,OAE9B/G,EAAU,CACN,CACI+O,QAAS,SACT86D,aAAa,EACb5C,UAAU,EACVvjE,SAAUmtC,aAAau5B,4BAE3B,CACIr7D,QAAS,UACT86D,aAAa,EACb5C,UAAU,EACVvjE,SAAUmtC,aAAa85B,6BAE3B,KACA,CACI57D,QAAS,aACT86D,aAAa,EACbnmE,SAAUmtC,aAAao6B,0BAE3B,CACIl8D,QAAS,mBACTrL,SAAU,SAASmZ,EAAM7c,EAASwD,EAAGgoE,EAAM/sE,GAAQoyC,aAAa8gB,cAAcihB,kBAAkBn0E,EAAO,GAE3G,KACA,CACIsQ,QAAS,QACTrL,SAAUmtC,aAAa27B,sBAE3B,CACIz9D,QAAS,OACT86D,aAAa,EACbnmE,SAAUmtC,aAAa+iC,kBAET,IAAnBn1E,EAAKq1D,WACJ9zD,EAAQoC,KAAK,CACT2M,QAAS,SAAUrL,SAAUmtC,aAAa06B,mBAGlDvrE,EAAQoC,KACJ,CACI2M,QAAS,WACTrL,SAAUmtC,aAAa6iC,oBAE3B,CAAE3kE,QAAS,MAAOrL,SAAUmtC,aAAa8iC,eACzC,CACI5kE,QAAS,SACT86D,aAAa,EACbnmE,SAAUmtC,aAAagjC,kBAE3B,CACI9kE,QAAS,SACT86D,aAAa,EACbnmE,SAAUmtC,aAAakjC,kBAE3B,OAIJt1E,EAAK6rE,YAAa,CAClB,IAAItsC,EAASv/B,EAAK6rE,cACdtsC,GAAUA,EAAOlgC,SACjBkC,EAAQ,GAAGinE,UAAW,EAE7B,CAED,GAAIxoE,EAAKosE,aAAc,CACnB,IAAI5sC,EAAUx/B,EAAKosE,eACf5sC,GAAWA,EAAQngC,SACnBkC,EAAQ,GAAGinE,UAAW,EAE7B,CAED,GAAIxoE,EAAKs2E,oBAAqB,CAC1B,IAAI7zC,EAAQziC,EAAKs2E,oBAAoBhuE,KAAM/G,GACvCkhC,IACAA,EAAM9+B,KAAK,MACXpC,EAAUkhC,EAAM1wB,OAAOxQ,GAE9B,CAiCD,OA/BsB,IAAlBvB,EAAKs5D,UACL/3D,EAAQoC,KAAK,CACT2M,QAAS,QACTrL,SAAUmtC,aAAasjC,kBAU3B13E,OAAOoB,KAAKkJ,KAAK+0C,gBAAgBh+C,OAAS,GAC1CkC,EAAQoC,KAAK,CACT2M,QAAS,oBACT86D,aAAa,EACbnmE,SAAUmtC,aAAas4B,cAI/BnpE,EAAQoC,KAAK,KAAM,CACf2M,QAAS,SACTk4D,YAA+B,IAAnBxoE,EAAK8rE,YAAwB9rE,EAAK+6D,cAC9C91D,SAAUmtC,aAAamjC,mBAGvBv1E,EAAKqyC,OAASryC,EAAKqyC,MAAMmkC,sBACzBx2E,EAAKqyC,MAAMmkC,qBAAqBj1E,EAASvB,GAGtCuB,CACf,EAEI6wC,aAAa3lC,UAAUgqE,oBAAsB,SAASz2E,GAkBlD,MAjBQ,CACJ,CAAEsQ,QAAS,QAASrL,SAAUmtC,aAAa27B,sBAC3C,CACIz9D,QAAS,QACT86D,aAAa,EACbnmE,SAAUmtC,aAAagjC,kBAE3B,CACI9kE,QAAS,YACT+xC,SAAU,YACVp5C,KAAM,SACNhE,SAAUmtC,aAAa27B,sBAE3B,KACA,CAAEz9D,QAAS,SAAUrL,SAAUmtC,aAAamjC,kBAIxD,EAEInjC,aAAa3lC,UAAUgoD,mBAAqB,SAASz0D,EAAMqB,GACvD,IAAIylB,EAAOxe,KAEP2qD,EADS7gB,aAAa8gB,cACFjC,kBAEpBylB,EAAY,KACZn1E,EAAU,CACVF,MAAOA,EACP4D,SAiFJ,SAA8B4N,EAAGtR,EAASwD,GACtC,IAAK8N,EACD,OAGJ,GAAiB,eAAbA,EAAEvC,QAA0B,CAC5B,IAAI+vC,EAAOxtC,EAAE+uB,KAQb,OAPA5hC,EAAKqyC,MAAM6K,eACPmD,EAAK99C,MACLvC,EAAKu/C,YAAYc,EAAKze,MACfye,EAAK5gB,QACZz/B,EAAKggD,aAAaK,EAAKze,WAE3B5hC,EAAKqyC,MAAMmL,aAE3B,CAAmB,GAAiB,oBAAb3qC,EAAEvC,QAA+B,CACpC+vC,EAAOxtC,EAAE+uB,KAQb,OAPA5hC,EAAKqyC,MAAM6K,eACPmD,EAAK5gB,OACLz/B,EAAKo9C,iBAAiBiD,EAAKze,MACpBye,EAAK99C,OACZvC,EAAKm9C,gBAAgBkD,EAAKze,WAE9B5hC,EAAKqyC,MAAMmL,aAE3B,CAAmB,GAAiB,eAAb3qC,EAAEvC,QAA0B,CACnC,IACIkzC,GADAnD,EAAOxtC,EAAE+uB,MACQr/B,MACfvC,EAAKsjD,aAAajD,EAAKze,MACvB5hC,EAAK2jD,cAActD,EAAKze,MAC1BosC,EAASlnD,EAAKsqD,aACd,kFACA7vE,GAEAgB,EAAQyrE,EAAOlgE,cAAc,SAC7BvL,GAASihD,IACTjhD,EAAM3C,MAAQ4jD,EAAUj2B,OAAS,IAErC,IAAI2gD,EAAQ,WACRluE,EAAKqyC,MAAM6K,eACP36C,EAAM3C,QACF4jD,IACAA,EAAUj2B,MAAQhrB,EAAM3C,OAE5BknB,EAAK+oC,UAAS,IAElBme,EAAOv3D,QACPzW,EAAKqyC,MAAMmL,aACd,EACDwwB,EAAOlgE,cAAc,UAAUtM,iBAAiB,QAAS0sE,GACzD3rE,EAAMf,iBAAiB,WAAW,SAASuD,GAEvC,GADAipE,EAAOC,aAAc,EACJ,IAAblpE,EAAE4zD,QAEFqV,EAAOv3D,aACJ,GAAiB,IAAb1R,EAAE4zD,QACTuV,SACG,GAAiB,IAAbnpE,EAAE4zD,SAAuC,YAAtB5zD,EAAEhF,OAAO4wD,UACnC,OAEJ5rD,EAAE6V,iBACF7V,EAAE2oD,iBACtB,IACgBnrD,EAAMoY,OACT,CAIJ,EApJG8nB,MAAOziC,GAGRA,IACCuB,EAAQuJ,MAAQ9K,EAAKiJ,MAGzB,IAAI24B,EAAO,KAMX,GALI5hC,IACA4hC,EAAO5hC,EAAK6nD,kBAAkBxmD,EAAMglD,QAAShlD,EAAMilD,SACnDlU,aAAaukC,YAAc32E,GAG3B4hC,EAAM,CAGN,GADA80C,EAAY,GACR12E,EAAK42E,mBACLF,EAAY12E,EAAK42E,mBAAmBh1C,OACjC,CAECA,GACAA,EAAKnC,QACLmC,EAAKnC,OAAOvK,OACZ0M,EAAKnC,OAAOvK,MAAM71B,QAElBq3E,EAAU/yE,KAAK,CAAE2M,QAAS,mBAAoBsxB,KAAMA,IAExD,IAAIi1C,EAAQj1C,EAAKr/B,OAASq/B,EAAKnC,OAC3Bo3C,EAAM/K,WACN4K,EAAU/yE,KACNkzE,EAAMC,OACA,gBACA,CAAExmE,QAAS,cAAesxB,KAAMA,IAGzCi1C,EAAM3yB,YACPwyB,EAAU/yE,KAAK,CAAE2M,QAAS,cAAesxB,KAAMA,GAGtD,CACDrgC,EAAQuJ,OACH82B,EAAKr/B,MAAQq/B,EAAKr/B,MAAM0G,KAAO24B,EAAKnC,OAAOx2B,OAAS,IACrD24B,EAAKr/B,OAASq/B,EAAKr/B,MAAM0G,MAAQ48B,UAAU0C,SAC3ChnC,EAAQuJ,MAAQ,UAEhB82B,EAAKnC,QAAUmC,EAAKnC,OAAOx2B,MAAQ48B,UAAUyC,QAC7C/mC,EAAQuJ,MAAQ,QAEhC,MACY,GAAI9K,EAEA02E,EAAYpuE,KAAKiuE,mBAAmBv2E,OACjC,CACH02E,EAAYpuE,KAAK8tE,uBACjB,IAAI53C,EAAQl2B,KAAK+pC,MAAM8L,cACnB98C,EAAMglD,QACNhlD,EAAMilD,SAEN9nB,GAEAk4C,EAAU/yE,KAAK,KAAM,CACjB2M,QAAS,aACT86D,aAAa,EACb2L,QAAS,CACLjsE,MAAO,QACP23B,MAAOjE,EACPj9B,QAAS+G,KAAKmuE,oBAAoBj4C,KAIjD,CAIAk4C,GAIM,IAAI7wC,UAAUs+B,YAAYuS,EAAWn1E,EAAS0xD,EAuEjE,EAI0B,oBAAX,QAA0BxhD,OAAOulE,2BAA6BvlE,OAAOulE,yBAAyBvqE,UAAU2xD,YAC/G3sD,OAAOulE,yBAAyBvqE,UAAU2xD,UAAY,SAClDxqD,EACAE,EACAf,EACAK,EACA6jE,EACAC,GAEA,IAAIC,EAAkB,EAClBC,EAAmB,EACnBC,EAAqB,EACrBC,EAAsB,EAE1B,GAAgB,IAAXL,EAAL,CAUA,QAJkBzkD,IAAf0kD,IACCA,EAAaD,GAGJ,MAAVA,GAAkBA,EAAO7uE,cAAgBlG,MAExC,GAAoB,GAAjB+0E,EAAO53E,OACN83E,EAAkBC,EAAmBC,EAAqBC,EAAsBL,EAAO,QACtF,GAAoB,GAAjBA,EAAO53E,OAEX83E,EAAkBG,EAAsBL,EAAO,GAC/CG,EAAmBC,EAAqBJ,EAAO,OAE9C,IAAoB,GAAjBA,EAAO53E,OAQX,OANA83E,EAAkBF,EAAO,GACzBG,EAAmBH,EAAO,GAC1BI,EAAqBJ,EAAO,GAC5BK,EAAsBL,EAAO,EAGtB,MAIXE,EAAkBF,GAAU,EAC5BG,EAAmBH,GAAU,EAC7BI,EAAqBH,GAAc,EACnCI,EAAsBJ,GAAc,EAIxC5uE,KAAK80D,OAAOxpD,EAAIujE,EAAiBrjE,GACjCxL,KAAK+0D,OAAOzpD,EAAIb,EAAIqkE,EAAkBtjE,GACtCxL,KAAKivE,iBAAiB3jE,EAAIb,EAAGe,EAAGF,EAAIb,EAAGe,EAAIsjE,GAG3C9uE,KAAK+0D,OAAOzpD,EAAIb,EAAGe,EAAIV,EAAIkkE,GAC3BhvE,KAAKivE,iBACD3jE,EAAIb,EACJe,EAAIV,EACJQ,EAAIb,EAAIukE,EACRxjE,EAAIV,GAIR9K,KAAK+0D,OAAOzpD,EAAI0jE,EAAqBxjE,EAAIV,GACzC9K,KAAKivE,iBAAiB3jE,EAAGE,EAAIV,EAAGQ,EAAGE,EAAIV,EAAIikE,GAG3C/uE,KAAK+0D,OAAOzpD,EAAGE,EAAIujE,GACnB/uE,KAAKivE,iBAAiB3jE,EAAGE,EAAGF,EAAIujE,EAAiBrjE,EArDhD,MAFGxL,KAAKgtB,KAAK1hB,EAAEE,EAAEf,EAAEK,EAwDhC,GAWIyyB,UAAUq9B,eAAiBA,eAO3Br9B,UAAUqvB,SAAWA,SAerBrvB,UAAUu9B,cAAgBA,cAQ1Bv9B,UAAU2gB,kBAAoBA,kBAgB9B3gB,UAAUw9B,aAAeA,aAczBx9B,UAAUy9B,iBAAmBA,iBAmB7Bz9B,UAAUmmB,gBAAkBA,gBAuB5BnmB,UAAU+9B,QAAUA,QAiBpB/9B,UAAUo+B,QAAUA,QA0MpBE,YAAY13D,UAAUo4D,QAAU,SAAS/jE,EAAMlB,EAAO2B,GAClD,IAAIulB,EAAOxe,KACX/G,EAAUA,GAAW,GAErB,IAAIV,EAAU9B,SAASC,cAAc,OACrC6B,EAAQuO,UAAY,yBAEpB,IAAIo5D,GAAW,EAkDf,SAASgP,EAAczyE,GACnB,IAAInF,EAAQ0I,KAAK1I,MACb63E,GAAe,GAEf3wD,EAAKw9C,iBACLx9C,EAAKw9C,gBAAgB7tD,MAAM1R,GAI3BxD,EAAQ0D,aASE,IARF1D,EAAQ0D,SAASiH,KACrB5D,KACA1I,EACA2B,EACAwD,EACA+hB,EACAvlB,EAAQvB,QAGRy3E,GAAe,IAKvB,GAAI73E,EAAO,CACP,GACIA,EAAMqF,WACL1D,EAAQm2E,wBACU,IAAnB93E,EAAM4oE,UAWI,IARF5oE,EAAMqF,SAASiH,KACnB5D,KACA1I,EACA2B,EACAwD,EACA+hB,EACAvlB,EAAQkhC,SAGRg1C,GAAe,GAGvB,GAAI73E,EAAMm3E,QAAS,CACf,IAAKn3E,EAAMm3E,QAAQx1E,QACf,KAAM,oCAEI,IAAIulB,EAAK1e,YAAYxI,EAAMm3E,QAAQx1E,QAAS,CACtD0D,SAAUrF,EAAMm3E,QAAQ9xE,SACxB5D,MAAO0D,EACPq/D,WAAYt9C,EACZ4wD,sBACA93E,EAAMm3E,QAAQW,sBACd5sE,MAAOlL,EAAMm3E,QAAQjsE,MACrB23B,MAAO7iC,EAAMm3E,QAAQt0C,MACrBk1C,SAAUp2E,EAAQo2E,WAEtBF,GAAe,CAClB,CACJ,CAEGA,IAAiB3wD,EAAKu9C,MACtBv9C,EAAKrQ,OAEZ,CAED,OAlHc,OAAV7W,EACAiB,EAAQmC,UAAUmC,IAAI,cAItBtE,EAAQmN,UAAYpO,GAASA,EAAMkL,MAAQlL,EAAMkL,MAAQhK,EACzDD,EAAQjB,MAAQA,EAEZA,IACIA,EAAM4oE,WACNA,GAAW,EACX3nE,EAAQmC,UAAUmC,IAAI,cAEtBvF,EAAMm3E,SAAWn3E,EAAMwrE,cACvBvqE,EAAQmC,UAAUmC,IAAI,gBAIV,mBAATvF,GACPiB,EAAQ8uE,QAAe,MAAI7uE,EAC3BD,EAAQ+2E,iBAAmBh4E,GAE3BiB,EAAQ8uE,QAAe,MAAI/vE,EAG3BA,EAAMwP,YACNvO,EAAQuO,WAAa,IAAMxP,EAAMwP,YAIzC9G,KAAKZ,KAAKzH,YAAYY,GACjB2nE,GACD3nE,EAAQW,iBAAiB,QAASg2E,IAEjChP,GAAYjnE,EAAQo2E,UACrB9xC,UAAUqmB,mBAAmBrrD,EAAQ,SAGzC,SAAoBkE,GAChB,IAAInF,EAAQ0I,KAAK1I,MACjB,IAAKA,IAAUA,EAAMwrE,YACjB,OAGJoM,EAActrE,KAAK5D,KAAMvD,EAC5B,IAqEMlE,CACf,EAEIsjE,YAAY13D,UAAUgK,MAAQ,SAAS1R,EAAG8yE,GAClCvvE,KAAKZ,KAAKpH,YACVgI,KAAKZ,KAAKpH,WAAWC,YAAY+H,KAAKZ,MAEtCY,KAAK87D,aAAeyT,IACpBvvE,KAAK87D,WAAWC,MAAO,EACvB/7D,KAAK87D,WAAWE,gBAAkB,UACxB9xC,IAANztB,EACAuD,KAAK87D,WAAW3tD,QAEhB1R,IACCo/D,YAAY2T,oBAAoB/yE,EAAGuD,KAAK87D,WAAW18D,OAEpDy8D,YAAYvlB,QAAQt2C,KAAK87D,WAAW18D,KAAMm+B,UAAUgG,qBAAqB,QAAS9mC,IAGtFuD,KAAKg8D,iBACLh8D,KAAKg8D,gBAAgB7tD,MAAM1R,GAAG,GAG9BuD,KAAKZ,KAAKo9D,eACVxuD,aAAahO,KAAKZ,KAAKo9D,cAKnC,EAGIX,YAAYvlB,QAAU,SAAS/9C,EAASk3E,EAAYnqC,EAAQ1uB,GACxD,IAAI84D,EAAMj5E,SAASk5E,YAAY,eAS/B,OARAD,EAAIE,gBAAgBH,GAAY,GAAM,EAAMnqC,GAC5CoqC,EAAIG,WAAaj5D,EACbre,EAAQu3E,cACRv3E,EAAQu3E,cAAcJ,GACfn3E,EAAQw3E,UACfx3E,EAAQw3E,SAASD,cAAcJ,GAG5BA,CACf,EAGI7T,YAAY13D,UAAU6rE,WAAa,WAC/B,OAAIhwE,KAAK/G,QAAQ6iE,WACN97D,KAAK/G,QAAQ6iE,WAAWkU,aAE5BhwE,IACf,EAEI67D,YAAY13D,UAAU++D,cAAgB,WAClC,OAAIljE,KAAK/G,QAAQ6iE,WACN97D,KAAK/G,QAAQ6iE,WAAWoH,gBAE5BljE,KAAK/G,QAAQF,KAC5B,EAEI8iE,YAAY2T,oBAAsB,SAASz2E,EAAOR,GAC9C,IAAI4rD,EAAOprD,EAAMmrD,QACb32B,EAAMx0B,EAAMqrD,QACZp3B,EAAOz0B,EAAQ00B,wBACnB,QAAKD,IAIDO,EAAMP,EAAKO,KACXA,EAAMP,EAAKO,IAAMP,EAAK3pB,QACtB8gD,EAAOn3B,EAAKm3B,MACZA,EAAOn3B,EAAKm3B,KAAOn3B,EAAK5pB,MAKpC,EAEIm6B,UAAUs+B,YAAcA,YAExBt+B,UAAU2tB,qBAAuB,SAASP,GAGtC,IAAIt3B,GAFJs3B,EAAaA,GAAcxhD,QAED1S,SAASuS,iBAAiB,oBACpD,GAAKqqB,EAASt8B,OAAd,CAKA,IADA,IAAI8D,EAAS,GACJxC,EAAI,EAAGA,EAAIg7B,EAASt8B,OAAQsB,IACjCwC,EAAOQ,KAAKg4B,EAASh7B,IAGzB,IAASA,EAAE,EAAGA,EAAIwC,EAAO9D,OAAQsB,IACzBwC,EAAOxC,GAAG8V,MACVtT,EAAOxC,GAAG8V,QACHtT,EAAOxC,GAAGL,YACjB6C,EAAOxC,GAAGL,WAAWC,YAAY4C,EAAOxC,GAX/C,CAcT,EAEIklC,UAAU0yC,YAAc,SAASx4E,EAAQmf,GACrC,IAAK,IAAIve,KAAKue,EAENnf,EAAO2M,eAAe/L,KAG1BZ,EAAOY,GAAKue,EAAOve,IAGvB,GAAIue,EAAOzS,UAEP,IAAK,IAAI9L,KAAKue,EAAOzS,UAEZyS,EAAOzS,UAAUC,eAAe/L,KAIjCZ,EAAO0M,UAAUC,eAAe/L,KAMhCue,EAAOzS,UAAU+rE,iBAAiB73E,GAClCZ,EAAO0M,UAAUgsE,iBACb93E,EACAue,EAAOzS,UAAU+rE,iBAAiB73E,IAGtCZ,EAAO0M,UAAU9L,GAAKue,EAAOzS,UAAU9L,GAIvCue,EAAOzS,UAAUisE,iBAAiB/3E,IAClCZ,EAAO0M,UAAUksE,iBACbh4E,EACAue,EAAOzS,UAAUisE,iBAAiB/3E,KAK1D,EAaIwkE,YAAYyT,YAAc,SAAS5oE,EAAEmR,GAEjC,GAAIA,EAAJ,CAEA,IAAI,IAAIxgB,EAAI,EAAGA,EAAIwgB,EAAO9hB,OAAS,IAAKsB,EACxC,CACI,IAAI6E,EAAI2b,EAAOxgB,GACXk4E,EAAK13D,EAAOxgB,EAAE,GAClB,KAAGk4E,EAAG,GAAK7oE,GAAX,CAEA,IAAI/D,EAAK4sE,EAAG,GAAKrzE,EAAE,GACnB,GAAIoP,KAAKE,IAAI7I,GAAK,KACd,OAAOzG,EAAE,GACb,IAAIszE,GAAW9oE,EAAIxK,EAAE,IAAMyG,EAC3B,OAAOzG,EAAE,IAAM,EAAMszE,GAAWD,EAAG,GAAKC,CAL3B,CAMhB,CACD,OAAO,CAbI,CAcd,EAED3T,YAAY14D,UAAUmmD,KAAO,SAAUntD,EAAKkY,EAAMs7B,EAAamvB,EAAkB2Q,EAAYC,GAEzF,IAAI73D,EAAS7Y,KAAK6Y,OAClB,GAAIA,EAAJ,CAEA7Y,KAAKqV,KAAOA,EACZ,IAAI5K,EAAI4K,EAAK,GAAmB,EAAdrV,KAAKyzC,OACnB3oC,EAAIuK,EAAK,GAAmB,EAAdrV,KAAKyzC,OAEvBg9B,EAAaA,GAAc,OAE3BtzE,EAAIq1B,OACJr1B,EAAImoD,UAAUtlD,KAAKyzC,OAAOzzC,KAAKyzC,QAE5BqsB,IAEC3iE,EAAIg4D,UAAY,OAChBh4D,EAAIk6D,SAAS,EAAE,EAAE5sD,EAAEK,GACnB3N,EAAIg4D,UAAY,OAChBh4D,EAAIk6D,SAAW,GAAF5sD,EAAM,EAAE,EAAEK,GACvB3N,EAAIi4D,YAAc,OAClBj4D,EAAIk4D,WAAW,EAAE,EAAE5qD,EAAEK,IAEzB3N,EAAIi4D,YAAcqb,EACfC,IACCvzE,EAAI04D,YAAc,IACtB14D,EAAI42D,YACJ,IAAI,IAAI17D,EAAI,EAAGA,EAAIwgB,EAAO9hB,SAAUsB,EACpC,CACI,IAAI6E,EAAI2b,EAAOxgB,GACf8E,EAAI43D,OAAQ73D,EAAE,GAAKuN,GAAI,EAAMvN,EAAE,IAAM4N,EACxC,CAGD,GAFA3N,EAAIg8D,SACJh8D,EAAI04D,YAAc,GACd6a,EACA,IAAQr4E,EAAI,EAAGA,EAAIwgB,EAAO9hB,SAAUsB,EACpC,CACQ6E,EAAI2b,EAAOxgB,GACf8E,EAAIg4D,UAAYn1D,KAAKmD,UAAY9K,EAAI,OAAU2H,KAAK88D,SAAWzkE,EAAI,OAAS,OAC5E8E,EAAI42D,YACJ52D,EAAI83D,IAAK/3D,EAAE,GAAKuN,GAAI,EAAMvN,EAAE,IAAM4N,EAAG,EAAG,EAAa,EAAVwB,KAAK4oD,IAChD/3D,EAAIoB,MACP,CACLpB,EAAIy2D,SAvCO,CAwCd,EAGDiJ,YAAY14D,UAAU2pD,YAAc,SAAU6iB,EAAUhgC,GAEpD,IAAI93B,EAAS7Y,KAAK6Y,OAClB,GAAIA,KAEA83D,EAAS,GAAK,GAAlB,CAIA,IAAIlmE,EAAIzK,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,OACxB3oC,EAAI9K,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,OACxBnoC,EAAIqlE,EAAS,GAAK3wE,KAAKyzC,OACvBjoC,EAAImlE,EAAS,GAAK3wE,KAAKyzC,OACvB/c,EAAM,CAACprB,EAAEE,GACTolE,EAAW,GAAKjgC,EAAYzG,GAAGZ,MAInC,GAFAtpC,KAAKmD,SAAWnD,KAAK6wE,eAAen6C,EAAKk6C,IAEpB,GAAlB5wE,KAAKmD,SACR,CACI,IAAIumD,EAAQ,CAACp+C,EAAIb,EAAG,EAAIe,EAAIV,GAC5B+N,EAAOxd,KAAKquD,GACZ7wC,EAAOmsB,MAAK,SAAS9uC,EAAEC,GAAI,OAAOD,EAAE,GAAKC,EAAE,EAAK,IAChD6J,KAAKmD,SAAW0V,EAAOrb,QAAQksD,GAC/B1pD,KAAK+8D,aAAc,CACtB,CACD,OAAqB,GAAlB/8D,KAAKmD,eAAR,CApBW,CAsBd,EAED05D,YAAY14D,UAAUuqD,YAAc,SAAUiiB,EAAUhgC,GAEpD,IAAI93B,EAAS7Y,KAAK6Y,OAClB,GAAIA,EAAJ,CAEA,IAAIxU,EAAIrE,KAAKmD,SACb,KAAGkB,EAAI,GAAP,CAEA,IAAIiH,GAAKqlE,EAAS,GAAK3wE,KAAKyzC,SAAWzzC,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,QACvDjoC,GAAKmlE,EAAS,GAAK3wE,KAAKyzC,SAAWzzC,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,QACvDq9B,EAAW,CAAEH,EAAS,GAAK3wE,KAAKyzC,OAASk9B,EAAS,GAAK3wE,KAAKyzC,QAC5Dm9B,EAAW,GAAKjgC,EAAYzG,GAAGZ,MACnCtpC,KAAK+wE,SAAW/wE,KAAK6wE,eAAeC,EAAUF,GAC9C,IAAIlnB,EAAQ7wC,EAAOxU,GACnB,GAAGqlD,EACH,CACI,IAAIsnB,EAAqB,GAAL3sE,GAAUA,GAAKwU,EAAO9hB,OAAS,EACnD,IAAKi6E,IAAkBL,EAAS,IAAM,IAAMA,EAAS,GAAK3wE,KAAKqV,KAAK,GAAK,IAAMs7D,EAAS,IAAM,IAAMA,EAAS,GAAK3wE,KAAKqV,KAAK,GAAK,IAI7H,OAFAwD,EAAOhY,OAAOwD,EAAE,QAChBrE,KAAKmD,UAAY,GAMjBumD,EAAM,GAHLsnB,EAGe,GAAL3sE,EAAS,EAAI,EAFb24D,MAAM1xD,EAAG,EAAG,GAG3Bo+C,EAAM,GAAK,EAAMsT,MAAMxxD,EAAG,EAAG,GAC7BqN,EAAOmsB,MAAK,SAAS9uC,EAAEC,GAAI,OAAOD,EAAE,GAAKC,EAAE,EAAK,IAChD6J,KAAKmD,SAAW0V,EAAOrb,QAAQksD,GAC/B1pD,KAAK+8D,aAAc,CACtB,CAxBU,CAHA,CA4Bd,EAEDF,YAAY14D,UAAU8rD,UAAY,SAAU0gB,EAAUhgC,GAGlD,OADA3wC,KAAKmD,UAAY,GACV,CACV,EAED05D,YAAY14D,UAAU0sE,eAAiB,SAASn6C,EAAKk6C,GAEjD,IAAI/3D,EAAS7Y,KAAK6Y,OAClB,IAAIA,EACA,OAAQ,EACZ+3D,EAAWA,GAAY,GAQvB,IAPA,IAAInmE,EAAKzK,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,OACzB3oC,EAAK9K,KAAKqV,KAAK,GAAmB,EAAdrV,KAAKyzC,OACzB73B,EAAM/C,EAAO9hB,OACbooE,EAAK,CAAC,EAAE,GACR8R,EAAW,IACXC,GAAW,EAEP74E,EAAI,EAAGA,EAAIujB,IAAOvjB,EAC1B,CACI,IAAI6E,EAAI2b,EAAOxgB,GACf8mE,EAAG,GAAKjiE,EAAE,GAAKuN,EACf00D,EAAG,IAAM,EAAMjiE,EAAE,IAAM4N,EACpBq0D,EAAG,GAAKzoC,EAAI,GAEf,IAAIknC,EAAOuT,KAAKvkB,SAASl2B,EAAIyoC,GAC1BvB,EAAOqT,GAAYrT,EAAOgT,IAE7BM,EAAU74E,EACV44E,EAAWrT,EACd,CACD,OAAOsT,CACV,EAED3zC,UAAUs/B,YAAcA,YAGxBt/B,UAAUkI,kBAAoB,SAASP,GACnC,OAAQA,EAAO,IACVtjC,QAAQ,cAAe,IACvBA,QAAQ,OAAQ,IAChBA,QAAQ,sBAAuB,IAC/BwQ,MAAM,KAAM,GAAG,GACfxQ,QAAQ,YAAa,IACrBA,QAAQ,UAAW,IACnBwQ,MAAM,KACNjU,OAAO2N,QACpB,EAIIyxB,UAAUqmB,mBAAqB,SAASwtB,EAAMC,EAAOC,EAAOC,GAAQ,GAChE,GAAKH,GAASA,EAAKl4E,kBAAqBm4E,GAAwB,mBAARC,EAAxD,CAKA,IAAIE,EAAUj0C,UAAUgG,qBACpBkuC,EAASJ,EAIb,GAAa,WAATG,IAAuBroE,OAAOuoE,aAG9B,OAAOD,GACH,IAAK,OACDD,EAAU,QACVC,EAAS,QACT,MAEJ,IAAK,OAUL,IAAK,SACDD,EAAU,QAEV,MARJ,IAAK,KACDA,EAAU,QACVC,EAAS,MAmBrB,OAAOA,GAEH,IAAK,OAAQ,IAAK,KAAM,IAAK,OAAQ,IAAK,OAAQ,IAAK,MAAO,IAAK,QAE/DL,EAAKl4E,iBAAiBs4E,EAAQC,EAAQH,EAAOC,GAGjD,IAAK,QAAS,IAAK,SAAU,IAAK,oBAAqB,IAAK,qBAExD,GAAa,SAATC,EACA,OAAOJ,EAAKl4E,iBAAiBs4E,EAAQC,EAAQH,EAAOC,GAI5D,QACI,OAAOH,EAAKl4E,iBAAiBu4E,EAAQH,EAAOC,GAzDnD,CA2DJ,EACDh0C,UAAUonB,sBAAwB,SAASysB,EAAMK,EAAQH,EAAOC,GAAQ,GACpE,GAAKH,GAASA,EAAKj4E,qBAAwBs4E,GAAyB,mBAARH,EAI5D,OAAOG,GAEH,IAAK,OAAQ,IAAK,KAAM,IAAK,OAAQ,IAAK,OAAQ,IAAK,MAAO,IAAK,QAE3B,WAAhCl0C,UAAUgG,sBAAmE,SAAhChG,UAAUgG,sBACvD6tC,EAAKj4E,oBAAoBokC,UAAUgG,qBAAqBkuC,EAAQH,EAAOC,GAI/E,IAAK,QAAS,IAAK,SAAU,IAAK,oBAAqB,IAAK,qBAExD,GAAoC,WAAhCh0C,UAAUgG,qBACV,OAAO6tC,EAAKj4E,oBAAoBokC,UAAUgG,qBAAqBkuC,EAAQH,EAAOC,GAItF,QACI,OAAOH,EAAKj4E,oBAAoBs4E,EAAQH,EAAOC,GAE1D,EAKDj0C,OAAO0/B,MAAQA,MAEM,oBAAV7zD,QAA0BA,OAA8B,wBAC/DA,OAAO6nC,sBACH7nC,OAAOwoE,6BACPxoE,OAAOyoE,0BACP,SAASj1E,GACLwM,OAAOmE,WAAW3Q,EAAU,IAAO,GACnD,EAEC,EAvkcsB,CAukcpBwM,QAEmB,oBAAXzF,UACPA,QAAQ65B,gBAAYv9B,GAAKu9B,UACzB75B,QAAQ4kC,aAAStoC,GAAKsoC,OACtB5kC,QAAQ+kC,YAAQzoC,GAAKyoC,MACrB/kC,QAAQqgC,iBAAa/jC,GAAK+jC,WAC1BrgC,QAAQwlC,kBAAclpC,GAAKkpC,YAC3BxlC,QAAQylC,mBAAenpC,GAAKmpC,aAC5BzlC,QAAQomC,mBAAe9pC,GAAK8pC,aAC5BpmC,QAAQm4D,kBAAc77D,GAAK67D,aDllcxB,IAAIgW,iBAAmBrnD,MAAOsnD,EAASC,KAE1CD,EAAWE,kBAAkBF,EADA,MAAbC,GAEhBD,EAAWG,YAAYH,GAEvB,IAAI/nC,EAAQ,IAAI5gC,OAAOm/B,OAIvB,OAHAyB,EAAMl1B,QACNk1B,EAAMvB,UAAUspC,SACAI,cAAcnoC,EACpB,EAIVioC,kBAAkB,CAACF,EAASK,KAC5B,IAeI,OAdAL,EAASryE,MAAM3J,SAAQ,CAAC+nB,EAAGu0D,KACnBv0D,EAAGse,gBACHte,EAAGse,eAAermC,SAAQ,CAACu8E,EAAIpzD,KACvBkzD,GAAaE,IAAQC,WAAWD,IAAsB,MAAdA,EAAIjmE,UAAqBimE,EAAIjmE,SAAS,OAC9EimE,EAAMA,EAAIE,WAAW,IAAK,MAC1BT,EAASryE,MAAM2yE,GAAMj2C,eAAeld,GAAOozD,IAE1CF,GAAaE,IAAQC,WAAWD,IAAsB,MAAdA,EAAIjmE,UAAoBimE,EAAIjmE,SAAS,QAC9EimE,EAAMA,EAAIE,WAAW,KAAM,KAC3BT,EAASryE,MAAM2yE,GAAMj2C,eAAeld,GAAOozD,EAC9C,GAER,IAEEP,CACV,CAAC,MAAOlgE,GAER,GAID0gE,WAAc97E,GAEG,qEAED0V,KAAK1V,GAGrBy7E,YAAeH,IACfA,EAASryE,MAAQqyE,EAASryE,MAAMvB,KAAK2f,IACjC,IAAIkd,EAAU+2C,EAAS33C,MAAMC,KAAKS,YAAYhd,EAAGtb,IACjD,MAAM,IAAIsb,EAAGkd,UAAO,IAExBX,KAAO03C,EAAS33C,MAAMC,KACf03C,GAIPU,mBAAsB96E,IACtB,IAAI6kC,GAAgB,EAIpB,OAHGnC,KAAKoC,cAAiBpC,KAAKoC,aAAazlC,SACvCwlC,EAAkBnC,KAAKoC,aAAapwB,SAAS1U,EAAKiJ,OAE/C47B,CAAa,EAIpBk2C,aAAejoD,MAAMuf,IACrB,IACA,IAAK,MAAM2oC,KAAS3oC,EAAMiI,uBAAsB,GAAQ,CACpD,GAAI0gC,EAAM33C,QACN,IAAK,MAAMtwB,KAAKioE,EAAM33C,QACftwB,GAAKA,EAAEkoE,cAAcloE,EAAEkoE,eAGlC,IAAK/M,EAAS,CAAC8M,GACZA,EAAME,gBAAgBhN,EAAS8M,EAAME,iBAExC,IAAK,IAAInvE,KAAKmiE,EACN4M,mBAAmB/uE,IAAMA,EAAEovE,cAC3BpvE,EAAEovE,cAGb,CACA,CAAC,MAAO3sC,GAGR,CACD,OAAO6D,CAAK,EAIZmoC,cAAgB1nD,MAAMuf,IAEtBA,QAAc0oC,aAAa1oC,GAC3B,MAAM+oC,EAAgB,CAAA,EAEtB,IACA,IAAK,MAAMC,KAAahpC,EAAMiI,uBAAsB,GAAQ,CACxD,MACMghC,IAD8B,IAAnBD,EAAU7yE,MAAiC,IAAnB6yE,EAAU7yE,OAClB6yE,EAAUH,cAAiBG,EAAUH,gBAAkB,CAACG,GACzF,IAAK,IAAIr7E,KAAQs7E,EAAY,CACzB,GAAIR,mBAAmB96E,GACnB,SAGJ,GAAI,CAAC,EAAE,GAAG0U,SAAS1U,EAAKwI,MAAO,SAE/B,IAAI+yE,EAAa,CAAA,EACbC,EAAcx7E,EAAKqjC,QAGvB,GAAIm4C,EACA,IAAK,IAAIj0D,KAAOi0D,EAAa,CACzB,IAAKC,EAAOD,EAAYj0D,IACpBk0D,GAAUA,EAAKl6E,UAAsC,IAA3Bk6E,EAAKl6E,QAAQg9C,YACpCk9B,EAAKC,eACJH,EAAWE,EAAK36E,YAAgB26E,EAAKC,eAAe17E,EAAMunB,GAE1Dg0D,EAAWE,EAAK36E,MAAQ26E,EAAK77E,MAGxC,CAIL,IAAK,IAAI2nB,KAAOvnB,EAAKu/B,OAAQ,CACzB,IAAIo8C,EAAa37E,EAAK67C,aAAat0B,GACnC,GAAIo0D,EAAY,CACZ,IAAIC,EAAW57E,EAAKujD,aAAah8B,GACjC,KAA2B,IAApBo0D,EAAWnzE,MAAcsyE,mBAAmBa,IAAa,CAC5D,IAAIE,GAAY,EAChB,GAAIf,mBAAmBa,GACnBC,EAAWD,EAAWp4B,aAAaq4B,EAAS3qC,aACxC2qC,IACAD,EAAaA,EAAW9/B,aAAa+/B,EAASzqC,aAC1CwqC,IACAE,GAAY,SAGjB,GAAID,GAAgC,IAApBD,EAAWnzE,KAAY,CAC1C,IAAIszE,EAAS,CAACF,EAAS3qC,eAAgBjzC,OAAOoB,KAAKu8E,EAAWp8C,SAC9D,IAAK,IAAIw8C,KAAaD,EAClB,GAAIH,EAAWp8C,OAAOw8C,IAAY9yE,OAASjJ,EAAKu/B,OAAOhY,GAAKte,KAAM,CAC9D2yE,EAAWD,EAAWp4B,aAAaw4B,GAC/BH,IACAD,EAAaA,EAAW9/B,aAAakgC,IAEzCF,GAAY,EACZ,KACH,CAER,CAED,IAAKA,EACD,KAEP,CAEGD,GAAYD,GAAYK,aACxBJ,EAAWD,EAAWK,WAAWJ,IAGjCA,IACAL,EAAWv7E,EAAKu/B,OAAOhY,GAAKzmB,MAAQ,CAAC2T,OAAOmnE,EAAS5qC,WAAYrtB,SAASi4D,EAAS3qC,cAE1F,CACJ,CACD,IAAIgrC,EAASj8E,EAAKiJ,KACfjJ,EAAK2tC,YAAc3tC,EAAK2tC,WAAW,uBAAsBsuC,EAASj8E,EAAK2tC,WAAW,sBACrFytC,EAAc3mE,OAAOzU,EAAK6K,KAAQ,CAC9B00B,OAAQg8C,EACRruC,WAAYltC,EAAKiJ,KACjBizE,MAAO,CACHpxE,MAAOmxE,GAGlB,CACJ,CAED,IAAK,IAAI74C,KAAOg4C,EACZ,IAAK,MAAMe,KAAaf,EAAch4C,GAAK7D,OAAQ,CAC/C,MAAMh9B,EAAQ64E,EAAch4C,GAAK7D,OAAO48C,GACpCj6E,MAAM6N,QAAQxN,IAA2B,IAAjBA,EAAMlD,SAAiB+7E,EAAc74E,EAAM,YAC5D64E,EAAch4C,GAAK7D,OAAO48C,EAExC,CAET,CAAE,MAAO3tC,GAGT,CACI,OAAQ4sC,CAAa,EEvLV,MAAMgB,MAEjB,kBAAOC,CAAYp9D,GAIf,OAHK3W,KAAKvB,WACNuB,KAAKvB,SAAW,IAAIq1E,MAAMn9D,IAEvB3W,KAAKvB,QACf,CAGD,mBAAM68B,CAAcC,EAAUC,GAC1B,OAAO,IAAI3/B,SAASC,IAChB,IAAIopC,EAAO1a,MAAOzxB,IACd,IAAIL,EAAOK,EAAML,KACjB,GAAiB,mBAAbA,EAAKyB,IAAyB,CAC3BzB,EAAKkZ,QAAO5R,KAAKg0E,WAAY,GAChC,IAAIC,GAAc3nE,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,SACtDvuB,KAAKk0E,YAAYx7E,EAAKsiB,OAAOi5D,GAEnC9qE,OAAOhQ,oBAAoB,UAAU+rC,GACrCppC,EAAQm4E,EACX,GAEL9qE,OAAOjQ,iBAAiB,UAAUgsC,GAElC/7B,OAAO8F,YAAY,CACf9U,IAAK,gBACLohC,YACAC,WACF,GAET,CAED,oBAAMH,CAAe3G,EAAcD,EAAU,GAAG7zB,GAC5C,OAAO,IAAI/E,SAASC,IAChB,IAAIopC,EAAO1a,MAAOzxB,IACd,IAAIL,EAAOK,EAAML,KACjB,GAAiB,sBAAbA,EAAKyB,IAA6B,CAClC,IAAIg6E,EAAOL,MAAMC,cACbE,GAAc3nE,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,SACtD4lD,EAAKD,YAAYx7E,EAAKsiB,OAAQi5D,GAEpC9qE,OAAOhQ,oBAAoB,UAAW+rC,GACtCppC,EAAQm4E,EACX,GAEL9qE,OAAOjQ,iBAAiB,UAAWgsC,GAEnC/7B,OAAO8F,YAAY,CACf9U,IAAK,mBACLu6B,eACAD,YACA7zB,SACF,GAET,CAED,qBAAMogB,GACF,IAAIlf,EACJ,IACIA,QAAYC,MAAM,GAAG/B,KAAKo0E,qCAC7B,CAAC,MAAO33E,GAOL,OANAA,EAAEkY,QAAU,+BACZlY,EAAEkY,SAAWlY,EAAEqwB,MACf3jB,OAAO8F,YAAY,CACf9U,IAAK,gBACLk6E,YAAa53E,KAEV,CACV,CACD,IAAI63E,QAAqBxyE,EAAII,OAE7B,GAAI,UAAWoyE,EACX,MAAM,IAAIr5E,MAAM8O,KAAKC,UAAUsqE,IAEnC,IAAIC,EAAkBD,EAAa12D,MAAMC,GAAkB,wBAAXA,EAAGrlB,OAgBnD,OAfI+7E,IACAA,EAAkBxqE,KAAK0W,MAAM8zD,EAAgBryE,OAEjDoyE,EAAeA,EAAan2E,QAAQ0f,GAAkB,wBAAXA,EAAGrlB,OAG9C87E,EAAeA,EAAan2E,QAAQwM,IAChC,IAAIkT,EAAK9T,KAAK0W,MAAM9V,EAAIzI,MACpBsyE,EAAO32D,GAAIsc,OAAOC,MAAMq6C,WAC5B,OAAIF,EAAgBnoE,SAASooE,EAGlB,IAGRF,CAEV,CAGD,WAAAx0E,CAAY6W,GACR3W,KAAK00E,SAAW10E,KAAKqnC,SAIrBrnC,KAAKo0E,cAAgBz9D,EAASngB,KAE1BwJ,KAAKo0E,eAAkBz9D,EAAS6Z,aAChCxwB,KAAKo0E,cAAgBz9D,EAAS6Z,WAAW7Z,EAASob,kBAAkBvD,cAAch4B,KAGtF,IAAIm+E,EAAwB30E,KAAKo0E,cAAcxyE,QAAQ,gBAAiB,IACpEgzE,EAAW,QAC+B,GAA1C50E,KAAKo0E,cAAc52E,QAAQ,cAC3Bo3E,EAAW,UAEf50E,KAAK60E,MAAQ,GAAGD,IAAWD,iBAAqC30E,KAAK00E,WACrE10E,KAAKghD,SACR,CAGD,aAAMA,GACEhhD,KAAK80E,UACC90E,KAAK+0E,aAEf/0E,KAAK80E,GAAK,IAAIE,UAAUh1E,KAAK60E,OAE7B70E,KAAK80E,GAAGG,OAAS,WAEzB,EACQj1E,KAAK80E,GAAG3lE,UAAY,SAAU1S,GACtC,EACQuD,KAAK80E,GAAG7L,QAAU,WAE1B,EACQjpE,KAAK80E,GAAGt7B,QAAU,WAE1B,CAEK,CAED,gBAAMu7B,GACE/0E,KAAK80E,KACL90E,KAAK80E,GAAG3mE,QACRnO,KAAK80E,QAAK5qD,EAEjB,CAED,mBAAMgrD,GACF,MAAMpzE,QAAYC,MAAM,GAAG/B,KAAKo0E,4BAE1BlyE,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EACX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,IAEnC,OAAOA,CACV,CAED,mBAAMizE,GACF,MAAMrzE,QAAYC,MAAM,GAAG/B,KAAKo0E,4BAC1BlyE,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EACX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,IAEnC,OAAOA,CACV,CAGD,eAAMkzE,CAAUz/D,GACZ,IAAK3V,KAAK80E,GACN,MAAM,IAAI75E,MACN,gFAIR,MACMo6E,SADcr1E,KAAKs1E,YAAY3/D,IACd4/D,UAEvB,OAAO,IAAI15E,SAAQ,CAACC,EAAS0R,KACzB,MAAMgoE,EAAe,GAEfC,EAAYz1E,KAAK01E,YAAelrD,MAAOklD,EAAKiG,KAG9C,IAAIA,EAAJ,CAGAxsE,OAAO8F,YAAY,CACf9U,IAAK,YACLzB,KAAKg3E,EAAIh3E,KACTk9E,WAAW51E,KAAK41E,WAChBC,WAAW71E,KAAK61E,aAGpB,IAEI,GAAsB,iBAAXnG,EAAIh3E,KAAiB,CAC5B,MAAMic,EAAU5K,KAAK0W,MAAMivD,EAAIh3E,KAAKyN,YAEpC,GAAqB,cAAjBwO,EAAQhU,KAAsB,CAC9B,MAAMm1E,EAAcnhE,EAAQjc,KAC5B,IAAKo9E,EAAYp+E,KAAM,CACEo+E,EAAYP,UAKjC,GAAIO,EAAYP,YAAcF,EAAU,CAEpC,MACMU,SADmB/1E,KAAKg2E,WAAWX,IACdA,GAE3B,IAAK,MAAMz+C,KAAUlhC,OAAOoB,KAAKi/E,EAAQ7+C,SACrC,GAAIl3B,KAAKi2E,aAAa97C,MAAMC,MAAQp6B,KAAKi2E,aAAa97C,MAAMC,KAAKF,UAAYl6B,KAAKi2E,aAAa97C,MAAMC,KAAKF,SAAStD,GAAS,CACxH,MAAMs/C,EAAaH,EAAQ7+C,QAAQN,GAE7Bu/C,EAAiB,GACvB,IAAK,MAAOh8E,EAAK7C,KAAU5B,OAAO+M,QAAQyzE,GACtC,IAAK,MAAM39E,KAAWjB,EAAO,CACzB,MAAM2wC,QAAajoC,KAAKm7B,SACpB5iC,EAAQu5D,SACRv5D,EAAQ69E,UACR79E,EAAQoI,MAEZw1E,EAAe96E,KAAK,CAChBu7B,SACAqR,OACA1vC,UACA4B,OAEP,CAEDg8E,EAAep/E,OAAO,GAAGy+E,EAAan6E,KAAK86E,EAGlD,CAIL,OADAn2E,KAAK80E,GAAG3lE,UAAY,KACbrT,EAAQ05E,EAClB,CACJ,CACJ,CACJ,CACJ,CAAC,MAAOtvC,GACL,OAAO14B,EAAO04B,EACjB,CA5DA,CA4DA,EAILlmC,KAAK80E,GAAG3lE,UAAYsmE,CAAS,GAGpC,CAED,cAAMt6C,CACF22B,EACAskB,EACAz1E,GAEA,MAAMmB,QAAYC,MACd,GAAG/B,KAAKo0E,sBACR,IAAIiC,gBAAgB,CAChBvkB,WACAskB,YACAz1E,UAKR,aADmBmB,EAAImmC,MAE1B,CAED,iBAAMqtC,CAAY3/D,GACd,MAAM7T,QAAYC,MAAM,GAAG/B,KAAKo0E,uBAAwB,CACpDr6D,OAAQ,OACRwG,QAAS,CACLC,OAAQ,mBACR,eAAgB,oBAEpBlP,KAAMvH,KAAKC,UAAU,CACjB2L,SACA2gE,UAAWt2E,KAAK00E,aAIlBxyE,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EAEX,YADMlC,KAAKu2E,sBACL,IAAIt7E,MAAM8O,KAAKC,UAAU9H,IAGnC,OAAOA,CACV,CAGD,eAAMs0E,SACgBz0E,MAAM,GAAG/B,KAAKo0E,0BAA2B,CACvDr6D,OAAQ,OACRwG,QAAS,CACLC,OAAQ,mBACR,eAAgB,qBAW3B,CAED,iBAAMi2D,CAAYnxC,GACd,MAAMxjC,QAAYC,MAAM,GAAG/B,KAAKo0E,wBAAyB,CACrDr6D,OAAQ,OACRwG,QAAS,CACLC,OAAQ,mBACR,eAAgB,oBAEpBlP,KAAMvH,KAAKC,UAAUs7B,KAGnBpjC,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EACX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,GAEtC,CAED,yBAAMw0E,GACF,MAAM50E,QAAYC,MAAM,GAAG/B,KAAKo0E,6BAA8B,CAC1Dr6D,OAAQ,QAGN7X,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EACX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,IAEnC,OAAOA,CACV,CAID,eAAMy0E,CAAUC,EAAWC,EAASC,GAChC,IACI,MAAM90E,QAAiBD,MAAM,GAAG/B,KAAKo0E,0CAA2C,CAC5Er6D,OAAQ,OACRwG,QAAS,CACL,eAAgB,oBAEpBjP,KAAMvH,KAAKC,UAAU,CACjB4sE,UAAWA,EACXG,SAAUF,EACVC,eAIR,aADqB90E,EAASvJ,MAEjC,CAAC,MAAOmZ,GACL6C,MAAM,qCAAuC7C,EAEhD,CACJ,CAED,gBAAMokE,CAAWX,GACb,MAAMvzE,QAAYC,MACd,GAAG/B,KAAKo0E,yBAA2BiB,EAAW,IAAIA,IAAa,KAG7DnzE,QAAaJ,EAAII,OAEvB,GAAyC,SAArCA,EAAKmzE,GAAU5+D,QAAQugE,WAEvB,YADMh3E,KAAKu2E,sBACL,IAAIt7E,MAAM8O,KAAKC,UAAU9H,EAAKmzE,GAAU5+D,OAAOwgE,WAIzD,GAAI,UAAW/0E,EAEX,YADMlC,KAAKu2E,sBACL,IAAIt7E,MAAM8O,KAAKC,UAAU9H,IAGnC,OAAOA,CACV,CAED,gBAAMg1E,CAAWx0E,EAAMovD,GACjB,IAAIpvD,EAAM,CACN,MAAMjG,EAAI,IAAIxB,MAAM,iCAKpB,OAJAkO,OAAO8F,YAAY,CACf9U,IAAK,gBACLk6E,YAAa53E,IAEV,IACV,CACD,OAAOuD,KAAKk0E,YAAYxxE,EAAMovD,GAAS,EAC5C,CAGD,iBAAMoiB,CACFxxE,EACAovD,EACAqlB,EACAC,GAGA,IAAInvC,EACA,GAAIkvC,EACAlvC,EAAO,IAAI98B,KAAK,CAACzI,SAEhB,GAAqB,iBAAVA,GAAsBA,aAAiByJ,OAAQ,CAC3D,IAAIrK,QAAYC,MAAMW,GACtBulC,QAAanmC,EAAImmC,MACjC,MACgBA,EAAO,IAAI98B,KAAK,CAACzI,IAKzB,MAAM20E,EAAW,IAAIC,SACrBD,EAAS7/E,OAAO,QAASywC,EAAM6pB,QAEb5nC,IAAdktD,GACAC,EAAS7/E,OAAO,YAAa4/E,EAAUjxE,YAG3C,MAAMrE,QAAYC,MAAM,GAAG/B,KAAKo0E,6BAA8B,CAC1Dr6D,OAAQ,OACRzI,KAAM+lE,IAGJn1E,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EAEX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,IAEnC,OAAOA,CACV,CAED,gBAAMq1E,CACF70E,EACAovD,EACA0lB,EACAJ,GAEA,MAAMC,EAAW,IAAIC,SAErB,IAAIrvC,EACJ,GAAqB,iBAAVvlC,GAAsBA,aAAiByJ,OAAQ,CACtD,IAAIrK,QAAYC,MAAMW,GACtBulC,QAAanmC,EAAImmC,MAC7B,MACYA,EAAO,IAAI98B,KAAK,CAACzI,IAGrB20E,EAAS7/E,OAAO,QAASywC,EAAM6pB,GAC/BulB,EAAS7/E,OAAO,eAAgBuS,KAAKC,UAAUwtE,IAC/CH,EAAS7/E,OAAO,OAAQ,SACxB6/E,EAAS7/E,OAAO,YAAa,SAEX0yB,IAAdktD,GACAC,EAAS7/E,OAAO,YAAa4/E,EAAUjxE,YAG3C,MAAMrE,QAAYC,MAAM,GAAG/B,KAAKo0E,4BAA6B,CACzDr6D,OAAQ,OACRzI,KAAM+lE,IAGJn1E,QAAaJ,EAAII,OAEvB,GAAI,UAAWA,EACX,MAAM,IAAIjH,MAAM8O,KAAKC,UAAU9H,IAGnC,OAAOA,CACV,CAGD,SAAAsU,GACI,OAAOxW,KAAKyW,MACf,CAGD,aAAAghE,GACI,IAAI94D,EAAS,CAAE,EASf,OARA3e,KAAK03E,0BAA0BtkD,MAAMlvB,QAAQmvB,SAASv9B,SAAS+nB,IAC3Dc,EAAOd,EAAGrlB,WAAmC,IAApBqlB,EAAG85D,aAA+B95D,EAAG85D,aAAe95D,EAAG3Z,QACjE,UAAX2Z,EAAGld,OAAkBge,EAAOd,EAAGrlB,MAAQ2d,WAAWwI,EAAOd,EAAGrlB,QACjD,QAAXqlB,EAAGrlB,OACEmmB,EAAOd,EAAGrlB,OAA6B,IAApBmmB,EAAOd,EAAGrlB,OAAmC,MAApBmmB,EAAOd,EAAGrlB,QAAemmB,EAAOd,EAAGrlB,MAAQwH,KAAK43E,gBACjGj5D,EAAOd,EAAGrlB,MAAQ6iB,SAASsD,EAAOd,EAAGrlB,OACxC,IAEEmmB,CACV,CAED,YAAAi5D,GACI,OAAOtrE,KAAKoL,MAAmB,WAAbpL,KAAK8C,UAA+B,CACzD,CAGD,iBAAAyoE,CAAkB36E,GACd,OAAKA,EAAE8a,wBACF9a,EAAE8a,uBAAuBjhB,OAEvBmG,EAAE8a,uBAAuB9Z,KAAK2f,IAC1B,IAAIA,EAAGld,KAAMkd,EAAGld,KAAM+B,MAAS,YAJJ,IAMzC,CAED,mBAAAo1E,CAAoB56E,GAChB,IAAIxE,EAAO,CAAA,EACXA,EAAKid,OAASzY,EAAEyY,OAChBjd,EAAKmf,eAAiB3a,EAAE2a,eACxBnf,EAAK0kC,SAAU,EACf1kC,EAAKq/E,cAAe,EACpBr/E,EAAKs/E,eAAe96E,EAAEkG,OAASlG,EAAE0yC,OAAOxsC,MACxC1K,EAAKu/E,gBAAgB/6E,EAAEmG,QAASnG,EAAE0yC,OAAOvsC,YAChB,IAAdnG,EAAEgb,UACTxf,EAAKw/E,YAAc,cAEM,IAAlBh7E,EAAE+b,cACTvgB,EAAKy/E,KAAO,UAEZj7E,EAAE+b,aAAe/b,EAAEk7E,YAAwB,cAAVl7E,EAAEgD,QACnCxH,EAAK0kC,SAAU,GAEH,eAAXlgC,EAAEgD,MAAqC,YAAXhD,EAAEgD,OAC/BxH,EAAKq/E,cAAe,GAExBr/E,EAAO,IAAIA,KAASsH,KAAKy3E,iBACzB,IAAIY,EAAWr4E,KAAK63E,kBAAkB36E,GAOtC,OALIxE,EAAK2kC,WADLg7C,GAGgB,GAGb3/E,CACV,CAGD,WAAMge,CAAMC,EAAUzZ,GAClB,IAAIo7E,EAEAt4E,KAAKu4E,eAAev4E,KAAKu4E,mBAAsBv4E,KAAKghB,mBAExDhhB,KAAKi2E,aAAelsE,KAAK0W,MAAMzgB,KAAKu4E,aAAa36D,MAAMC,GAAOA,EAAGrlB,MAAQme,EAAS6hE,6BAA4Bt2E,MAC9GlC,KAAK03E,0BAA4B/gE,EAAS8hE,mBAAmB76D,MAAMC,GAAOA,EAAGrlB,MAAQme,EAAS6hE,6BAE3F7hE,EAAS+hE,2BACR14E,KAAKi2E,aAAelsE,KAAK0W,MAAMzgB,KAAKu4E,aAAa36D,MAAMC,GAAOA,EAAGtb,IAAMoU,EAAS+hE,2BAA0Bx2E,MAC1GlC,KAAK03E,0BAA4B/gE,EAAS8hE,mBAAmB76D,MAAMC,GAAOA,EAAG42D,YAAa99D,EAAS+hE,4BAIvG,IAAIC,EAAS,IAAI77C,iBAAiB98B,KAAKi2E,cACnC2C,EAAW54E,KAAK83E,oBAAoB56E,GACpC27E,EAAeD,EAASE,eAAiB,EAGzCC,EAAW,GACXH,EAASn9D,MAAMs9D,EAAS19E,KAAKu9E,EAASn9D,MAE1C,UACUk9D,EAAO/jD,QAAQgkD,EACxB,CAAC,MAAOn8E,GACLA,EAAEkY,QAAUlY,EAAEqwB,MAEd,IAAIksD,EAAkB97E,EAAE87E,gBAQxB,YAPA7vE,OAAO8F,YAAY,CACf9U,IAAK,eACLujB,OAAQxgB,EAAEwgB,OACVyB,UAAW1iB,EACXw8E,eAAgB9vE,OAAO+vE,aACvBF,mBAGP,CAGD,GAAGh5E,KAAKg0E,UAEJ,YADAh0E,KAAKg0E,WAAY,GAGrB,GAAGr9D,EAASwiE,kBAAkB,CAE1B,IAAI7gF,EAAI,IAAIw2C,KAEZ,IACIsqC,EAAc,cAFlB9gF,EAAI,IAAIw2C,KAAKx2C,EAAEs2C,YACSyqC,cAAclzE,WAAa,KAA+C,IAAvC7N,EAAEghF,WAAa,GAAGnzE,WAAWpP,QAAeuB,EAAEghF,WAAa,GAAGnzE,WAAa,KAAO7N,EAAEghF,WAAa,GAAGnzE,YAAc,KAAwC,GAAjC7N,EAAEihF,UAAUpzE,WAAWpP,OAAcuB,EAAEihF,UAAUpzE,WAAa,IAAM7N,EAAEihF,UAAUpzE,YAAc,KAAyC,GAAlC7N,EAAEkhF,WAAWrzE,WAAWpP,OAAcuB,EAAEkhF,WAAWrzE,WAAa,IAAM7N,EAAEkhF,WAAWrzE,YAAc,KAA+D,IAAxB,EAA/BkV,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,WAAWpP,QAA8C,EAA/BskB,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,WAAa,KAAsC,EAA/BkV,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,YAAc,aAEpiBizE,EAAcA,EAAYx3E,QAAQ,MAAO,KACzCw3E,EAAcA,EAAY7G,WAAW,IAAK,KAC1C6G,EAAcA,EAAY7G,WAAW,IAAK,WACpCvyE,KAAK22E,UAAUyC,EAAarvE,KAAKC,UAAU2uE,EAAO7iD,UAAU,eAC5D91B,KAAK22E,UAAU,YAAYyC,EAAarvE,KAAKC,UAAU4uE,GAAU,WAC1E,CACD54E,KAAK41E,WAAc+C,EAAO7iD,SAASr2B,MAAM1I,OAEzCiJ,KAAK61E,WAAa8C,EAAO7iD,SAASr2B,MAAMvB,KAAK2f,IAAc,CAACtb,GAAGsb,EAAGtb,GAAG5B,KAAKkd,EAAGld,SAG7E23E,QAAwBzG,iBAAiB8G,EAAO7iD,SAAS91B,KAAK+xE,aAAa2H,QAAQC,IAEnF35E,KAAK45E,aAAe,GAEpB,IAAK,IAAIvhF,EAAI,EAAGA,EAAIwgF,EAAcxgF,IAAK,CACnC,IAAIwhF,EAAW9vE,KAAKC,UAAUsuE,GAC9B,GAAGS,EAAShiF,OAAO,CACf,IAAI+iF,EAAU95E,KAAK43E,eACnBiC,EAAWA,EAAStH,WAAWwG,EAAS,GAAGe,GAC3Cf,EAAS19E,KAAKy+E,EACjB,CACD,IAAIztB,EAAStiD,KAAK0W,MAAMo5D,GACxB75E,KAAK45E,aAAav+E,KAAKgxD,EAC1B,CAED,aADMrsD,KAAK+5E,kBAAkB78E,EAAE67E,GAbrB,IAeb,CAED,yBAAMxC,GACFv2E,KAAKg6E,eAAgB,QACfh6E,KAAKw2E,WACd,CAED,uBAAMuD,CAAkB78E,EAAE67E,GAEtB,IAAIh7D,GAAW,EACXkB,EAAM,EACV,MAAQlB,GAAU,CACd,GAAG/d,KAAKg6E,cAAc,CAClBh6E,KAAKg6E,eAAgB,EACrB,KACH,OAEK,IAAIn+E,SAAQ8H,GAAK2J,WAAW3J,EAAG,OACrC,IAAIs2E,EAAWj6E,KAAK45E,aAAalnC,QAC7BwnC,EAASl6E,KAAK43E,eACfmB,EAAShiF,QAAUgiF,EAAS95D,KAAOi7D,EAASnB,EAAS95D,IACxD,IAAInd,QAAY9B,KAAKm6E,eAAeF,EAASC,GAEzClB,EAAkB97E,EAAE87E,gBACxB7vE,OAAO8F,YAAY,CACf9U,IAAK,eACLujB,OAAQxgB,EAAEwgB,OACVyB,UAAWrd,EACXm3E,eAAgB9vE,OAAO+vE,aACvBkB,kBAAkB,EAClBn7D,MACA+5D,oBAIJ/5D,IACKjf,KAAK45E,aAAa7iF,SAAQgnB,GAAW,EAE7C,CAEJ,CAGD,oBAAMo8D,CAAe7B,EAAiB78D,GAClC,IAUIxE,EAVAojE,EAAgBpyC,GACT,IAAIpsC,SAAQ,CAACC,EAASvE,KACzB,MAAM24B,EAAS,IAAIC,WACnBD,EAAOoqD,UAAY,IAAMx+E,EAAQo0B,EAAOr1B,QACxCq1B,EAAOG,cAAc4X,EAAK,IAOlC,IACIhxB,QAAejX,KAAKo1E,UAAUkD,EACjC,CAAC,MAAO77E,GACL,IAAInE,EAAI,IAAIw2C,KAEZ,IACIsqC,EAAc,cAFlB9gF,EAAI,IAAIw2C,KAAKx2C,EAAEs2C,YACSyqC,cAAclzE,WAAa,KAA+C,IAAvC7N,EAAEghF,WAAa,GAAGnzE,WAAWpP,QAAeuB,EAAEghF,WAAa,GAAGnzE,WAAa,KAAO7N,EAAEghF,WAAa,GAAGnzE,YAAc,KAAwC,GAAjC7N,EAAEihF,UAAUpzE,WAAWpP,OAAcuB,EAAEihF,UAAUpzE,WAAa,IAAM7N,EAAEihF,UAAUpzE,YAAc,KAAyC,GAAlC7N,EAAEkhF,WAAWrzE,WAAWpP,OAAcuB,EAAEkhF,WAAWrzE,WAAa,IAAM7N,EAAEkhF,WAAWrzE,YAAc,KAA+D,IAAxB,EAA/BkV,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,WAAWpP,QAA8C,EAA/BskB,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,WAAa,KAAsC,EAA/BkV,SAAS/iB,EAAEmhF,aAAe,IAAQtzE,YAAc,aAOpiB,OALAizE,EAAcA,EAAYx3E,QAAQ,MAAO,KACzCw3E,EAAcA,EAAY7G,WAAW,IAAK,KAC1C6G,EAAcA,EAAY7G,WAAW,IAAK,WAEpCvyE,KAAK22E,UAAUyC,EAAarvE,KAAKC,UAAUsuE,IAC1C77E,CACV,CAED,IAAIkiB,EAAS,GACb,IAAK,IAAIM,EAAM,EAAGA,EAAMhI,EAAOlgB,OAAQkoB,IAAO,CAC1C,IAAIjE,QAAeq/D,EAAapjE,EAAOgI,GAAK,GAAGgpB,MAC3CpuB,EAAOmB,EAAO5I,MAAM,KAAK,GAC7B4I,EAASA,EAAO5I,MAAM,KAAK,GAC3B,IAAImoE,EAAS,CAAC1gE,OAAMmB,SAAQS,KAAMA,EAAMwsB,KAAMhxB,EAAOgI,GAAK,GAAGgpB,MAC7DtpB,EAAOtjB,KAAKk/E,EACf,CACD,OAAO57D,CACV,CAGD,uBAAMgB,CAAkBhJ,GACpB,IACI,IAAI4I,EAAW,CAAE,EACjBvf,KAAK+xE,kBAAoB/xE,KAAK02E,sBAC9B12E,KAAKu4E,mBAAsBv4E,KAAKghB,kBAEhCzB,EAASi7D,wBAAyB,EAClCj7D,EAASrC,qBAAsB,EAC/BqC,EAASk7D,0BAAyB,EAClCl7D,EAASA,SAAW,CAChB,QACA,8BACA,QACA,WACA,OACA,UACA,MACA,gBAGJ,IAAIzd,QAAYC,MAAM,GAAG/B,KAAKo0E,qCACzBlyE,QAAaJ,EAAII,OAMtB,OALIA,GAAQA,EAAK0d,OACbL,EAASm7D,gBAAgBx4E,EAAK0d,OAE9BL,EAASm7D,gBAAgB,GAEtBn7D,CACV,CAAC,MAAO9iB,GAOL,OANAA,EAAEkY,QAAU,kCACZlY,EAAEkY,SAAWlY,EAAEqwB,MACf3jB,OAAO8F,YAAY,CACf9U,IAAK,gBACLk6E,YAAa53E,KAEV,CACV,CAEJ,CAGD,MAAA4qC,GACI,MAAO,uCAAuCzlC,QAAQ,UAAUrE,IAC3DA,EAAIo9E,OAAOC,gBAAgB,IAAIC,WAAW,IAAI,GAAK,IAAMt9E,EAAI,GAAG4I,SAAS,KAEjF,EC9uBU,MAAM20E,aACjB,WAAAh7E,GACC,CAED,KAAAsW,CAAMC,EAAKzN,GACP,KAAOyN,EAAItf,OAAS,IAAuC,GAAlC6R,EAAOpL,QAAQ6Y,EAAIjP,OAAO,KAC/CiP,EAAMA,EAAIC,OAAO,GAErB,KAAOD,EAAItf,OAAS,IAAoD,GAA/C6R,EAAOpL,QAAQ6Y,EAAIjP,OAAOiP,EAAItf,OAAS,KAC5Dsf,EAAMA,EAAIC,OAAO,EAAGD,EAAItf,OAAS,GAErC,OAAOsf,CACV,CAGD,YAAA0kE,CAAapkE,GACD,MAAmB,UAAhBA,EAAShW,KACDmzE,MAAMC,YAAYp9D,GAElB,IAAIlB,IAE1B,CAED,qBAAMuL,CAAgBrK,GAClB,IAAIqkE,EAAGh7E,KAAK+6E,aAAapkE,GAEzB,aADcqkE,EAAGh6D,gBAAgBrK,EAEpC,CAID,uBAAMgJ,CAAkBhJ,GACpB,IAAIskE,EAAS,GACT73E,EAAMiY,SAAS1E,EAASvT,OACxBC,EAAOgY,SAAS1E,EAAStT,QAEjB23E,EAAGh7E,KAAK+6E,aAAapkE,GACrB4I,QAAey7D,EAAGr7D,kBAAkBhJ,GAExCskE,EAAS,CAAC,CAACziF,KAAK,OAAO,CAACA,KAAK,WAAW,CAACA,KAAK,SAAS,CAACA,KAAK,QAAQ,CAACA,KAAK,QAAQ,CAACA,KAAK,UAAU,CAACA,KAAK,QAAQ,CAACA,KAAK,QAAQ,CAACA,KAAK,uBAAuB,CAACA,KAAK,uBACjK,CAACA,KAAK,uBAAuB,CAACA,KAAK,oBAAoB,CAACA,KAAK,mBAAmB,CAACA,KAAK,kBAAkB,CAACA,KAAK,0BAG/G,IAAI0iF,EAAa,CAACn/D,QAAO,EAAMkB,UAAS,EAAMvB,OAAM,EAAKD,MAAK,EAAKw/D,SAASA,EAAS5yD,IAAG,EAAKlL,MAAK,EAAKg+D,iBAAiB,GAcxH,OAbI57D,GAAYA,EAASlB,WAAakB,EAASlB,UAAUjS,SAAS,oBAAmB8uE,EAAa9gE,OAAM,GACpGmF,GAAYA,EAASK,SAAQs7D,EAAat7D,OAAOL,EAASK,QAC1DL,GAAYA,EAASF,YAAW67D,EAAa77D,UAAUE,EAASF,UAAU0B,QAC1ExB,GAAYA,EAASpI,QAAO+jE,EAAa/jE,MAAMoI,EAASpI,OACxD/T,GAAO,KAAOC,GAAS,MAAK63E,EAAa7yD,IAAG,GAChD6yD,EAAaE,kBAAiB,EAC9BF,EAAaG,WAAU,EACvBH,EAAa37D,SAASA,EAASA,SAC5BA,EAASrC,sBAAqBg+D,EAAah+D,oBAAsBqC,EAASrC,qBAC1EqC,EAASi7D,yBAAwBU,EAAaV,uBAAyBj7D,EAASi7D,wBAChFj7D,EAASk7D,2BAA0BS,EAAaT,yBAA2Bl7D,EAASk7D,0BACpFl7D,EAASm7D,kBAAiBQ,EAAaR,gBAAkBn7D,EAASm7D,iBAE9DQ,CAGlB,CAMD,mBAAMI,CAAcp+E,EAAEq+E,EAAS5kE,GAC3B,IAAI2J,EAAW3J,EAASngB,IACxB8pB,EAAWtgB,KAAKoW,MAAMkK,EAAU,KACnB,YAATpjB,EAAEgD,KAAwBogB,GAAY,oBACpCA,GAAY,oBAClB,IACI,IAAIxe,QAAWC,MAAMue,EAAU,CAC3BC,QAAS,CACT,eAAgB,mBAChBC,OAAU,oBAEVzG,OAAQ,OACRzI,KAAMiqE,IAEN1gF,QAAaiH,EAAII,OAErB,OAAMrH,EAAe,OAIjBA,EAAc,iBACR,IAAI2Z,eAAgBC,MAAM,QAAQ5Z,EAAa,MAGlDA,aAPG,IAAI2Z,eAAgBC,MAAM,QAAQ1K,KAAKC,UAAUnP,GAQ9D,CAAC,MAAM+W,SACE,IAAI4C,eAAgBC,MAAM,eAAe7C,EAAMzL,WAAW,KAAKma,EACxE,CACJ,CACD,YAAAk7D,CAAa7kE,EAASzZ,GAClB,OAAKyZ,EAAS8kE,gBAEP9kE,EAAS8kE,gBAAgBv+E,EAAE0e,IAAI1e,EAAEwe,MAFF,GAAGxe,EAAE0e,IAAI1e,EAAEwe,KAGpD,CACD,SAAAlF,GACI,OAAIxW,KAAKg7E,GAAWh7E,KAAKg7E,GAAGxkE,YACxBxW,KAAK07E,GAAW17E,KAAK07E,GAAGllE,YACrBxW,KAAKyW,MACf,CAGD,uBAAMklE,CAAkBhlE,GAEpB,MAAO,EAMV,CAED,mBAAMiI,CAAcjI,EAAS+G,GACzB,GAAoB,WAAhB/G,EAAShW,KAAiB,CAC1BX,KAAKg7E,GAAGh7E,KAAK+6E,aAAapkE,GAC1B,UACU3W,KAAKg7E,GAAGp8D,cAAcjI,EAAS+G,EACrD,CAAc,MAAOjhB,GAAK,CACjB,CACD,GAAoB,UAAhBka,EAAShW,KAAgB,CACzBX,KAAKg7E,GAAKlH,MAAMC,YAAYp9D,GAC5B,UACU3W,KAAKg7E,GAAGp8D,cAAcjI,EAAS+G,EACrD,CAAc,MAAOjhB,GAAK,CACjB,CACJ,CAED,WAAMia,CAAMC,EAAUzZ,GAGlB,GADAA,EAAE0yC,OAAOj5B,EACW,UAAhBA,EAAShW,KAAgB,CACzB,IAEIi7E,EAFAC,EAAYltC,YAAYE,MAC5B7uC,KAAKg7E,GAAKlH,MAAMC,YAAYp9D,GAE5B,IACIilE,QAAY57E,KAAKg7E,GAAGtkE,MAAMC,EAAUzZ,EACpD,CAAc,MAAOT,GAAK,CAEd,IAEIq/E,EAFUntC,YAAYE,MAELgtC,EAErB,OADAllE,EAAS8kE,gBAAgBK,EAAS5+E,EAAE0e,IAAI1e,EAAEwe,MACnCkgE,CACV,CAEA,GAAoB,WAAhBjlE,EAAShW,KAAiB,CAC3B,IAGIi7E,EAHAC,EAAYltC,YAAYE,MAE5B7uC,KAAKg7E,GAAGh7E,KAAK+6E,aAAapkE,GAE1B,IACIilE,QAAY57E,KAAKg7E,GAAGtkE,MAAMC,EAAUzZ,EACpD,CAAc,MAAOT,GAAK,CAEd,IAEIq/E,EAFUntC,YAAYE,MAELgtC,EAErB,OADAllE,EAAS8kE,gBAAgBK,EAAS5+E,EAAE0e,IAAI1e,EAAEwe,MACnCkgE,CACV,CAED,IAAIngE,EADJzb,KAAKyW,OAAO,UAEsBgF,EAA7Bve,EAAEue,KAAkCJ,SAASne,EAAEue,OAA7B,EAEO,CAAC,OAAQ,WAAY,eAAgB,iBAAiB,eACtCje,QAAQmZ,EAASua,sBAE/D,UADclxB,KAAK+7E,YAAYplE,EAASzZ,GAGpC,YADA8C,KAAKyW,OAAO,SAGhB,IAAIkxB,EAAI,CACJq0C,UAAa9+E,EAAE8+E,UACfC,mBAAsB,EACtBC,iBAAoB,EACpBC,kBAAqB,EACrBxmE,OAAUzY,EAAEyY,OACZ8F,KAAQA,EACR2gE,SAAY,EACZC,iBAAoB,EACpBC,oBAAuB,EACvBC,oBAAuB,EACvBC,WAAc,EACdC,OAAUphE,SAASne,EAAE0e,KACrBF,MAASL,SAASne,EAAEwe,OACpBghE,UAAavmE,WAAWjZ,EAAE2f,WAC1BzZ,MAAUiY,SAAS1E,EAASvT,OAC5BC,OAAWgY,SAAS1E,EAAStT,QAC7Bs5E,cAAkBz/E,EAAEy/E,cACpB5gE,OAAW7e,EAAE6e,OACb6gE,gBAAmB1/E,EAAE0/E,gBACrBC,IAAO,EACPC,QAAW,EACXC,OAAU,EACVC,OAAU,EACVC,QAAW,EACXC,kBAAqB,CAAE,EACvBC,cAAiBjgF,EAAEqf,iBAEjBrf,EAAE8+E,YAAWr0C,EAAEs0C,mBAAmB,IACzB,YAAT/+E,EAAEgD,MAA6B,eAAThD,EAAEgD,MAAiC,wBAAThD,EAAEgD,OACpDynC,EAAEy1C,YAAY,CAAC,yBAAyBlgF,EAAEgb,SAC1CyvB,EAAEs0C,mBAAmB/+E,EAAE+f,SACvB0qB,EAAE01C,YAAY,EACd11C,EAAE21C,kBAAkB,EAChBpgF,EAAE+b,cACF0uB,EAAEwwC,KAAK,yBAAyBj7E,EAAE+b,YAIlC0uB,EAAEs0C,mBAAmB,EACrBt0C,EAAE41C,gBAAgB,EAClB51C,EAAE61C,UAAU,IASpB,IAAI9kF,EAAOqR,KAAKC,UAAU29B,GACtBk0C,EAAYltC,YAAYE,MAC5B7uC,KAAKyW,OAAO,aACZ,IAAIzU,QAAiBhC,KAAKs7E,cAAcp+E,EAAExE,EAAMie,GAEhD,IAAK3U,EAED,YADAhC,KAAKyW,OAAO,SAGhBzW,KAAKyW,OAAO,QACZ,IACIqlE,EADUntC,YAAYE,MACLgtC,EACrBllE,EAAS8kE,gBAAgBK,EAAS5+E,EAAE0e,IAAI1e,EAAEwe,MAC1C,IAAIzE,EAAS,GACb/Z,EAAEga,SAAW,GACb,IAGIumE,EAHAp5E,EAAIrC,EAAe,KAInB07E,EAHO3zE,KAAK0W,MAAMpc,GAGO,UACzB,IAAI,IAAIhM,EAAE,EAAEA,EAAE6E,EAAE0e,IAAIvjB,IAAK,CACrBolF,EAAUz7E,EAAiB,OAAE3J,GAC7B6E,EAAEga,SAAS7e,GAAKqlF,EAASrlF,GAAG,GAC5B,IAAIkmB,EAAI,CAACvD,OAAQyiE,GACjBl/D,EAAI9C,KAAKve,EAAEga,SAAS7e,GACpB4e,EAAO5b,KAAKkjB,EACf,CACL,OAAOtH,CACV,CAED,eAAMI,CAAUV,GAEZ,IAAI2J,EAAW3J,EAASngB,IACxB8pB,EAAWtgB,KAAKoW,MAAMkK,EAAU,KAChCA,GAAY,sBACZ,IACIzlB,EADA8iF,EAAW,GAEf,IACI,IAAI77E,QAAWC,MAAMue,EAAU,CAC3BC,QAAS,CACT,eAAgB,mBAChBC,OAAU,oBAEVzG,OAAQ,QAGZ,GADAlf,QAAaiH,EAAII,OACbrH,EAAc,MAEd,kBADM,IAAI2Z,eAAgBC,MAAM,QAAQ5Z,EAAa,KAG5D,CAAC,MAAM+W,SACE,IAAI4C,eAAgBC,MAAM,eAAe7C,EAAMzL,WAAW,KAAKma,EACxE,CAED,IAAI,IAAIjoB,EAAE,EAAEA,EAAEwC,EAAO9D,OAAOsB,IAAK,CAC7B,IAAI2F,EAAEnD,EAAOxC,GACbslF,EAAWtiF,KAAK,CAACkH,GAAGvE,EAAE4/E,WAAWC,KAAK7/E,EAAE6/E,MAC3C,CAED,OAAOF,CACV,CACD,iBAAM5B,CAAYplE,EAASzZ,GACvB,IAAIoiB,QAAWtf,KAAKqX,UAAUV,GAC9B,IAAK2I,EAAM,OAAO,EAClB,IAAInI,EAAM,GAMV,GALAA,EAAMR,EAASQ,MACF,eAATja,EAAEgD,OACFiX,EAAMR,EAASmnE,iBACV3mE,IAAOA,EAAM,wBAEjBA,EAED,aADM,IAAI3C,eAAgBC,MAAM,gCACzB,EAEX,IAAIjS,EAAM,GACV,IAAK,IAAInK,EAAE,EAAEA,EAAEinB,EAAKvoB,OAAOsB,IAAK,CAC5B,IAAI2F,EAAEshB,EAAKjnB,GACP2F,EAAEuE,KAAK4U,IAAO3U,EAAM2U,EAAM,UAAUnZ,EAAE6/E,KAAK,IAClD,CAED,IAAKr7E,EAED,aADM,IAAIgS,eAAgBC,MAAM,oBAAoBjS,IAC7C,EAEX,IAAIu7E,EAAQ,CACRC,oBAAsBx7E,GAEtB+4E,EAAUxxE,KAAKC,UAAU+zE,GACzBz9D,EAAW3J,EAASngB,IACxB8pB,EAAWtgB,KAAKoW,MAAMkK,EAAU,KAChCA,GAAY,oBACZ,IACI,IAAIxe,QAAWC,MAAMue,EAAU,CAC3BC,QAAS,CACT,eAAgB,mBAChBC,OAAU,oBAEVzG,OAAQ,OACRzI,KAAMiqE,UAEOz5E,EAAII,OACrB,OAAO,CACV,CAAC,MAAM0P,GAEJ,aADM,IAAI4C,eAAgBC,MAAM,eAAe7C,EAAMzL,WAAW,KAAKma,IAC9D,CACV,CACJ,EC7UU,MAAM3K,OAEjB+H,OAEA,WAAA5d,CAAY4d,GACR1d,KAAK0d,OAASA,CACjB,CAED,mBAAMugE,CAAcC,GAChB,IAAIh9D,EAAY,GAEZ5B,EADI4+D,EAAIh9D,UACG9O,MAAM,SACjB+rE,EAAO,GACPxoE,EAAO,GACX,IAEI,IAAK,IAAItd,EAAI,EAAGA,EAAIinB,EAAKvoB,OAAQsB,IAAK,CAClC,IAAI2F,EAAIshB,EAAKjnB,GACb2F,EAAEA,EAAE2H,OACA3H,EAAE6Y,SAAS,OACXsnE,GAAQngF,EAAE4D,QAAQ,MAAM,KAEpB5D,GAAa,KAARA,EAAE,IAAqB,KAARA,EAAE,KAAcA,EAAEiyB,WAAW,YAC3B,GAAlBjyB,EAAE+X,OAAO,OAAa/X,EAAE,IAAIA,EAAE,KAClCkjB,GAAa,KAAOljB,EAG/B,CACD2X,EAASuoE,EAAIvoE,MAChB,CAAC,MAAMlZ,GAEP,CAUD,OATKkZ,IAAQA,EAAO,IAOpBA,EAAOwoE,EAAOxoE,EACdA,GAAUuL,EACHvL,CACV,CACD,WAAAyoE,CAAYF,GACR,IACI5+D,EADI4+D,EAAIh9D,UACG9O,MAAM,SACjB+I,EAAS,GACb,IAAK,IAAI9iB,EAAI,EAAGA,EAAIinB,EAAKvoB,OAAQsB,IAAK,CAClC,IAAI2F,EAAIshB,EAAKjnB,GACb,GAAI2F,EAAEiyB,WAAW,SAAU,CACvB,IAAIz5B,EAAIwH,EAAE4D,QAAQ,QAAQ,IACtBoU,EAAO,EAEX,GADAxf,EAAIA,EAAIoL,QAAQ,MAAO,cACC,GAApBpL,EAAIuf,OAAO,KAAa,CACxB,IAAIG,EAAI1f,EAAI4b,MAAM,KAClB5b,EAAI0f,EAAI,GACRF,EAAOG,WAAWD,EAAI,GACzB,CACD1f,EAAIA,EAAIoL,QAAQ,YAAa,OAC7BuZ,EAAS9f,KAAK,CAAC7E,MAAIwf,UACtB,CACJ,CACD,OAAOmF,CAEV,CACD,uBAAMkjE,CAAkBH,GACpB,IAAIrmE,EAAiB,GAEjByH,EADI4+D,EAAIh9D,UACG9O,MAAM,SACrB,IAAK,IAAI/Z,EAAI,EAAGA,EAAIinB,EAAKvoB,OAAQsB,IAAK,CAClC,IAAI2F,EAAIshB,EAAKjnB,GACA,MAAT2F,EAAE,KAAY6Z,GAAkB,KAAO7Z,EAAE4D,QAAQ,IAAI,IAC5D,CACD,OAAOiW,CACV,CACD,qBAAMymE,CAAgBhtD,EAAQitD,EAAOC,EAAUC,EAAaC,EAAe1mE,EAAuB2mE,GAC9F,IAAIjmF,EAAK44B,EACLp0B,EAAE,CAAE,EAKR,GAJAA,EAAEyY,aAAa3V,KAAKi+E,cAAcvlF,GAClCwE,EAAE2a,qBAAqB7X,KAAKq+E,kBAAkB3lF,GAC9CwE,EAAEie,eAAenb,KAAKo+E,YAAY1lF,GAE7BwE,EAAEyY,OAyDP,OAxDAzY,EAAEgD,KAAKq+E,EACM,eAATrhF,EAAEgD,OAAqBhD,EAAEyY,OAAO,cACpCzY,EAAEwe,MAAMhjB,EAAY,MACpBwE,EAAEue,KAAK/iB,EAAW,KAClBwE,EAAE0e,IAAIljB,EAAU,IAChBwE,EAAEggB,oBAAoBxkB,EAA0B,oBAChDwE,EAAEqf,gBAAgB7jB,EAAsB,gBACxCwE,EAAE2f,UAAUnkB,EAAgB,UACxBA,EAAW,OAAGwE,EAAEigB,MAAK,GACzBjgB,EAAE6e,OAAOuV,EAAQvV,OACjB7e,EAAE8+E,UAAU1qD,EAAQ0qD,UACpB9+E,EAAE0hF,aAAattD,EAAQstD,aACvB1hF,EAAEy/E,cAAcrrD,EAAQqrD,cACxBz/E,EAAE+f,SAAS,IACE,YAATshE,IACArhF,EAAE+f,SAASvkB,EAAe,SAC1BwE,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,OACpBJ,IAAgBxhF,EAAE6hF,aAAaL,EAAe1jE,SAEzC,eAATujE,IACArhF,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,QAEf,qBAATP,IACArhF,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,QAEf,cAATP,IACArhF,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,OACxB5hF,EAAE0b,UAAU0Y,EAAQ1Y,UACpB1b,EAAEub,cAAc6Y,EAAQ7Y,cACxBvb,EAAEsb,MAAM8Y,EAAQ9Y,OAGP,YAAT+lE,IACArhF,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,OACxB5hF,EAAE8b,cAAcsY,EAAQtY,eAEf,eAATulE,GAAkC,wBAATA,IACzBrhF,EAAE+f,SAASvkB,EAAe,SAC1BwE,EAAEgb,QAAQsmE,EAAUxjE,OACpB9d,EAAE2hF,YAAYL,EAAUM,OACpBL,IACAvhF,EAAE+b,YAAYwlE,EAAazjE,OAC3B9d,EAAEk7E,WAAWqG,EAAaK,OACvBH,IAAoBzhF,EAAE8hF,yBAA0BL,EAAmBG,UAG9E5hF,EAAE8a,uBAAuBA,EACtBhY,KAAK0d,SAAQxgB,EAAEwgB,OAAS1d,KAAK0d,QAChCxgB,EAAEqe,YAAY+V,EAAQ/V,YACtBre,EAAEse,aAAa8V,EAAQ9V,aAEhBte,CACV,EC3IU,MAAM+hF,wBAAwBnL,MAEzC,kBAAOC,CAAYp9D,GAIf,OAHK3W,KAAKk/E,qBACNl/E,KAAKk/E,mBAAqB,IAAID,gBAAgBtoE,IAE3C3W,KAAKk/E,kBACf,CAED,WAAAp/E,CAAY6W,GACR5W,MAAM4W,GACN3W,KAAKm/E,uBACR,CAGD,qBAAAA,GACIh2E,OAAOjQ,iBAAiB,WAAYR,IAExBsH,KAAKo/E,gBAA+B,kBAAb1mF,EAAKyB,KAC5B6F,KAAKo/E,eAAe1mF,EACvB,GAEZ,CAID,mBAAM4iC,CAAcC,EAAUC,GAC1B,IAAI15B,QAAY9B,KAAKq/E,eAAe,gBAAgB9jD,EAAUC,GAC1D15B,IAAK9B,KAAKg0E,WAAY,GAC1B,IAAIC,GAAc3nE,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,GAE5D,aADMvuB,KAAKk0E,YAAYpyE,EAAImyE,GACpBA,CACV,CAED,oBAAM54C,CAAe3G,EAAcD,EAAU,GAAG7zB,GAC5C,IAAIkB,QAAY9B,KAAKq/E,eAAe,iBAAiB3qD,EAAcD,EAAU7zB,GACzEkB,IAAK9B,KAAKg0E,WAAY,GAC1B,IAAIC,GAAc3nE,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,GAE5D,aADMvuB,KAAKk0E,YAAYpyE,EAAImyE,GACpBA,CACV,CACD,aAAMx4C,CAAQ/G,EAAcD,EAAU,GAAG7zB,GACrC,IAAIkB,QAAY9B,KAAKq/E,eAAe,UAAU3qD,EAAcD,EAAU7zB,GAClEkB,IAAK9B,KAAKg0E,WAAY,GAC1B,IAAIC,GAAc3nE,KAAK8C,SAAW,GAAGjJ,SAAS,IAAIooB,UAAU,GAE5D,aADMvuB,KAAKk3E,WAAWp1E,EAAImyE,GACnBA,CACV,CAED,eAAMqL,CAAUC,EAAWC,EAAkB5G,EAASyG,EAAeD,GAEjE,aADgBp/E,KAAK0W,MAAM6oE,EAAWC,EAAkB5G,EAASyG,EAAeD,EAAe,OAElG,CAED,WAAM1oE,CAAM+oE,EAAaD,EAAkB5G,EAASyG,EAAeD,EAAeM,GAAK,GACnF,IAAIpH,EAMAqH,EAQJ,GAbA3/E,KAAKq/E,eAAiBA,EACtBr/E,KAAKw/E,kBAAoBA,EACzBx/E,KAAKo/E,eAAiBA,EAClBp/E,KAAKu4E,eACLv4E,KAAKu4E,mBAAqBv4E,KAAKghB,mBAI/B2+D,EADDD,EACI1/E,KAAKu4E,aAAa36D,MAAMC,GAAOA,EAAGtb,IAAMk9E,IAExCz/E,KAAKu4E,aAAa36D,MAAMC,GAAOA,EAAGrlB,MAAQinF,KAG5CE,EACD,KAAM,2BAA2BF,EAErCz/E,KAAKi2E,aAAelsE,KAAK0W,MAAMk/D,EAAGz9E,MAClC,IAAIy2E,EAAS,IAAI77C,iBAAiB98B,KAAKi2E,cACnC4C,EAAeD,EAASE,eAAiB,EAEzCC,EAAW,GACXH,EAASn9D,MAAMs9D,EAAS19E,KAAKu9E,EAASn9D,MAC1C,UACUk9D,EAAO/jD,QAAQgkD,EACxB,CAAC,MAAOn8E,GAUL,OATAA,EAAEkY,QAAUlY,EAAEqwB,WAEd3jB,OAAO8F,YAAY,CACf9U,IAAK,eAELglB,UAAW1iB,EACXw8E,eAAgB9vE,OAAO+vE,cAI9B,CAGD,GAAGl5E,KAAKg0E,UAEJ,YADAh0E,KAAKg0E,WAAY,GAIrBh0E,KAAK41E,WAAc+C,EAAO7iD,SAASr2B,MAAM1I,OAEzCiJ,KAAK61E,WAAa8C,EAAO7iD,SAASr2B,MAAMvB,KAAK2f,IAAc,CAACtb,GAAGsb,EAAGtb,GAAG5B,KAAKkd,EAAGld,SAG7E23E,QAAwBzG,iBAAiB8G,EAAO7iD,SAAS91B,KAAK+xE,aAAa2H,QAAQC,IAEnF35E,KAAK45E,aAAe,GAEpB,IAAK,IAAIvhF,EAAI,EAAGA,EAAIwgF,EAAcxgF,IAAK,CACnC,IAAIwhF,EAAW9vE,KAAKC,UAAUsuE,GAC9B,GAAGS,EAAShiF,OAAO,CACf,IAAI+iF,EAAU95E,KAAK43E,eACnBiC,EAAWA,EAAStH,WAAWwG,EAAS,GAAGe,GAC3Cf,EAAS19E,KAAKy+E,EACjB,CACD,IAAIztB,EAAStiD,KAAK0W,MAAMo5D,GACxB75E,KAAK45E,aAAav+E,KAAKgxD,EAC1B,CAED,aADMrsD,KAAK+5E,kBAAkBhB,GAbnB,IAeb,CAED,uBAAMgB,CAAkBhB,GAEpB,IAAIh7D,GAAW,EACXkB,EAAM,EACV,MAAQlB,GAAU,CACd,GAAG/d,KAAKg6E,cAAc,CAClBh6E,KAAKg6E,eAAgB,EACrB,KACH,OAEK,IAAIn+E,SAAQ8H,GAAK2J,WAAW3J,EAAG,OACrC,IAAIs2E,EAAWj6E,KAAK45E,aAAalnC,QAC7BwnC,EAASl6E,KAAK43E,eACfmB,EAAShiF,QAAUgiF,EAAS95D,KAAOi7D,EAASnB,EAAS95D,IACxD,IAAInd,QAAY9B,KAAKm6E,eAAeF,EAASC,GAE7Cl6E,KAAKw/E,kBAAkB19E,GAIvBmd,IACKjf,KAAK45E,aAAa7iF,SAAQgnB,GAAW,EAE7C,CAEJ,EC9IL,MAAM6hE,mBACFxoF,YACAg0B,aAAc,EACdy0D,mBACAC,gBAEA,WAAAhgF,GAAgB,CAEhB,iBAAMmP,CAAYvW,GACd,IAAImC,EAEJ,GAAiB,SAAbnC,EAAKyB,IACL,IAEA,IAAImxB,EAAY,IACZC,EAAa,IACbw0D,EAAU,GACVC,EAAa,GACblvD,EAAS,IAAI8e,OA6CjB,UA5CM9e,EAAOyB,aACPzB,EAAO9sB,MAeR8sB,EAAON,WAAWz5B,cACb+5B,EAAOj0B,IAAI,UAGNi0B,EAAON,WAAW5S,MAAMC,GACH,SAAzBA,EAAG2Q,cAAch2B,eAGlBs4B,EAAOj0B,IAAI,SACjBi0B,EAAOiB,iBAAmB,GAI9B/xB,KAAK6/E,mBAAqBppF,SAASC,cAAc,oBACjDsJ,KAAK6/E,mBAAmBnlF,UAAUmC,IAAI,eACtCmD,KAAK6/E,mBAAmBr0D,UAAYsF,EAAOtC,cAAch4B,KAAO2S,OAAO4C,SAASpV,KAChFqJ,KAAK6/E,mBAAmBp0D,OAASqF,EAAOtC,cAAcrO,MACtDngB,KAAK6/E,mBAAmBlpE,SAAWma,EACnC9wB,KAAK6/E,mBAAmBn0D,WAAaoF,EAAOtC,cAAch2B,KAC1D/B,SAAS6a,KAAK3Z,YAAYqI,KAAK6/E,oBAC1B/uD,EAAON,WAAWz5B,SACnBiJ,KAAK6/E,mBAAmBx0D,cAAe,GAE3CrrB,KAAK6/E,mBAAmBx0D,cAAe,EAElCrrB,KAAK6/E,mBAAmBr0D,YAAoD,0BAAtCxrB,KAAK6/E,mBAAmBr0D,WAA0CxrB,KAAK6/E,mBAAmBp0D,UACjIzrB,KAAK6/E,mBAAmBz0D,aAAc,GAEnCprB,KAAK6/E,mBAAmBx0D,oBACrB,IAAIxvB,SAAQ8H,GAAK2J,WAAW3J,EAAG,OAKzCo8E,EAAU//E,KAAK6/E,mBAAmBr0D,WAAau0D,EAC/CA,EAAUA,EAAQlpE,SAAS,KAAOkpE,EAAQz4E,MAAM,GAAI,GAAKy4E,EACzDz0D,EAAYtrB,KAAK6/E,mBAAmBv0D,WAAaA,EACjDC,EAAavrB,KAAK6/E,mBAAmBt0D,YAAcA,EACnDy0D,EAAahgF,KAAK6/E,mBAAmBp0D,OAErC,IAAIsG,EAAmB,EAEvBjB,EAAON,WAAW16B,SAAQ,CAAC+nB,EAAIoB,KACvBpB,EAAG2Q,cAAch2B,MAAQwH,KAAK6/E,mBAAmBn0D,aACjDqG,EAAmB9S,EACtB,IAKD6R,EAAOiB,kBAAoBA,IAC3BjB,EAAOiB,iBAAmBA,QACpBjB,EAAO9sB,OAKjB8sB,EAAOtC,cAAch4B,IAAMupF,EAC3BjvD,EAAOtC,cAAcrO,MAAQ6/D,QACvBlvD,EAAO9b,MAGb,IAAI6V,EAASp0B,SAASC,cAAc,UAEpCm0B,EAAOznB,MAAQkoB,EACfT,EAAOxnB,OAASkoB,EAChB,IACIvQ,EAKAitB,EACAg4C,EAPAC,EAAY,MAEXlgF,KAAK6/E,mBAAmBj0D,WAAc5rB,KAAK6/E,mBAAmB9zD,mBAAsB/rB,KAAK6/E,mBAAmBl0D,cAC7G3Q,EAAS6P,EAAOI,aAMhBjrB,KAAK6/E,mBAAmBl0D,aAAqD,UAAtC3rB,KAAK6/E,mBAAmBh0D,YAC/D7Q,EAAShb,KAAK6/E,mBAAmBl0D,YACjCu0D,EAAYllE,EAAOuT,UAAU,GAAsBvT,EAAOxd,QAAQ,aAGlEwC,KAAK6/E,mBAAmBl0D,aAAqD,SAAtC3rB,KAAK6/E,mBAAmBh0D,YAC/D7Q,EAAShb,KAAK6/E,mBAAmBl0D,YACjCu0D,EAAY,QAGZlgF,KAAK6/E,mBAAmBj0D,WAAmD,SAAtC5rB,KAAK6/E,mBAAmBh0D,YAC7Doc,EAAOjoC,KAAK6/E,mBAAmBj0D,UAC/Bs0D,EAAY,QAGZlgF,KAAK6/E,mBAAmB9zD,mBAA2D,SAAtC/rB,KAAK6/E,mBAAmBh0D,YACrEo0D,EAAejgF,KAAK6/E,mBAAmB9zD,kBACvCm0D,EAAY,QAEhB,IAAIC,EAAK,IAAIC,aACbpgF,KAAK8/E,sBAAwBK,EAAGxgE,kBAAkBmR,EAAOtC,eACzD,IAAI+pD,QAAqB4H,EAAGn/D,gBAAgB8P,EAAOtC,eAGnD3zB,EAAS,CACLnC,KACI,CACIsiB,SACAitB,OACAi4C,YACAD,eACA9lF,IAAK,OACLkmF,aAAc,CAACj9E,MAAOkoB,EAAWjoB,OAAQkoB,GACjEuF,OAAwBA,EACAlV,IAAKkV,EAAOiB,iBACZuuD,eAAgBtgF,KAAK8/E,gBACrBvH,gBAGX,CAAC,MAAO97E,GAML,OALAA,EAAEkY,QAAUlY,EAAEqwB,MACd3jB,OAAO8F,YAAY,CACf9U,IAAK,gBACLk6E,YAAa53E,KAEV,CACV,CAgBL,GAdiB,gBAAb/D,EAAKyB,MACLU,QAAemF,KAAKugF,oBAAoB,CAACC,OAAQ,QAASlpF,MAAOoB,EAAKye,SAGzD,0BAAbze,EAAKyB,MACLU,QAAemF,KAAKugF,oBAAoB,CAACC,OAAQ,mBAAoBlpF,MAAOoB,EAAKye,SAGpE,wBAAbze,EAAKyB,MACLU,QAAemF,KAAKugF,oBAAoB,CAACC,OAAQ9nF,EAAKiI,KAAMrJ,MAAOoB,EAAKpB,QACrEoB,EAAK+nF,cAAa5lF,EAAO,OAIf,qBAAbnC,EAAKyB,IAA4B,EACpB,IAAIy1C,QACVtd,iBAAiB55B,EAAK+4B,WAChC,CAID,GAAiB,eAAb/4B,EAAKyB,IAAsB,CAC3B,IAAIqmF,EACc,UAAd9nF,EAAKiI,OACL6/E,EAAS,SAGK,WAAd9nF,EAAKiI,OACL6/E,EAAS,UAEb3lF,QAAemF,KAAKugF,oBAAoB,CAACC,SAAQlpF,MAAOoB,EAAKpB,OAChE,CAED,GAAiB,iBAAboB,EAAKyB,IAAwB,CAE7B,IAAI22B,EAAS,IAAI8e,aACX9e,EAAOyB,aACPzB,EAAO9sB,MACb8sB,EAAOtC,cAAc8C,QAAQ1V,IAAMP,SAAS3iB,EAAKkjB,KACjDkV,EAAO9b,KACV,CAED,GAAiB,iBAAbtc,EAAKyB,IAAwB,CAC7B,IAAI22B,EAAS,IAAI8e,aACX9e,EAAOyB,aACPzB,EAAO9sB,MACb8sB,EAAOe,aAAe9nB,KAAK0W,MAAM/nB,EAAKgoF,SAASC,oBACzC7vD,EAAO0B,MAChB,CAGD,GAAiB,kBAAb95B,EAAKyB,IAAyB,CAC9B,IAAI22B,EAAS,IAAI8e,aACX9e,EAAOyB,aACPzB,EAAO9sB,MACb8sB,EAAOtC,cAAc8C,QAAQ/U,gBAAkB7jB,EAAK6jB,gBACpDuU,EAAO9b,KACV,CAGD,GAAiB,kBAAbtc,EAAKyB,IAAyB,CAC9B,IAAIgmF,EAAK,IAAIC,mBACPD,EAAGvhE,cAAclmB,EAAKo4B,OAAOtC,cAAe91B,EAAKglB,OAC1D,CAED,GAAiB,qBAAbhlB,EAAKyB,IAA4B,CACjC,IAAIgmF,EAAK,IAAIC,aAEbvlF,EAAS,CACLnC,KACI,CACIyB,IAAK,oBACLymF,mBALaT,EAAGn/D,gBAAgBtoB,EAAKo4B,OAAOtC,gBAQ3D,CAGD,GAAiB,aAAb91B,EAAKyB,IAAoB,CAEzB,IAAIunB,EAAQhpB,EAAKgpB,MACbxkB,EAAI,IAAI2jF,OAAYn/D,EAAMhE,QAE1B/H,QAAezY,EAAEohF,gBAAgB58D,EAAMo/D,SAAUp/D,EAAMo/D,SAAS5gF,KAAMwhB,EAAM88D,UAAW98D,EAAMq/D,eAAgBr/D,EAAMg9D,eAAgBh9D,EAAM1J,wBACzImoE,EAAK,IAAIC,aACbpgF,KAAKghF,YAAa,EAClB,IAAIhI,EAAkBt3D,EAAMo/D,SAAS9H,gBACrCrjE,EAAOqjE,gBAAkBA,EACzB,IAAI/hE,QAAekpE,EAAGzpE,MAAMhe,EAAKo4B,OAAOtC,cAAe7Y,GAGlD3V,KAAK5I,cACN4I,KAAK5I,YAAcke,cAActe,WAAUwzB,MAAOy2D,IAC9C,IAAKA,EAAQ,OACb,IAAKA,EAAOvjE,OAAQ,OACpB,IAAI5b,EAAMm/E,EAAOzkE,QAAQwB,OAAO9f,KAAK2f,IACjC,IAAIqB,EAAKrB,EAAGQ,UAAU,GAKlBM,EAAS,CAAC3D,OAHDkE,EAAG9G,OAGMqD,KAFXyD,EAAGzD,MAId,OAHewlE,EAAOzkE,QAAQuB,WAEhBY,EAAOZ,UAAW,GACzBY,CAAM,IAGjBxV,OAAO8F,YAAY,CACf9U,IAAK,eACLujB,OAAQujE,EAAOvjE,OACfyB,UAAWrd,EACXm3E,eAAgB9vE,OAAO+vE,eAG3B5jE,cAAcN,KAAK,KAKhB,MAARiC,IACCpc,EAAS,CACLnC,KACI,CACIyB,IAAK,eACLujB,OAAQgE,EAAMhE,OACdu7D,eAAgB9vE,OAAO+vE,aACvB/5D,UAAWlI,EACX+hE,oBAInB,CAGGn+E,GAAQsO,OAAO8F,YAAYpU,EAAOnC,KACzC,CAED,cAAMooF,CAASlxC,EAAQluB,GACnB,IAAIy+D,EAAK,IAAIC,aACb,GAAqB,iBAAV1+D,GAAsBA,aAAiBvV,OAAO,CACrD,MAAMnK,QAAiBD,MAAM2f,GAC7BA,QAAc1f,EAASE,MAC1B,CAED,IAAIhF,EAAI,IAAI2jF,OAAYn/D,EAAMhE,QAE1B/H,QAAezY,EAAEohF,gBAAgB58D,EAAMo/D,SAAUp/D,EAAMo/D,SAAS5gF,KAAMwhB,EAAM88D,UAAW98D,EAAMq/D,eAAgBr/D,EAAMg9D,eAAgBh9D,EAAM1J,uBAAuB0J,EAAMi9D,oBAEtK1nE,QAAekpE,EAAGzpE,MAAMk5B,EAAQj6B,GAEhC9a,EAAS,CACLnC,KACI,CACIyB,IAAK,eAEL8+E,eAAgB9vE,OAAO+vE,aACvB/5D,UAAWlI,IAI3B,GAAIpc,EACA,OAAOA,EAAOnC,IAGrB,CAGD,UAAM8F,CAAK0iF,GACPlhF,KAAKmhF,mBAAsB,CAAC3qF,IAAO0qF,GACnC,IAAIE,EAAUphF,KAAKo7B,sCAAsC,cACzD,GAAIimD,WAAWjnD,KAAM,CACjB,IAAIm+C,QAAmB6I,EAAQpgE,kBAC/BqgE,WAAWjnD,KAAKknD,QAAQ/I,aAAaA,CACxC,CAEJ,CAED,qBAAMgJ,CAAgB9B,EAAaD,EAAkBH,EAAehI,EAAS+H,GAE3Dp/E,KAAKo7B,sCAAsC,cACjD1kB,MAAM+oE,EAAaD,EAAkBnI,EAASgI,EAAeD,EAExE,CACD,yBAAMoC,CAAoBjC,EAAWC,EAAkBH,EAAehI,EAAS+H,GAE7Dp/E,KAAKo7B,sCAAsC,cACjDkkD,UAAUC,EAAWC,EAAkBnI,EAASgI,EAAeD,EAE1E,CAED,yBAAMmB,CAAoBhoF,GACtB,IAAIu4B,EAAS,IAAI8e,aACX9e,EAAOyB,aACPzB,EAAO9sB,MACM,IAAhBzL,EAAQioF,OACP1vD,EAAOtC,cAAgBj2B,EAAQjB,MAE/Bw5B,EAAOtC,cAAcj2B,EAAQioF,QAAUjoF,EAAQjB,YAG7Cw5B,EAAO9b,MAEb,IAAImrE,EAAK,IAAIC,aAab,OAXIpgF,KAAK8/E,kBAAiB9/E,KAAK8/E,sBAAwBK,EAAGxgE,kBAAkBmR,EAAOtC,gBAGpE,CACX91B,KACI,CACIyB,IAAK,eACLyhB,IAAKkV,EAAOiB,iBACZuuD,eAAgBtgF,KAAK8/E,iBAIpC,CAED,qCAAA1kD,CAAsC4lD,GAClC,IAAIS,EAAWzhF,KAAK6/E,oBAAoBlpE,UAAY,KACpD,OAAGqqE,GAAchhF,KAAKghF,YAClBhhF,KAAKghF,YAAa,EACfhhF,KAAKmhF,qBAAqBM,EAAWzhF,KAAKmhF,qBACzCM,GAAYzhF,KAAK6/E,oBAAoBlpE,WAAU8qE,EAAWzhF,KAAK6/E,oBAAoBlpE,UAChFsoE,gBAAgBlL,YAAY0N,IAEhC3N,MAAMC,YAAY0N,EAC5B,EAML,IAAIC,KAAO,IAAI9B,oIC3YA5kF,wBAEAsG,UAAUO,WAkCR,MAAAqO,EAAUyxE,eAGvBzmF,SAAO,UAjBesvB,eAAQ7pB,GACtB,MAAO,YAAPA,EACW,IAAA9E,SAAQC,IACfA,EAAQ6lF,QAAgB,UAGhBrgF,UAAUC,QAAQZ,EAAKnI,UDgX/C2Q,OAAO8U,mBAAqByjE"}